{
  "service_name": "sql",
  "display_name": "Azure Sql",
  "functions": [
    {
      "name": "sql_database_no_any_ip_ingress",
      "category": "Network",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Restrict ingress from any IP to SQL databases.",
      "notes": "Configure firewall rules to block public access."
    },
    {
      "name": "sql_server_tde_protector_encrypted_with_cmk",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Encrypt TDE protector with customer-managed key.",
      "notes": "Set up CMK for TDE protection."
    },
    {
      "name": "sql_server_azuread_admin_configured",
      "category": "Identity",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Configure Azure AD admin for SQL server.",
      "notes": "Enable Azure AD authentication for SQL server."
    },
    {
      "name": "sql_database_data_encryption_on",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Enable data encryption for SQL databases.",
      "notes": "Ensure encryption is enabled for all databases."
    },
    {
      "name": "sql_server_vulnerability_assessment_storage_account_set",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Set storage account for vulnerability assessment.",
      "notes": "Configure storage for assessment reports."
    },
    {
      "name": "sqlserver_vulnerabilityassessment_periodic_recurring_scans_on",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Enable periodic recurring scans for vulnerability assessment.",
      "notes": "Schedule regular scans for compliance."
    },
    {
      "name": "sqlserver_vulnerability_assessment_scan_reports_configured",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Configure scan reports for vulnerability assessment.",
      "notes": "Ensure scan reports are generated and stored."
    },
    {
      "name": "sqlserver_vulnerabilityassessment_email_notifications_admins_set",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Set email notifications for vulnerability assessment admins.",
      "notes": "Configure notifications for assessment results."
    },
    {
      "name": "sql_server_tde_protector_encryption_cmk",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Encrypt TDE protector using CMK.",
      "notes": "Ensure TDE protector uses customer-managed key."
    },
    {
      "name": "sql_database_monitor_logs_enabled",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Enable monitor logs for SQL databases.",
      "notes": "Configure monitoring for all databases."
    },
    {
      "name": "sql_database_backup_not_public",
      "category": "Storage",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Ensure backups are not publicly accessible.",
      "notes": "Restrict access to backup files."
    },
    {
      "name": "sql_database_cluster_automatic_backup_policy_protected",
      "category": "Storage",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Protect automatic backup policy for clusters.",
      "notes": "Automate backup policy protection."
    },
    {
      "name": "sql_database_backup_enabled_retention_period_window",
      "category": "Storage",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Enable backup retention period window.",
      "notes": "Configure retention for backups."
    },
    {
      "name": "azure_sql_database_in_backup_policy",
      "category": "Storage",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Include Azure SQL database in backup policy.",
      "notes": "Ensure all databases are covered by backup policy."
    },
    {
      "name": "sql_managed_instance_backup_policy_inclusion",
      "category": "Storage",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Include managed instance in backup policy.",
      "notes": "Automate inclusion of managed instances."
    },
    {
      "name": "sql_database_encryption_at_rest_enabled",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Enable encryption at rest for SQL databases.",
      "notes": "Configure encryption for all stored data."
    },
    {
      "name": "sql_database_backup_encryption_enabled",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Enable encryption for database backups.",
      "notes": "Ensure backups are encrypted."
    },
    {
      "name": "sql_database_storage_encryption_enabled",
      "category": "Storage",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Enable storage encryption for SQL databases.",
      "notes": "Configure encryption for storage accounts."
    },
    {
      "name": "sql_database_auto_minor_version_upgrade_enabled",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Enable auto minor version upgrade for SQL databases.",
      "notes": "Automate upgrades for compliance."
    },
    {
      "name": "sql_database_managed_instance_aad_authentication_enabled",
      "category": "Identity",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Enable AAD authentication for managed instances.",
      "notes": "Configure Azure AD for managed instances."
    },
    {
      "name": "sql_database_aad_authentication_enabled",
      "category": "Identity",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Enable AAD authentication for SQL databases.",
      "notes": "Configure Azure AD for all databases."
    },
    {
      "name": "sql_database_encrypted_at_rest",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Ensure SQL database is encrypted at rest.",
      "notes": "Verify encryption for stored data."
    },
    {
      "name": "sql_database_data_masking_compliance_with_policy_and_business_reqs",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Ensure data masking complies with policy and business requirements.",
      "notes": "Automate data masking configuration."
    },
    {
      "name": "sql_database_table_info_access_control_policies",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Implement access control policies for table info.",
      "notes": "Configure access controls for sensitive tables."
    },
    {
      "name": "sqlserver_auditing_on",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Enable auditing for SQL server.",
      "notes": "Configure auditing for compliance."
    },
    {
      "name": "monitor_alert_sqlserver_enabled",
      "category": "Security",
      "execution_type": "Code Executable",
      "remediation_effort": "Programmable",
      "description": "Enable monitoring alerts for SQL server.",
      "notes": "Set up alerts for critical events."
    }
  ],
  "summary": {
    "total_functions": 26,
    "categories": [
      "Identity",
      "Storage",
      "Security",
      "Network"
    ],
    "execution_types": [
      "Code Executable"
    ],
    "remediation_efforts": [
      "Programmable"
    ]
  }
}