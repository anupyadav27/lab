[
  {
    "id": "1.1",
    "title": "(L1) Ensure 'User access to environments is controlled with Security Groups'",
    "assessment": "Manual",
    "description": "If the organization has multiple Microsoft Dataverse environments, security groups can be used to control which licensed users can be a member of a particular environment.",
    "rationale": "Limiting the access and permissions for the accounts that needs access to the information, reduces the risk of having users with improper access to data in the environment. Impact: Users with legitimate needs to an environment might not be able to access the environment if they are not part of the correct security group.",
    "audit": "Verify that user access to environments is controlled with security groups. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Edit on the Details pane of the environment. 3. Select the pencil icon under Security group. 4. Ensure the appropriate group(s) are selected.",
    "remediation": "Ensure that user access to environments is controlled with security groups. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Edit on the Details pane of the environment. 3. Select the pencil icon under Security group. 4. Select the appropriate security group. 5. Select Done followed by Save.   Default Value: N/A References: 1. https://docs.microsoft.com/en-us/power-platform/admin/control-user-access",
    "function_names": [
      "dataverse_environment_security_group_access_controlled",
      "dataverse_environment_user_access_restricted",
      "dataverse_environment_security_group_assigned",
      "dataverse_environment_licensed_user_access_limited",
      "dataverse_environment_security_group_membership_enforced"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Users with legitimate needs to an environment might not be able to access the environment if they are not part of the correct security group.",
    "references": "1. https://docs.microsoft.com/en-us/power-platform/admin/control-user-access"
  },
  {
    "id": "1.2",
    "title": "(L1) Ensure 'User sessions are terminated upon time limit exceeded and user logoff'",
    "assessment": "Manual",
    "description": "The Dynamics 365 platform can be configured with a user session expiration time and inactivity timeout. The recommended state for this setting is: 120 minutes.",
    "rationale": "By default, the timeout for a user\u2019s session is set to 24 hours which means the user is not required to re-enter their login details for up to 24 hours. Whenever a Dynamics 365 user sessions is started, a unique session ID and other session information are generated. Such information can be used be a malicious user to hijack the session. By terminating sessions upon user logoff and idle time limit, the underlying session information is invalidated. Therefore, the potential for the session to be hijacked is removed. Impact: User session will be terminated after two hours.",
    "audit": "Verify that user sessions are terminated upon user logoff and when the idle time limit is exceeded. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Settings. 3. Expand Product then select Privacy + Security. 4. Under Session Expiration ensure the slider is set to On. Confirm the length and timeout as determined by organizational policy. 5. Under Inactivity timeout ensure the slider is set to On. Confirm the duration for timeout and warning as determined by organizational policy. 6. Click Save.",
    "remediation": "Ensure that user sessions are terminated upon user logoff and when the idle time limit is exceeded. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Settings. 3. Expand Product then select Privacy + Security. 4. Under Session Expiration move the slider to On. Enter the session length and timeout as determined by organizational policy. 5. Under Inactivity timeout move the slider to On. Enter the duration for timeout and warning as determined by organizational policy. 6. Click Save. Note: These settings apply to all users in the environment. Default Value: \u2022 Maximum Session Length: 1440 minutes \u2022 Minimum Session Length: 60 minutes \u2022 How long before session expires before showing timeout warning: 20 minutes \u2022 The updated settings will be effective the next time the user signs into the application. References: 1. https://docs.microsoft.com/en-us/power-platform/admin/user-session- management",
    "function_names": [
      "dynamics365_user_session_timeout_enabled",
      "dynamics365_user_session_inactivity_timeout_enabled",
      "dynamics365_user_session_termination_on_logoff_enabled",
      "dynamics365_user_session_max_duration_120m",
      "dynamics365_user_session_inactivity_timeout_120m"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "User session will be terminated after two hours.",
    "references": "1. https://docs.microsoft.com/en-us/power-platform/admin/user-session- management"
  },
  {
    "id": "1.3",
    "title": "(L1) Ensure 'Administrative accounts are separate, unassigned, and cloud-only'",
    "assessment": "Manual",
    "description": "Administrative accounts are special privileged accounts that could have varying levels of access to data, users, and settings. Each system administrator should utilize two (2) separate accounts, an administrator account to perform administrative tasks and a separate account for daily activities such as checking email. Users should only sign in with system administrator account to perform administrative tasks in the environment.",
    "rationale": "Users with the system administrator role automatically have access to records, system, and custom entities. Creating separate administrative accounts can reduce the risk of credential theft and other types of attacks. Impact: Administrative users will have to switch accounts utilizing the login/logout functionality when performing administrative tasks.",
    "audit": "Verify there are separate administrative accounts being utilized. In the Microsoft 365 Admin Center: 1. Log in to https://admin.microsoft.com as a Global Administrator. 2. Select Users > Active users then sort by the User type column. 3. Verify that Administrators have a dedicated administrative and regular user account.",
    "remediation": "Ensure each administrator has an administrative and regular user account. In the Microsoft 365 Admin Center: 1. Log in to https://admin.microsoft.com as a Global Administrator. 2. Go to Users and then Active users and select Add a user. 3. Fill out the appropriate fields for Name, user, domain, password etc. 4. When prompted to assign licenses select Create user without product license (not recommended), then click Next. 5. Under the Option settings choose Admin center access followed by the appropriate role then click Next. 6. Select Finish adding. Note: Take into account the proper and valid licensing requirements and attribute the security roles inside power platform with the least privilege approach. Default Value: N/A References: 1. https://docs.microsoft.com/en-us/power-platform/admin/create-users#create-a- user-account 2. https://docs.microsoft.com/en-us/power-platform/admin/prevent-elevation- security-role-privilege 3. https://docs.microsoft.com/en-us/microsoft-365/admin/add-users/add- users?view=o365-worldwide Additional Information: The following setting should also be considered: \u2022 Don\u2019t stay signed in with a system administrator account Staying signed in with a system administrator account when specific administrative tasks are not being performed can increase exposure to phishing attacks. System administrators should sign in as needed to do specific tasks and then sign out.",
    "function_names": [
      "iam_user_no_daily_use_admin_privileges",
      "iam_user_admin_account_separate",
      "iam_user_admin_account_cloud_only",
      "iam_user_no_regular_activity_admin_account",
      "iam_user_admin_account_unassigned",
      "iam_user_admin_account_no_regular_login",
      "iam_user_admin_account_no_email_access",
      "iam_user_admin_account_no_non_admin_tasks"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Administrative users will have to switch accounts utilizing the login/logout functionality when performing administrative tasks.",
    "references": "1. https://docs.microsoft.com/en-us/power-platform/admin/create-users#create-a- user-account 2. https://docs.microsoft.com/en-us/power-platform/admin/prevent-elevation- security-role-privilege 3. https://docs.microsoft.com/en-us/microsoft-365/admin/add-users/add- users?view=o365-worldwide Additional Information: The following setting should also be considered: \u2022 Don\u2019t stay signed in with a system administrator account Staying signed in with a system administrator account when specific administrative tasks are not being performed can increase exposure to phishing attacks. System administrators should sign in as needed to do specific tasks and then sign out."
  },
  {
    "id": "1.4",
    "title": "(L2) Ensure 'Multifactor authentication for all users' is 'Enabled'",
    "assessment": "Manual",
    "description": "Enable multifactor authentication (MFA) for all users in the Microsoft 365 tenant. MFA is an authentication method which requires the user to provide two (or more) pieces of information to gain access to the system or application. There are several options for MFA within the Microsoft 365 tenant: \u2022 Authentication code received via text message to a registered mobile phone number. \u2022 Mobile authentication application like Microsoft Authenticator.",
    "rationale": "Multifactor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multifactor authentication provides additional assurance that the individual attempting to gain access is who they claim to be. With multifactor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk. Users will be prompted to authenticate with a second factor upon logging in to Microsoft 365 services. Impact: Implementation of multifactor authentication for all users will necessitate a change to users' routine. All users will be required to enroll in multifactor authentication using a mobile phone or an authentication application. After enrollment, use of multifactor authentication will be required for future authentication to the environment.",
    "audit": "Verify the multifactor authentication is configured for all users. In the Microsoft 365 Admin Center: 1. Log in to https://admin.microsoft.com as a Global Administrator. 2. Go to Admin centers and click on Azure Active Directory. 3. Select Enterprise applications then, under Security, select Conditional Access. 4. Review the list of policies and ensure that there is a policy that requires the Grant access control with Require multi-factor authentication for All users under Users and groups Verify the multifactor authentication configuration for administrators, using the M365 SecureScore service: 1. Log in to the Secure Score portal https://security.microsoft.com as a Global Administrator or another custom admin role. 2. Click on Require MFA for all users policy to check MFA for all users. 3. It will show the number of users who do not have MFA configured. This information is also available via the Microsoft Graph Security API: GET https://graph.microsoft.com/beta/security/secureScores",
    "remediation": "Enable multifactor authentication for all users. In the Microsoft 365 Admin Center: 1. Log in to https://admin.microsoft.com as a Global Administrator. 2. Go to Admin centers and click on Azure Active Directory. 3. Select Enterprise applications then, under Security, select Conditional Access. 4. Click New policy 5. Select Cloud apps or actions > All cloud apps (and don't exclude any apps) 6. Go to Assignments > Users and groups > Include > select All users (and do not exclude any user). 7. Access Controls > Grant > Require multi-factor authentication (and nothing else) 8. Conditions > Client Apps > Configure (Yes) > Explicitly select Browser, Mobile apps and desktop clients, Modern authentication clients, Exchange ActiveSync clients, and Other clients 9. Leave all other conditions blank 10. Make sure the policy is enabled 11. Create Default Value: Disabled References: 1. https://docs.microsoft.com/en-us/microsoft-365/admin/security-and- compliance/set-up-multi-factor-authentication?view=o365-worldwide",
    "function_names": [
      "m365_user_mfa_enabled",
      "m365_user_mfa_enabled_all_users",
      "m365_user_mfa_enabled_all_accounts",
      "m365_user_authentication_mfa_enabled",
      "m365_user_security_mfa_enabled",
      "m365_user_mfa_enabled_all_identities",
      "m365_user_mfa_enabled_all_tenant_users",
      "m365_user_mfa_enabled_all_human_users",
      "m365_user_mfa_enabled_all_non_service_accounts",
      "m365_user_mfa_enabled_all_interactive_users"
    ],
    "profile_applicability": "\u2022 Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "Implementation of multifactor authentication for all users will necessitate a change to users' routine. All users will be required to enroll in multifactor authentication using a mobile phone or an authentication application. After enrollment, use of multifactor authentication will be required for future authentication to the environment.",
    "references": "1. https://docs.microsoft.com/en-us/microsoft-365/admin/security-and- compliance/set-up-multi-factor-authentication?view=o365-worldwide"
  },
  {
    "id": "2.1",
    "title": "(L1) Ensure 'Creation of new trial, production, and sandbox environments' is restricted to 'Administrators'",
    "assessment": "Manual",
    "description": "An environment is a space to store, manage, and share organizational data, apps, and flows. It also serves as a container to separate apps that may have different roles, security requirements, or target audiences. Power Apps automatically creates a single default environment for each tenant, which is shared by all users in that tenant. For managing environments centrally and to prevent environment sprawl, it is suggested to limit the ability of environment creation to specific users.",
    "rationale": "Any PowerApps licensed user can create an environment. If someone in the organization is on a Power Apps or Power Automate per-user plan, they may have permission to create their own environment. These environments can be used and shared by Dynamics 365, Power Apps portals and apps, and Power Automate flows. Environments can store multiple Dataverse tables. Power Platform apps and Dynamics 365 can then connect to, read from, and write to these tables, which would likely be shared across multiple applications/processes. It is suggested to restrict the power platform environment creation for just administrators and restrict the access for this feature for a limited number of users. Impact: Enabling this feature may slow the user\u2019s individual productivity, but could also prevent duplicated efforts, inconsistent data, scattered naming conventions, and data leakage. Note: After enabling this feature, only the Tenant Admin or members of the Power Platform Admin Group will be able to create new environments (if non-admins are disabled). Each environment requires 1GB of space before provisioning a new environment.",
    "audit": "Verify that the creation of new trial, production, and sandbox environment is restricted to administrators. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select the gear icon in the top right corner then select Power Platform Settings. 3. Under Who can create production and sandbox environments ensure that Only specific admins is selected. Note: This restricts creation to Global admins, Dynamics 365 service admins, Power Platform service admins, and Delegated admins. 4. Under Who can create trial environments ensure that Only specific admins is selected. Note: This restricts creation to Global admins, Dynamics 365 service admins, Power Platform service admins, and Delegated admins.",
    "remediation": "Ensure that the creation of new trial, production, and sandbox environment is restricted to administrators. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select the gear icon in the top right corner then select Power Platform Settings. 3. Under Who can create production and sandbox environments select Only specific admins. Note: This restricts creation to Global admins, Dynamics 365 service admins, Power Platform service admins, and Delegated admins 4. Under Who can create trial environments select Only specific admins. Note: This restricts creation to Global admins, Dynamics 365 service admins, Power Platform service admins, and Delegated admins 5. Click Save  Default Value: Everyone / Unrestricted   References: 1. https://docs.microsoft.com/en-us/power-platform/admin/control-environment- creation#control-environment-creation-through-powershell 2. https://docs.microsoft.com/en-us/power-platform/admin/create-environment",
    "function_names": [
      "power_platform_environment_creation_restricted_to_admins",
      "power_platform_environment_admin_only_creation",
      "power_platform_environment_creation_admin_restricted",
      "power_platform_environment_creation_permission_restricted",
      "power_platform_environment_creation_admin_only"
    ],
    "profile_applicability": "\u2022 Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Enabling this feature may slow the user\u2019s individual productivity, but could also prevent duplicated efforts, inconsistent data, scattered naming conventions, and data leakage. Note: After enabling this feature, only the Tenant Admin or members of the Power Platform Admin Group will be able to create new environments (if non-admins are disabled). Each environment requires 1GB of space before provisioning a new environment.",
    "references": "1. https://docs.microsoft.com/en-us/power-platform/admin/control-environment- creation#control-environment-creation-through-powershell 2. https://docs.microsoft.com/en-us/power-platform/admin/create-environment"
  },
  {
    "id": "2.2",
    "title": "(L1) Ensure 'Security roles provide access to the minimum amount of business data required'",
    "assessment": "Manual",
    "description": "Users should only have access to data that they really require access to. Make use of the predefined security roles whenever possible and assure the minimum privileges required for the roles and for the users to perform their activities.",
    "rationale": "Microsoft Dynamics 365 makes use of the Dataverse and role-based security model to help secure the access. It also comes with predefined security roles that can be used for granting user access. If the permission for a predefined role requires customization, copy one that exists and work under the copied role, keeping the integrity of the original role. It is important to apply the least privilege and need-to-know principle when customizing and granting users and roles permissions. Details in the reference links. Limiting the access and permissions for the accounts that needs access to the information, reduces the risk of having users with improper access to data in the environment and compromising the integrity/confidentiality of the data. Impact: If not configured correctly, users with need-to-know might not have access to business data.",
    "audit": "Ensure that user access to the environment is controlled with security groups. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Settings. 3. Expand Users + permissions then select Security roles. 4. Analyze the predefined Security Roles to determine which fits the environmental needs. 5. Under the More actions click the 3 dots and select copy to audit the roles.",
    "remediation": "Change user roles to meet environment needs via security groups. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Settings. 3. Expand Users + permissions then select Security roles. 4. Edit the Security Role to fit environmental needs. References: 1. https://learn.microsoft.com/en-us/dynamics365/customerengagement/on- premises/developer/security-dev/how-role-based-security-control-access- entities?view=op-9-1",
    "function_names": [
      "iam_role_minimum_data_access",
      "iam_user_minimum_data_access",
      "iam_role_predefined_usage",
      "iam_user_predefined_usage",
      "iam_role_least_privilege",
      "iam_user_least_privilege",
      "iam_role_data_access_scope",
      "iam_user_data_access_scope"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "If not configured correctly, users with need-to-know might not have access to business data.",
    "references": "1. https://learn.microsoft.com/en-us/dynamics365/customerengagement/on- premises/developer/security-dev/how-role-based-security-control-access- entities?view=op-9-1"
  },
  {
    "id": "2.3",
    "title": "(L1) Ensure 'Set blocked file extensions' is configured to match the enterprise block list",
    "assessment": "Manual",
    "description": "This setting prevents the upload or download of certain attachment types that are considered dangerous.",
    "rationale": "Dynamics 365 comes with a predefined extensions list that is blocked in the tool; it is required to have it as restricted as possible, allowing just the extensions that are required for business purposes. Consider updating the blocked extensions periodically. Impact: File types that are legitimate might be blocked.",
    "audit": "Verify the 'Set blocked file extensions' is configured to match the organizations block list. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Settings. 3. Expand Product then select Privacy + Security. 4. Review the list extensions to ensure it matches the organizations block list.",
    "remediation": "Ensure the 'Set blocked file extensions' is configured to match the organizations block list. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Settings. 3. Expand Product then select Privacy + Security. 4. Add extensions as relevant to the organization.   Default Value: ade; adp; app; asa; ashx; asmx; asp; bas; bat; cdx; cer; chm; class; cmd; com; config; cpl; crt; csh; dll; exe; fxp; hlp; hta; htr; htw; ida; idc; idq; inf; ins; isp; its; jar; js; jse; ksh; lnk; mad; maf; mag; mam; maq; mar; mas; mat; mau; mav; maw; mda; mdb; mde; mdt; mdw; mdz; msc; msh; msh1; msh1xml; msh2; msh2xml; mshxml; msi; msp; mst; ops; pcd; pif; prf; prg; printer; pst; reg; rem; scf; scr; sct; shb; shs; shtm; shtml; soap; stm; tmp; url; vb; vbe; vbs; vsmacros; vss; vst; vsw; ws; wsc; wsf; wsh References: 1. https://docs.microsoft.com/en-us/power-platform/admin/settings-privacy-security",
    "function_names": [
      "storage_bucket_blocked_file_extensions_configured",
      "storage_bucket_blocked_file_extensions_matching_enterprise_list",
      "storage_bucket_upload_restrictions_enabled",
      "storage_bucket_download_restrictions_enabled",
      "storage_bucket_attachment_type_blocking_enabled",
      "storage_bucket_enterprise_block_list_applied",
      "storage_bucket_file_extension_blocking_enabled",
      "storage_bucket_secure_upload_download_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "File types that are legitimate might be blocked.",
    "references": "1. https://docs.microsoft.com/en-us/power-platform/admin/settings-privacy-security"
  },
  {
    "id": "2.4",
    "title": "(L2) Ensure 'Access to the environment is restricted by location'",
    "assessment": "Manual",
    "description": "Location condition in Azure AD Conditional Access, controls access to cloud apps based on the network location of a user. The location condition is commonly used to block access from countries/regions where organizations know traffic should not come from. Restrict access to users by location to reduce unauthorized access.",
    "rationale": "Conditional access policies controls access to cloud apps based on the network location of a user. It then blocks access from countries/regions where it knows traffic should not come from reducing the risk of a breach. Impact: When location restrictions are set in a user\u2019s profile and the user tries to sign in from a blocked location, access to customer engagement apps (Dynamics 365 Sales, Dynamics 365 Customer Service, Dynamics 365 Field Service, Dynamics 365 Marketing, Dynamics 365 Project Service Automation), and Finance and Operations apps are denied. Requirements for using conditional access: \u2022 A subscription to Azure Active Directory Premium. \u2022 A federated Azure Active Directory tenant.",
    "audit": "Verify that access to the environment is restricted by location. In the Microsoft 365 Admin Center: 1. Log in to https://admin.microsoft.com as a Global Administrator or Conditional Access administrator. 2. Go to Admin centers and click on Azure Active Directory. 3. Select Enterprise applications then, under Security, select Conditional Access. 4. Ensure a policy exists to restrict location.",
    "remediation": "Ensure access to the environment is restricted by location. In the Microsoft 365 Admin Center: 1. Log in to https://admin.microsoft.com as a Global Administrator or Conditional Access administrator. 2. Go to Admin centers and click on Azure Active Directory. 3. Select Enterprise applications then, under Security, select Conditional Access. 4. Click New policy and create a name. 5. Go to Assignments > Users or workload identity > Users and groups > 6. Under Include > select All users (and do not exclude any user). 7. Under Exclude, select Users and groups, add the organizations emergency access or break-glass accounts. 8. Select Cloud apps or actions > Include and click Select apps 9. Choose Microsoft Dataverse Application or Microsoft Dynamics ERP for Finance and Operations application. 10. Select Conditions > Location configure to Yes 11. Under Include select Selected locations a. Select the blocked location created for the organization. b. Click Select. 12. Select Access controls > click Block Access and click Select. 13. Confirm the settings and set Enable policy to Report-only. 14. Click Create to create and enable the policy. Default Value: N/A References: 1. https://docs.microsoft.com/en-us/azure/active-directory/conditional- access/howto-conditional-access-policy-location#create-a-conditional-access- policy 2. https://docs.microsoft.com/en-us/power-platform/admin/restrict-access-online- trusted-ip-rules",
    "function_names": [
      "conditional_access_policy_location_restricted",
      "conditional_access_policy_location_blocked_regions",
      "conditional_access_policy_location_allowed_countries",
      "conditional_access_policy_location_based_access_control",
      "conditional_access_policy_geo_restriction_enabled",
      "conditional_access_policy_trusted_locations_configured",
      "conditional_access_policy_untrusted_locations_blocked",
      "conditional_access_policy_ip_range_restricted",
      "conditional_access_policy_country_filter_enabled",
      "conditional_access_policy_network_location_restricted"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "When location restrictions are set in a user\u2019s profile and the user tries to sign in from a blocked location, access to customer engagement apps (Dynamics 365 Sales, Dynamics 365 Customer Service, Dynamics 365 Field Service, Dynamics 365 Marketing, Dynamics 365 Project Service Automation), and Finance and Operations apps are denied. Requirements for using conditional access: \u2022 A subscription to Azure Active Directory Premium. \u2022 A federated Azure Active Directory tenant.",
    "references": "1. https://docs.microsoft.com/en-us/azure/active-directory/conditional- access/howto-conditional-access-policy-location#create-a-conditional-access- policy 2. https://docs.microsoft.com/en-us/power-platform/admin/restrict-access-online- trusted-ip-rules"
  },
  {
    "id": "2.5",
    "title": "(L1) Ensure 'Cross-tenant isolation is enabled for Power Platform Apps and Flows'",
    "assessment": "Manual",
    "description": "Microsoft Power Platform has a rich ecosystem of connectors based on Azure Active Directory (Azure AD) that allow authorized Azure AD users to build compelling apps and flows establishing connections to the business data available through these data stores. Tenant isolation makes it easy for administrators to ensure that these connectors can be harnessed in a safe and secure way within the tenant while minimizing the risk of data exfiltration outside the tenant. Tenant isolation allows admins to effectively govern the movement of tenant data from Azure AD authorized data sources to and from their tenant. With tenant isolation On, all tenants are restricted. Inbound (connections to the tenant from external tenants) and outbound (connections from the tenant to external tenants) cross-tenant connections are blocked by Power Platform even if the user presents valid credentials to the Azure AD-secured data source. Rules can be used to add exceptions. Note: Power Platform tenant isolation is different from Azure AD-wide tenant restriction. It doesn't impact Azure AD-based access outside of Power Platform. Power Platform tenant isolation only works for connectors using Azure AD-based authentication such as Office 365 Outlook or SharePoint.",
    "rationale": "Cross-tenant isolation restricts how other tenants connect. Applied at the connector level, cross-tenant isolation blocks inbound or outbound connections for canvas apps and flows. An attacker can compromise an account and create a connection in order to maintain persistent access to the user\u2019s account.   Impact: Restricting outbound connections means that a user is blocked from connecting to a third-party tenant. (Restricting outbound cross-tenant connections can be done using tenant restrictions that apply to all Azure Active Directory (Azure AD) software as a service (SaaS) cloud apps, or at the connector level, which would block outbound connections just for canvas apps and flows.) Restricting inbound connections means that a user in a third-party tenant is blocked from creating a connection to the tenant. (Restricting inbound cross-tenant connections requires a support ticket\u2014this restriction then only applies to Power Apps and Power Automate.) Enable the configurations below will prevent communication with any other tenant. Warning: Perform an impact analysis before implementation. Requirements for using cross-tenant isolation: \u2022 A subscription to Azure Active Directory Premium. \u2022 A federated Azure Active Directory tenant. Admins can specify an explicit allowlist of tenants that they want to enable inbound, outbound, or both, which will bypass tenant isolation controls when configured. Admins can use a special pattern \u201c*\u201d to allow all tenants in a specific direction when tenant isolation is turned on. All other cross-tenant connections except the ones in the allowlist are rejected by Power Platform.",
    "audit": "Verify that cross-tenant isolation is enabled. In the Power Platform Admin Center: \u2022 Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. \u2022 Select Tenant isolation (preview). \u2022 Confirm that tenant isolation is on.",
    "remediation": "Ensure that tenant restrictions for outbound connections are setup: There are two steps to get started with tenant restrictions. First, make sure that clients can connect to the right addresses. Second, configure proxy infrastructure. 1. URLs and IP addresses: a) To use tenant restrictions, clients must be able to connect to the following Azure AD URLs to authenticate: login.microsoftonline.com, login.microsoft.com, and login.windows.net. b) Additionally, to access Office 365, clients must also be able to connect to the fully qualified domain names (FQDNs), URLs, and IP addresses defined in Office 365 URLs and IP address ranges. 2. Proxy configuration and requirements: a) The following configuration is required to enable tenant restrictions through the proxy infrastructure. This guidance is generic, refer to the proxy vendor' documentation for specific implementation steps. b) Prerequisites: 1. The proxy must be able to perform TLS interception, HTTP header insertion, and filter destinations using FQDNs/URLs. 2. Clients must trust the certificate chain presented by the proxy for TLS communications. For example, if certificates from an internal public key infrastructure (PKI) are used, the internal issuing root certificate authority certificate must be trusted. 3. Azure AD Premium 1 licenses are required for use of Tenant Restrictions. c) Configuration: 1. For each outgoing request to login.microsoftonline.com, login.microsoft.com, and login.windows.net, insert two HTTP headers: Restrict-Access-To-Tenants and Restrict-Access- Context.   Note: Do not include subdomains under *.login.microsoftonline.com in the proxy configuration. Doing so will include device.login.microsoftonline.com and will interfere with Client Certificate authentication, which is used in Device Registration and Device- based Conditional Access scenarios. Configure the proxy server to exclude device.login.microsoftonline.com and enterpriseregistration.windows.net from TLS break-and-inspect and header injection. 3. The headers should include the following elements: 1. For Restrict-Access-To-Tenants, use a value of permitted tenant list, which is a comma-separated list of tenants that allow users to access. Any domain that is registered with a tenant can be used to identify the tenant in this list, as well as the directory ID itself. For an example of all three ways of describing a tenant, the name/value pair to allow Contoso, Fabrikam, and Microsoft looks like: Restrict-Access-To-Tenants: contoso.com,fabrikam.onmicrosoft.com,72f988bf-86f1-41af-91ab- 2d7cd011db47 2. For Restrict-Access-Context, use a value of a single directory ID, declaring which tenant is setting the tenant restrictions. Example: Declare Contoso as the tenant that set the tenant restrictions policy, the name/value pair looks like: Restrict-Access-Context: 456ff232-35l2-5h23-b3b3- 3236w0826f3d. Use the environments directory ID here to get logs for these authentications. If any directory ID other than the environments being set up, those sign-in logs will appear in another tenant, with all personal information removed. For more information, see Admin experience. To prevent users from inserting their own HTTP header with non-approved tenants, the proxy needs to replace the Restrict-Access-To-Tenants header if it is already present in the incoming request. Clients must be forced to use the proxy for all requests to login.microsoftonline.com, login.microsoft.com, and login.windows.net. For example, if PAC files are used to direct clients to use the proxy, end users shouldn't be able to edit or disable the PAC files. 4. Inbound Connections: 1. Browse to the Power Platform admin center, select Help + support. 2. Under the New support request option, fill out the information required regarding the environment. Default Value: Tenant isolation is not activated by default.   References: 1. https://docs.microsoft.com/en-us/power-platform/admin/cross-tenant-restrictions 2. https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/tenant- restrictions 3. https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/tenant- restrictions#admin-experience 4. https://learn.microsoft.com/en-us/microsoft-365/enterprise/urls-and-ip-address- ranges?view=o365-worldwide   3 Data Management",
    "function_names": [
      "power_platform_tenant_isolation_enabled",
      "power_platform_connector_cross_tenant_blocked",
      "power_platform_tenant_data_movement_restricted",
      "power_platform_tenant_inbound_connections_blocked",
      "power_platform_tenant_outbound_connections_blocked",
      "power_platform_tenant_isolation_exceptions_configured",
      "power_platform_tenant_isolation_aad_auth_required",
      "power_platform_tenant_isolation_connector_compliance_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Restricting outbound connections means that a user is blocked from connecting to a third-party tenant. (Restricting outbound cross-tenant connections can be done using tenant restrictions that apply to all Azure Active Directory (Azure AD) software as a service (SaaS) cloud apps, or at the connector level, which would block outbound connections just for canvas apps and flows.) Restricting inbound connections means that a user in a third-party tenant is blocked from creating a connection to the tenant. (Restricting inbound cross-tenant connections requires a support ticket\u2014this restriction then only applies to Power Apps and Power Automate.) Enable the configurations below will prevent communication with any other tenant. Warning: Perform an impact analysis before implementation. Requirements for using cross-tenant isolation: \u2022 A subscription to Azure Active Directory Premium. \u2022 A federated Azure Active Directory tenant. Admins can specify an explicit allowlist of tenants that they want to enable inbound, outbound, or both, which will bypass tenant isolation controls when configured. Admins can use a special pattern \u201c*\u201d to allow all tenants in a specific direction when tenant isolation is turned on. All other cross-tenant connections except the ones in the allowlist are rejected by Power Platform.",
    "references": "1. https://docs.microsoft.com/en-us/power-platform/admin/cross-tenant-restrictions 2. https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/tenant- restrictions 3. https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/tenant- restrictions#admin-experience 4. https://learn.microsoft.com/en-us/microsoft-365/enterprise/urls-and-ip-address- ranges?view=o365-worldwide   3 Data Management"
  },
  {
    "id": "3.1",
    "title": "(L2) Ensure 'Environments with Critical Data are Encrypted with Customer Managed Keys'",
    "assessment": "Manual",
    "description": "All environments of Microsoft Dataverse use SQL Server Transparent Data Encryption (TDE) to perform real-time encryption of data when written to disk, also known as encryption at rest. By default, Microsoft stores and manages the database encryption key for environments. The manage keys feature in the Microsoft Power Platform admin center gives administrators the ability to self-manage the database encryption key that is associated with the Dataverse tenant. Enable sensitive data encryption at rest using Customer Managed Keys rather than Microsoft Managed keys. Note: This feature is only available in tenants with 1,000 or more users. An exception to this recommendation will be needed for those tenants that have under 1,000 users.",
    "rationale": "By default, Microsoft stores and manages the database encryption key for organizational environments, so administrators don't have to. The manage keys feature in the Microsoft Power Platform admin center gives administrators the ability to self- manage the database encryption key that is associated with the Dataverse tenant. Impact: Using Customer Managed Keys may also incur additional man-hour requirements to create, store, manage, and protect the keys as needed. Note: It is strongly recommended that a copy of the encryption key is made and stored in a safe place. The key may need to be entered again to ensure that certain features keep working and the data is retrievable. For more information, see Data Encryption. Changing the encryption key can take a long time in a large database. Run this operation during off-peak hours if the system is busy or when working with a large amount of data. Note #2: This feature is only available in tenants with 1,000 or more users. An exception to this recommendation will be needed for those tenants that have under 1,000 users.",
    "audit": "Ensure that Customer Managed Keys are utilized. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Settings at the top of the screen. 3. Expand Encryption then select Data encryption A new window will open and may be slow to load 4. Ensure Encryption status is set to Active 5. Ensure self-managed encryption keys are utilized. 6. Click Close (data will not be re-encrypted).",
    "remediation": "Configure Customer Managed Keys. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Settings at the top of the screen. 3. Expand Encryption then select Data encryption A new window will open and may be slow to load 4. Ensure Encryption status is set to Active 5. Under Change Encryption Key insert the new key followed by Change Note: It is important to safeguard the encryption key. 6. Click Close References: 1. https://docs.microsoft.com/en-us/power-platform/admin/data-encryption 2. https://docs.microsoft.com/en-us/power-platform/admin/manage-encryption-key",
    "function_names": [
      "dataverse_environment_customer_managed_keys_enabled",
      "dataverse_environment_tde_customer_managed_keys",
      "dataverse_environment_encryption_customer_managed",
      "dataverse_environment_sensitive_data_encrypted",
      "dataverse_environment_encryption_at_rest_customer_managed",
      "dataverse_environment_encryption_key_self_managed",
      "dataverse_environment_tde_key_customer_managed",
      "dataverse_environment_encryption_key_not_microsoft_managed"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "Using Customer Managed Keys may also incur additional man-hour requirements to create, store, manage, and protect the keys as needed. Note: It is strongly recommended that a copy of the encryption key is made and stored in a safe place. The key may need to be entered again to ensure that certain features keep working and the data is retrievable. For more information, see Data Encryption. Changing the encryption key can take a long time in a large database. Run this operation during off-peak hours if the system is busy or when working with a large amount of data. Note #2: This feature is only available in tenants with 1,000 or more users. An exception to this recommendation will be needed for those tenants that have under 1,000 users.",
    "references": "1. https://docs.microsoft.com/en-us/power-platform/admin/data-encryption 2. https://docs.microsoft.com/en-us/power-platform/admin/manage-encryption-key"
  },
  {
    "id": "3.2",
    "title": "(L1) Ensure 'Extract customer data privileges from Microsoft Dynamics 365 is controlled'",
    "assessment": "Manual",
    "description": "Ensure that privileges related to customer data extraction are well tailored for the business needs considering the minimum privileges required.",
    "rationale": "When users are able to export data deliberately, data governance and security can become an impossible activity and can also lead data leakage. Impact: If not configured correctly, users with need-to-know might not have access to the data.",
    "audit": "Ensure that the extract customer data privileges from Microsoft Dynamics 365 controlled. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Settings 3. Expand Users + permissions then click Security roles. 4. Select Edit under More Actions for each security role 5. Select the Business Management tab then review the permissions under Privacy Related Privileges. 6. Ensure that the appropriate privileges are assigned based on organizational policy.",
    "remediation": "To configure the extract customer data privileges from Microsoft Dynamics 365 privilege, use the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Settings 3. Expand Users + permissions then click Security roles. 4. Select Edit under More Actions for each security role 5. Select the Business Management tab then review the permissions under Privacy Related Privileges. 6. Enable or disable privilege based on organizational policy. Note: Enabling these privileges will allow users to extract customer data from Microsoft Dynamics 365. For more information, review the corresponding user documentation. References: 1. https://docs.microsoft.com/en-us/power-platform/admin/create-edit-security-role",
    "function_names": [
      "dynamics365_customer_data_extraction_privileges_restricted",
      "dynamics365_customer_data_extraction_min_privileges_enforced",
      "dynamics365_data_extraction_privileges_controlled",
      "dynamics365_customer_data_extraction_least_privilege_applied",
      "dynamics365_data_extraction_privileges_minimized"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "If not configured correctly, users with need-to-know might not have access to the data.",
    "references": "1. https://docs.microsoft.com/en-us/power-platform/admin/create-edit-security-role"
  },
  {
    "id": "3.3",
    "title": "(L1) Ensure 'Dynamics 365 restricts incoming email actions for public queue mailboxes'",
    "assessment": "Manual",
    "description": "Microsoft Dynamics 365 can be used in Outlook to track email messages, contacts, tasks, and appointments. When an email message, contact, task, or appointment record is tracked, a copy of that record is saved as an activity in Dynamics 365 for Customer Engagement and synchronized with the Outlook record. This can be viewed and edited in Dynamics 365 for Outlook or Customer Engagement. If Outlook is synced to a mobile device, the mobile device will also have access to these records. Options to automatically track email messages: Email messages from Dynamics 365 apps Leads, Contacts, and Accounts: Tracks email messages only if they originate from someone with a Dynamics 365 for Customer Engagement lead, contact, or account record. The recommended state for this setting is: Email messages from Dynamics 365 apps Leads, Contacts, and Accounts",
    "rationale": "An unauthenticated attacker can create arbitrary contacts and email activities within the Dynamics 365 system. This can lead to several problems of varying severity: \u2022 Spam and reduction of data quality. \u2022 Denial of Service (DoS). \u2022 Sophisticated attacks aiming at human error. For example, an attacker may create a new contact that has the same name as an already existing contact. \u2022 A Dynamics 365 application user may accidentally choose the attacker-controlled contact for communication instead of the legitimate one and thereby cause exposure of sensitive information. If possible, emails should only be converted to Dynamics 365 entities when the sender address is known or considered trustworthy. Impact: Emails from a trustworthy entity might not be converted to Dynamics 365.",
    "audit": "Verify that the option Email messages from Dynamics 365 apps Leads, Contacts, and Accounts is selected. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Settings at the top. 3. Expand Business followed by Queues. This will open in a new window. 4. Click on the email boxes to modify. 5. Under EMAIL SETTINGS ensure that the Email messages from Dynamics 365 Leads, Contacts, and Accounts options is selected.",
    "remediation": "Ensure that the option Email messages from Dynamics 365 apps Leads, Contacts, and Accounts selected. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Settings at the top. 3. Expand Business followed by Queues This will open in a new window. 4. Click on the email boxes to modify. 5. Under EMAIL SETTINGS set Convert Incoming Email to Activities to Email messages from Dynamics 365 Leads, Contacts, and Accounts 6. Click Save. Note: Avoid setting the option to All email messages as Dynamics 365 apps will track junk mail as well as business conversations. Default Value: By default, email in the \u201cSent Items\u201d folder within Outlook will not automatically appear as tracked in Dynamics 365.   References: 1. https://docs.microsoft.com/en-us/dynamics365/outlook-addin/user-guide/set- option-automatically-track-incoming-outlook-email 2. https://docs.microsoft.com/en-us/dynamics365/outlook-addin/user- guide/overview-tracking-records",
    "function_names": [
      "dynamics365_queue_mailbox_restrict_incoming_email_actions",
      "dynamics365_queue_mailbox_email_tracking_restricted",
      "dynamics365_queue_mailbox_incoming_email_actions_disabled",
      "dynamics365_queue_mailbox_email_tracking_from_leads_contacts_accounts",
      "dynamics365_queue_mailbox_public_email_actions_restricted",
      "dynamics365_queue_mailbox_email_tracking_scope_limited",
      "dynamics365_queue_mailbox_incoming_email_actions_from_known_entities",
      "dynamics365_queue_mailbox_email_tracking_compliance_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Emails from a trustworthy entity might not be converted to Dynamics 365.",
    "references": "1. https://docs.microsoft.com/en-us/dynamics365/outlook-addin/user-guide/set- option-automatically-track-incoming-outlook-email 2. https://docs.microsoft.com/en-us/dynamics365/outlook-addin/user- guide/overview-tracking-records"
  },
  {
    "id": "3.4",
    "title": "(L1) Ensure 'DLP policies are enabled and restrict the connectors usage'",
    "assessment": "Manual",
    "description": "Power Platform data loss prevention policies (DLP) act as guardrails to help prevent users from unintentionally exposing organizational data. These data loss prevention policies enforce rules for which connectors can be used together in apps and flows. The policies can be scoped to one environment, many environments, or tenant-wide",
    "rationale": "Power Apps and automation are becoming increasingly connected across multiple data sources and multiple services. Some of these might be external, third-party services and might even include some social networks. Users generally have good intentions, but they can easily overlook the potential for exposure from data leakage to services and audiences that shouldn't have access to the data. Categorize the data connectors into one of three data groups, \"Business data only\", \"No business data allowed\" and \u201cBlocked\u201d. Users will be prevented from creating flows and apps that combine connectors from the \"Business data only\" and \"No business data allowed\" data groups and also will not have access to connectors blocked. Impact: Enabling a Power Platform DLP policy will restrict the connectors usage in the environment. Always ensure to follow appropriate procedures in regard to testing and implementation of DLP policies based on the business needs.",
    "audit": "Verify DLP policies are enabled. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com. 2. Expand Policies in the left pane then select Data policies 3. Verify that organizational policies are set and applied.",
    "remediation": "Ensure DLP policies are enabled. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com. 2. Expand Policies in the left pane then select Data policies. 3. Click New Policy to initiate the policy wizard. 4. Name the policy, then click next. 5. At the Custom Connectors choose which connectors should fit in every data group: 1. Business 2. Non-business (Default) 3. Blocked 4. Ignore. 6. For the Scope ensure to select all applicable environments. 7. Click Create policy. Default Value: By default, no DLP policies are implemented in the tenant. References: 1. https://docs.microsoft.com/en-us/power-platform/guidance/adoption/dlp-strategy 2. https://docs.microsoft.com/en-us/power-platform/admin/wp-data-loss-prevention 3. https://docs.microsoft.com/en-us/power-platform/admin/create-dlp-policy",
    "function_names": [
      "power_platform_dlp_policy_enabled",
      "power_platform_dlp_policy_restrict_connectors",
      "power_platform_dlp_policy_tenant_wide",
      "power_platform_dlp_policy_environment_scoped",
      "power_platform_dlp_policy_connector_rules_enforced"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Enabling a Power Platform DLP policy will restrict the connectors usage in the environment. Always ensure to follow appropriate procedures in regard to testing and implementation of DLP policies based on the business needs.",
    "references": "1. https://docs.microsoft.com/en-us/power-platform/guidance/adoption/dlp-strategy 2. https://docs.microsoft.com/en-us/power-platform/admin/wp-data-loss-prevention 3. https://docs.microsoft.com/en-us/power-platform/admin/create-dlp-policy"
  },
  {
    "id": "4.1",
    "title": "(L1) Ensure 'System Administrator security role changes are reviewed periodically'",
    "assessment": "Manual",
    "description": "Security roles define how different users access different types of records. To control access to data, security roles can be modified to create new security roles or change which security roles are assigned to each user. Each user can have multiple security roles and are cumulative meaning having more than one security role gives a user every privilege available in every role.",
    "rationale": "Illicit role group changes could give an attacker access to data that is privileged and perform tasks in the environment. Impact: None - there is no impact to users or the system.",
    "audit": "Verify which users have been added to the System Administrator Security Role. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Edit on the Details pane of the environment. 3. Select Settings at the top of the window. 4. Expand Users + permissions then select Security roles. 5. Click on System Administrator (not the three dots and edit) 6. Review the list of users",
    "remediation": "Ensure no unauthorized users have been added to the System Administrator Security Role. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Edit on the Details pane of the environment. 3. Select Settings at the top of the window. 4. Expand Users + permissions then select Security roles. 5. Click on System Administrator (not the three dots and edit) 6. Add/Remove users as appropriate. Default Value: N/A References: 1. https://docs.microsoft.com/en-us/power-platform/admin/database-security 2. https://docs.microsoft.com/en-us/power-platform/admin/security-roles-privileges",
    "function_names": [
      "iam_role_system_admin_changes_reviewed_periodically",
      "iam_role_system_admin_changes_reviewed_over_90d",
      "iam_role_system_admin_changes_reviewed_recently",
      "iam_role_system_admin_changes_audited_periodically",
      "iam_role_system_admin_changes_monitored_continuously"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "None - there is no impact to users or the system.",
    "references": "1. https://docs.microsoft.com/en-us/power-platform/admin/database-security 2. https://docs.microsoft.com/en-us/power-platform/admin/security-roles-privileges"
  },
  {
    "id": "4.2",
    "title": "(L1) Ensure 'Environment Activity logging is Enabled'",
    "assessment": "Manual",
    "description": "Activity logging track changes to organizational data and maintain a log of those changes.",
    "rationale": "Enabling Power Platform Activity logging helps the security teams to investigate activities for regular security operational or forensic purposes. The auditing feature is designed to meet the auditing, compliance, security, and governance policies of many regulated enterprises. Impact: It is required to plan and evaluate the log size for impact to storage/costs.",
    "audit": "Verify that the Environment Activity logging is Enabled. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Click Settings at the top of the window. 3. Expand Audit and logs then select Audit settings. 4. Ensure the following are set: a. Start Auditing b. Log access c. Read logs 5. Ensure that the retention for logs to the appropriate timeframe according to organizational policy.",
    "remediation": "Ensure that the Environment Activity logging is Enabled. In the Power Platform Admin Center: 1. Log in to https://admin.powerplatform.microsoft.com and select the appropriate environment. 2. Select Settings at the top of the window. 3. Expand Audit and logs then select Audit settings. 4. Select the following: a. Start b. Auditing Log access c. Read logs 5. Set the retention for logs to the appropriate timeframe according to organizational policy. 6. Click Save. Note: Logs are found in the Security and Compliance Center Default Value: Disabled. References: 1. https://docs.microsoft.com/en-us/power-platform/admin/enable-use- comprehensive-auditing#enable-auditing 2. https://docs.microsoft.com/en-us/power-platform/admin/system-settings-dialog- box-auditing-tab 3. https://docs.microsoft.com/en-us/power-platform/admin/logging-powerapps",
    "function_names": [
      "cloudtrail_trail_logging_enabled",
      "cloudtrail_trail_activity_logging_enabled",
      "cloudtrail_trail_environment_activity_logging_enabled",
      "cloudtrail_trail_data_changes_logging_enabled",
      "cloudtrail_trail_organizational_data_logging_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "It is required to plan and evaluate the log size for impact to storage/costs.",
    "references": "1. https://docs.microsoft.com/en-us/power-platform/admin/enable-use- comprehensive-auditing#enable-auditing 2. https://docs.microsoft.com/en-us/power-platform/admin/system-settings-dialog- box-auditing-tab 3. https://docs.microsoft.com/en-us/power-platform/admin/logging-powerapps"
  },
  {
    "id": "4.3",
    "title": "(L1) Ensure 'App creation notification is enabled in the environment'",
    "assessment": "Manual",
    "description": "App creation alerting can be used to inform admins and stakeholders about specific events, or provide a summary of activity in the environment.",
    "rationale": "Alerting on the creation of apps allows for administrators to look for risky apps that users have created that could cause data spillage or accidental elevation of privilege. Impact: Alerts will be sent to an individual(s) and could be high in volume. Note: Audit logging must be enabled.",
    "audit": "Verify that App creation notifications are set to enabled. In the Microsoft 365 Security & Compliance Center: \u2022 Log in to the Microsoft 365 Security & Compliance Center https://compliance.microsoft.com/ as a tenant Administrator. \u2022 Go to Policies > Alert Policy. \u2022 Verify a policy exists for app creation notification.",
    "remediation": "Ensure that App creation notifications are set to enabled. In the Microsoft 365 Security & Compliance Center: \u2022 Log in to the Microsoft 365 Security & Compliance Center https://compliance.microsoft.com/ as a tenant Administrator. \u2022 Go to Policies > Alert Policy > +New Alert policy. \u2022 Name policy and select the Severity and Category for the policy. \u2022 In the Activity section scroll down to PowerApps app or search for Publish. \u2022 Name the alert and select users (emails) to send alerts to. Ensure that a notification is triggered when a new app is created in the environment.  Default Value: N/A References: 1. https://docs.microsoft.com/en-us/power-platform/guidance/adoption/sharing- alerts   Appendix: Summary Table CIS Benchmark Recommendation Set Correctly Yes No 1 Accounts and Authentication 1.1 (L1) Ensure 'User access to environments is controlled with Security Groups' (Manual) \uf06f \uf06f 1.2 (L1) Ensure 'User sessions are terminated upon time limit exceeded and user logoff' (Manual) \uf06f \uf06f 1.3 (L1) Ensure 'Administrative accounts are separate, unassigned, and cloud-only' (Manual) \uf06f \uf06f 1.4 (L2) Ensure 'Multifactor authentication for all users' is 'Enabled' (Manual) \uf06f \uf06f 2 Permissions 2.1 (L1) Ensure 'Creation of new trial, production, and sandbox environments' is restricted to 'Administrators' (Manual) \uf06f \uf06f 2.2 (L1) Ensure 'Security roles provide access to the minimum amount of business data required' (Manual) \uf06f \uf06f 2.3 (L1) Ensure 'Set blocked file extensions' is configured to match the enterprise block list (Manual) \uf06f \uf06f 2.4 (L2) Ensure 'Access to the environment is restricted by location' (Manual) \uf06f \uf06f 2.5 (L1) Ensure 'Cross-tenant isolation is enabled for Power Platform Apps and Flows' (Manual) \uf06f \uf06f 3 Data Management 3.1 (L2) Ensure 'Environments with Critical Data are Encrypted with Customer Managed Keys' (Manual) \uf06f \uf06f  CIS Benchmark Recommendation Set Correctly Yes No 3.2 (L1) Ensure 'Extract customer data privileges from Microsoft Dynamics 365 is controlled' (Manual) \uf06f \uf06f 3.3 (L1) Ensure 'Dynamics 365 restricts incoming email actions for public queue mailboxes' (Manual) \uf06f \uf06f 3.4 (L1) Ensure 'DLP policies are enabled and restrict the connectors usage' (Manual) \uf06f \uf06f 4 Logging and Auditing 4.1 (L1) Ensure 'System Administrator security role changes are reviewed periodically' (Manual) \uf06f \uf06f 4.2 (L1) Ensure 'Environment Activity logging is Enabled' (Manual) \uf06f \uf06f 4.3 (L1) Ensure 'App creation notification is enabled in the environment' (Manual) \uf06f \uf06f   Appendix: Change History Date Version Changes for this version 12/20/2022 1.0.0 Initial Public Release",
    "function_names": [
      "app_environment_app_creation_notification_enabled",
      "app_environment_alerting_enabled",
      "app_environment_event_notification_enabled",
      "app_environment_activity_alerting_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Alerts will be sent to an individual(s) and could be high in volume. Note: Audit logging must be enabled.",
    "references": "1. https://docs.microsoft.com/en-us/power-platform/guidance/adoption/sharing- alerts   Appendix: Summary Table CIS Benchmark Recommendation Set Correctly Yes No 1 Accounts and Authentication 1.1 (L1) Ensure 'User access to environments is controlled with Security Groups' (Manual) \uf06f \uf06f 1.2 (L1) Ensure 'User sessions are terminated upon time limit exceeded and user logoff' (Manual) \uf06f \uf06f 1.3 (L1) Ensure 'Administrative accounts are separate, unassigned, and cloud-only' (Manual) \uf06f \uf06f 1.4 (L2) Ensure 'Multifactor authentication for all users' is 'Enabled' (Manual) \uf06f \uf06f 2 Permissions 2.1 (L1) Ensure 'Creation of new trial, production, and sandbox environments' is restricted to 'Administrators' (Manual) \uf06f \uf06f 2.2 (L1) Ensure 'Security roles provide access to the minimum amount of business data required' (Manual) \uf06f \uf06f 2.3 (L1) Ensure 'Set blocked file extensions' is configured to match the enterprise block list (Manual) \uf06f \uf06f 2.4 (L2) Ensure 'Access to the environment is restricted by location' (Manual) \uf06f \uf06f 2.5 (L1) Ensure 'Cross-tenant isolation is enabled for Power Platform Apps and Flows' (Manual) \uf06f \uf06f 3 Data Management 3.1 (L2) Ensure 'Environments with Critical Data are Encrypted with Customer Managed Keys' (Manual) \uf06f \uf06f  CIS Benchmark Recommendation Set Correctly Yes No 3.2 (L1) Ensure 'Extract customer data privileges from Microsoft Dynamics 365 is controlled' (Manual) \uf06f \uf06f 3.3 (L1) Ensure 'Dynamics 365 restricts incoming email actions for public queue mailboxes' (Manual) \uf06f \uf06f 3.4 (L1) Ensure 'DLP policies are enabled and restrict the connectors usage' (Manual) \uf06f \uf06f 4 Logging and Auditing 4.1 (L1) Ensure 'System Administrator security role changes are reviewed periodically' (Manual) \uf06f \uf06f 4.2 (L1) Ensure 'Environment Activity logging is Enabled' (Manual) \uf06f \uf06f 4.3 (L1) Ensure 'App creation notification is enabled in the environment' (Manual) \uf06f \uf06f   Appendix: Change History Date Version Changes for this version 12/20/2022 1.0.0 Initial Public Release"
  }
]