[
  {
    "id": "1.1",
    "title": "Keep ESXi system properly patched",
    "assessment": "Scored",
    "description": "VMware Update Manager is a tool used to automate patch management for vSphere hosts and Virtual machines.  Creating a baseline for patches is a good way to ensure all hosts are at the same patch level.",
    "rationale": "By staying up to date on ESXi patches, vulnerabilities in the hypervisor can be mitigated. An educated attacker can exploit known vulnerabilities when attempting to attain access or elevate privileges on an ESXi host.",
    "audit": "Employ a process to keep ESXi hosts up to date with patches in accordance with industry- standards and internal guidelines. VMware Update Manager is an automated tool that can greatly assist with this. VMware also publishes Advisories on security patches, and offers a way to subscribe to email alerts for them.",
    "remediation": "Leverage the VMware Update Manager to test and apply patches as they become available. Impact: VMs must be powered off in order to update the host ESXi server. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.update_manager.doc/GUID-EF6BEE4C-4583-4A8C- 81B9-5B074CA2E272.html",
    "profile_applicability": "  Level 1",
    "impact": "VMs must be powered off in order to update the host ESXi server.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.update_manager.doc/GUID-EF6BEE4C-4583-4A8C- 81B9-5B074CA2E272.html",
    "function_names": [
      "compute_esxi_host_patches_up_to_date",
      "compute_esxi_host_patch_baseline_configured",
      "compute_esxi_host_automated_patching_enabled",
      "compute_esxi_host_vum_integration_enabled",
      "compute_esxi_host_critical_patches_applied",
      "compute_esxi_host_patch_compliance_verified",
      "compute_esxi_host_patch_baseline_all_hosts",
      "compute_esxi_host_patch_remediation_enabled"
    ]
  },
  {
    "id": "1.2",
    "title": "Verify Image Profile and VIB Acceptance Levels",
    "assessment": "Scored",
    "description": "The ESXi Image Profiles supports four VIB acceptance levels. A VIB (vSphere Installation Bundle) is a collection of files that are packaged into an archive. The VIB contains a signature file that is used to verify the level of trust.",
    "rationale": "Verify the ESXi Image Profile to only allow signed VIBs. An unsigned VIB represents untested code installed on an ESXi host. The ESXi Image profile supports four acceptance levels: 1. VMwareCertified - VIBs created, tested and signed by VMware 2. VMwareAccepted - VIBs created by a VMware partner but tested and signed by VMware 3. PartnerSupported - VIBs created, tested and signed by a certified VMware partner 4. CommunitySupported - VIBs that have not been tested by VMware or a VMware partner. Community Supported VIBs are not supported and do not have a digital signature. To protect the security and integrity of your ESXi hosts do not allow unsigned (CommunitySupported) VIBs to be installed on your hosts.",
    "audit": "Perform the following to procedure: 1. Connect to each ESX/ESXi host using the ESXi Shell or vCLI and execute the command \"esxcli software acceptance get\" to verify the acceptance level is at either \"VMware Certified\", \"VMware Supported\", or \"PartnerSupported\". 2. Connect to each ESX/ESXi host using the vCLI and execute the command \"esxcli software vib list\" and verify the acceptance level for each VIB is either \"VMware Certified\", \"VMware Supported\", or \"Partner Supported\" Additionally, the following PowerCLI command may be used: # List the Software AcceptanceLevel for each host Foreach ($VMHost in Get-VMHost ) {   $ESXCli = Get-EsxCli -VMHost $VMHost $VMHost | Select Name, @{N=\"AcceptanceLevel\";E={$ESXCli.software.acceptance.get()}} } # List only the vibs which are not at \"VMwareCertified\" or \"VMwareAccepted\" or \"PartnerSupported\" acceptance level Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $ESXCli.software.vib.list() | Where { ($_.AcceptanceLevel -ne \"VMwareCertified\") -and ($_.AcceptanceLevel -ne \"VMwareAccepted\") -and ($_.AcceptanceLevel -ne \"PartnerSupported\") } }",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Set the Software AcceptanceLevel for each host Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $ESXCli.software.acceptance.Set(\"PartnerSupported\") } Default Value: The default level is PartnerSupported References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.install.doc/GUID-56600593-EC2E-4125-B1A0- 065BDD16CF2D.html",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.install.doc/GUID-56600593-EC2E-4125-B1A0- 065BDD16CF2D.html",
    "function_names": [
      "compute_image_profile_vib_acceptance_levels",
      "compute_image_profile_vib_trust_verified",
      "compute_image_profile_vib_signature_valid",
      "compute_image_profile_vib_acceptance_levels_secure",
      "compute_image_profile_vib_acceptance_levels_compliant"
    ]
  },
  {
    "id": "1.3",
    "title": "Verify no unauthorized kernel modules are loaded on the host",
    "assessment": "Scored",
    "description": "ESXi hosts by default do not permit the loading of kernel modules that lack valid digital signatures.  This feature can be overridden which would result in unauthorized kernel modules to be loaded.",
    "rationale": "VMware provides digital signatures for kernel modules. By default the ESXi host does not permit loading of kernel modules that lack a valid digital signature. However, this behavior can be overridden allowing unauthorized kernel modules to be loaded. Untested or malicious kernel modules loaded on the ESXi host can put the host at risk for instability and/or exploitation.",
    "audit": "Each ESXi host should be monitored for unsigned kernel modules. To list all the loaded kernel modules from the ESXi Shell or vCLI run: \"esxcli system module list\". For each module, verify the signature by running: esxcli system module get -m <module>. Secure the host by disabling unsigned modules and removing the offending VIBs from the host. Additionally, the following PowerCLI command may be used: # List the system modules and Signature Info for each host Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $ESXCli.system.module.list() | Foreach { $ESXCli.system.module.get($_.Name) | Select @{N=\"VMHost\";E={$VMHost}}, Module, License, Modulefile, Version, SignedStatus, SignatureDigest, SignatureFingerPrint } }",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # To disable a module: $ESXCli = Get-EsxCli -VMHost MyHost $ESXCli.system.module.set($false, $false, \"MyModuleName\") Note: evacuate VMs and place the host into maintenance mode before disabling kernel modules. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-E9B71B85-FBA3-447C-8A60- DEE2AE1A405A.html http://kb.vmware.com/kb/2042473 2. http://kb.vmware.com/kb/2042473",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-E9B71B85-FBA3-447C-8A60- DEE2AE1A405A.html http://kb.vmware.com/kb/2042473 2. http://kb.vmware.com/kb/2042473",
    "function_names": [
      "esxi_host_kernel_modules_unauthorized_loaded",
      "esxi_host_kernel_modules_signature_enforced",
      "esxi_host_kernel_modules_override_disabled",
      "esxi_host_kernel_modules_whitelist_enforced",
      "esxi_host_kernel_modules_integrity_verified"
    ]
  },
  {
    "id": "1.4",
    "title": "Ensure that the Forged Transmits policy is set to reject",
    "assessment": "Scored",
    "description": "Ensure that the Forged Transmits policy is set to reject.",
    "rationale": "If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. Forged transmissions should be set to accept by default. This means the dvPortgroup does not compare the source and effective MAC addresses. To protect against MAC address impersonation, all virtual switches should have forged transmissions set to reject.",
    "audit": "1. Verify by using the vSphere Web Client to connect to the vCenter Server and as administrator: 2. Go to Home > Networking. 3. Select each VDS and edit each dvPortgroup connected to active VM's requiring securing. 4. Edit Settings for each PortGroup under Security. 5. Verify that the Forged transmits value is set to \"Reject\" Additionally, the following PowerCLI command may be used: # List all dvPortGroups and their Security Settings Get-VirtualPortGroup -Distributed | Select Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Config.DefaultPortConfig.SecurityPolicy.MacChanges.Value) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Config.DefaultPortConfig.SecurityPolicy.AllowPromiscuous.Value) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Config.DefaultPortConfig.SecurityPolicy.ForgedTransmits.Value) { \"Accept\" } Else { \"Reject\"} }}",
    "remediation": "1. Configure by using the vSphere Web Client to connect to the vCenter Server and as administrator: 2. Go to Home > Networking. 3. Select each VDS and edit each dvPortgroup connected to active VM's requiring securing. 4. Edit Settings for each PortGroup under Security. 5. Set the Forged transmits value to \"Reject\"   Impact: This will prevent VMs from changing their effective MAC address. This will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the dvPortgroups that these applications are connected to.",
    "profile_applicability": "  Level 1",
    "impact": "This will prevent VMs from changing their effective MAC address. This will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the dvPortgroups that these applications are connected to.",
    "function_names": [
      "compute_instance_forged_transmits_reject",
      "compute_network_forged_transmits_reject",
      "compute_vpc_forged_transmits_reject",
      "compute_subnet_forged_transmits_reject",
      "compute_firewall_forged_transmits_reject",
      "compute_interface_forged_transmits_reject",
      "compute_vm_forged_transmits_reject",
      "compute_security_policy_forged_transmits_reject"
    ]
  },
  {
    "id": "1.5",
    "title": "Ensure that VDS Netflow traffic is only being sent to authorized collector IP Addresses",
    "assessment": "Not Scored",
    "description": "Ensure that VDS Netflow traffic is only being sent to authorized collector IP Addresses.",
    "rationale": "The vSphere vDS can export Netflow information about traffic crossing the vDS. Netflow exports are not encrypted and can contain information about the virtual network making it easier for a MITM attack to be executed successfully. If Netflow export is required, verify that all vDS Netflow target IP Addresses are correct.",
    "audit": "1. From the Web or vSphere Clients, verify that Netflow destinations are correct. 2. Edit the VDS properties. 3. In the Netflow tab, verify the Collector Settings > IP Address and Port.",
    "remediation": "1. From the Web or vSphere Clients. 2. Configure the Netflow destinations to be correct. 3. Edit the VDS properties. 4. In the Netflow tab, set the Collector Settings > IP Address and Port. References:   1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.networking.doc/GUID-E19FECAD-8629-4E8A- B61C-1F1C16770B3B.html",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.networking.doc/GUID-E19FECAD-8629-4E8A- B61C-1F1C16770B3B.html",
    "function_names": [
      "vds_netflow_collector_authorized_ips",
      "vds_netflow_traffic_restricted_to_authorized_ips",
      "vds_netflow_collector_ip_whitelisted",
      "vds_netflow_authorized_destination_ips",
      "vds_netflow_traffic_authorized_collector_only"
    ]
  },
  {
    "id": "1.6",
    "title": "Restrict port-level configuration overrides on vDS",
    "assessment": "Scored",
    "description": "Restrict port-level configuration overrides on vDS.",
    "rationale": "Port-level configuration over-rides are disabled by default. Once enabled, this allows for different security settings to be set from what is established at the Port-Group level. There are cases where particular VM's require unique configurations, but this should be monitored so it is only used when authorized. If over-rides are not monitored, anyone who gains access to a VM with a less secure VDS configuration could exploit that broader access.",
    "audit": "1. From the Web or vSphere Clients. 2. Verify that Port Mirror destination interfaces are correct. 3. Edit the VDS properties. 4. In the Port Mirror tab, verify the Destination VLAN, Port or Uplink ID's.",
    "remediation": "1. From the Web or vSphere Clients. 2. Verify that Port Mirror destination interfaces are correct. 3. Edit the VDS properties and in the Port Mirror tab. 4. Configure the Destination VLAN, Port or Uplink ID's. Default Value: Port-level configuration over-rides are disabled by default. This is the prescribed state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.networking.doc/GUID-EA78AD26-F099-4136- 9EA6-AD60626D3EF7.html   2 Communication",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.networking.doc/GUID-EA78AD26-F099-4136- 9EA6-AD60626D3EF7.html   2 Communication",
    "function_names": [
      "compute_vds_port_override_restricted",
      "compute_vds_port_config_locked",
      "compute_vds_port_override_disabled",
      "compute_vds_port_security_enforced",
      "compute_vds_port_policy_restricted"
    ]
  },
  {
    "id": "2.1",
    "title": "Configure NTP time synchronization",
    "assessment": "Scored",
    "description": "NTP(Network Time Protocol) synchronization should be configured and enabled on each VMware ESXi host. Verify that the NTP time server is correct for each host to ensure accurate time for system event logs.",
    "rationale": "By ensuring that all systems use the same relative time source (including the relevant localization offset), and that the relative time source can be correlated to an agreed-upon time standard, you can make it simpler to track and correlate an intruder's actions when reviewing the relevant log files. Incorrect time settings can make it difficult to inspect and correlate log files to detect attacks, and can make auditing inaccurate.",
    "audit": "1. From the vSphere web client select the host 2. Click \"Manage\" -> \"Time Configuration\" 3. Click the \"Edit...\" button. 4. Provide the name/IP of your NTP servers 5. Start the NTP service 6. Change the startup policy to \"Start and stop with host\" Notes: verify the NTP firewall ports are open. It is recommended to synchronize the ESXi clock with a time server that is located on the management network rather than directly with a time server on a public network. This time server can then synchronize with a public source through a strictly controlled network connection with a firewall. Additionally, the following PowerCLI command may be used: # List the NTP Settings for all hosts Get-VMHost | Select Name, @{N=\"NTPSetting\";E={$_ | Get-VMHostNtpServer}}",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Set the NTP Settings for all hosts # If an internal NTP server is used replace pool.ntp.org with # the IP address of the internal NTP server $NTPServers = \"pool.ntp.org\", \"pool2.ntp.org\" Get-VMHost | Add-VmHostNtpServer $NTPServers Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vcli.examples.doc/cli_manage_networks.11.9.html",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vcli.examples.doc/cli_manage_networks.11.9.html",
    "function_names": [
      "compute_vmware_ntp_enabled",
      "compute_vmware_ntp_server_configured",
      "compute_vmware_ntp_sync_accurate",
      "compute_vmware_ntp_logs_time_valid",
      "compute_vmware_ntp_service_running"
    ]
  },
  {
    "id": "2.2",
    "title": "Configure the ESXi host firewall to restrict access to services running on the host",
    "assessment": "Scored",
    "description": "The ESXi Firewall is enabled by default and allows ping (ICMP) and communication with DHCP/DNS clients. Confirm that access to services are only allowed by authorized IP's/networks to protect from outside attacks.",
    "rationale": "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access. Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks.",
    "audit": "1. From the vSphere web client 2. Select the host 3. Go to \"Manage\" -> \"Security Profile\" 4. In the \"Firewall\" section select \"Edit...\". 5. For each enabled service, (e.g. ssh, vSphere Web Access, http client) provide a range of allowed IP addresses.   Additionally, the following PowerCLI command may be used: # List all services for a host Get-VMHost HOST1 | Get-VMHostService # List the services which are enabled and have rules defined for specific IP ranges to access the service Get-VMHost HOST1 | Get-VMHostFirewallException | Where {$_.Enabled -and (-not $_.ExtensionData.AllowedHosts.AllIP)} # List the services which are enabled and do not have rules defined for specific IP ranges to access the service Get-VMHost HOST1 | Get-VMHostFirewallException | Where {$_.Enabled -and ($_.ExtensionData.AllowedHosts.AllIP)}",
    "remediation": "To implement the recommended configuration state, run the following ESXi shell command: # /etc/init.d/[SERVICE] STOP Impact: Only systems in the IP whitelist/ACL will be able to connect to services on the ESXi server. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-DD4322FF-3DC4-4716-8819- 6688938F99D7.html",
    "profile_applicability": "  Level 1",
    "impact": "Only systems in the IP whitelist/ACL will be able to connect to services on the ESXi server. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-DD4322FF-3DC4-4716-8819- 6688938F99D7.html",
    "function_names": [
      "esxi_host_firewall_restricted_access",
      "esxi_host_firewall_authorized_ips_only",
      "esxi_host_firewall_service_access_controlled",
      "esxi_host_firewall_icmp_restricted",
      "esxi_host_firewall_dhcp_dns_restricted",
      "esxi_host_firewall_unauthorized_networks_blocked",
      "esxi_host_firewall_default_rules_secure",
      "esxi_host_firewall_external_attacks_prevented"
    ]
  },
  {
    "id": "2.3",
    "title": "Disable Managed Object Browser (MOB)",
    "assessment": "Scored",
    "description": "The Managed Object Browser (MOB) is a web-based server application that lets you examine objects that exist on the server side.  This is installed and started automatically when vCenter is installed.",
    "rationale": "The managed object browser (MOB) provides a way to explore the object model used by the VMkernel to manage the host; it enables configurations to be changed as well. This interface is meant to be used primarily for debugging the vSphere SDK. Because there are no access controls the MOB could also be used as a method to obtain information about a host being targeted for unauthorized access.",
    "audit": "To determine if the MOB is enabled run the following command from the ESXi shell: vim-cmd proxysvc/service_list",
    "remediation": "To implement the recommended configuration state, run the following ESXi shell command: vim-cmd proxysvc/remove_service \"/mob\" \"httpsWithRedirect\" Note: You cannot disable the MOB while a host is in lockdown mode. Impact: The MOB will no longer be available for diagnostics. Some 3rd party tools use this interface to gather information. Testing should be done after disabling the MOB to verify 3rd party applications are still functioning as expected. To re-enable the MOB temporarily: ~ # vim-cmd proxysvc/add_np_service \"/mob\" httpsWithRedirect /var/run/vmware/proxy-mob Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-0EF83EA7-277C-400B-B697- 04BDC9173EA3.html",
    "profile_applicability": "  Level 1",
    "impact": "The MOB will no longer be available for diagnostics. Some 3rd party tools use this interface to gather information. Testing should be done after disabling the MOB to verify 3rd party applications are still functioning as expected. To re-enable the MOB temporarily: ~ # vim-cmd proxysvc/add_np_service \"/mob\" httpsWithRedirect /var/run/vmware/proxy-mob Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-0EF83EA7-277C-400B-B697- 04BDC9173EA3.html",
    "function_names": [
      "vcenter_mob_disabled",
      "vcenter_server_mob_disabled",
      "vcenter_managed_object_browser_disabled",
      "vcenter_mob_service_disabled",
      "vcenter_web_browser_disabled"
    ]
  },
  {
    "id": "2.4",
    "title": "Do not use default self-signed certificates for ESXi communication",
    "assessment": "Scored",
    "description": "The default certificates are not signed by a commercial certificate authority (CA). These default x.509 certificates should be replaced with those issued by a trusted CA.",
    "rationale": "Using the default self-signed certificates may increase risk related to Man-in-The-Middle (MiTM) attacks. Replace default self-signed certificates with those from a trusted CA, either commercial or organizational.",
    "audit": "View the details of the SSL certificate presented by the ESXi host and determine if it is issued by a trusted CA, either commercial or organizational.",
    "remediation": "Leverage VMware's SSL Certificate Automation Tool to install CA-signed SSL certificates.  Fore more information on this tool, please see http://kb.vmware.com/kb/2041600. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-A261E6D8-03E4-48ED-ADB6- 473C2DAAB7AD.html 2. http://kb.vmware.com/kb/2015499 3. http://kb.vmware.com/kb/2034833",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-A261E6D8-03E4-48ED-ADB6- 473C2DAAB7AD.html 2. http://kb.vmware.com/kb/2015499 3. http://kb.vmware.com/kb/2034833",
    "function_names": [
      "compute_esxi_certificate_trusted_ca",
      "compute_esxi_certificate_no_self_signed",
      "compute_esxi_communication_trusted_certificate",
      "compute_esxi_default_certificate_replaced",
      "compute_esxi_certificate_commercial_ca"
    ]
  },
  {
    "id": "2.5",
    "title": "Enable SSL for Network File copy (NFC)",
    "assessment": "Scored",
    "description": "Enable SSL encryption for the Network File Copy function used during Virtual Machine migration or clone operations between two ESXi hosts.",
    "rationale": "NFC (Network File Copy) is the name of the mechanism used to migrate or clone a VM between two ESXi hosts over the network. By default, SSL is used only for the authentication of the transfer, but if desired, SSL can also be enabled on the data transfer. Without this setting VM contents could potentially be sniffed if the management network is not adequately isolated and secured.",
    "audit": "Perform the following: 1. From the vSphere client select \"Administration -> vCenter Server Settings -> Advanced Settings\" 2. Check if the config.nfc.useSSL key exists and is set to true Additionally, the following PowerCLI command may be used: # Check Network File Copy NFC uses SSL. OS Administrator Privileges will # be needed on your server for this to complete $vCenter = \"<MyvCenterFQDN>\" [XML]$file = Get-Content \"\\\\$vCenter\\C$\\ProgramData\\VMware\\VMware VirtualCenter\\vpxd.cfg\" if ($file.config.nfc.Usessl) { \"SSL Setting is compliant\" } Else { \"SSL Setting is not set or is unreadable\"}",
    "remediation": "Perform the following: 1. From the vSphere client select \"Administration -> vCenter Server Settings -> Advanced Settings\" 2. Check if the config.nfc.useSSL key exists 3. If the key does not exist, add it to the list of keys 4. Set the value of the key to true Impact: Using SSL may reduce performance of actions involving NFC, such as VM clone or migration. Default Value: The prescribed state is not the default state. References:   1. http://kb.vmware.com/kb/2010332",
    "profile_applicability": "  Level 2",
    "impact": "Using SSL may reduce performance of actions involving NFC, such as VM clone or migration. Default Value: The prescribed state is not the default state.",
    "references": "1. http://kb.vmware.com/kb/2010332",
    "function_names": [
      "compute_vm_ssl_enabled",
      "compute_nfc_encryption_enabled",
      "compute_migration_ssl_required",
      "compute_esxi_ssl_for_nfc",
      "compute_vm_clone_ssl_enabled",
      "compute_host_nfc_secure_transfer",
      "compute_vm_migration_ssl_enforced",
      "compute_nfc_secure_channel_enabled"
    ]
  },
  {
    "id": "2.6",
    "title": "Ensure proper SNMP configuration",
    "assessment": "Scored",
    "description": "Verify that SNMP (Simple Network Management Protocol) is configured and that all the settings are correct.  If SNMP is not being used, it should be disabled. Note : ESXi 5.1 supports SNMPv3 which provides stronger security than SNMPv1 or SNMPv2, including key authentication and encryption.",
    "rationale": "If SNMP is not being used, it should remain disabled. If it is being used, the proper trap destination should be configured. If SNMP is not properly configured, monitoring information can be sent to a malicious host.",
    "audit": "Perform the following: 1. From the ESXi Shell or vCLI run the following  to determine if SNMP is being used: esxcli system snmp get 2. If SNMP is not being used, make sure that it is disabled by running: esxcli system snmp set --enable false. 3. If SNMP is being used, refer to the vSphere Monitoring and Performance guide, chapter 8 for steps to configure the required parameters. Additionally, the following PowerCLI command may be used: # List the SNMP Configuration of a host (single host connection required) Get-VMHost | Get-VMHostSnmp",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Update the host SNMP Configuration (single host connection required) Get-VmHostSNMP | Set-VMHostSNMP -Enabled:$true -ReadOnlyCommunity '<secret>' Notes:  SNMP must be configured on each ESXi host  SNMP settings can be configured using Host Profiles References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.monitoring.doc/GUID-8EF36D7D-59B6-4C74- B1AA-4A9D18AB6250.html",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.monitoring.doc/GUID-8EF36D7D-59B6-4C74- B1AA-4A9D18AB6250.html",
    "function_names": [
      "snmp_service_disabled",
      "snmp_service_v3_enabled",
      "snmp_service_authentication_enabled",
      "snmp_service_encryption_enabled",
      "snmp_service_community_strings_secure",
      "snmp_service_read_only_access",
      "snmp_service_trap_destinations_secure",
      "snmp_service_no_default_community_strings",
      "snmp_service_access_control_enabled",
      "snmp_service_logging_enabled"
    ]
  },
  {
    "id": "2.7",
    "title": "Prevent unintended use of dvfilter network APIs",
    "assessment": "Scored",
    "description": "Confirm that dvfilter API is not configured if not is use. If you are using virtual security appliances that leverage this API then configuration may be necessary.",
    "rationale": "If you are not using products that make use of the dvfilter network API (e.g. VMSafe), the host should not be configured to send network information to a VM. If the API is enabled, an attacker might attempt to connect a VM to it, thereby potentially providing access to the network of other VMs on the host. If you are using a product that makes use of this API then verify that the host has been configured correctly.",
    "audit": "If a dvfilter-based network security appliance is not being used on the host, ensure that the following kernel parameter has a blank value: /Net/DVFilterBindIpAddress. 1. From the vSphere web client select the host and click \"Manage\" -> \"Advanced System Settings\". 2. Enter Net.DVFilterBindIpAddress in the filter. 3. Verify Net.DVFilterBindIpAddress has an empty value.   4. If an appliance is being used, then make sure the value of this parameter is set to the proper IP address. Additionally, the following PowerCLI command may be used: # List Net.DVFilterBindIpAddress for each host Get-VMHost | Select Name, @{N=\"Net.DVFilterBindIpAddress\";E={$_ | Get- VMHostAdvancedConfiguration Net.DVFilterBindIpAddress | Select -ExpandProperty Values}}",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Set Net.DVFilterBindIpAddress to null on all hosts Get-VMHost HOST1 | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name Net.DVFilterBindIpAddress -Value \"\" } Impact: This will prevent a dvfilter-based network security appliance such as a firewall from functioning if not configured correctly. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.ext_solutions.doc/GUID-6013E15D-92CE-4970- 953C-ACCB36ADA8AD.html",
    "profile_applicability": "  Level 1",
    "impact": "This will prevent a dvfilter-based network security appliance such as a firewall from functioning if not configured correctly. Default Value: The prescribed state is the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.ext_solutions.doc/GUID-6013E15D-92CE-4970- 953C-ACCB36ADA8AD.html",
    "function_names": [
      "compute_vm_dvfilter_api_disabled",
      "compute_vm_dvfilter_api_unused",
      "compute_vm_dvfilter_api_restricted",
      "compute_vm_dvfilter_api_no_unintended_use",
      "compute_vm_dvfilter_api_secure_config"
    ]
  },
  {
    "id": "2.8",
    "title": "When adding ESXi hosts to Active Directory use the vSphere Authentication Proxy to protect passwords",
    "assessment": "Scored",
    "description": "If you are using Host Profiles to join ESXi hosts to Active Directory then vSphere Authentication Proxy should be used to keep credentials from being sent over the network.",
    "rationale": "If you configure your host to join an Active Directory domain using Host Profiles the active directory credentials are saved in the host profile and are transmitted over the network. To avoid having to save active directory credentials in the Host Profile and to avoid transmitting active directory credentials over the network use the vSphere Authentication Proxy.",
    "audit": "Perform the following: 1. From the vSphere web client, navigate to \"Host Profiles\" 2. Select the host profile. 3. Select \"Manage\" -> \"Edit Host profile\". 4. Expand \"Security and Services\" -> \"Security Settings\" -> \"Authentication Configuration\". 5. Select \"Active Directory configuration\". 6. Ensure \"Join Domain Method\" is set to \"Use vSphere Authentication Proxy to add the host do domain\". Additionally, the following PowerCLI command may be used: # Ensure the host profile is using vSphere Authentication proxy to add the host to the # domain Get-VMHost | Select Name, ` @{N=\"HostProfile\";E={$_ | Get-VMHostProfile}}, ` @{N=\"JoinADEnabled\";E={($_ | Get- VmHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory.Enable d}}, ` @{N=\"JoinDomainMethod\";E={(($_ | Get- VMHostProfile).ExtensionData.Config.ApplyProfile.Authentication.ActiveDirectory | Select -ExpandProperty Policy | Where {$_.Id -eq \"JoinDomainMethodPolicy\"}).Policyoption.Id}} # Check each host and their domain membership status Get-VMHost | Get-VMHostAuthentication | Select VmHost, Domain, DomainMembershipStatus",
    "remediation": "To implement the recommended configuration state, perform the following: 1. From the vSphere web client, navigate to \"Host Profiles\" 2. Select the host profile. 3. Select \"Manage\" -> \"Edit Host profile\". 4. Expand \"Security and Services\" -> \"Security Settings\" -> \"Authentication Configuration\". 5. Select \"Active Directory configuration\". 6. Set the \"Join Domain Method\" to \"Use vSphere Authentication Proxy to add the host do domain\".   7. Provide the IP address of the authentication proxy. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-084B74BD-40A5-4A4B-A82C- 0C9912D580DC.html    3 Logging",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-084B74BD-40A5-4A4B-A82C- 0C9912D580DC.html    3 Logging",
    "function_names": [
      "compute_esxi_host_ad_auth_proxy_used",
      "compute_host_profile_ad_auth_proxy_enabled",
      "compute_esxi_ad_join_credentials_protected",
      "compute_vsphere_auth_proxy_required",
      "compute_esxi_host_ad_auth_proxy_enforced",
      "compute_host_profile_ad_auth_proxy_configured",
      "compute_esxi_ad_join_auth_proxy_used",
      "compute_vsphere_auth_proxy_for_ad_join"
    ]
  },
  {
    "id": "3.1",
    "title": "Configure a centralized location to collect ESXi host core dumps",
    "assessment": "Scored",
    "description": "The VMware vSphere Network Dump Collector service allows for collecting diagnostic information from a host that experiences a critical fault.",
    "rationale": "When a host crashes, an analysis of the resultant core dump is essential to being able to identify the cause of the crash to identify a resolution. Installing a centralized dump collector helps ensure that core files are successfully saved and made available in the event an ESXi host should ever panic.",
    "audit": "Run the following ESXi shell command to determine if the host is configured as prescribed: esxcli system coredump network get",
    "remediation": "To implement the recommended configuration state, run the following ESXi shell command: # Configure remote Dump Collector Server esxcli system coredump network set -v [VMK#] -i [DUMP_SERVER] -o [PORT] # Enable remote Dump Collector esxcli system coredump network set -e true Impact: No impact on functionality. Default Value: The prescribed state is not the default state. References:   1. http://kb.vmware.com/kb/1032051 http://kb.vmware.com/kb/2003042",
    "profile_applicability": "  Level 1",
    "impact": "No impact on functionality. Default Value: The prescribed state is not the default state.",
    "references": "1. http://kb.vmware.com/kb/1032051 http://kb.vmware.com/kb/2003042",
    "function_names": [
      "esxi_host_core_dump_collector_configured",
      "esxi_host_core_dump_centralized_location_enabled",
      "vsphere_network_dump_collector_service_enabled",
      "esxi_host_core_dump_remote_storage_configured",
      "vsphere_dump_collector_network_access_secure",
      "esxi_host_core_dump_retention_policy_set",
      "vsphere_dump_collector_service_autostart_enabled",
      "esxi_host_core_dump_encryption_enabled"
    ]
  },
  {
    "id": "3.2",
    "title": "Configure Host Profiles to monitor and alert on configuration changes",
    "assessment": "Scored",
    "description": "The Host Profiles feature monitors host configurations against an established profile and provides notification when unauthorized configurations take place.",
    "rationale": "Monitoring for configuration drift and unauthorized changes is critical to ensuring the security of an ESXi hosts. Host Profiles provide an automated method for monitoring host configurations against an established template and for providing notification in the event deviations are detected.",
    "audit": "There are 3 ways to monitor an ESXi host's compliance to the host profile: 1. Navigate to the Host Profiles list in the vSphere Client. 1. Select the profile to check. 2. In the Hosts and Clusters tab, select the host or cluster from the list under Entity Name. 3. Click Check Compliance Now. 4. The compliance status is updated as Compliant, Unknown, or Non-compliant. 2. Schedule the \"Check compliance of a profile\" task to run once in the future or multiple times, at a recurring interval. This task checks that a host's configuration matches the configuration specified in a host profile. By default, this interval is set to check once a day. 3. Set the following alarms to alert on various events. 1. Alarm Settings -> Alarm Type: \"Hosts\" -> \"Monitor for specific events\" -> Triggers: \"Host profile applied\", \"Host compliant with profile\", \"Host noncompliant with profile\" 2. Alarm Settings -> Alarm Type: \"Clusters\" -> \"Monitor for specific events\" -> Triggers: \"Cluster compliance checked\"",
    "remediation": "Perform the following: 1. Configure a reference ESXi host with the desired configuration and use the host to create a Host Profile. 2. Attach the host profile to other hosts with identical hardware configurations. 3. Monitor hosts compliance to the host profile from the vSphere Client.  References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.hostprofiles.doc/GUID-78BB234A-D735-4356- 9CCF-19DD55DB8060.html",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.hostprofiles.doc/GUID-78BB234A-D735-4356- 9CCF-19DD55DB8060.html",
    "function_names": [
      "compute_host_profile_monitoring_enabled",
      "compute_host_profile_alerting_enabled",
      "compute_host_profile_configuration_changes_monitored",
      "compute_host_profile_unauthorized_changes_alerted",
      "compute_host_profile_baseline_compliance_enabled"
    ]
  },
  {
    "id": "3.3",
    "title": "Configure persistent logging for all ESXi host",
    "assessment": "Scored",
    "description": "System logs are required for auditing and diagnostic purposes. If you do not store system logs permanently, for example on a datastore, they disappear after a reboot. Ensuring persistent logging is set can prevent the loss of logs on reboot.",
    "rationale": "ESXi can be configured to store log files on an in-memory file system. This occurs when the host's /scratch directory is linked to /tmp/scratch. When this is done only a single day's worth of logs are stored at any time, in addition log files will be reinitialized upon each reboot. This presents a security risk as user activity logged on the host is only stored temporarily and will not be preserved across reboots. This can also complicate auditing and make it harder to monitor events and diagnose issues. ESXi host logging should always be configured to a persistent datastore.",
    "audit": "Perform the following: 1. Logon to the ESXi shell.   2. Run \"ls -al /\" to verify/scratch is not linked to/tmp/scratch. Additionally, the following PowerCLI command may be used: # List Syslog.global.logDir for each host Get-VMHost | Select Name, @{N=\"Syslog.global.logDir\";E={$_ | Get- VMHostAdvancedConfiguration Syslog.global.logDir | Select -ExpandProperty Values}}",
    "remediation": "Perform the following: 1. Logon to the ESXi shell. 2. Run \"ls -al /\" to verify/scratch is not linked to/tmp/scratch. 3. If/scratch is linked to/tmp/scratch change it to a persistent datastore. 4. Identify the datastore path where you want to place scratch. 5. Login to the vSphere web client. 6. Navigating to the host. 7. Select \"Manage\" -> \"Advanced System Settings\". 8. EnterSyslog.global.LogDir in the filter. 9. Set theSyslog.global.LogDirto the desired datastore path. Alternatively, run the following PowerCLI command: # Set Syslog.global.logDir for each host Get-VMHost | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name Syslog.global.logDir -Value \"<NewLocation>\" }  Note: the Syslog.global.LogDir must be set for each host. The host syslog parameters can also be configured using the vCLI or PowerCLI, or using an API client. Impact: Additional disk space will be required to store log files. Default Value: When booting from a local disk: YES When booting from USB/SD: NO When using Auto Deploy Stateless Installs: NO References:   1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.install.doc/GUID-9F67DB52-F469-451F-B6C8- DAE8D95976E7.html http://kb.vmware.com/kb/1033696",
    "profile_applicability": "  Level 1",
    "impact": "Additional disk space will be required to store log files. Default Value: When booting from a local disk: YES When booting from USB/SD: NO When using Auto Deploy Stateless Installs: NO",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.install.doc/GUID-9F67DB52-F469-451F-B6C8- DAE8D95976E7.html http://kb.vmware.com/kb/1033696",
    "function_names": [
      "esxi_host_logging_persistent_enabled",
      "esxi_host_logging_datastore_configured",
      "esxi_host_logging_reboot_protected",
      "esxi_host_logging_audit_retention_enabled"
    ]
  },
  {
    "id": "3.4",
    "title": "Configure remote logging for ESXi hosts",
    "assessment": "Scored",
    "description": "By default ESXI logs are stored on a local scratch volume or ramdisk. To preserve logs further configure centralized logging for the ESXI hosts.",
    "rationale": "Remote logging to a central log host provides a secure, centralized store for ESXi logs. By gathering host log files onto a central host you can more easily monitor all hosts with a single tool. You can also do aggregate analysis and searching to look for such things as coordinated attacks on multiple hosts. Logging to a secure, centralized log server also helps prevent log tampering and also provides a long-term audit record.",
    "audit": "Perform the following: 1. Install/Enable a syslog host (i.e vSphere Syslog Collector). 2. From the vSphere web client select the host and click \"Manage\" -> \"Advanced Sytem Settings\" 3. Enter Syslog.global.logHost in the filter. 4. Ensure the Syslog.global.logHost to the hostname of your syslog server. Additionally, the following PowerCLI command may be used: # List Syslog.global.logHost for each host Get-VMHost | Select Name, @{N=\"Syslog.global.logHost\";E={$_ | Get- VMHostAdvancedConfiguration Syslog.global.logHost | Select -ExpandProperty Values}}",
    "remediation": "Perform the following: 1. Install/Enable a syslog host (i.e vSphere Syslog Collector). 2. From the vSphere web client select the host and click \"Manage\" -> \"Advanced Sytem Settings\"   3. Enter Syslog.global.logHost in the filter. 4. Set the Syslog.global.logHost to the hostname of your syslog server. To implement the recommended configuration state, run the following PowerCLI command: # Set Syslog.global.logHost for each host Get-VMHost | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name Syslog.global.logHost -Value \"<NewLocation>\" } Note: When setting a remote log host it is also recommended to set the \"Syslog.global.logDirUnique\" to true. You must configure the syslog settings for each host. The host syslog parameters can also be configured using the vCLI or PowerCLI, or using an API client. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.install.doc/GUID-471EFE67-9035-473E-8217- 6B67E493A518.html    4 Access",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.install.doc/GUID-471EFE67-9035-473E-8217- 6B67E493A518.html    4 Access",
    "function_names": [
      "compute_esxi_host_remote_logging_enabled",
      "compute_esxi_host_logs_centralized",
      "compute_esxi_host_logs_remote_storage_enabled",
      "compute_esxi_host_logs_persistent_storage",
      "compute_esxi_host_logs_external_destination",
      "compute_esxi_host_logs_non_local_storage",
      "compute_esxi_host_logs_remote_retention_enabled",
      "compute_esxi_host_logs_offsite_backup_enabled"
    ]
  },
  {
    "id": "4.1",
    "title": "Create a non-root user account for local admin access",
    "assessment": "Scored",
    "description": "Create at least one named user account and use this account in lieu of a shared \"root\" account.",
    "rationale": "By default each ESXi host has a single \"root\" admin account that is used for local administration and to connect the host to vCenter Server. To avoid sharing a common root account it is recommended on each host to create at least one named user account and assign it full admin privileges and to use this account in lieu of a shared \"root\" account. Set a highly complex password for the \"root\" account and secure it in a safe location. Limit the use of \"root\" but do not remove the \"root\" account.",
    "audit": "Perform the following: 1. Connect directly to the ESXi host using the vSphere Client. 2. Login as root or another authorized user. 3. Select the \"Local Users & Groups\" tab and view the local users. 4. Ensure at least one user exists that posses the following: 1. Shell access has been granted to this user. 2. Select the \"Permissions\" tab and verify the \"Administrator\" role has been granted to the user. 5. Repeat this for each ESXi hosts.",
    "remediation": "Local ESXi user accounts cannot be created using the vSphere web client, you must use the vSphere client. 1. Connect directly to the ESXi host using the vSphere Client. 2. Login as root. 3. Select the \"Local Users & Groups\" tab 4. Add a local user, be sure to grant shell access to this user.   5. Select the \"Permissions\" tab. 6. Assign the \"Administrator\" role to the user. 7. Repeat this for each ESXi hosts. Notes: 1. Even if you add your ESXi host to an Active Directory domain it is still recommended to add at least one local user account to ensure admins can still login in the event the host ever becomes isolated and unable to access Active Directory. 2. Adding local user accounts can be automated using Host Profiles. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-670B9B8C-3810-4790-AC83- 57142A9FE16F.html",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-670B9B8C-3810-4790-AC83- 57142A9FE16F.html",
    "function_names": [
      "iam_user_root_usage_disabled",
      "iam_user_local_admin_exists",
      "iam_user_non_root_account_created",
      "iam_user_root_login_prohibited",
      "iam_user_admin_privileges_restricted"
    ]
  },
  {
    "id": "4.2",
    "title": "Ensure the vpxuser account's password is automatically changed every 10 or fewer days",
    "assessment": "Scored",
    "description": "When a host is added to the vCenter Server inventory, vCenter Server creates a special user account called vpxuser on the host. vpxuser is a privileged account that acts as a proxy for all actions initiated through vCenter Server. Ensure that vpxuser's password is set to change every 10 or fewer days.",
    "rationale": "Ensuring that the password expires frequently limits the amount of time an attacker can use the vpxuser password if it is compromised.",
    "audit": "From the vSphere web client:   1. Select the vCenter Server and go to \"Manage\" -> \"Advanced Settings\". 2. Enter VimPasswordExpirationInDays in the filter. 3. Ensure VirtualCenter.VimPasswordExpirationInDays is set to 10 or less. Additionally, the following PowerCLI command may be used: # List the vCenter Password Expiration Value Get-AdvancedSetting -Entity $defaultVIServer -Name \"VirtualCenter.VimPasswordExpirationInDays\"",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Set the vCenter Password Expiration Value to 10 Get-AdvancedSetting -Entity $defaultVIServer -Name \"VirtualCenter.VimPasswordExpirationInDays\" | Set-AdvancedSetting -Value 10 Impact: The password aging policy must not be shorter than the interval that is set to automatically change the vpxuser password, otherwise vCenter might get locked out of an ESXi host. Default Value: Password automatically changes every 30 days. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-96210743-0C17-4AE9-89FC- 76778EC9D06E.html",
    "profile_applicability": "  Level 1",
    "impact": "The password aging policy must not be shorter than the interval that is set to automatically change the vpxuser password, otherwise vCenter might get locked out of an ESXi host. Default Value: Password automatically changes every 30 days.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-96210743-0C17-4AE9-89FC- 76778EC9D06E.html",
    "function_names": [
      "vcenter_host_vpxuser_password_rotation_over_10d",
      "vcenter_account_vpxuser_password_rotation_enabled",
      "vcenter_host_vpxuser_password_auto_rotation",
      "vcenter_account_vpxuser_password_rotation_frequency",
      "vcenter_host_vpxuser_password_rotation_compliance"
    ]
  },
  {
    "id": "4.3",
    "title": "Establish a password policy for password complexity",
    "assessment": "Scored",
    "description": "Require the use of passwords that are not easily guessed and that are difficult for password generators to determine.",
    "rationale": "ESXi uses the pam_passwdqc.so plug-in to set password strength and complexity. It is important to use passwords that are not easily guessed and that are difficult for password generators to determine. Note: ESXi imposes no restrictions on the root password. Password strength and complexity rules only apply to non-root users.",
    "audit": "Perform the following: 1. Login to the ESXi shell as a user with administrator privileges. 2. Open /etc./pam.d/passwd 3. Locate the following line: password requisite /lib/security/$ISA/pam_passwdqc.so retry=N min=N0,N1,N2,N3,N4 4. Confirm N is less than or equal to 5 5. Confirm N0 is set to disabled 6. Confirm N1 is set to disabled 7. Confirm N2 is set to disabled 8. Confirm N3 is set to disabled 9. Confirm N4 is set to 14 or greater This above requires all passwords to be 14 or more characters long and comprised of at least one character from four distinct character sets. Additionally, a maximum of 5 login attempts are permitted.",
    "remediation": "Perform the following: 1. Login to the ESXi shell as a user with administrator privileges. 2. Open /etc./pam.d/passwd 3. Locate the following line: password requisite /lib/security/$ISA/pam_passwdqc.so retry=N min=N0,N1,N2,N3,N4 4. Set N is less than or equal to 5 5. Set N0 to disabled 6. Set N1 to disabled 7. Set N2 to disabled 8. Set N3 to disabled   9. Set N4 to 14 or greater This above requires all passwords to be 14 or more characters long and comprised of at least one character from four distinct character sets. Additionally, a maximum of 5 login attempts are permitted. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-F48903DA-8A66-47C7-9796- CD12339B2164.html 2. http://www.openwall.com/passwdqc/README.shtml",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-F48903DA-8A66-47C7-9796- CD12339B2164.html 2. http://www.openwall.com/passwdqc/README.shtml",
    "function_names": [
      "iam_password_policy_complexity_enabled",
      "iam_password_policy_min_length_14",
      "iam_password_policy_require_uppercase",
      "iam_password_policy_require_lowercase",
      "iam_password_policy_require_numbers",
      "iam_password_policy_require_symbols",
      "iam_password_policy_no_reuse_over_24",
      "iam_password_policy_max_age_90d",
      "iam_password_policy_expire_passwords_enabled",
      "iam_password_policy_prevent_common_passwords"
    ]
  },
  {
    "id": "4.4",
    "title": "Use Active Directory for local user authentication",
    "assessment": "Scored",
    "description": "ESXi can be configured to use a directory service such as Active Directory to manage users and groups. It is recommended that a directory service be used.",
    "rationale": "Joining ESXi hosts to an Active Directory (AD) domain will eliminate the need to create and maintain multiple local user accounts. Using AD for user authentication simplifies the ESXi host configuration, ensures password complexity and reuse policies are enforced and reduces the risk of security breaches and unauthorized access.",
    "audit": "Execute the following PowerCLI command: # Check each host and their domain membership status Get-VMHost | Get-VMHostAuthentication | Select VmHost, Domain, DomainMembershipStatus",
    "remediation": "From the vSphere Web Client:   1. Select the host and go to \"Manage\" -> \"Authentication Services\" and click the \"Join Domain\" button. 2. Provide the domain name along with the user credentials for an AD user that has the rights to join computers to the domain. To implement the recommended configuration state, run the following PowerCLI command: # Join the ESXI Host to the Domain Get-VMHost HOST1 | Get-VMHostAuthentication | Set-VMHostAuthentication -Domain domain.local -User Administrator -Password Passw0rd -JoinDomain  Notes : 1. Host Profiles can be used to automate adding hosts to an AD domain. 2. Consider using the vSphere Authentication proxy to avoid transmitting AD credentials over the network. 3. If the AD group \"ESX Admins\" (default) is created all users and groups that are assigned as members to this group will have full administrative access to all ESXi hosts the domain. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-A61A8FA4-A4AF-475C-860E- 3FD8947F0D0B.html http://kb.vmware.com/kb/1025569.",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-A61A8FA4-A4AF-475C-860E- 3FD8947F0D0B.html http://kb.vmware.com/kb/1025569.",
    "function_names": [
      "esxi_host_active_directory_authentication_enabled",
      "esxi_host_local_user_authentication_disabled",
      "esxi_host_directory_service_integration_required",
      "esxi_host_ad_authentication_configured",
      "esxi_host_external_identity_provider_used"
    ]
  },
  {
    "id": "4.5",
    "title": "Verify Active Directory group membership for the \"ESX Admins\" group",
    "assessment": "Not Scored",
    "description": "The AD group used by vSphere is defined by the esxAdminsGroup attribute. By default, this attribute is set to \"ESX Admins\". All members of the \"ESX Admins\" group are granted full administrative access to all ESXi hosts in the domain. Monitor AD for the creation of this group and limit membership to highly trusted users and groups.",
    "rationale": "An unauthorized user having membership in the group set by the esxAdminsGroup attribute will have full administrative access to all ESXi hosts. Given this, such users may compromise the confidentiality, availability, and integrity of the all ESXi hosts and the respective data and processes they influence.",
    "audit": "From Active Directory, monitor the membership of the group name that is defined by the advanced host setting: Config.HostAgent.plugins.hostsvc.esxAdminsGroup. As with any default group, consider changing this name to avoid possible exploits) and verify only authorized user and group accounts are members of this group. If full admin access for the AD ESX admins group is not desired you can disable this behavior using the advanced host setting: \"Config.HostAgent.plugins.hostsvc.esxAdminsGroupAutoAdd\"",
    "remediation": "1. Verify the setting of the esxAdminsGroup attribute (\"ESX Admins\" by default). 2. Check the list of members for that Microsoft Active Directory group. 3. Remove any unauthorized users from that group. Impact: Coordination between vSphere admins and Active Directory admins is needed. Default Value: The AD group used by vSphere is defined by the esxAdminsGroup attribute. By default, this attribute is set to \"ESX Admins\" References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.apiref.doc/vim.host.AuthenticationManager.html    5 Console",
    "profile_applicability": "  Level 1",
    "impact": "Coordination between vSphere admins and Active Directory admins is needed. Default Value: The AD group used by vSphere is defined by the esxAdminsGroup attribute. By default, this attribute is set to \"ESX Admins\"",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.apiref.doc/vim.host.AuthenticationManager.html    5 Console",
    "function_names": [
      "active_directory_group_membership_restricted",
      "active_directory_esx_admins_group_monitored",
      "active_directory_esx_admins_group_limited",
      "active_directory_group_high_trust_membership",
      "active_directory_esx_admins_group_audit_enabled",
      "active_directory_group_administrative_access_controlled",
      "active_directory_esx_admins_group_membership_alerted",
      "active_directory_group_privileged_access_restricted"
    ]
  },
  {
    "id": "5.1",
    "title": "Disable DCUI to prevent local administrative control",
    "assessment": "Scored",
    "description": "The Direct Console User Interface (DCUI) can be disabled to prevent any local administration from the Host.  Once the DCUI is disabled any administration of the ESXi host will be done through vCenter.",
    "rationale": "The DCUI allows for low-level host configuration such as configuring IP address, hostname and root password as well as diagnostic capabilities such as enabling the ESXi shell, viewing log files, restarting agents, and resetting configurations. Actions performed from the DCUI are not tracked by vCenter Server. Even if Lockdown Mode is enabled, users who are members of the DCUI.Access list can perform administrative tasks in the DCUI bypassing RBAC and auditing controls provided through vCenter. DCUI access can be disabled. Disabling it prevents all local activity and thus forces actions to be performed in vCenter Server where they can be centrally audited and monitored.",
    "audit": "Perform the following: 1. From the vSphere web client select the host. 2. Select \"Manage\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"Direct Console UI\". 6. Very the Startup Policy is set to \"Start and Stop Manually\". Additionally, the following PowerCLI command may be used: # List DCUI settings for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"DCUI\" }",
    "remediation": "Perform the following:   1. From the vSphere web client select the host. 2. Select \"Manage\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"Direct Console UI\". 6. Click \"Stop\". 7. Change the Startup Policy \"Start and Stop Manually\". Additionally, the following PowerCLI command will implement the recommended configuration state: # Set DCUI to start manually rather than automatic for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"DCUI\" } | Set-VMHostService - Policy Off Impact: Disabling the DCUI can create a potential \"lock out\" situation should the host become isolated from vCenter Server. Recovering from a \"lock out\" scenario requires re-installing ESXi. Consider leaving DCUI enabled and instead enable lockdown mode and limit the users allowed to access the DCUI using the DCUI.Access list. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116- A8353D19FF56.html",
    "profile_applicability": "  Level 2",
    "impact": "Disabling the DCUI can create a potential \"lock out\" situation should the host become isolated from vCenter Server. Recovering from a \"lock out\" scenario requires re-installing ESXi. Consider leaving DCUI enabled and instead enable lockdown mode and limit the users allowed to access the DCUI using the DCUI.Access list. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116- A8353D19FF56.html",
    "function_names": [
      "esxi_host_dcui_disabled",
      "esxi_host_local_admin_disabled",
      "esxi_host_console_access_disabled",
      "esxi_host_direct_console_disabled",
      "esxi_host_remote_management_only"
    ]
  },
  {
    "id": "5.2",
    "title": "Disable ESXi Shell unless needed for diagnostics or troubleshooting",
    "assessment": "Scored",
    "description": "The ESXi shell should only be enabled when running diagnostics or troubleshooting. Otherwise it should be disabled on each host.",
    "rationale": "ESXi Shell is an interactive command line environment available from the Direct Console User Interface (DCUI) or remotely via SSH. Access to this mode requires the root password of the server. The ESXi Shell can be turned on and off for individual hosts. Activities performed from the ESXi Shell bypass vCenter RBAC and audit controls. The ESXi shell should only be turned on when needed to troubleshoot/resolve problems that cannot be fixed through the vSphere client or vCLI/PowerCLI.",
    "audit": "Perform the following: 1. From the vSphere web client select the host. 2. Select \"Manage\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"ESXi Shell\". 6. Click \"Stop\". 7. Ensure the Startup Policy is set \"Start and Stop Manually\" Additionally, the following PowerCLI command may be used: # Check if ESXi Shell is running and set to start Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM\" } | Select VMHost, Key, Label, Policy, Running, Required Note: A host warning is displayed in the web client anytime the ESXi Shell is enabled on a host.",
    "remediation": "Perform the following: 1. From the vSphere web client select the host. 2. Select \"Manage\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"ESXi Shell\". 6. Click \"Stop\". 7. Change the Startup Policy \"Start and Stop Manually\" Additionally, the following PowerCLI command will implement the recommended configuration state: # Set ESXi Shell to start manually rather than automatic for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM\" } | Set-VMHostService - Policy Off   Default Value: The prescribed state is the default state. References: 1. http://kb.vmware.com/kb/2004746",
    "profile_applicability": "  Level 1",
    "references": "1. http://kb.vmware.com/kb/2004746",
    "function_names": [
      "compute_esxi_shell_disabled",
      "compute_esxi_shell_diagnostics_enabled",
      "compute_esxi_shell_troubleshooting_enabled",
      "compute_esxi_shell_disabled_all_hosts",
      "compute_esxi_shell_restricted_access"
    ]
  },
  {
    "id": "5.3",
    "title": "Disable SSH",
    "assessment": "Scored",
    "description": "Disable Secure Shell (SSH) for each ESXi host to prevent remote access to the ESXi shell. only enable if needed for troubleshooting or diagnostics.",
    "rationale": "The ESXi shell, when enabled, can be accessed directly from the host console through the DCUI or remotely using SSH. Remote access to the host should be limited to the vSphere Client, remote command-line tools (vCLI/PowerCLI), and through the published APIs. Under normal circumstances remote access to the host using SSH should be disabled.",
    "audit": "Perform the following: 1. From the vSphere web client select the host. 2. Select \"Manage\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"SSH\". 6. Ensure the Startup Policy is set to \"Start and Stop Manually\". Additionally, the following PowerCLI command may be used: # Check if SSH is running and set to start Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM-SSH\" } | Select VMHost, Key, Label, Policy, Running, Required Note: A host warning is displayed in the web client anytime SSH is enabled on a host.",
    "remediation": "Perform the following: 1. From the vSphere web client select the host. 2. Select \"Manage\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"SSH\". 6. Click \"Stop\". 7. Change the Startup Policy \"to Start and Stop Manually\". Additionally, the following PowerCLI command will implement the recommended configuration state: # Set SSH to start manually rather than automatic for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM-SSH\" } | Set-VMHostService - Policy Off Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-12E27BF3-3769-4665-8769- DA76C2BC9FFE.html",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-12E27BF3-3769-4665-8769- DA76C2BC9FFE.html",
    "function_names": [
      "compute_esxi_host_ssh_disabled",
      "compute_esxi_host_remote_access_restricted",
      "compute_esxi_host_shell_access_disabled",
      "compute_esxi_host_ssh_troubleshooting_only",
      "compute_esxi_host_direct_access_disabled"
    ]
  },
  {
    "id": "5.4",
    "title": "Enable lockdown mode to restrict remote access",
    "assessment": "Scored",
    "description": "Lockdown mode disables local access to the ESXi host.  All management must be done from vCenter to ensure proper permissions and roles are being applied when using lockdown mode.",
    "rationale": "Enabling lockdown mode disables direct access to an ESXi host requiring the host be managed remotely from vCenter Server. Lockdown limits ESXi host access to the vCenter server. This is done to ensure the roles and access controls implemented in vCenter are always enforced and users cannot bypass them by logging into a host directly. By forcing all   interaction to occur through vCenter Server, the risk of someone inadvertently attaining elevated privileges or performing tasks that are not properly audited is greatly reduced. Note: Lockdown mode does not apply to users who log in using authorized keys. When you use an authorized key file for root user authentication, root users are not prevented from accessing a host with SSH even when the host is in lockdown mode. Note that users listed in the DCUI.Access list for each host are allowed to override lockdown mode and login to the DCUI. By default the \"root\" user is the only user listed in the DCUI.Access list.",
    "audit": "From the vSphere web client: 1. Select the host 2. Select \"Manage\" -> \"Security Profile\". 3. Scroll down to \"Lockdown Mode\". 4. Click \"Edit...\". 5. Ensure the \"Enable Lockdown Mode\" checkbox is set Additionally, the following PowerCLI command may be used: # To check if Lockdown mode is enabled Get-VMHost | Select Name,@{N=\"Lockdown\";E={$_.Extensiondata.Config.adminDisabled}}",
    "remediation": "From the vSphere web client: 1. Select the host 2. Select \"Manage\" -> \"Security Profile\". 3. Scroll down to \"Lockdown Mode\". 4. Click \"Edit...\". 5. Select the \"Enable Lockdown Mode\" checkbox. To implement the recommended configuration state, run the following PowerCLI command: # Enable lockdown mode for each host Get-VMHost | Foreach { $_.EnterLockdownMode() } Impact: There are some operations, such as backup and troubleshooting, that require direct access to the host. In these cases Lockdown Mode can be disabled on a temporary basis for specific hosts as needed, and then re-enabled when the task is completed.   Note: Lockdown mode does not apply to users listed in the DCUI.Access list, which by default includes the root user. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2-B838- 225F5FF480FF.html http://kb.vmware.com/kb/1008077",
    "profile_applicability": "  Level 1",
    "impact": "There are some operations, such as backup and troubleshooting, that require direct access to the host. In these cases Lockdown Mode can be disabled on a temporary basis for specific hosts as needed, and then re-enabled when the task is completed.   Note: Lockdown mode does not apply to users listed in the DCUI.Access list, which by default includes the root user. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2-B838- 225F5FF480FF.html http://kb.vmware.com/kb/1008077",
    "function_names": [
      "compute_esxi_host_lockdown_mode_enabled",
      "compute_esxi_host_remote_access_restricted",
      "compute_esxi_host_local_access_disabled",
      "compute_esxi_host_vcenter_management_required",
      "compute_esxi_host_lockdown_mode_active"
    ]
  },
  {
    "id": "5.5",
    "title": "Remove keys from SSH authorized_keys file",
    "assessment": "Scored",
    "description": "For day-to-day operations the ESXi host should be in Lockdown mode with the Secure Shell (SSH) service disabled. Lockdown mode does not prevent root users from logging in using authorized keys. When you use an authorized key file for root user authentication, root users are not prevented from accessing a host with SSH even when the host is in lockdown mode.",
    "rationale": "ESXi hosts come with SSH which can be enabled to allow remote access without requiring user authentication. To enable password free access copy the remote users public key into the /etc/ssh/keys-root/authorized_keys file on the ESXi host. The presence of the remote user's public key in the authorized_keys file identifies the user as trusted, meaning the user is granted access to the host without providing a password. Note: Lockdown mode does not apply to root users who log in using authorized keys. When you use an authorized key file for root user authentication, root users are not prevented from accessing a host with SSH even when the host is in lockdown mode.",
    "audit": "To check for SSH keys added to the authorized_keys file: 1. Logon to the ESXi shell as root or an authorized admin user.   2. Verify the /etc/ssh/keys-root/authorized_keys file is empty.",
    "remediation": "To check for SSH keys added to the authorized_keys file: 1. Logon to the ESXi shell as root or an authorized admin user. 2. Verify the contents of the /etc/ssh/keys-root/authorized_keys file. 3. If the file is not empty remove any keys found in the file. Impact: Disabling the SSH authorized_keys access may limit your ability to run unattended remote scripts. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-392ADDE9-FD3B-49A2-BF64- 4ACBB60EB149.html",
    "profile_applicability": "  Level 1",
    "impact": "Disabling the SSH authorized_keys access may limit your ability to run unattended remote scripts. Default Value: The prescribed state is the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-392ADDE9-FD3B-49A2-BF64- 4ACBB60EB149.html",
    "function_names": [
      "compute_host_authorized_keys_removed",
      "compute_host_ssh_lockdown_enabled",
      "compute_host_root_ssh_disabled",
      "compute_host_authorized_keys_empty",
      "compute_host_ssh_root_access_restricted"
    ]
  },
  {
    "id": "5.6",
    "title": "Set a timeout to automatically terminate idle ESXi Shell and SSH sessions",
    "assessment": "Scored",
    "description": "Set a timeout to automatically terminate any idle ESXi shell and SSH sessions.",
    "rationale": "If a user forgets to logout of their SSH session the idle connection will remain indefinitely increasing the potential for someone to gain privileged access to the host. The ESXiShellInteractiveTimeOut allows you to automatically terminate idle shell sessions.",
    "audit": "From the vSphere web client:   1. Select the host. 2. Click \"Manage\" -> \"Advanced System Settings\". 3. Type ESXiShellInteractiveTimeOut in the filter. 4. Set the attribute to 300 or less. Note: A value of 0 disables the ESXi ShellInteractiveTimeOut. It is recommended to set the ESXiShellTimeOut together with ESXiShellInteractiveTimeOut. Additionally, the following PowerCLI command may be used: # List UserVars.ESXiShellInteractiveTimeOut for each host Get-VMHost | Select Name, @{N=\"UserVars.ESXiShellInteractiveTimeOut\";E={$_ | Get- VMHostAdvancedConfiguration UserVars.ESXiShellInteractiveTimeOut | Select - ExpandProperty Values}}",
    "remediation": "From the vSphere web client: 1. Select the host. 2. Click \"Manage\" -> \"Advanced System Settings\". 3. Type ESXiShellInteractiveTimeOut in the filter. 4. Set the attribute to the desired value. Note: A value of 0 disables the ESXi ShellInteractiveTimeOut. Additionally, the following PowerCLI command will implement the recommended configuration state: # Set Remove UserVars.ESXiShellInteractiveTimeOut to 300 on all hosts Get-VMHost | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name UserVars.ESXiShellInteractiveTimeOut -Value 300 } Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-A1D310D7-F00B-4827-9469- EC2C318A0C30.html http://kb.vmware.com/kb/2004746",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-A1D310D7-F00B-4827-9469- EC2C318A0C30.html http://kb.vmware.com/kb/2004746",
    "function_names": [
      "compute_esxi_shell_session_timeout_enabled",
      "compute_ssh_session_timeout_enabled",
      "compute_esxi_idle_session_termination_enabled",
      "compute_esxi_shell_idle_timeout_enabled",
      "compute_ssh_idle_timeout_enabled",
      "compute_esxi_session_timeout_configured",
      "compute_esxi_shell_auto_termination_enabled",
      "compute_ssh_auto_termination_enabled"
    ]
  },
  {
    "id": "5.7",
    "title": "Set a timeout for Shell Services",
    "assessment": "Scored",
    "description": "Set a timeout to automatically stop the service for ESXi shell and SSH sessions.",
    "rationale": "When the ESXi Shell or SSH services are enabled on a host they will run indefinitely. To avoid having these services left running set the ESXiShellTimeOut. The ESXiShellTimeOut defines a window of time after which the ESXi Shell and SSH services will automatically be terminated.",
    "audit": "From the vSphere web client: 1. Select the host and click \"Manage\" -> \"Advanced System Settings\". 2. Type ESXiShellTimeOut in the filter. 3. Ensure the attribute is set to 3600 seconds (1 hour) or less. This value is in seconds. Additionally, the following PowerCLI command may be used: # List UserVars.ESXiShellTimeOut in minutes for each host Get-VMHost | Select Name, @{N=\"UserVars.ESXiShellTimeOut\";E={$_ | Get- VMHostAdvancedConfiguration UserVars.ESXiShellTimeOut | Select -ExpandProperty Values}}",
    "remediation": "From the vSphere web client: 1. Select the host and click \"Manage\" -> \"Advanced System Settings\". 2. Type ESXiShellTimeOut in the filter. 3. Set the attribute to 3600 seconds (1 hour) or less. Note: A value of 0 disables the ESXi ShellTimeOut. It is recommended to set the ESXiShellInteractiveTimeOut together with ESXiShellTimeOut. To implement the recommended configuration state, run the following PowerCLI command: # Set UserVars.ESXiShellTimeOut to 3660 on all hosts Get-VMHost | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name UserVars.ESXiShellTimeOut -Value 3600 }   Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-862CA8EF-C8CE-4322-864E- 86D0803015A5.html 2. https://blogs.vmware.com/vsphere/2012/09/vsphere-5-1-new- esxishellinteractivetimeout.html 3. http://kb.vmware.com/kb/2004746",
    "profile_applicability": "  Level 2",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-862CA8EF-C8CE-4322-864E- 86D0803015A5.html 2. https://blogs.vmware.com/vsphere/2012/09/vsphere-5-1-new- esxishellinteractivetimeout.html 3. http://kb.vmware.com/kb/2004746",
    "function_names": [
      "compute_esxi_shell_timeout_enabled",
      "compute_ssh_session_timeout_enabled",
      "compute_shell_service_timeout_configured",
      "compute_esxi_shell_session_timeout_set",
      "compute_ssh_timeout_enabled",
      "compute_shell_service_auto_stop_enabled",
      "compute_esxi_shell_inactivity_timeout_set",
      "compute_ssh_inactivity_timeout_configured"
    ]
  },
  {
    "id": "5.8",
    "title": "Set DCUI.Access to allow trusted users to override lockdown mode",
    "assessment": "Not Scored",
    "description": "Create a list of highly trusted users that would be able to override lockdown mode and access the DCUI in the event a host became isolated.",
    "rationale": "Lockdown disables direct host access requiring admins manage hosts from vCenter. However, if a host becomes isolated from vCenter the admin would become locked out and would be unable to manage the host. To avoid potentially becoming locked out of an ESXi hosts that is running in locked down mode set the DCUI.Access to a list of highly trusted users that are allowed to override the lockdown mode and access the DCUI.",
    "audit": "From the vSphere client: 1. Select the host. 2. Select \"Manage\" -> \"Advanced System Settings\". 3. Type \"DCUI.Access\" in the filter. 4. Set the \"DCUI.Access\" attribute to a comma separated list the users who are allowed to override lockdown mode.   Notes: By default only the \"root\" user is a member of the DCUI.Access list. It is not recommended to remove root from the DCUI.Access list as this will revoke the root users admin privileges on the host. Additionally, the following ESXi shell command may be used: vim-cmd hostsvc/advopt/view DCUI.Access",
    "remediation": "To implement the recommended configuration state, run the following ESXi shell command: vim-cmd hostsvc/advopt/update DCUI.Access string [USERS] Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-D92BB375-9F94-449E-838E- 51086C43CF80.html    6 Storage",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-D92BB375-9F94-449E-838E- 51086C43CF80.html    6 Storage",
    "function_names": [
      "compute_host_dcui_access_trusted_users_configured",
      "compute_host_lockdown_mode_override_enabled",
      "compute_dcui_access_whitelist_configured",
      "compute_host_isolation_override_users_defined",
      "compute_dcui_trusted_users_lockdown_configured"
    ]
  },
  {
    "id": "6.1",
    "title": "Enable bidirectional CHAP authentication for iSCSI traffic",
    "assessment": "Scored",
    "description": "By enabling bidirectional CHAP authentication, an additional level of security enables the initiator to authenticate the target.",
    "rationale": "vSphere allows for the use of bidirectional authentication of both the iSCSI target and host. Choosing not to enforce more stringent authentication can make sense if you create a dedicated network or VLAN to service all your iSCSI devices. By not authenticating both the iSCSI target and host, there is a potential for a MiTM attack in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication can mitigate this risk. If the iSCSI facility is isolated from general network traffic, it is less vulnerable to exploitation.",
    "audit": "Perform the following: 1. In the vSphere client navigate to the host. 2. Select \"Configuration\" -> \"Storage Adaptors\" -> \"iSCSI Initiator Properties\" -> \"CHAP\" -> \"CHAP (Target Authenticates Host)\". 3. Verify \"Use Chap\" is selected with a Name and a \"Secret\" configured. Additionally, the following PowerCLI command may be used: # List Iscsi Initiator and CHAP Name if defined Get-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Select VMHost, Device, ChapType, @{N=\"CHAPName\";E={$_.AuthenticationProperties.ChapName}}",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Set the Chap settings for the Iscsi Adapter Get-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Set-VMHostHba # Use desired parameters here   Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD- 49B433E2F266.html",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD- 49B433E2F266.html",
    "function_names": [
      "iscsi_target_bidirectional_chap_authentication_enabled",
      "iscsi_initiator_bidirectional_chap_authentication_enabled",
      "iscsi_connection_bidirectional_chap_authentication_enabled",
      "iscsi_session_bidirectional_chap_authentication_enabled",
      "iscsi_storage_bidirectional_chap_authentication_enabled"
    ]
  },
  {
    "id": "6.2",
    "title": "Ensure uniqueness of CHAP authentication secrets",
    "assessment": "Scored",
    "description": "CHAP (Challenge-Handshake Authentication Protocol) requires both Client and Host to know the secret (Password) to establish connection. When setting up CHAP ensure each host connects with a unique secret.",
    "rationale": "The mutual authentication secret for each host should be different; if possible, the secret should be different for each client authenticating to the server as well. This ensures that if a single host is compromised, an attacker cannot create another arbitrary host and authenticate to the storage device. With a single shared secret, compromise of one host can allow an attacker to authenticate to the storage device.",
    "audit": "In the vSphere Client: 1. Navigate to the host. 2. Select \"Configuration\" -> \"Storage Adaptors\" -> \"iSCSI Initiator Properties\" -> \"CHAP\" -> \"CHAP (Target Authenticates Host)\". 3. Verify that a different authentication secret is configured for each ESXi host. Additionally, the following PowerCLI command may be used: # List Iscsi Initiator and CHAP Name if defined Get-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Select VMHost, Device, ChapType, @{N=\"CHAPName\";E={$_.AuthenticationProperties.ChapName}}",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Set the Chap settings for the Iscsi Adapter Get-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Set-VMHostHba # Use desired parameters here Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD- 49B433E2F266.html    7 vNetwork This section contains recommendations for configuring aspects of the vNetwork, such as VLANs, vSwitches, and VDSs. 7.1 VDS This section contains recommendations for configuring vSphere Distributed Switches (VDS).",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD- 49B433E2F266.html    7 vNetwork This section contains recommendations for configuring aspects of the vNetwork, such as VLANs, vSwitches, and VDSs. 7.1 VDS This section contains recommendations for configuring vSphere Distributed Switches (VDS).",
    "function_names": [
      "storage_chap_secret_unique",
      "storage_chap_authentication_unique_secret",
      "storage_chap_connection_unique_credentials",
      "storage_chap_host_unique_password",
      "storage_chap_client_unique_secret_per_host"
    ]
  },
  {
    "id": "7.1.1",
    "title": "Disable VDS network healthcheck if not used",
    "assessment": "Scored",
    "description": "Disable VDS network healthcheck if not used.",
    "rationale": "Network Healthcheck is disabled by default. Once enabled, the healthcheck packets contain information on host#, vds# port#, which an attacker would find useful. It is recommended that network healthcheck be used for troubleshooting, and turned off when troubleshooting is finished.",
    "audit": "1. Using the vSphere Web Client, select each VDS. 2. Go to Manage > Settings > Health check\". 3. Verify that VLAN and MTU Check and Teaming and Failover Check are both disabled.",
    "remediation": "1. Using the vSphere Web Client. 2. Select each VDS. 3. Go to Manage > Settings > Health check\". 4. Disable the VLAN and MTU Check and Teaming and Failover Check settings. Impact:   Limit the use of this feature only to when actively troubleshooting VLAN or MTU issues on a VDS. Default Value: The default value is the prescribed value.",
    "profile_applicability": "  Level 1",
    "impact": "Limit the use of this feature only to when actively troubleshooting VLAN or MTU issues on a VDS. Default Value: The default value is the prescribed value.",
    "function_names": [
      "compute_vds_network_healthcheck_disabled_unused",
      "compute_vds_network_healthcheck_disabled_if_unused",
      "compute_vds_healthcheck_disabled_unused",
      "compute_vds_healthcheck_disabled_if_unused",
      "network_vds_healthcheck_disabled_unused"
    ]
  },
  {
    "id": "7.1.2",
    "title": "Ensure that the MAC Address Change policy is set to reject",
    "assessment": "Scored",
    "description": "Ensure that the MAC Address Change policy is set to reject.",
    "rationale": "If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the dvPortgroups that these applications are connected to.",
    "audit": "1. Verify by using the vSphere Client to connect to the vCenter Server and logging in as an administrator. 2. Go to \"Home > Inventory > Networking\". 3. Select each dvPortgroup connected to active VMs requiring securing. 4. Go to tab \"Summary > Edit Settings > Policies > Security\". 5. \"Mac Address Changes\" = \"Reject\" Additionally, the following PowerCLI command may be used: # List all dvPortGroups and their Security Settings Get-VirtualPortGroup -Distributed | Select Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Config.DefaultPortConfig.SecurityPolicy.MacChanges.Value) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if   ($_.ExtensionData.Config.DefaultPortConfig.SecurityPolicy.AllowPromiscuous.Value) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Config.DefaultPortConfig.SecurityPolicy.ForgedTransmits.Value) { \"Accept\" } Else { \"Reject\"} }}",
    "remediation": "1. Configure by using the vSphere Client to connect to the vCenter Server and logging in as an administrator. 2. Go to \"Home > Inventory > Networking\". 3. Select each dvPortgroup connected to active VMs requiring securing. 4. Go to tab \"Summary > Edit Settings > Policies > Security\". 5. Set \"Mac Address Changes\" = \"Reject\" Impact: This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the dvPortgroups that these applications are connected to. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.apiref.doc/vim.host.NetworkPolicy.SecurityPolicy.ht ml",
    "profile_applicability": "  Level 1",
    "impact": "This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the dvPortgroups that these applications are connected to.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.apiref.doc/vim.host.NetworkPolicy.SecurityPolicy.ht ml",
    "function_names": [
      "compute_network_interface_mac_address_change_rejected",
      "compute_vm_mac_address_change_rejected",
      "network_interface_mac_address_change_rejected",
      "vm_mac_address_change_rejected",
      "compute_mac_address_change_rejected"
    ]
  },
  {
    "id": "7.1.3",
    "title": "Ensure that the Promiscuous Mode policy is set to reject",
    "assessment": "Scored",
    "description": "Configure the vDS Promiscuous Mode setting to reject.",
    "rationale": "When promiscuous mode is enabled for a dvPortgroup, all virtual machines connected to the dvPortgroup have the potential of reading all packets across that network, meaning only the virtual machines connected to that dvPortgroup. Promiscuous mode is disabled by default on the ESXi host, and this is the recommended setting. However, there might be a   legitimate reason to enable it for debugging, monitoring or troubleshooting reasons. Security devices might require the ability to see all packets on a vSwitch. An exception should be made for the dvPortgroups that these applications are connected to, in order to allow for full-time visibility to the traffic on that dvPortgroup.",
    "audit": "1. Verify by using the vSphere Client to connect to the vCenter Server and logging in as an administrator. 2. Go to \"Home > Inventory > Networking\". 3. Select each dvPortgroup connected to active VM's requiring securing. 4. Go to tab \"Summary > Edit Settings > Policies > Security\". 5. Configure \"Promiscuous Mode\" = \"Reject\" Additionally, the following PowerCLI command may be used: # List all dvPortGroups and their Security Settings Get-VirtualPortGroup -Distributed | Select Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Config.DefaultPortConfig.SecurityPolicy.MacChanges.Value) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Config.DefaultPortConfig.SecurityPolicy.AllowPromiscuous.Value) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Config.DefaultPortConfig.SecurityPolicy.ForgedTransmits.Value) { \"Accept\" } Else { \"Reject\"} }}",
    "remediation": "1. Verify by using the vSphere Client to connect to the vCenter Server and logging in as an administrator. 2. Go to \"Home > Inventory > Networking\". 3. Select each dvPortgroup connected to active VMs requiring securing. 4. Go to tab \"Summary > Edit Settings > Policies > Security\". 5. Configure \"Promiscuous Mode\" = \"Reject\" Impact: Security devices that require the ability to see all packets on a vSwitch will not operate properly if the Promiscuous Mode parameter is set to Reject. Default Value: Promiscuous mode is disabled by default. This is the prescribed setting. References:   1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.apiref.doc/vim.host.NetworkPolicy.SecurityPolicy.ht ml",
    "profile_applicability": "  Level 1",
    "impact": "Security devices that require the ability to see all packets on a vSwitch will not operate properly if the Promiscuous Mode parameter is set to Reject. Default Value: Promiscuous mode is disabled by default. This is the prescribed setting.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.apiref.doc/vim.host.NetworkPolicy.SecurityPolicy.ht ml",
    "function_names": [
      "compute_vds_promiscuous_mode_reject",
      "compute_vds_promiscuous_mode_disabled",
      "compute_vds_promiscuous_mode_secure",
      "compute_vds_promiscuous_mode_restricted",
      "compute_vds_promiscuous_mode_compliant"
    ]
  },
  {
    "id": "7.1.4",
    "title": "Ensure that there are no unused ports on a distributed virtual port group",
    "assessment": "Scored",
    "description": "Ensure that there are no unused ports on a distributed virtual port group.",
    "rationale": "The number of ports available on a vdSwitch distributed port group can be adjusted to exactly match the number of virtual machine vNICs that need to be assigned to that dvPortgroup. Limiting the number of ports to just what is needed limits the potential for an administrator, either accidentally or maliciously, to move a virtual machine to an unauthorized network. This is especially relevant if the management network is on a dvPortgroup, because it could help prevent someone from putting a rogue virtual machine on this network.",
    "audit": "1. Connect to the vCenter Server with vSphere Client. 2. Navigate to Home > Inventory > Networking. 3. Find all dvSwitches. 4. Verify that the number of ports available total is only the amount required for legitimate virtual machine connections to that dvPortgroup. Additionally, the following PowerCLI command may be used: # Check for the number of free ports on all VDS PortGroups Function Get-FreeVDSPort { Param ( [parameter(Mandatory=$true,ValueFromPipeline=$true)] $VDSPG ) Process { $nicTypes = \"VirtualE1000\",\"VirtualE1000e\",\"VirtualPCNet32\",\"VirtualVmxnet\",\"VirtualVmxnet2\",\"Virt ualVmxnet3\" $ports = @{} $VDSPG.ExtensionData.PortKeys | Foreach { $ports.Add($_,$VDSPG.Name)   } $VDSPG.ExtensionData.Vm | Foreach { $VMView = Get-View $_ $nic = $VMView.Config.Hardware.Device | where {$nicTypes -contains $_.GetType().Name - and $_.Backing.GetType().Name -match \"Distributed\"} $nic | where {$_.Backing.Port.PortKey} | Foreach {$ports.Remove($_.Backing.Port.PortKey)} } ($ports.Keys).Count } } Get-VirtualPortGroup -Distributed | Select Name, @{N=\"NumFreePorts\";E={Get-FreeVDSPort -VDSPG $_}}",
    "remediation": "1. Connect to the vCenter Server with vSphere Client ( Home > Inventory > Networking view, find all dvSwitches) or the Web Client (Networking > vDS name > dvPortgroup name > Manage > Edit Settings > General) 2. Configure the number of ports available to be only the amount required for legitimate virtual machine connections to that dvPortgroup. Impact: The VDS or dvPortgroup on the VDS will not have any extra available port capacity. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.apiref.doc/vim.dvs.DistributedVirtualPortgroup.html",
    "profile_applicability": "  Level 1",
    "impact": "The VDS or dvPortgroup on the VDS will not have any extra available port capacity.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.apiref.doc/vim.dvs.DistributedVirtualPortgroup.html",
    "function_names": [
      "compute_distributed_port_group_no_unused_ports",
      "compute_port_group_unused_ports_removed",
      "compute_virtual_port_group_active_ports_only",
      "compute_distributed_port_group_ports_utilized",
      "compute_port_group_unused_ports_cleanup"
    ]
  },
  {
    "id": "7.1.5",
    "title": "Ensure that VDS Port Mirror traffic is only being sent to authorized collector ports or VLANs",
    "assessment": "Not Scored",
    "description": "Ensure that VDS Port Mirror traffic is only being sent to authorized collectors.",
    "rationale": "The vSphere VDS can mirror traffic from one port to another in order to allow for packet capture devices to collect specific traffic flows. Port mirroring will send a copy of all traffic specified in un-encrypted format. This mirrored traffic contains the full data in the packets   captured and can result in total compromise of that data if misdirected. If Port Mirroring is required, verify that all Port Mirror Destination VLAN, Port and Uplink ID's are correct.",
    "audit": "1. From the Web or vSphere Clients. 2. Verify that Port Mirror destination interfaces are correct. 3. Edit the VDS properties and in the Port Mirror tab. 4. Verify the Destination VLAN, Port, and Uplink ID's.",
    "remediation": "1. From the Web or vSphere Clients. 2. Configure the Port Mirror destination interfaces to be correct. 3. Edit the VDS properties. 4. In the Port Mirror tab, configure the Destination VLAN, Port, and Uplink ID's. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.networking.doc/GUID-CFFD9157-FC17-440D- BDB4-E16FD447A1BA.html",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.networking.doc/GUID-CFFD9157-FC17-440D- BDB4-E16FD447A1BA.html",
    "function_names": [
      "vds_port_mirror_authorized_collectors_only",
      "vds_port_mirror_traffic_restricted_to_authorized_ports",
      "vds_port_mirror_traffic_restricted_to_authorized_vlans",
      "vds_port_mirror_collector_port_validation",
      "vds_port_mirror_vlan_restriction_enabled"
    ]
  },
  {
    "id": "7.1.6",
    "title": "Verify that the autoexpand option for VDS dvPortgroups is disabled",
    "assessment": "Scored",
    "description": "Disable the autoexpand option for vDS dvPortgroups.",
    "rationale": "If the \"no-unused-dvports\" guideline is followed, there should be only the exact number of ports on a vDS that are actually needed. The Autoexpand feature on vDS dvPortgroups can override that limit. The feature allows dvPortgroups to automatically add 10 virtual distributed switch ports to a dvPortgroup that has run out of available ports. The risk is that maliciously or inadvertently, a virtual machine that is not supposed to be part of that portgroup is able to affect confidentiality, integrity or authenticity of data of other virtual machines on that portgroup. To reduce the risk of inappropriate dvPortgroup access, the   autoexpand option on VDS should be disabled. By default the option is disabled, but regular monitoring should be implemented to verify this has not been changed.",
    "audit": "1. Connect to the vCenter Server using the Web Client. 2. Open the settings for Networking > (vDS name) > (dvPortgroup name) > Manage > Edit Settings > General 3. Verify that \"Port allocation\" is set to \"Fixed\". 4. Verify that the \"Number of Ports\" is set to the exact amount required for legitimate virtual machine connections to that dvPortgroup. Additionally, the following PowerCLI command may be used: # Check if auto expand is enabled on vDS Get-VirtualPortGroup -Distributed | Select Name, @{N=\"AutoExpand\";E={$_.ExtensionData.Config.AutoExpand}}",
    "remediation": "1. Connect to the vCenter Server using the Web Client. 2. Open the settings for Networking > (vDS name) > (dvPortgroup name) > Manage > Edit Settings > General 3. Configure \"Port allocation\" to \"Fixed\". 4. Configure the \"Number of Ports\" to the exact amount required for legitimate virtual machine connections to that dvPortgroup. Default Value: The default state is the prescribed state. References: 1. http://kb.vmware.com/kb/1022312    7.2 VLAN This section contains recommendations for VLAN configuration.",
    "profile_applicability": "  Level 1",
    "references": "1. http://kb.vmware.com/kb/1022312    7.2 VLAN This section contains recommendations for VLAN configuration.",
    "function_names": [
      "vds_dvportgroup_autoexpand_disabled",
      "vds_dvportgroup_autoexpand_not_enabled",
      "vds_dvportgroup_autoexpand_config_disabled",
      "vds_dvportgroup_autoexpand_setting_disabled",
      "vds_dvportgroup_autoexpand_feature_disabled"
    ]
  },
  {
    "id": "7.2.1",
    "title": "Ensure that port groups are not configured to the value of the native VLAN",
    "assessment": "Scored",
    "description": "Do not use Native VLAN ID 1.",
    "rationale": "ESXi does not use the concept of native VLAN. Frames with VLAN specified in the port group will have a tag, but frames with VLAN not specified in the port group are not tagged and therefore will end up as belonging to native VLAN of the physical switch. For example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a 1; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a 1 instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged). If the ESXi virtual switch port group uses the native VLAN ID, traffic from those VMs will not be visible to the native VLAN on the switch, because the switch is expecting untagged traffic.",
    "audit": "If the default value of 1 for the native VLAN is being used, the ESXi Server virtual switch port groups should be configured with any value between 2 and 4094. Otherwise, ensure that the port group is not configured to use whatever value is set for the native VLAN. Additionally, the following PowerCLI command may be used: # List all vSwitches, their Portgroups and VLAN Ids Get-VirtualPortGroup -Standard | Select virtualSwitch, Name, VlanID",
    "remediation": "If the default value of 1 for the native VLAN is being used, the ESXi Server virtual switch port groups should be configured with any value between 2 and 4094. Otherwise, ensure that the port group is not configured to use whatever value is set for the native VLAN.",
    "profile_applicability": "  Level 1",
    "function_names": [
      "network_port_group_native_vlan_disabled",
      "network_port_group_non_default_vlan_id",
      "network_port_group_vlan_id_not_1",
      "network_port_group_secure_vlan_configuration",
      "network_port_group_native_vlan_restricted"
    ]
  },
  {
    "id": "7.2.2",
    "title": "Ensure that port groups are not configured to VLAN 4095 except for Virtual Guest Tagging (VGT)",
    "assessment": "Scored",
    "description": "Don't use VLAN 4095 except for Virtual Guest Tagging (VGT).",
    "rationale": "When a port group is set to VLAN 4095, this activates VGT mode. In this mode, the vSwitch passes all network frames to the guest VM without modifying the VLAN tags, leaving it up to the guest to deal with them. VLAN 4095 should be used only if the guest has been specifically configured to manage VLAN tags itself. If VGT is enabled inappropriately, it might cause denial of service or allow a guest VM to interact with traffic on an unauthorized VLAN.",
    "audit": "VLAN ID setting on all port groups should not be set to 4095 unless VGT is required. Additionally, the following PowerCLI command may be used: # List all vSwitches, their Portgroups and VLAN Ids Get-VirtualPortGroup -Standard | Select virtualSwitch, Name, VlanID",
    "remediation": "VLAN ID setting on all port groups should not be set to 4095 unless VGT is required.",
    "profile_applicability": "  Level 1",
    "function_names": [
      "network_port_group_no_vlan_4095",
      "network_port_group_vgt_vlan_4095_only",
      "network_port_group_vlan_4095_restricted",
      "network_port_group_vgt_compliance",
      "network_port_group_vlan_4095_allowed_only_for_vgt"
    ]
  },
  {
    "id": "7.2.3",
    "title": "Ensure that port groups are not configured to VLAN values reserved by upstream physical switches",
    "assessment": "Not Scored",
    "description": "Ensure that port groups are not configured to VLAN values reserved by upstream physical switches",
    "rationale": "Certain physical switches reserve certain VLAN IDs for internal purposes and often disallow traffic configured to these values. For example, Cisco Catalyst switches typically reserve VLANs 1001 through 1024 and 4094, while Nexus switches typically reserve 3968 through 4047 and 4094. Check with the documentation for your specific switch. Using a reserved VLAN might result in a denial of service on the network.",
    "audit": "VLAN ID setting on all port groups should not be set to reserved values of the physical switch. Additionally, the following PowerCLI command may be used: # List all vSwitches, their Portgroups and VLAN Ids Get-VirtualPortGroup -Standard | Select virtualSwitch, Name, VlanID",
    "remediation": "VLAN ID setting on all port groups should not be set to reserved values of the physical switch. Additionally, the following PowerCLI command may be used: # List all vSwitches, their Portgroups and VLAN Ids Get-VirtualPortGroup -Standard | Select virtualSwitch, Name, VlanID References: 1. http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12- 2/20ew/configuration/guide/config/vlans.html#wp1038758 2. http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5500/sw/laye r2/7x/b_5500_Layer2_Config_7x/b_5500_Layer2_Config_7x_chapter_010.html#con_ 1143823    7.3 vSwitch This section contains recommendations for securing vSwitches.",
    "profile_applicability": "  Level 1",
    "references": "1. http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12- 2/20ew/configuration/guide/config/vlans.html#wp1038758 2. http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5500/sw/laye r2/7x/b_5500_Layer2_Config_7x/b_5500_Layer2_Config_7x_chapter_010.html#con_ 1143823    7.3 vSwitch This section contains recommendations for securing vSwitches.",
    "function_names": [
      "compute_port_group_reserved_vlan_avoided",
      "network_port_group_reserved_vlan_restricted",
      "compute_port_group_vlan_reserved_blocked",
      "network_port_group_vlan_upstream_conflict_prevented",
      "compute_port_group_vlan_physical_switch_reserved_avoided"
    ]
  },
  {
    "id": "7.3.1",
    "title": "Ensure that the vSwitch Forged Transmits policy is set to reject",
    "assessment": "Scored",
    "description": "Set the vSwitch Forged Transmits policy is set to reject for each vSwitch.",
    "rationale": "If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. Forged transmissions should be set to accept by default. This means the virtual switch does not compare the source and effective MAC addresses. To protect against MAC address impersonation, all virtual switches should have forged transmissions set to reject.",
    "audit": "Verify by using the vSphere Client to connect to the vCenter Server and as administrator: 1. Go to \"Home > Inventory > Hosts and clusters\". 2. Select each ESXi host with active virtual switches connected to active VM's requiring securing. 3. Go to tab \"Configuration > Network > vSwitch(?) > Properties > Ports > vSwitch > Default Policies > Security\" 4. Ensure \"Forged Transmits\" is set to \"Reject\" Additionally, the following PowerCLI command may be used: # List all vSwitches and their Security Settings Get-VirtualSwitch -Standard | Select VMHost, Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Spec.Policy.Security.MacChanges) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Spec.Policy.Security.PromiscuousMode) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Spec.Policy.Security.ForgedTransmits) { \"Accept\" } Else { \"Reject\"} }}",
    "remediation": "Verify by using the vSphere Client to connect to the vCenter Server and as administrator: 1. Go to \"Home > Inventory > Hosts and clusters\". 2. Select each ESXi host with active virtual switches connected to active VM's requiring securing. 3. Go to tab \"Configuration > Network > vSwitch(?) > Properties > Ports > vSwitch > Default Policies > Security\" 4. Set \"Forged Transmits\" to \"Reject\" Additionally, the following ESXi shell command may be used: # esxcli network vswitch standard policy security set -v vSwitch2 -f false Impact: This will prevent VMs from changing their effective MAC address. This will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.networking.doc/GUID-74E2059A-CC5E-4B06-81B5- 3881C80E46CE.html",
    "profile_applicability": "  Level 1",
    "impact": "This will prevent VMs from changing their effective MAC address. This will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.networking.doc/GUID-74E2059A-CC5E-4B06-81B5- 3881C80E46CE.html",
    "function_names": [
      "compute_vswitch_forged_transmits_reject",
      "compute_vswitch_forged_transmits_reject_all_regions",
      "compute_vswitch_forged_transmits_reject_enabled",
      "compute_vswitch_forged_transmits_reject_config",
      "compute_vswitch_forged_transmits_reject_policy"
    ]
  },
  {
    "id": "7.3.2",
    "title": "Ensure that the vSwitch MAC Address Change policy is set to reject",
    "assessment": "Scored",
    "description": "Ensure that the MAC Address Change policy within the vSwitch is set to reject.",
    "rationale": "If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks   on the devices in a network by impersonating a network adaptor authorized by the receiving network. This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to.",
    "audit": "Verify by using the vSphere Client to connect to the vCenter Server and as administrator: 1. Go to \"Home > Inventory > Hosts and clusters\". 2. Select each ESXi host with active virtual switches connected to active VM's requiring securing. 3. Go to tab \"Configuration > Network > vSwitch(?) > Properties > Ports > vSwitch > Default Policies > Security\" 4. Ensure \"Mac Address Changes\" is set to \"Reject\". Additionally, the following PowerCLI command may be used: # List all vSwitches and their Security Settings Get-VirtualSwitch -Standard | Select VMHost, Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Spec.Policy.Security.MacChanges) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Spec.Policy.Security.PromiscuousMode) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Spec.Policy.Security.ForgedTransmits) { \"Accept\" } Else { \"Reject\"} }}",
    "remediation": "Using the vSphere Client, connect to the vCenter Server and as administrator: 1. Go to \"Home > Inventory > Hosts and clusters\". 2. Select each ESXi host with active virtual switches connected to active VM's requiring securing. 3. Go to tab \"Configuration > Network > vSwitch(?) > Properties > Ports > vSwitch > Default Policies > Security\" 4. Set \"Mac Address Changes\" to \"Reject\". Additionally, perform the following to implement the recommended configuration state using the ESXi shell: # esxcli network vswitch standard policy security set -v vSwitch2 -m false Impact:   This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.networking.doc/GUID-74E2059A-CC5E-4B06-81B5- 3881C80E46CE.html",
    "profile_applicability": "  Level 1",
    "impact": "This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.networking.doc/GUID-74E2059A-CC5E-4B06-81B5- 3881C80E46CE.html",
    "function_names": [
      "vpc_vswitch_mac_address_change_reject",
      "vpc_vswitch_mac_address_change_policy_reject",
      "vpc_vswitch_mac_address_change_deny",
      "vpc_vswitch_mac_address_change_protection_enabled",
      "vpc_vswitch_mac_address_change_security_enabled"
    ]
  },
  {
    "id": "7.3.3",
    "title": "Ensure that the vSwitch Promiscuous Mode policy is set to reject",
    "assessment": "Scored",
    "description": "Ensure that the Promiscuous Mode Policy within the vSwitch is set to reject.",
    "rationale": "When promiscuous mode is enabled for a virtual switch all virtual machines connected to the dvPortgroup have the potential of reading all packets crossing that network. Promiscuous mode is disabled by default on the ESXi Server, and this is the recommended setting. However, there might be a legitimate reason to enable it for debugging, monitoring or troubleshooting reasons. Security devices might require the ability to see all packets on a vSwitch. An exception should be made for the dvPortgroups that these applications are connected to, in order to allow for full-time visibility to the traffic on that dvPortgroup.",
    "audit": "Verify by using the vSphere Client to connect to the vCenter Server and as administrator: 1. Go to \"Home > Inventory > Hosts and clusters\". 2. Select each ESXi host with active virtual switches connected to active VM's requiring securing. 3. Go to tab \"Configuration > Network > vSwitch name > Properties > Ports > vSwitch > Default Policies > Security\"   4. Ensure \"Promiscuous Mode\" is set to \"Reject\" Additionally, the following PowerCLI command may be used: # List all vSwitches and their Security Settings Get-VirtualSwitch -Standard | Select VMHost, Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Spec.Policy.Security.MacChanges) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Spec.Policy.Security.PromiscuousMode) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Spec.Policy.Security.ForgedTransmits) { \"Accept\" } Else { \"Reject\"} }}",
    "remediation": "Using the vSphere Client, connect to the vCenter Server and as administrator: 1. Go to \"Home > Inventory > Hosts and clusters\". 2. Select each ESXi host with active virtual switches connected to active VM's requiring securing. 3. Go to tab \"Configuration > Network > vSwitch name > Properties > Ports > vSwitch > Default Policies > Security\" 4. Set \"Promiscuous Mode\" = \"Reject\" Additionally, perform the following to implement the recommended configuration state via the ESXi shell: # esxcli network vswitch standard policy security set -v vSwitch2 -p false Impact: Security devices that require the ability to see all packets on a vSwitch will not operate properly if the Promiscuous Mode parameter is set to Reject. Default Value: The prescribed state is the default state. References: 1. http://kb.vmware.com/kb/1004099    8 Virtual Machines 8.1 Communication",
    "profile_applicability": "  Level 1",
    "impact": "Security devices that require the ability to see all packets on a vSwitch will not operate properly if the Promiscuous Mode parameter is set to Reject. Default Value: The prescribed state is the default state.",
    "references": "1. http://kb.vmware.com/kb/1004099    8 Virtual Machines 8.1 Communication",
    "function_names": [
      "compute_vswitch_promiscuous_mode_rejected",
      "network_vswitch_promiscuous_mode_disabled",
      "vpc_vswitch_promiscuous_mode_rejected",
      "vswitch_promiscuous_mode_rejected",
      "vswitch_security_promiscuous_mode_disabled"
    ]
  },
  {
    "id": "8.1.1",
    "title": "Disable VM communication through VMCI",
    "assessment": "Scored",
    "description": "Configure the Virtual Machine Communication Interface (VMCI) to restrict VM communication.",
    "rationale": "If the interface is not restricted, a VM can detect and be detected by all other VMs with the same option enabled within the same host. This might be the intended behavior, but custom-built software can have unexpected vulnerabilities that might potentially lead to an exploit. Additionally, it is possible for a VM to detect how many other VMs are within the same ESXI system by simply registering the VM. This information might also be used for a potentially malicious objective. By default, the setting is FALSE. The VM can be exposed to other VMs within the same system as long as there is at least one program connected to the VMCI socket interface. Guest-to-guest communications (virtual machine to virtual machine) are deprecated in the vSphere 5.1 release. This functionality will be removed in the next major release. VMware will continue support for host to guest communications.",
    "audit": "Check virtual machine configuration file and verify that vmci0.unrestricted is set to FALSE Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"vmci0.unrestricted\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command:   # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"vmci0.unrestricted\" -value $false Impact: Virtual machines will be unable to communicate using VMCI technology. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.ICbase/PDF/ws8x_esx51_vmci_sockets.pdf",
    "profile_applicability": "  Level 1",
    "impact": "Virtual machines will be unable to communicate using VMCI technology. Default Value: The prescribed state is the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.ICbase/PDF/ws8x_esx51_vmci_sockets.pdf",
    "function_names": [
      "compute_vm_vmci_disabled",
      "compute_vm_vmci_restricted",
      "compute_vm_communication_disabled",
      "compute_vmci_interface_disabled",
      "compute_vmci_restricted_mode_enabled"
    ]
  },
  {
    "id": "8.1.2",
    "title": "Limit informational messages from the VM to the VMX file",
    "assessment": "Scored",
    "description": "Limit informational messages from the virtual machine to the VMX file to avoid filling the datastore and causing a Denial of Service (DoS).",
    "rationale": "The configuration file containing these name-value pairs is limited to a size of 1MB. This 1MB capacity should be sufficient for most cases, but you can change this value if necessary. You might increase this value if large amounts of custom information are being stored in the configuration file. The default limit is 1MB; this limit is applied even when the sizeLimit parameter is not listed in the .vmx file. Uncontrolled size for the VMX file can lead to denial of service if the datastore is filled.",
    "audit": "Check virtual machine configuration file and verify that tools.setInfo.sizeLimit is set to 1048576. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"tools.setInfo.sizeLimit\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"tools.setInfo.sizeLimit\" -value 1048576 Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_vm_informational_messages_limited",
      "compute_vm_vmx_file_logging_restricted",
      "compute_vm_datastore_dos_protected",
      "compute_vmx_file_message_threshold_set",
      "compute_vm_logging_rate_limited"
    ]
  },
  {
    "id": "8.1.3",
    "title": "Limit sharing of console connections",
    "assessment": "Scored",
    "description": "Limit the max number of console connections to prevent non-administrators from observing the VMs screen.",
    "rationale": "By default, remote console sessions can be connected to by more than one user at a time. When multiple sessions are activated, each terminal window gets a notification about the new session. If an administrator in the VM logs in using a VMware remote console during their session, a non-administrator in the VM might connect to the console and observe the administrator's actions. Also, this could result in an administrator losing console access to a virtual machine. For example if a jump box is being used for an open console session, and the admin loses connection to that box, then the console session remains open. Allowing two console sessions permits debugging via a shared session. For highest security, only one remote console session at a time should be allowed.",
    "audit": "Check virtual machine configuration file and verify that RemoteDisplay.maxConnections is set to 1.   Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"RemoteDisplay.maxConnections\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"RemoteDisplay.maxConnections\" -value 1 Impact: Only one remote console connection to the VM will be permitted. Other attempts will be rejected until the first session disconnects. Default Value: The prescribed state is not the default state. References: 1. http://kb.vmware.com/kb/2015407    8.2 Devices",
    "profile_applicability": "  Level 1",
    "impact": "Only one remote console connection to the VM will be permitted. Other attempts will be rejected until the first session disconnects. Default Value: The prescribed state is not the default state.",
    "references": "1. http://kb.vmware.com/kb/2015407    8.2 Devices",
    "function_names": [
      "compute_vm_console_connection_limit",
      "compute_vm_console_sharing_disabled",
      "compute_vm_console_access_restricted",
      "compute_vm_console_session_limit",
      "compute_vm_console_observation_blocked"
    ]
  },
  {
    "id": "8.2.1",
    "title": "Disconnect unauthorized devices - Floppy Devices",
    "assessment": "Scored",
    "description": "Any enabled or connected device represents a potential attack channel. Users and processes without privileges on a virtual machine can connect or disconnect hardware devices, such as network adapters and CD-ROM drives. Attackers can use this capability to breach virtual machine security. Removing unnecessary hardware devices can help prevent attacks.",
    "rationale": "Besides disabling unnecessary virtual devices from within the virtual machine, you should ensure that no device is connected to a virtual machine if it is not required to be there. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE. NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel.",
    "audit": "The following parameters should either NOT be present or should be set to FALSE, unless Floppy drives are required: floppyX.present Additionally, the following PowerCLI command may be used: # Check for Floppy Devices attached to VMs Get-VM | Get-FloppyDrive | Select Parent, Name, ConnectionState",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command:   # Remove all Floppy drives attached to VMs Get-VM | Get-FloppyDrive | Remove-FloppyDrive Impact: Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "profile_applicability": "  Level 1",
    "impact": "Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "function_names": [
      "compute_vm_floppy_disabled",
      "compute_vm_unauthorized_devices_disabled",
      "compute_vm_floppy_disconnected",
      "compute_vm_removable_media_disabled",
      "compute_vm_floppy_device_removed",
      "compute_vm_hardware_devices_restricted",
      "compute_vm_floppy_access_blocked",
      "compute_vm_unnecessary_devices_disabled"
    ]
  },
  {
    "id": "8.2.2",
    "title": "Disconnect unauthorized devices - CD/DVD Devices",
    "assessment": "Scored",
    "description": "Any enabled or connected device represents a potential attack channel. Users and processes without privileges on a virtual machine can connect or disconnect hardware devices, such as network adapters and CD-ROM drives. Attackers can use this capability to breach virtual machine security. Removing unnecessary hardware devices can help prevent attacks.",
    "rationale": "Besides disabling unnecessary virtual devices from within the virtual machine, you should ensure that no device is connected to a virtual machine if it is not required to be there. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE. NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel.",
    "audit": "The following parameters should either NOT be present or should be set to FALSE, unless CD-ROM is required: ideX:Y.present Additionally, the following PowerCLI command may be used: # Check for CD/DVD Drives attached to VMs Get-VM | Get-CDDrive",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Remove all CD/DVD Drives attached to VMs Get-VM | Get-CDDrive | Remove-CDDrive Impact: Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "profile_applicability": "  Level 1",
    "impact": "Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "function_names": [
      "compute_vm_cd_dvd_disabled",
      "compute_vm_unauthorized_devices_disconnected",
      "compute_vm_removable_media_restricted",
      "compute_vm_hardware_devices_minimized",
      "compute_vm_external_media_blocked",
      "compute_vm_device_connection_restricted",
      "compute_vm_physical_media_disabled",
      "compute_vm_peripheral_devices_removed"
    ]
  },
  {
    "id": "8.2.3",
    "title": "Disconnect unauthorized devices - Parallel Devices",
    "assessment": "Scored",
    "description": "Any enabled or connected device represents a potential attack channel. Users and processes without privileges on a virtual machine can connect or disconnect hardware devices, such as network adapters and CD-ROM drives. Attackers can use this capability to breach virtual machine security. Removing unnecessary hardware devices can help prevent attacks.",
    "rationale": "Besides disabling unnecessary virtual devices from within the virtual machine, you should ensure that no device is connected to a virtual machine if it is not required to be there. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE. NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel.",
    "audit": "The following parameters should either NOT be present or should be set to FALSE, unless Parallel ports are required: parallelX.present Additionally, the following PowerCLI command may be used: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html # Check for Parallel ports attached to VMs Get-VM | Get-ParallelPort",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html # Remove all Parallel Ports attached to VMs Get-VM | Get-ParallelPort | Remove-ParallelPort Impact: Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state. References:   1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "profile_applicability": "  Level 1",
    "impact": "Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "function_names": [
      "compute_vm_unauthorized_devices_disconnected",
      "compute_vm_parallel_devices_restricted",
      "compute_vm_hardware_devices_minimized",
      "compute_vm_device_connection_audited",
      "compute_vm_unnecessary_devices_removed",
      "compute_vm_network_adapter_restricted",
      "compute_vm_cdrom_drive_disabled",
      "compute_vm_privileged_device_access_controlled"
    ]
  },
  {
    "id": "8.2.4",
    "title": "Disconnect unauthorized devices - Serial Devices",
    "assessment": "Scored",
    "description": "Any enabled or connected device represents a potential attack channel. Users and processes without privileges on a virtual machine can connect or disconnect hardware devices, such as network adapters and CD-ROM drives. Attackers can use this capability to breach virtual machine security. Removing unnecessary hardware devices can help prevent attacks.",
    "rationale": "Besides disabling unnecessary virtual devices from within the virtual machine, you should ensure that no device is connected to a virtual machine if it is not required to be there. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE. NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel.",
    "audit": "The following parameters should either NOT be present or should be set to FALSE, unless Serial ports are required: serialX.present Additionally, the following PowerCLI command may be used: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html # Check for Serial ports attached to VMs Get-VM | Get-SerialPort",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html # Remove all Serial Ports attached to VMs Get-VM | Get-SerialPort | Remove-SerialPort Impact: Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "profile_applicability": "  Level 1",
    "impact": "Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "function_names": [
      "compute_vm_serial_devices_disconnected",
      "compute_vm_unauthorized_devices_disabled",
      "compute_vm_serial_port_access_restricted",
      "compute_vm_hardware_devices_minimized",
      "compute_vm_device_connection_audited",
      "compute_vm_serial_interface_disabled",
      "compute_vm_peripheral_devices_removed",
      "compute_vm_console_access_restricted"
    ]
  },
  {
    "id": "8.2.5",
    "title": "Disconnect unauthorized devices - USB Devices",
    "assessment": "Scored",
    "description": "Any enabled or connected device represents a potential attack channel. Users and processes without privileges on a virtual machine can connect or disconnect hardware devices, such as network adapters and CD-ROM drives. Attackers can use this capability to breach virtual machine security. Removing unnecessary hardware devices can help prevent attacks.",
    "rationale": "Besides disabling unnecessary virtual devices from within the virtual machine, you should ensure that no device is connected to a virtual machine if it is not required to be there. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE.   NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel.",
    "audit": "The following parameters should either NOT be present or should be set to FALSE, unless USB controllers are required: usb.present Additionally, the following PowerCLI command may be used: # Check for USB Devices attached to VMs Get-VM | Get-USBDevice",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Remove all USB Devices attached to VMs Get-VM | Get-USBDevice | Remove-USBDevice Impact: Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "profile_applicability": "  Level 1",
    "impact": "Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "function_names": [
      "compute_vm_unauthorized_usb_devices_disconnected",
      "compute_vm_hardware_devices_restricted",
      "compute_vm_unnecessary_devices_removed",
      "compute_vm_usb_devices_disabled",
      "compute_vm_device_connection_restricted"
    ]
  },
  {
    "id": "8.2.6",
    "title": "Prevent unauthorized removal, connection, and modification of devices",
    "assessment": "Scored",
    "description": "Prevent unauthorized removal, connection, and modification of devices.",
    "rationale": "Normal users and processes - that is, users and processes without root or administrator privileges  within virtual machines have the capability to connect or disconnect devices, such as network adaptors and CD-ROM drives, as well as the ability to modify device settings. In general, you should use the virtual machine settings editor or configuration editor to remove any unneeded or unused hardware devices. However, you might want to use the device again, so removing it is not always a good solution. In that case, you can prevent a user or running process in the virtual machine from connecting or disconnecting a device from within the guest operating system, as well as modifying devices, by adding the following parameters. By default, a rogue user with non-administrator privileges in a virtual machine can:  Connect a disconnected CD-ROM drive and access sensitive information on the media left in the drive.  Disconnect a network adapter to isolate the virtual machine from its network, which is a denial of service.  Modify settings on a device.",
    "audit": "Check virtual machine configuration file and verify that isolation.device.edit.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.device.edit.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.device.edit.disable\" -value $true Impact: Device interaction is blocked inside the guest OS using VMware tools. Default Value:   The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-C5898E50-2182-4B71-BADC- C9BFA409FB6C.html 2. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html    8.3 Guest",
    "profile_applicability": "  Level 1",
    "impact": "Device interaction is blocked inside the guest OS using VMware tools. Default Value:   The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-C5898E50-2182-4B71-BADC- C9BFA409FB6C.html 2. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html    8.3 Guest",
    "function_names": [
      "compute_instance_device_removal_protected",
      "compute_instance_device_connection_restricted",
      "compute_instance_device_modification_prevented",
      "compute_device_removal_authorization_required",
      "compute_device_connection_authorization_required",
      "compute_device_modification_authorization_required",
      "compute_device_removal_protected_all_regions",
      "compute_device_connection_restricted_all_regions",
      "compute_device_modification_prevented_all_regions"
    ]
  },
  {
    "id": "8.3.1",
    "title": "Disable unnecessary or superfluous functions inside VMs",
    "assessment": "Not Scored",
    "description": "Reduce the number of potential attack vectors by disabling unnecessary system components that are not needed to support the application or service running on the virtual machine.",
    "rationale": "By disabling unnecessary system components that are not needed to support the application or service running on the system, you reduce the number of parts that can be attacked. VMs often don't require as many services or functions as ordinary physical servers; so when virtualizing, you should evaluate whether a particular service or function is truly needed. Any service running in a VM provides a potential avenue of attack.",
    "audit": "Verify the following are disabled: 1. Unused services in the operating system. For example, if the system runs a file server, make sure to turn off any Web services. 2. Unused physical devices, such as CD/DVD drives, floppy drives, and USB adaptors. This is described in the Removing Unnecessary Hardware Devices section in the ESXI Configuration Guide. 3. Screen savers. X-Windows if using a Linux, BSD, or Solaris guest operating system.",
    "remediation": "Some of these steps include: 1. Disable unused services in the operating system. For example, if the system runs a file server, make sure to turn off any Web services. 2. Disconnect unused physical devices, such as CD/DVD drives, floppy drives, and USB adaptors. This is described in the Removing Unnecessary Hardware Devices section in the ESXI Configuration Guide.   3. Turn off any screen savers. If using a Linux, BSD, or Solaris guest operating system, do not run the X Window system unless it is necessary. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-6BFA8CA7-610F-4E6B-9FC6- D656917B7E7A.html",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-6BFA8CA7-610F-4E6B-9FC6- D656917B7E7A.html",
    "function_names": [
      "compute_vm_unnecessary_functions_disabled",
      "compute_vm_superfluous_components_disabled",
      "compute_vm_attack_vectors_reduced",
      "compute_vm_unused_services_disabled",
      "compute_vm_nonessential_functions_disabled"
    ]
  },
  {
    "id": "8.3.2",
    "title": "Minimize use of the VM console",
    "assessment": "Not Scored",
    "description": "Grant access to the Virtual Machine console only when needed. Use custom roles to provide fine grained permissions.",
    "rationale": "The VM console enables you to connect to the console of a virtual machine, in effect seeing what a monitor on a physical server would show. The VM console also provides power management and removable device connectivity controls, which might potentially allow a malicious user to bring down a virtual machine. In addition, it also has a performance impact on the service console, especially if many VM console sessions are open simultaneously.",
    "audit": "Instead of VM console, use native remote management services, such as terminal services and ssh, to interact with virtual machines. Grant VM console access only when necessary. 1. From the vSphere Client, select an object in the inventory. 2. Click the Permissions tab to view the user and role pair assignments for that object. 3. Next, navigate to Administration\\Roles section of vCenter. 4. Select the role in question and choose edit to see which effective privileges are enabled. 5. Only Authorized users should have a role which allows them a privilege under the Virtual Machine\\Interaction section of the role editor.",
    "remediation": "By default the vCenter roles \"Virtual Machine Power User\" and \"Virtual Machine Administrator\" have the \"Virtual Machine.Interaction.Console Interaction\" privilege. Do not allow unauthorized individuals to have these roles on a virtual machine or folder of virtual machines. 1. From the vSphere Client, navigate to Administration\\Roles section of vCenter. 2. Create a custom role and choose edit to enable only the minimum needed effective privileges. 3. Next, select an object in the inventory. 4. Click the Permissions tab to view the user and role pair assignments for that object. 5. Remove any default \"Admin\" or \"Power User\" roles and assign the new custom role as needed. References: 1. http://www.vmware.com/support/developer/PowerCLI/PowerCLI51/html/Invok e-VMScript.html 2. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-3D47149A-947D-4608-88B3- E5811129EFA8.html",
    "profile_applicability": "  Level 1",
    "references": "1. http://www.vmware.com/support/developer/PowerCLI/PowerCLI51/html/Invok e-VMScript.html 2. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-3D47149A-947D-4608-88B3- E5811129EFA8.html",
    "function_names": [
      "compute_vm_console_access_restricted",
      "compute_vm_custom_role_required",
      "compute_vm_console_minimal_permissions",
      "compute_vm_console_access_audited",
      "compute_vm_console_role_based_access"
    ]
  },
  {
    "id": "8.3.3",
    "title": "Use secure protocols for virtual serial port access",
    "assessment": "Not Scored",
    "description": "Virtual serial ports allow virtual machines to communicate over the network. Doing so allows you to redirect the virtual serial port connection to a TCP/IP connection on the ESXi host. If virtual serial ports are needed be sure they are configured to use secure protocols.",
    "rationale": "Serial ports are interfaces for connecting peripherals to the virtual machine. They are often used on physical systems to provide a direct, low-level connection to the console of a server. Serial ports allow for debug level access, which often does not have strong controls like logging or privileges.",
    "audit": "Check that no clear text protocols are configured:    tcp - an unencrypted TCP connection (IPv4 or IPv6)  tcp4 - an unencrypted TCP connection (IPv4 only)  tcp6 - an unencrypted TCP connection (IPv6 only)  telnet telnet over TCP without SSL. The virtual machine and remote system can negotiate and use SSL if the remote system supports the telnet authentication option. If not, the connection uses unencrypted text (plain text) Only these secure protocols should be configured:  ssl - the equivalent of TCP+SSL  tcp+ssl - SSL over TCP over IPv4 or IPv6  tcp4+ssl - SSL over TCP over IPv4  tcp6+ssl - SSL over TCP over IPv6  telnet over TCP with SSL. The virtual machine and remote system can negotiate and use SSL if the remote system supports the telnet authentication option. If not, the connection uses unencrypted text (plain text)  telnets - telnet over SSL over TCP. In this case, SSL negotiation begins immediately and you cannot use the telnet authentication option.",
    "remediation": "Configuring Virtual Serial Port Communications with Secure Network Protocols:  ssl - the equivalent of TCP+SSL  tcp+ssl - SSL over TCP over IPv4 or IPv6  tcp4+ssl - SSL over TCP over IPv4  tcp6+ssl - SSL over TCP over IPv6  telnet over TCP with SSL. The virtual machine and remote system can negotiate and use SSL if the remote system supports the telnet authentication option. If not, the connection uses unencrypted text (plain text)  telnets - telnet over SSL over TCP. In this case, SSL negotiation begins immediately and you cannot use the telnet authentication option. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.apiref.doc/vim.vm.device.VirtualSerialPort.URIBackin gInfo.html 2. http://kb.vmware.com/kb/2004954 3. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.vsp.doc/virtual_serial_port_using_proxy_Chapter1.3.2. html",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.apiref.doc/vim.vm.device.VirtualSerialPort.URIBackin gInfo.html 2. http://kb.vmware.com/kb/2004954 3. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.vsp.doc/virtual_serial_port_using_proxy_Chapter1.3.2. html",
    "function_names": [
      "compute_virtual_serial_port_secure_protocol_enabled",
      "compute_serial_port_tcp_redirect_secure",
      "compute_vm_serial_port_encrypted_connection",
      "compute_virtual_serial_port_tls_required",
      "compute_serial_port_network_access_restricted",
      "compute_vm_serial_port_secure_channel_enabled",
      "compute_serial_port_secure_protocol_only",
      "compute_virtual_serial_port_no_insecure_protocols"
    ]
  },
  {
    "id": "8.3.4",
    "title": "Use templates to deploy VMs whenever possible",
    "assessment": "Not Scored",
    "description": "Use a hardened base operating system template image to create other, application-specific templates and use the application-specific templates to deploy virtual machines.",
    "rationale": "By capturing a hardened base operating system image (with no applications installed) in a template, you can ensure that all your virtual machines are created with a known baseline level of security. You can then use this template to create other, application-specific templates, or you can use the application template to deploy virtual machines. Manual installation of the OS and applications into a VM introduces the risk of misconfiguration due to human or process error.",
    "audit": "Verify that new virtual machine deployments are completed using hardened, patched, and properly configured OS  templates.",
    "remediation": "Provide templates for VM creation that contain hardened, patched, and properly configured OS deployments. If possible, pre-deploy applications in templates as well, although care should be taken that the application doesn't depend upon VM-specific information to be deployed. In vSphere, you can convert a template to a virtual machine and back again quickly, which makes updating templates quite easy. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.vm_admin.doc/GUID-9062F225-E01B-42BA-8AFB- 8EA4069068FE.html    8.4 Monitor",
    "profile_applicability": "  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.vm_admin.doc/GUID-9062F225-E01B-42BA-8AFB- 8EA4069068FE.html    8.4 Monitor",
    "function_names": [
      "compute_vm_template_used",
      "compute_vm_hardened_image_used",
      "compute_vm_application_template_used",
      "compute_vm_deployment_from_template",
      "compute_image_hardened_base_used",
      "compute_template_application_specific_used"
    ]
  },
  {
    "id": "8.4.1",
    "title": "Control access to VMs through the dvfilter network APIs",
    "assessment": "Not Scored",
    "description": "Configure VMs protected by dvfilter network APIs correctly.",
    "rationale": "A VM must be configured explicitly to accept access by the dvfilter network API. This should be done only for VMs for which you want this to be done. An attacker might compromise the VM by making use of this introspection channel.",
    "audit": "If a VM is supposed to be protected:  Verify that the following in its VMX file: ethernet0.filter1.name = dv- filter1 where ethernet0 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and dv- filter1 is the name of the particular data path kernel module that is protecting the VM.  Ensure that the name of the data path kernel is set correctly. If a VM is not supposed to be protected:  Verify that the following is not in its VMX file: ethernet0.filter1.name = dv- filter1 where ethernet0 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and dv- filter1 is the name of the particular data path kernel module that is protecting the VM.",
    "remediation": "If a VM is supposed to be protected:  Configure the following in its VMX file: ethernet0.filter1.name = dv- filter1 where ethernet0 is the network adapter interface of the virtual machine   that is to be protected, filter1 is the number of the filter that is being used, and dv- filter1 is the name of the particular data path kernel module that is protecting the VM.  Ensure that the name of the data path kernel is set correctly. If a VM is not supposed to be protected:  Remove the following from its VMX file: ethernet0.filter1.name = dv- filter1 where ethernet0 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and dv- filter1 is the name of the particular data path kernel module that is protecting the VM. Impact: Incorrectly configuring this option can negatively impact functionality of tools that use vmsafe API. Incorrectly configuring this option can prevent VMs from connecting to the network. Default Value: The prescribed state is the default state. References: 1. http://kb.vmware.com/kb/1714 2. http://kb.vmware.com/kb/1028151",
    "profile_applicability": "  Level 1",
    "impact": "Incorrectly configuring this option can negatively impact functionality of tools that use vmsafe API. Incorrectly configuring this option can prevent VMs from connecting to the network. Default Value: The prescribed state is the default state.",
    "references": "1. http://kb.vmware.com/kb/1714 2. http://kb.vmware.com/kb/1028151",
    "function_names": [
      "compute_vm_dvfilter_access_controlled",
      "compute_vm_dvfilter_network_apis_restricted",
      "compute_vm_dvfilter_security_enabled",
      "compute_vm_dvfilter_protection_enabled",
      "compute_vm_dvfilter_api_access_limited",
      "compute_vm_dvfilter_network_secure",
      "compute_vm_dvfilter_config_valid",
      "compute_vm_dvfilter_policy_enforced"
    ]
  },
  {
    "id": "8.4.2",
    "title": "Control VMsafe Agent Address",
    "assessment": "Not Scored",
    "description": "Configure the vmsafe.agentAddress option in the virtual machine configuration file correctly.",
    "rationale": "The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks. However, an attacker might compromise the VM by making   use of this introspection channel; therefore you should monitor for unauthorized usage of this API. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters to perform the following: 1. Enable the API 2. Set the IP address used by the security virtual appliance on the introspection vSwitch 3. Set the port number for that IP address. If the VM is being protected by such a product, then make sure the latter two parameters are set correctly. This should be done only for specific VMs for which you want this protection.",
    "audit": "If the VM is not being protected by a VMsafe CPU/memory product, then check virtual machine configuration file and verify that vmsafe.agentAddress is not present. If it is being protected by a VMsafe CPU/Memory product then make sure the vmsafe.agentAddress is set to the correct value. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"vmsafe.agentAddress\" | Select Entity, Name, Value",
    "remediation": "If the VM is not being protected by a VMsafe CPU/memory product, then check virtual machine configuration file and verify that vmsafe.agentAddress is not present. If it is being protected by a VMsafe CPU/Memory product then make sure this is set to the correct value Impact: Incorrectly configuring this option can negatively impact functionality of tools that use VMsafe API. Default Value: The prescribed state is the default state. References:   1. http://kb.vmware.com/kb/1714 2. http://www.vmware.com/files/xls/hardeningguide-vsphere5-1-ga-release- public.xlsx",
    "profile_applicability": "  Level 1",
    "impact": "Incorrectly configuring this option can negatively impact functionality of tools that use VMsafe API. Default Value: The prescribed state is the default state.",
    "references": "1. http://kb.vmware.com/kb/1714 2. http://www.vmware.com/files/xls/hardeningguide-vsphere5-1-ga-release- public.xlsx",
    "function_names": [
      "compute_virtual_machine_vmsafe_agent_address_configured",
      "compute_vm_vmsafe_agent_address_valid",
      "compute_vm_vmsafe_agent_address_correct",
      "compute_vm_vmsafe_agent_address_properly_set",
      "compute_vm_vmsafe_agent_address_compliant"
    ]
  },
  {
    "id": "8.4.3",
    "title": "Control VMsafe Agent Port",
    "assessment": "Not Scored",
    "description": "Configure the vmsafe.agentPort option in the virtual machine configuration file correctly.",
    "rationale": "The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks. However, an attacker might compromise the VM by making use of this introspection channel; therefore you should monitor for unauthorized usage of this API. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters to perform the following: 1. Enable the API 2. Set the IP address used by the security virtual appliance on the introspection vSwitch 3. Set the port number for that IP address. If the VM is being protected by such a product, then make sure the latter two parameters are set correctly. This should be done only for specific VMs for which you want this protection.",
    "audit": "If the VM is not being protected by a VMsafe CPU/memory product, then check virtual machine configuration file and verify that vmsafe.agentPort is not present. If it is being protect by a VMsafe CPU/Memory product, make sure this is set to the correct value Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"vmsafe.agentPort\"| Select Entity, Name, Value",
    "remediation": "If the VM is not being protected by a VMsafe CPU/memory product, then check virtual machine configuration file and verify that vmsafe.agentPort is not present. If it is being protect by a VMsafe CPU/Memory product, make sure vmsafe.agentPort is set to the correct value. Impact: Incorrectly configuring this option can negatively impact functionality of tools that use VMsafe API. Default Value: The prescribed state is the default state. References: 1. http://kb.vmware.com/kb/1714 2. http://www.vmware.com/files/xls/hardeningguide-vsphere5-1-ga-release- public.xlsx",
    "profile_applicability": "  Level 1",
    "impact": "Incorrectly configuring this option can negatively impact functionality of tools that use VMsafe API. Default Value: The prescribed state is the default state.",
    "references": "1. http://kb.vmware.com/kb/1714 2. http://www.vmware.com/files/xls/hardeningguide-vsphere5-1-ga-release- public.xlsx",
    "function_names": [
      "compute_virtual_machine_agent_port_configured",
      "compute_vm_agent_port_secure",
      "compute_vmsafe_agent_port_valid",
      "compute_vm_config_agent_port_correct",
      "compute_virtual_machine_vmsafe_port_compliant"
    ]
  },
  {
    "id": "8.4.4",
    "title": "Control VMsafe Agent Configuration",
    "assessment": "Not Scored",
    "description": "Configure the vmsafe.enable option in the virtual machine configuration file correctly.",
    "rationale": "The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks. However, an attacker might compromise the VM by making use of this introspection channel; therefore you should monitor for unauthorized usage of this API. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters to perform the following: 1. Enable the API   2. Set the IP address used by the security virtual appliance on the introspection vSwitch 3. Set the port number for that IP address. If the VM is being protected by such a product, then make sure the latter two parameters are set correctly. This should be done only for specific VMs for which you want this protection.",
    "audit": "If the VM is not being protected by a VMsafe CPU/memory product, then check virtual machine configuration file and verify that vmsafe.enable is either not present, or set to FALSE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"vmsafe.enable\"| Select Entity, Name, Value",
    "remediation": "If the VM is not being protected by a VMsafe CPU/memory product, then check virtual machine configuration file and set vmsafe.enable to FALSE. Impact: Incorrectly configuring this option can negatively impact functionality of tools that use vmsafe API. Default Value: The prescribed state is the default state. References: 1. http://kb.vmware.com/kb/1714 2. http://www.vmware.com/files/xls/hardeningguide-vsphere5-1-ga-release- public.xlsx",
    "profile_applicability": "  Level 1",
    "impact": "Incorrectly configuring this option can negatively impact functionality of tools that use vmsafe API. Default Value: The prescribed state is the default state.",
    "references": "1. http://kb.vmware.com/kb/1714 2. http://www.vmware.com/files/xls/hardeningguide-vsphere5-1-ga-release- public.xlsx",
    "function_names": [
      "compute_virtual_machine_vmsafe_enabled",
      "compute_vm_vmsafe_agent_configured",
      "compute_vm_vmsafe_option_set",
      "compute_vm_vmsafe_agent_correct_config",
      "compute_vm_vmsafe_enable_valid"
    ]
  },
  {
    "id": "8.4.5",
    "title": "Disable Autologon",
    "assessment": "Scored",
    "description": "Disable unneeded autologon to reduce the potential for vulnerabilities.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.ghi.autologon.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.ghi.autologon.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.autologon.disable\" -value $true Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "profile_applicability": "  Level 2",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "windows_autologon_disabled",
      "windows_autologon_disabled_all_users",
      "windows_autologon_disabled_domain_joined",
      "windows_autologon_disabled_local_accounts",
      "windows_autologon_disabled_registry_setting",
      "windows_autologon_disabled_group_policy",
      "windows_autologon_disabled_all_systems",
      "windows_autologon_disabled_enterprise_wide"
    ]
  },
  {
    "id": "8.4.6",
    "title": "Disable BIOS BBS",
    "assessment": "Scored",
    "description": "Disable BIOS BBS to reduce the potential for vulnerabilities.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.bios.bbs.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.bios.bbs.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.bios.bbs.disable\" -value $true Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "profile_applicability": "  Level 2",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_bios_bbs_disabled",
      "compute_firmware_bbs_disabled",
      "compute_boot_security_disabled",
      "compute_bios_boot_services_disabled",
      "compute_uefi_bbs_disabled"
    ]
  },
  {
    "id": "8.4.7",
    "title": "Disable Guest Host Interaction Protocol Handler",
    "assessment": "Scored",
    "description": "Disable Guest Host Interaction Protocol Handle to reduce opportunity for vulnerabilities.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.ghi.protocolhandler.info.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.ghi.protocolhandler.info.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.protocolhandler.info.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References:   1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_vm_guest_host_interaction_disabled",
      "compute_instance_protocol_handler_disabled",
      "compute_vm_guest_interaction_protocol_blocked",
      "compute_vm_host_interaction_disabled",
      "compute_instance_guest_host_communication_disabled"
    ]
  },
  {
    "id": "8.4.8",
    "title": "Disable Unity Taskbar",
    "assessment": "Scored",
    "description": "Disable unexposed Unity Taskbar feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.unity.taskbar.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unity.taskbar.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unity.taskbar.disable\" -value $true Impact: Some automated tools and process may cease to function.   Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function.   Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "unity_taskbar_disabled",
      "unity_taskbar_feature_unexposed",
      "unity_taskbar_config_disabled",
      "unity_taskbar_visibility_disabled"
    ]
  },
  {
    "id": "8.4.9",
    "title": "Disable Unity Active",
    "assessment": "Scored",
    "description": "Disable unexposed Unity Active feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.unityActive.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unityActive.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command:   # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unityActive.disable\" -value $True Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_instance_unity_active_disabled",
      "compute_vm_unity_active_disabled",
      "compute_unity_active_feature_disabled",
      "compute_unity_active_deactivated",
      "compute_unity_active_setting_disabled"
    ]
  },
  {
    "id": "8.4.10",
    "title": "Disable Unity Window Contents",
    "assessment": "Scored",
    "description": "Disable unexposed Unity Window Contents feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.unity.windowContents.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unity.windowContents.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unity.windowContents.disable\" - value $True Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "unity_window_contents_disabled",
      "unity_unexposed_contents_disabled",
      "unity_window_feature_disabled",
      "unity_contents_feature_disabled",
      "unity_window_security_disabled"
    ]
  },
  {
    "id": "8.4.11",
    "title": "Disable Unity Push Update",
    "assessment": "Scored",
    "description": "Disable unexposed Unity Push Update features",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.unity.push.update.disable is set to TRUE.   Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unity.push.update.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unity.push.update.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "unity_push_update_disabled",
      "unity_push_update_feature_unexposed",
      "unity_push_update_config_disabled",
      "unity_push_update_setting_disabled",
      "unity_push_update_service_disabled"
    ]
  },
  {
    "id": "8.4.12",
    "title": "Disable Drag and Drop Version Get",
    "assessment": "Scored",
    "description": "Disable unexposed Drag and Drop Version Get feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.vmxDnDVersionGet.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.vmxDnDVersionGet.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.vmxDnDVersionGet.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "cloud_cdn_distribution_drag_and_drop_disabled",
      "cloud_cdn_distribution_version_get_disabled",
      "cloud_cdn_distribution_unexposed_feature_disabled",
      "cloud_cdn_distribution_legacy_feature_disabled",
      "cloud_cdn_distribution_insecure_feature_disabled"
    ]
  },
  {
    "id": "8.4.13",
    "title": "Disable Drag and Drop Version Set",
    "assessment": "Scored",
    "description": "Disable unexposed Drag and Drop Version Set feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters   that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.guestDnDVersionSet.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.guestDnDVersionSet.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.guestDnDVersionSet.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "cloud_cdn_distribution_drag_and_drop_disabled",
      "cloud_cdn_distribution_version_set_disabled",
      "cloud_cdn_distribution_unexposed_feature_disabled",
      "cloud_cdn_distribution_drag_and_drop_version_set_disabled"
    ]
  },
  {
    "id": "8.4.14",
    "title": "Disable Shell Action",
    "assessment": "Scored",
    "description": "Disable unexposed Shell Action feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.ghi.host.shellAction.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.ghi.host.shellAction.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.ghi.host.shellAction.disable\" -value $true Impact: Some automated tools and process may cease to function Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_instance_shell_action_disabled",
      "compute_vm_shell_action_disabled",
      "compute_instance_unexposed_shell_disabled",
      "compute_vm_unexposed_shell_disabled",
      "compute_instance_shell_access_disabled",
      "compute_vm_shell_access_disabled"
    ]
  },
  {
    "id": "8.4.15",
    "title": "Disable Request Disk Topology",
    "assessment": "Scored",
    "description": "Disable unexposed Request Disk Topology feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.dispTopoRequest.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.dispTopoRequest.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.dispTopoRequest.disable\" -value $true Impact: Some automated tools and process may cease to function Default Value: The prescribed state is not the default state. References:   1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_disk_request_topology_disabled",
      "compute_disk_topology_requests_disabled",
      "compute_disk_unexposed_topology_disabled",
      "compute_disk_topology_feature_disabled",
      "compute_disk_request_topology_feature_disabled"
    ]
  },
  {
    "id": "8.4.16",
    "title": "Disable Trash Folder State",
    "assessment": "Scored",
    "description": "Disable unexposed Trash Folder State feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.trashFolderState.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.trashFolderState.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.trashFolderState.disable\" -value $true Impact: Some automated tools and process may cease to function.   Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function.   Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "cloud_storage_bucket_trash_disabled",
      "cloud_storage_bucket_trash_folder_disabled",
      "cloud_storage_bucket_unexposed_trash_disabled",
      "cloud_storage_bucket_trash_state_disabled",
      "cloud_storage_bucket_trash_feature_disabled"
    ]
  },
  {
    "id": "8.4.17",
    "title": "Disable Guest Host Interaction Tray Icon",
    "assessment": "Scored",
    "description": "Disable unexposed Guest Host Interaction Tray Icon feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.ghi.trayicon.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.ghi.trayicon.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command:   # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.trayicon.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_vm_guest_host_interaction_disabled",
      "compute_vm_tray_icon_disabled",
      "compute_vm_guest_interaction_disabled",
      "compute_vm_host_interaction_disabled",
      "compute_vm_guest_host_tray_icon_disabled"
    ]
  },
  {
    "id": "8.4.18",
    "title": "Disable Unity",
    "assessment": "Scored",
    "description": "Disable unexposed Unity feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.unity.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unity.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unity.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "unity_feature_disabled",
      "unity_feature_unexposed_disabled",
      "unity_unexposed_feature_disabled",
      "unity_unity_feature_disabled",
      "unity_unity_feature_unexposed_disabled"
    ]
  },
  {
    "id": "8.4.19",
    "title": "Disable Unity Interlock",
    "assessment": "Scored",
    "description": "Disable unexposed Unity Interlock feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.unityInterlockOperation.disable is set to TRUE.   Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unityInterlockOperation.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unityInterlockOperation.disable\" - value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "unity_interlock_disabled",
      "unity_feature_unexposed",
      "unity_interlock_unexposed",
      "unity_interlock_deactivated",
      "unity_feature_disabled"
    ]
  },
  {
    "id": "8.4.20",
    "title": "Disable GetCreds",
    "assessment": "Scored",
    "description": "Disable unexposed GetCreds feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.getCreds.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.getCreds.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.getCreds.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "iam_role_getcreds_disabled",
      "iam_role_unexposed_feature_disabled",
      "iam_role_credential_retrieval_disabled",
      "iam_role_getcreds_feature_disabled",
      "iam_role_secure_credential_access_disabled"
    ]
  },
  {
    "id": "8.4.21",
    "title": "Disable Host Guest File System Server",
    "assessment": "Scored",
    "description": "Disable unexposed Host Guest File System Server feature.",
    "rationale": "Certain automated operations such as automated tools upgrades use a component into the hypervisor called Host Guest File System (HGFS) and an attacker could potentially use this to transfer files inside the guest OS.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.hgfsServerSet.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.hgfsServerSet.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.hgfsServerSet.disable\" -value $true Impact: Setting isolation.tools.hgfsServerSet.disable to true disables registration of the guest's HGFS server with the host. APIs that use HGFS to transfer files to and from the guest operating system, such as some VIX commands or the VMware Tools auto-upgrade utility, will not function. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "profile_applicability": "  Level 2",
    "impact": "Setting isolation.tools.hgfsServerSet.disable to true disables registration of the guest's HGFS server with the host. APIs that use HGFS to transfer files to and from the guest operating system, such as some VIX commands or the VMware Tools auto-upgrade utility, will not function. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_vm_host_guest_file_system_disabled",
      "compute_instance_host_guest_file_system_disabled",
      "compute_virtual_machine_host_guest_file_system_disabled",
      "compute_vm_host_guest_fs_server_disabled",
      "compute_instance_host_guest_fs_server_disabled"
    ]
  },
  {
    "id": "8.4.22",
    "title": "Disable Guest Host Interaction Launch Menu",
    "assessment": "Scored",
    "description": "Disable unexposed Guest Host Interaction Launch Menu feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESXi, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.ghi.launchmenu.change is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.ghi.launchmenu.change\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.launchmenu.change\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_vm_guest_host_interaction_disabled",
      "compute_vm_launch_menu_disabled",
      "compute_vm_unexposed_features_disabled",
      "compute_vm_guest_interaction_restricted",
      "compute_vm_host_interaction_disabled"
    ]
  },
  {
    "id": "8.4.23",
    "title": "Disable memSchedFakeSampleStats",
    "assessment": "Scored",
    "description": "Disable unexposed memSchedFakeSampleStats feature.",
    "rationale": "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere. Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities. Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.memSchedFakeSampleStats.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.memSchedFakeSampleStats.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.memSchedFakeSampleStats.disable\" - value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.   References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "profile_applicability": "  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_vm_memsched_fake_sample_stats_disabled",
      "compute_instance_memsched_fake_sample_stats_disabled",
      "compute_node_memsched_fake_sample_stats_disabled",
      "compute_cluster_memsched_fake_sample_stats_disabled",
      "compute_host_memsched_fake_sample_stats_disabled"
    ]
  },
  {
    "id": "8.4.24",
    "title": "Disable VM Monitor Control",
    "assessment": "Scored",
    "description": "Disable VM Monitor Control.",
    "rationale": "When Virtual Machines are running on a hypervisor they are \"aware\" that they are running in a virtual environment and this and this information is available to tools inside the guest OS. This can give attackers information about the platform that they are running on that they may not get from a normal physical server. This option completely disables all hooks for a virtual machine and the guest OS will not be aware that it is running in a virtual environment at all.",
    "audit": "Check virtual machine configuration file and verify that isolation.monitor.control.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.monitor.control.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.monitor.control.disable\" -value $true Impact:   This configuration option may cause unexpected results, the virtual machine will be completely unaware that it is running in a virtualized setting. VMware tools will not install or function. Default Value: The prescribed state is not the default state. References: 1. http://www.vmware.com/files/xls/hardeningguide-vsphere5-1-ga-release- public.xlsx",
    "profile_applicability": "  Level 2",
    "impact": "This configuration option may cause unexpected results, the virtual machine will be completely unaware that it is running in a virtualized setting. VMware tools will not install or function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://www.vmware.com/files/xls/hardeningguide-vsphere5-1-ga-release- public.xlsx",
    "function_names": [
      "compute_vm_monitor_control_disabled",
      "compute_instance_monitor_control_disabled",
      "compute_vm_monitor_control_disabled_all_regions",
      "compute_instance_monitor_control_disabled_all_regions"
    ]
  },
  {
    "id": "8.4.25",
    "title": "Disable VM Console Copy operations",
    "assessment": "Scored",
    "description": "Disable VM console copy and paste operations.",
    "rationale": "By default, the ability to copy and paste text, graphics, and files is disabled, as is the ability to drag and drop files. When this feature is enabled, you can copy and paste rich text and, depending on the VMware product, graphics and files from your clipboard to the guest operating system in a virtual machine. That is, as soon as the console window of a virtual machine gains focus, nonprivileged users and processes running in the virtual machine can access the clipboard on the computer where the console window is running.",
    "audit": "Check virtual machine configuration and verify that isolation.tools.copy.disable option is missing or set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.copy.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.copy.disable\" -value $true Impact: This is the default setting so functionality remains the same. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 1",
    "impact": "This is the default setting so functionality remains the same. Default Value: The prescribed state is the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_vm_console_copy_disabled",
      "compute_vm_clipboard_disabled",
      "compute_vm_console_operations_restricted",
      "compute_vm_console_copy_paste_disabled",
      "compute_vm_console_clipboard_disabled"
    ]
  },
  {
    "id": "8.4.26",
    "title": "Disable VM Console Drag and Drop operations",
    "assessment": "Scored",
    "description": "Disable VM Console Drag and Drop operations.",
    "rationale": "By default, the ability to copy and paste text, graphics, and files is disabled, as is the ability to drag and drop files. When this feature is enabled, you can copy and paste rich text and, depending on the VMware product, graphics and files from your clipboard to the guest operating system in a virtual machine. That is, as soon as the console window of a virtual machine gains focus, nonprivileged users and processes running in the virtual machine can access the clipboard on the computer where the console window is running.",
    "audit": "Check virtual machine configuration and verify that isolation.tools.dnd.disable is missing or set to TRUE. Additionally, the following PowerCLI command may be used:   # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.dnd.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.dnd.disable\" -value $true Impact: This is the default setting so functionality remains the same. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 50/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 1",
    "impact": "This is the default setting so functionality remains the same. Default Value: The prescribed state is the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 50/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_vm_console_drag_drop_disabled",
      "compute_vm_console_drag_drop_blocked",
      "compute_vm_console_drag_drop_restricted",
      "compute_vm_console_drag_drop_prohibited",
      "compute_vm_console_drag_drop_deactivated"
    ]
  },
  {
    "id": "8.4.27",
    "title": "Disable VM Console and Paste GUI Options",
    "assessment": "Scored",
    "description": "Disable VM Console and Paste GUI Options.",
    "rationale": "By default, the ability to copy and paste text, graphics, and files is disabled, as is the ability to drag and drop files. When this feature is enabled, you can copy and paste rich text and, depending on the VMware product, graphics and files from your clipboard to the guest operating system in a virtual machine. That is, as soon as the console window of a virtual machine gains focus, nonprivileged users and processes running in the virtual machine can access the clipboard on the computer where the console window is running.",
    "audit": "Check virtual machine configuration and verify that isolation.tools.setGUIOptions.enable option is missing or set to FALSE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.setGUIOptions.enable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.setGUIOptions.enable\" -value $false Impact: This is the default setting so functionality remains the same. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 50/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 1",
    "impact": "This is the default setting so functionality remains the same. Default Value: The prescribed state is the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 50/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_instance_console_disabled",
      "compute_instance_paste_gui_disabled",
      "compute_vm_console_access_disabled",
      "compute_vm_paste_gui_disabled",
      "compute_instance_serial_console_disabled",
      "compute_vm_console_and_paste_disabled"
    ]
  },
  {
    "id": "8.4.28",
    "title": "Disable VM Console Paste operations",
    "assessment": "Scored",
    "description": "Disable VM Console Paste operations.",
    "rationale": "By default, the ability to copy and paste text, graphics, and files is disabled, as is the ability to drag and drop files. When this feature is enabled, you can copy and paste rich text and, depending on the VMware product, graphics and files from your clipboard to the guest   operating system in a virtual machine. That is, as soon as the console window of a virtual machine gains focus, nonprivileged users and processes running in the virtual machine can access the clipboard on the computer where the console window is running.",
    "audit": "Check virtual machine configuration and verify that isolation.tools.paste.disable is missing or set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.paste.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.paste.disable\" -value $true Impact: This is the default setting so functionality remains the same. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html    8.5 Resources",
    "profile_applicability": "  Level 1",
    "impact": "This is the default setting so functionality remains the same. Default Value: The prescribed state is the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html    8.5 Resources",
    "function_names": [
      "compute_vm_console_paste_disabled",
      "compute_vm_console_paste_restricted",
      "compute_vm_console_clipboard_disabled",
      "compute_vm_console_input_disabled",
      "compute_vm_console_secure_mode_enabled"
    ]
  },
  {
    "id": "8.5.1",
    "title": "Prevent virtual machines from taking over resources",
    "assessment": "Not Scored",
    "description": "Use limits, shares, and reservations to prevent virtual machines from taking over resources.",
    "rationale": "By default, all virtual machines on an ESXi host share the resources equally. By using the resource management capabilities of ESXi, such as shares and limits, you can control the server resources that a virtual machine consumes. You can use this mechanism to prevent a denial of service that causes one virtual machine to consume so much of the host's resources that other virtual machines on the same host cannot perform their intended functions.",
    "audit": "Use shares or reservations to guarantee resources to critical VMs. Use limits to constrain resource consumption by virtual machines that have a greater risk of being exploited or attacked, or that run applications that are known to have the potential to greatly consume resources. Additionally, the following PowerCLI command may be used: # List all Resource shares on all VMs Get-VM | Get-VMResourceConfiguration",
    "remediation": " Use shares or reservations to guarantee resources to critical VMs.  Use limits to constrain resource consumption by virtual machines that have a greater risk of being exploited or attacked, or that run applications that are known to have the potential to greatly consume resources. References: 1. http://pubs.vmware.com/vsphere-50/topic/com.vmware.ICbase/PDF/vsphere- esxi-vcenter-server-50-resource-management-guide.pdf   8.6 Storage",
    "profile_applicability": "  Level 2",
    "references": "1. http://pubs.vmware.com/vsphere-50/topic/com.vmware.ICbase/PDF/vsphere- esxi-vcenter-server-50-resource-management-guide.pdf   8.6 Storage",
    "function_names": [
      "compute_virtual_machine_cpu_limits_enabled",
      "compute_virtual_machine_memory_limits_enabled",
      "compute_virtual_machine_disk_limits_enabled",
      "compute_virtual_machine_cpu_shares_enabled",
      "compute_virtual_machine_memory_shares_enabled",
      "compute_virtual_machine_disk_shares_enabled",
      "compute_virtual_machine_cpu_reservation_enabled",
      "compute_virtual_machine_memory_reservation_enabled",
      "compute_virtual_machine_disk_reservation_enabled",
      "compute_virtual_machine_resource_limits_configured",
      "compute_virtual_machine_resource_shares_configured",
      "compute_virtual_machine_resource_reservation_configured"
    ]
  },
  {
    "id": "8.6.1",
    "title": "Avoid using nonpersistent disks",
    "assessment": "Scored",
    "description": "Virtual Machine Disks are created as Dependent by default and are affected by snapshots. To ensure a virtual machine disk is not affected by snapshots the disk mode can be set to Independent. Disks set to Independent mode can be Independent Persistent or Independent Nonpersistent. Disks with Independent persistent mode have their data written permanently to the disk. Independent Nonpersistent disks lose any changes made to the disk when the system is rebooted and can mask any trace of an attack on the system.",
    "rationale": "The security issue with nonpersistent disk mode is that successful attackers, with a simple shutdown or reboot, might undo or remove any traces that they were ever on the machine. To safeguard against this risk production virtual machines should be configured as follows: 1. Independent setting not enabled 2. Independent persistent 3. Independent nonpersistent with remote logging Without a persistent record of activity on a VM, administrators might never know whether they have been attacked or hacked.",
    "audit": "If remote logging of events and activity is not configured for the guest, scsiX:Y.mode should be either: 1. Not present. This is the default. 2. Not set to independent nonpersistent   Additionally, the following PowerCLI command may be used: #List the VM's and their disk types Get-VM | Get-HardDisk | Select Parent, Name, Filename, DiskType, Persistence",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: #Alter the parameters for the following cmdlet to set the VM Disk Type: Get-VM | Get-HardDisk | Set-HardDisk Impact: Won't be able to make use of nonpersistent mode, which allows rollback to a known state when rebooting the VM. Default Value: The default mode is the correct mode. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.apiref.doc/vim.vm.device.VirtualDiskOption.DiskMod e.html 2. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.vm_admin.doc/GUID-81629CAB-72FA-42F0-9F86- F8FD0DE39E57.html",
    "profile_applicability": "  Level 1",
    "impact": "Won't be able to make use of nonpersistent mode, which allows rollback to a known state when rebooting the VM. Default Value: The default mode is the correct mode.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.wssdk.apiref.doc/vim.vm.device.VirtualDiskOption.DiskMod e.html 2. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.vm_admin.doc/GUID-81629CAB-72FA-42F0-9F86- F8FD0DE39E57.html",
    "function_names": [
      "compute_virtual_machine_disk_independent_persistent",
      "compute_virtual_machine_disk_nonpersistent_avoided",
      "compute_disk_independent_mode_enabled",
      "compute_disk_persistent_mode_required",
      "compute_vm_disk_nonpersistent_disabled"
    ]
  },
  {
    "id": "8.6.2",
    "title": "Disable virtual disk shrinking",
    "assessment": "Scored",
    "description": "If Virtual disk shrinking is done repeatedly it will cause the virtual disk to become unavailable resulting in a denial of service. You can prevent virtual disk shrinking by disabling it.",
    "rationale": "Shrinking a virtual disk reclaims unused space in it. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. Normal users and processes—that is, users and processes without root or administrator privileges—within virtual machines have the capability to invoke this procedure. However, if this is done repeatedly, the virtual disk can become unavailable while this shrinking is being performed, effectively causing a denial of service. In most datacenter environments, disk shrinking is not done, so you should disable this feature. Repeated disk shrinking can make a virtual disk unavailable. This capability is available to nonadministrative users in the guest.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.diskShrink.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.diskShrink.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.diskShrink.disable\" -value $true Impact: Inability to shrink virtual machine disks in the event that a datastore runs out of space. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-C7D50832-CDBF-4E64-B5C0- 57DF4A94B892.html    8.7 Tools",
    "profile_applicability": "  Level 2",
    "impact": "Inability to shrink virtual machine disks in the event that a datastore runs out of space. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-C7D50832-CDBF-4E64-B5C0- 57DF4A94B892.html    8.7 Tools",
    "function_names": [
      "compute_virtual_disk_shrinking_disabled",
      "compute_disk_shrink_protection_enabled",
      "compute_vm_disk_shrink_disabled",
      "compute_virtual_disk_shrink_prevention_enabled"
    ]
  },
  {
    "id": "8.7.1",
    "title": "Disable VMware Tools auto install",
    "assessment": "Scored",
    "description": "When installing VMware tools, it can sometimes require a reboot to finalize the installation. If you choose the auto install option it will reboot the system without notice if one is required.",
    "rationale": "VMware Tools auto install can initiate an automatic reboot, disabling this option will prevent tools from being installed automatically and prevent automatic machine reboots.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.autoinstall.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.autoInstall.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.autoInstall.disable\" -value $true Impact: This option disables tools auto install via the hypervisor. It is recommended that VMware tools installs and upgrades be handled  through other means (For example: a devops tool such as ansible, chef, puppet, or saltstack). Default Value:   The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-65BCA561-5A03-4D17-A663- 46A0C50CE6A7.html",
    "profile_applicability": "  Level 1",
    "impact": "This option disables tools auto install via the hypervisor. It is recommended that VMware tools installs and upgrades be handled  through other means (For example: a devops tool such as ansible, chef, puppet, or saltstack). Default Value:   The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-65BCA561-5A03-4D17-A663- 46A0C50CE6A7.html",
    "function_names": [
      "compute_vm_vmware_tools_auto_install_disabled",
      "compute_vm_auto_install_disabled",
      "compute_vmware_tools_auto_install_disabled",
      "compute_vm_tools_auto_install_disabled",
      "compute_vm_auto_install_disabled_vmware"
    ]
  },
  {
    "id": "8.7.2",
    "title": "Disable VIX messages from the VM",
    "assessment": "Scored",
    "description": "If you do not make use of custom VIX programming in your environment then you should disable this feature to reduce the potential for vulnerabilities.",
    "rationale": "The VIX API is a library for writing scripts and programs to manipulate virtual machines. If you do not make use of custom VIX programming in your environment, then you should disable certain features to reduce the potential for vulnerabilities. The ability to send messages from the VM to the host is one of these features. Note: Disabling this feature does NOT adversely affect the functioning of VIX operations that originate outside the guest, so certain VMware and 3rd party solutions that rely upon this capability should continue to work. This is a deprecated interface. Ensure that any deprecated interface is turned off for audit purposes.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.vixMessage.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.vixMessage.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command:   # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.vixMessage.disable\" -value $true Impact: Guest will no longer be able to send messages via VIX API. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vddk.pg.doc/vddkTasks.8.7.html",
    "profile_applicability": "  Level 1",
    "impact": "Guest will no longer be able to send messages via VIX API. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vddk.pg.doc/vddkTasks.8.7.html",
    "function_names": [
      "compute_vm_vix_messages_disabled",
      "compute_vm_vix_communication_disabled",
      "compute_vm_vix_feature_disabled",
      "compute_vm_vix_api_disabled",
      "compute_vm_vix_disabled_by_default"
    ]
  },
  {
    "id": "8.7.3",
    "title": "Do not send host information to guests",
    "assessment": "Scored",
    "description": "Configure VMware Tools to disable host info from being sent to guests.",
    "rationale": "If set to TRUE a VM can obtain detailed information about the physical host. The default value for the parameter is FALSE. This setting should not be TRUE unless a particular VM requires this information for performance monitoring. An adversary potentially can use this information to inform further attacks on the host.",
    "audit": "Check virtual machine configuration file and verify that tools.guestlib.enableHostInfo is set to FALSE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"tools.guestlib.enableHostInfo\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"tools.guestlib.enableHostInfo\" -value $false Impact: Unable to retrieve performance information about the host from inside the guest, there are times when this can be useful for troubleshooting. Default Value: The prescribed state is the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-2CF880DA-2435-4201-9AFB- A16A11951A2D.html",
    "profile_applicability": "  Level 1",
    "impact": "Unable to retrieve performance information about the host from inside the guest, there are times when this can be useful for troubleshooting. Default Value: The prescribed state is the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-2CF880DA-2435-4201-9AFB- A16A11951A2D.html",
    "function_names": [
      "compute_vm_host_info_disabled",
      "vmware_tools_host_info_disabled",
      "compute_vm_guest_isolation_enabled",
      "vmware_tools_guest_isolation_enabled",
      "compute_vm_host_telemetry_disabled",
      "vmware_tools_telemetry_disabled",
      "compute_vm_guest_communication_restricted",
      "vmware_tools_guest_communication_restricted"
    ]
  },
  {
    "id": "8.7.4",
    "title": "Limit number of VM log files",
    "assessment": "Scored",
    "description": "Configure VM settings to prevent uncontrolled logging.",
    "rationale": "You can use these settings to limit the total size and number of log files. Normally a new log file is created only when a host is rebooted, so the file can grow to be quite large. You can ensure that new log files are created more frequently by limiting the maximum size of the log files. If you want to restrict the total size of logging data, VMware recommends saving 10 log files, each one limited to 1,000KB. Datastores are likely to be formatted with a block size of 2MB or 4MB, so a size limit too far below this size would result in unnecessary storage utilization. Each time an entry is written to the log, the size of the log is checked; if it is over the limit, the next entry is written to a new log. If the maximum number of log files already exists, when a new one is created, the oldest log file is deleted. A denial-of-service attack that avoids these limits might be attempted by writing an enormous log entry. But each log entry is limited to 4KB, so no log files are ever more than 4KB larger than the   configured limit. A second option is to disable logging for the virtual machine. Disabling logging for a virtual machine makes troubleshooting challenging and support difficult. You should not consider disabling logging unless the log file rotation approach proves insufficient. Uncontrolled logging can lead to denial of service due to the datastore's being filled.",
    "audit": "Check virtual machine configuration file and verify that log.keepOld is set to 10. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"log.keepOld\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"log.keepOld\" -value \"10\" Impact: A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "  Level 1",
    "impact": "A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_vm_log_file_limit",
      "compute_vm_log_retention_configured",
      "compute_vm_log_rotation_enabled",
      "compute_vm_log_size_restricted",
      "compute_vm_log_count_threshold",
      "compute_vm_log_storage_quota",
      "compute_vm_log_disk_space_limited",
      "compute_vm_log_max_files_enforced"
    ]
  },
  {
    "id": "8.7.5",
    "title": "Limit VM log file size",
    "assessment": "Scored",
    "description": "Configure VM settings to prevent uncontrolled logging.",
    "rationale": "You can use these settings to limit the total size and number of log files. Normally a new log file is created only when a host is rebooted, so the file can grow to be quite large. You can ensure that new log files are created more frequently by limiting the maximum size of the log files. If you want to restrict the total size of logging data, VMware recommends saving 10 log files, each one limited to 1,000KB. Datastores are likely to be formatted with a block size of 2MB or 4MB, so a size limit too far below this size would result in unnecessary storage utilization. Each time an entry is written to the log, the size of the log is checked; if it is over the limit, the next entry is written to a new log. If the maximum number of log files already exists, when a new one is created, the oldest log file is deleted. A denial-of-service attack that avoids these limits might be attempted by writing an enormous log entry. But each log entry is limited to 4KB, so no log files are ever more than 4KB larger than the configured limit. A second option is to disable logging for the virtual machine. Disabling logging for a virtual machine makes troubleshooting challenging and support difficult. You should not consider disabling logging unless the log file rotation approach proves insufficient. Uncontrolled logging can lead to denial of service due to the datastore's being filled.",
    "audit": "Check virtual machine configuration file and verify that log.rotateSize is set to 100000. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"log.rotateSize\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"log.rotateSize\" -value \"100000\" Impact: A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient. Default Value:   The prescribed state is not the default state. References: 1. http://kb.vmware.com/kb/8182749      Appendix: Change History Date Version Changes for this version 2014-06-10 1.0.0 Initial Public Release 2014-06-23 1.0.1 Fixed numbering in section 1",
    "profile_applicability": "  Level 1",
    "impact": "A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient. Default Value:   The prescribed state is not the default state.",
    "references": "1. http://kb.vmware.com/kb/8182749      Appendix: Change History Date Version Changes for this version 2014-06-10 1.0.0 Initial Public Release 2014-06-23 1.0.1 Fixed numbering in section 1",
    "function_names": [
      "compute_vm_log_size_limited",
      "compute_vm_log_rotation_enabled",
      "compute_vm_log_retention_configured",
      "compute_vm_log_max_size_set",
      "compute_vm_log_disk_quota_enforced"
    ]
  }
]