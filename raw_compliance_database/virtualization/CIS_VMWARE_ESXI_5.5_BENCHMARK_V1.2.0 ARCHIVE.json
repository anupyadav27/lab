[
  {
    "id": "1.1",
    "title": "Keep ESXi system properly patched",
    "assessment": "Scored",
    "description": "VMware Update Manager is a tool used to automate patch management for vSphere hosts and Virtual machines.  Creating a baseline for patches is a good way to ensure all hosts are at the same patch level.",
    "rationale": "By staying up to date on ESXi patches, vulnerabilities in the hypervisor can be mitigated. An educated attacker can exploit known vulnerabilities when attempting to attain access or elevate privileges on an ESXi host.",
    "audit": "Employ a process to keep ESXi hosts up to date with patches in accordance with industry- standards and internal guidelines. VMware Update Manager is an automated tool that can greatly assist with this. VMware also publishes Advisories on security patches, and offers a way to subscribe to email alerts for them. The following Power Shell snippet will provide a list of all installed patches: Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost; $ESXCli.software.vib.list() | Select-Object @{N=\"VMHost\";E={$VMHost}}, Name, AcceptanceLevel, CreationDate, ID, InstallDate, Status, Vendor, Version; }",
    "remediation": "Leverage the VMware Update Manager to test and apply patches as they become available. Impact: Page | 8 VMs must be powered off in order to update the host ESXi server. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.update_manager.doc/GUID-EF6BEE4C-4583-4A8C- 81B9-5B074CA2E272.html",
    "function_names": [
      "compute_vmware_host_patches_up_to_date",
      "compute_vmware_host_baseline_configured",
      "compute_vmware_host_patch_automation_enabled",
      "compute_vmware_host_patch_level_consistent",
      "compute_vmware_host_patch_manager_configured"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Page | 8 VMs must be powered off in order to update the host ESXi server.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.update_manager.doc/GUID-EF6BEE4C-4583-4A8C- 81B9-5B074CA2E272.html"
  },
  {
    "id": "1.2",
    "title": "Verify Image Profile and VIB Acceptance Levels",
    "assessment": "Scored",
    "description": "The ESXi Image Profiles supports four VIB acceptance levels. A VIB (vSphere Installation Bundle) is a collection of files that are packaged into an archive. The VIB contains a signature file that is used to verify the level of trust.",
    "rationale": "Verify the ESXi Image Profile to only allow signed VIBs. An unsigned VIB represents untested code installed on an ESXi host. The ESXi Image profile supports four acceptance levels: 1. VMwareCertified - VIBs created, tested and signed by VMware 2. VMwareAccepted - VIBs created by a VMware partner but tested and signed by VMware 3. PartnerSupported - VIBs created, tested and signed by a certified VMware partner 4. CommunitySupported - VIBs that have not been tested by VMware or a VMware partner. Community Supported VIBs are not supported and do not have a digital signature. To protect the security and integrity of your ESXi hosts do not allow unsigned (CommunitySupported) VIBs to be installed on your hosts.",
    "audit": "Perform the following to procedure: 1. Connect to each ESX/ESXi host using the ESXi Shell or vCLI and execute the command \"esxcli software acceptance get\" to verify the acceptance level is at either \"VMware Certified\", \"VMware Supported\", or \"PartnerSupported\". Page | 9 2. Connect to each ESX/ESXi host using the vCLI and execute the command \"esxcli software vib list\" and verify the acceptance level for each VIB is either \"VMware Certified\", \"VMware Supported\", or \"Partner Supported\" Additionally, the following PowerCLI command may be used: # List the Software AcceptanceLevel for each host Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $VMHost | Select Name, @{N=\"AcceptanceLevel\";E={$ESXCli.software.acceptance.get()}} } # List only the vibs which are not at \"VMwareCertified\" or \"VMwareAccepted\" or \"PartnerSupported\" acceptance level Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $ESXCli.software.vib.list() | Where { ($_.AcceptanceLevel -ne \"VMwareCertified\") -and ($_.AcceptanceLevel -ne \"VMwareAccepted\") -and ($_.AcceptanceLevel -ne \"PartnerSupported\") } }",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Set the Software AcceptanceLevel for each host Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $ESXCli.software.acceptance.Set(\"PartnerSupported\") } Impact: 1. Third party VIBs tested by VMware partners are not allowed on the host. This could include some device drivers, CIM modules, and other add-on software. Host customization using custom VIBs is not allowed. 2. No VMware partner VIBs are allowed on the host, to include non-VMware written device drivers, CIM modules, and other third party software. Host customization using custom VIBs is not allowed. 3. Host customization using custom VIBs is not allowed. Default Value: The default level is PartnerSupported References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.install.doc/GUID-56600593-EC2E-4125-B1A0- 065BDD16CF2D.html Page | 10 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-751034F3-5337-4DB2-8272- 8DAC0980EACA.html",
    "function_names": [
      "compute_image_profile_vib_acceptance_levels_secure",
      "compute_image_profile_vib_acceptance_levels_compliant",
      "compute_image_profile_vib_acceptance_levels_approved",
      "compute_image_profile_vib_acceptance_levels_restricted",
      "compute_image_profile_vib_acceptance_levels_verified",
      "compute_image_profile_vib_acceptance_levels_trusted",
      "compute_image_profile_vib_acceptance_levels_minimum",
      "compute_image_profile_vib_acceptance_levels_enforced"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "1. Third party VIBs tested by VMware partners are not allowed on the host. This could include some device drivers, CIM modules, and other add-on software. Host customization using custom VIBs is not allowed. 2. No VMware partner VIBs are allowed on the host, to include non-VMware written device drivers, CIM modules, and other third party software. Host customization using custom VIBs is not allowed. 3. Host customization using custom VIBs is not allowed. Default Value: The default level is PartnerSupported",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.install.doc/GUID-56600593-EC2E-4125-B1A0- 065BDD16CF2D.html Page | 10 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-751034F3-5337-4DB2-8272- 8DAC0980EACA.html"
  },
  {
    "id": "1.3",
    "title": "Verify no unauthorized kernel modules are loaded on the host",
    "assessment": "Scored",
    "description": "ESXi hosts by default do not permit the loading of kernel modules that lack valid digital signatures.  This feature can be overridden which would result in unauthorized kernel modules to be loaded.",
    "rationale": "VMware provides digital signatures for kernel modules. By default the ESXi host does not permit loading of kernel modules that lack a valid digital signature. However, this behavior can be overridden allowing unauthorized kernel modules to be loaded. Untested or malicious kernel modules loaded on the ESXi host can put the host at risk for instability and/or exploitation.",
    "audit": "Each ESXi host should be monitored for unsigned kernel modules. To list all the loaded kernel modules from the ESXi Shell or vCLI run: \"esxcli system module list\". For each module, verify the signature by running: esxcli system module get -m <module>. Secure the host by disabling unsigned modules and removing the offending VIBs from the host. Additionally, the following PowerCLI command may be used: # List the system modules and Signature Info for each host Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $ESXCli.system.module.list() | Foreach { $ESXCli.system.module.get($_.Name) | Select @{N=\"VMHost\";E={$VMHost}}, Module, License, Modulefile, Version, SignedStatus, SignatureDigest, SignatureFingerPrint } }",
    "remediation": "Page | 11 To implement the recommended configuration state, run the following PowerCLI command: # To disable a module: $ESXCli = Get-EsxCli -VMHost MyHost $ESXCli.system.module.set($false, $false, \"MyModuleName\") Note: evacuate VMs and place the host into maintenance mode before disabling kernel modules. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-E9B71B85-FBA3-447C-8A60- DEE2AE1A405A.html 2. http://kb.vmware.com/kb/2042473  Page | 12 2 Communication This section contains recommendations related to ESXi communication.",
    "function_names": [
      "esxi_host_kernel_module_signature_enforced",
      "esxi_host_unauthorized_kernel_module_blocked",
      "esxi_host_kernel_module_integrity_verified",
      "esxi_host_kernel_module_loading_restricted",
      "esxi_host_kernel_module_signature_required"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-E9B71B85-FBA3-447C-8A60- DEE2AE1A405A.html 2. http://kb.vmware.com/kb/2042473  Page | 12 2 Communication This section contains recommendations related to ESXi communication."
  },
  {
    "id": "2.1",
    "title": "Configure NTP time synchronization",
    "assessment": "Scored",
    "description": "NTP (Network Time Protocol) synchronization should be configured and enabled on each VMware ESXi host. Verify that the NTP time server is correct for each host to ensure accurate time for system event logs.",
    "rationale": "By ensuring that all systems use the same relative time source (including the relevant localization offset), and that the relative time source can be correlated to an agreed-upon time standard, you can make it simpler to track and correlate an intruder's actions when reviewing the relevant log files. Incorrect time settings can make it difficult to inspect and correlate log files to detect attacks, and can make auditing inaccurate.",
    "audit": "Perform the following from the vSphere web client: 1. Select the host. 2. Click \"Manage\" -> \"Settings\" -> \"System\" -> \"Time Configuration\". 3. Click the \"Edit...\" button. 4. Verify that the name/IP of your NTP servers is correct. 5. Verify that the NTP service startup policy to \"Start and stop with host\". Additionally, the following PowerCLI command may be used: # List the NTP Settings for all hosts Get-VMHost | Select Name, @{N=\"NTPSetting\";E={$_ | Get-VMHostNtpServer}}",
    "remediation": "Perform the following From the vSphere web client: 1. Select the host. 2. Click \"Manage\" -> \"Settings\" -> \"System\" -> \"Time Configuration\". Page | 13 3. Click the \"Edit...\" button. 4. Click on \"Use Network Time Protocol\". 5. Provide the name and / or IP of your NTP servers. Separate servers with commas. 6. If the NTP Service Status is \"Stopped\", click on \"Start\". 7. Change the startup policy to \"Start and stop with host\". 8. Click \"OK\". To implement the recommended configuration state, run the following PowerCLI command: # Set the NTP Settings for all hosts # If an internal NTP server is used replace pool.ntp.org with # the IP address of the internal NTP server $NTPServers = \"pool.ntp.org\", \"pool2.ntp.org\" Get-VMHost | Add-VmHostNtpServer $NTPServers Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vcli.examples.doc/cli_manage_networks.11.9.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-2553C86E-7981-4F79-B9FC- A6CECA52F6CC.html",
    "function_names": [
      "compute_esxi_host_ntp_enabled",
      "compute_esxi_host_ntp_server_configured",
      "compute_esxi_host_ntp_sync_accurate",
      "compute_esxi_host_ntp_time_server_correct"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vcli.examples.doc/cli_manage_networks.11.9.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-2553C86E-7981-4F79-B9FC- A6CECA52F6CC.html"
  },
  {
    "id": "2.2",
    "title": "Configure the ESXi host firewall to restrict access to services running on the host",
    "assessment": "Scored",
    "description": "The ESXi Firewall is enabled by default and allows ping (ICMP) and communication with DHCP/DNS clients. Confirm that access to services are only allowed by authorized IP\u2019s/networks to protect from outside attacks.",
    "rationale": "Page | 14 Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access. Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks.",
    "audit": "Perform the following from From the vSphere web client: 1. Select the host 2. Go to \"Manage\" -> \"Settings\" -> \"System\" -> \"Security Profile\" 3. In the \"Firewall\" section select \"Edit...\". 4. For each enabled service, (e.g. ssh, vSphere Web Access, http client) check to see if there is a range of allowed IP addresses provided. Additionally, the following PowerCLI command may be used: # List all services for a host Get-VMHost HOST1 | Get-VMHostService # List the services which are enabled and have rules defined for specific IP ranges to access the service Get-VMHost HOST1 | Get-VMHostFirewallException | Where {$_.Enabled -and (-not $_.ExtensionData.AllowedHosts.AllIP)} # List the services which are enabled and do not have rules defined for specific IP ranges to access the service Get-VMHost HOST1 | Get-VMHostFirewallException | Where {$_.Enabled -and ($_.ExtensionData.AllowedHosts.AllIP)}",
    "remediation": "Perform the following from the vSphere web client: 1. Select the host 2. Go to \"Manage\" -> \"Settings\" -> \"System\" -> \"Security Profile\" 3. In the \"Firewall\" section select \"Edit...\". 4. For each enabled service, (e.g. ssh, vSphere Web Access, http client) provide a range of allowed IP addresses. 5. Click \"Ok\". Impact: Only systems in the IP whitelist/ACL will be able to connect to services on the ESXi server. Default Value: The prescribed state is not the default state. References: Page | 15 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-DD4322FF-3DC4-4716-8819- 6688938F99D7.html",
    "function_names": [
      "esxi_host_firewall_restricted_access",
      "esxi_host_firewall_authorized_ips_only",
      "esxi_host_firewall_unauthorized_services_blocked",
      "esxi_host_firewall_default_rules_disabled",
      "esxi_host_firewall_icmp_restricted",
      "esxi_host_firewall_dhcp_dns_restricted",
      "esxi_host_firewall_inbound_traffic_limited",
      "esxi_host_firewall_outbound_traffic_limited",
      "esxi_host_firewall_service_access_controlled",
      "esxi_host_firewall_network_whitelisted"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Only systems in the IP whitelist/ACL will be able to connect to services on the ESXi server. Default Value: The prescribed state is not the default state.",
    "references": "Page | 15 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-DD4322FF-3DC4-4716-8819- 6688938F99D7.html"
  },
  {
    "id": "2.3",
    "title": "Disable Managed Object Browser (MOB)",
    "assessment": "Scored",
    "description": "The Managed Object Browser (MOB) is a web-based server application that lets you examine objects that exist on the server side.  This is installed and started automatically when vCenter is installed.",
    "rationale": "The managed object browser (MOB) provides a way to explore the object model used by the VMkernel to manage the host; it enables configurations to be changed as well. This interface is meant to be used primarily for debugging the vSphere SDK. Because there are no access controls the MOB could also be used as a method to obtain information about a host being targeted for unauthorized access.",
    "audit": "To determine if the MOB is enabled run the following command from the ESXi shell: vim-cmd proxysvc/service_list",
    "remediation": "To implement the recommended configuration state, run the following ESXi shell command: vim-cmd proxysvc/remove_service \"/mob\" \"httpsWithRedirect\" Note: You cannot disable the MOB while a host is in lockdown mode. Impact: The MOB will no longer be available for diagnostics. Some 3rd party tools use this interface to gather information. Testing should be done after disabling the MOB to verify 3rd party applications are still functioning as expected. Page | 16 To re-enable the MOB temporarily: vim-cmd proxysvc/add_np_service \"/mob\" httpsWithRedirect /var/run/vmware/proxy-mob Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-0EF83EA7-277C-400B-B697- 04BDC9173EA3.html",
    "function_names": [
      "vcenter_mob_disabled",
      "vcenter_server_mob_deactivated",
      "vcenter_managed_object_browser_disabled",
      "vcenter_mob_service_stopped",
      "vcenter_mob_access_restricted"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "The MOB will no longer be available for diagnostics. Some 3rd party tools use this interface to gather information. Testing should be done after disabling the MOB to verify 3rd party applications are still functioning as expected. Page | 16 To re-enable the MOB temporarily: vim-cmd proxysvc/add_np_service \"/mob\" httpsWithRedirect /var/run/vmware/proxy-mob Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-0EF83EA7-277C-400B-B697- 04BDC9173EA3.html"
  },
  {
    "id": "2.4",
    "title": "Do not use default self-signed certificates for ESXi communication",
    "assessment": "Scored",
    "description": "The default certificates are not signed by a trusted certificate authority (CA) and should be replaced with valid certificates that have been issued by a trusted CA.",
    "rationale": "Using the default self-signed certificates may increase risk related to Man-in-The-Middle (MiTM) attacks. Replace default self-signed certificates with those from a trusted CA, either commercial or organizational.",
    "audit": "View the details of the SSL certificate presented by the ESXi host and determine if it is issued by a trusted CA, either commercial or organizational. 1. Log in to the ESXi Shell, either directly from the DCUI or from an SSH client, as a user with administrator privileges. 2. In the directory /etc/vmware/ssl, rename the existing certificates using the following commands: 1. mv rui.crt orig.rui.crt 2. mv rui.key orig.rui.key 3. Copy the certificates you want to use to /etc/vmware/ssl. 4. Rename the new certificate and key to rui.crt and rui.key. Page | 17 5. Restart the host after you install the new certificate. Alternatively, you can put the host into maintenance mode, install the new certificate, use the Direct Console User Interface (DCUI) to restart the management agents, and set the host to exit maintenance mode.",
    "remediation": "Leverage VMware's SSL Certificate Automation Tool to install CA-signed SSL certificates.  For more information on this tool, please see http://kb.vmware.com/kb/2057340. Impact: If the host has Verify Certificates enabled, replacing the default certificate might cause vCenter Server to stop managing the host. Disconnect and reconnect the host if vCenter Server cannot verify the new certificate. Default Value: The prescribed state is not the default state. References: 1. http://kb.vmware.com/kb/2034833 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-AC7E6DD7-F984-4E0F-983A- 463031BA5FE7.html",
    "function_names": [
      "compute_esxi_certificate_trusted_ca",
      "compute_esxi_certificate_no_self_signed",
      "compute_esxi_certificate_valid_ca_signed",
      "compute_esxi_communication_trusted_certificate",
      "compute_esxi_communication_no_default_certificate"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "If the host has Verify Certificates enabled, replacing the default certificate might cause vCenter Server to stop managing the host. Disconnect and reconnect the host if vCenter Server cannot verify the new certificate. Default Value: The prescribed state is not the default state.",
    "references": "1. http://kb.vmware.com/kb/2034833 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-AC7E6DD7-F984-4E0F-983A- 463031BA5FE7.html"
  },
  {
    "id": "2.5",
    "title": "Ensure proper SNMP configuration",
    "assessment": "Not Scored",
    "description": "Verify that SNMP (Simple Network Management Protocol) is configured and that all the settings are correct.  If SNMP is not being used, it should be disabled. Note : ESXi supports SNMPv3 which provides stronger security than SNMPv1 or SNMPv2, including key authentication and encryption.",
    "rationale": "Page | 18 If SNMP is not being used, it should remain disabled. If it is being used, the proper trap destination should be configured. If SNMP is not properly configured, monitoring information can be sent to a malicious host.",
    "audit": "Perform the following from the ESXi Shell or vCLI: 1. Run the following to determine if SNMP is being used: esxcli system snmp get 2. If SNMP is not being used, make sure that it is disabled by running: esxcli system snmp set --enable false 3. If SNMP is being used, refer to the vSphere Monitoring and Performance guide, chapter 8 for steps to configure the required parameters. Additionally, the following PowerCLI command may be used: # List the SNMP Configuration of a host (single host connection required) Get-VMHost | Get-VMHostSnmp",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Update the host SNMP Configuration (single host connection required) Get-VmHostSNMP | Set-VMHostSNMP -Enabled:$true -ReadOnlyCommunity '<secret>' Notes: \uf0b7 SNMP must be configured on each ESXi host \uf0b7 SNMP settings can be configured using Host Profiles  References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.monitoring.doc/GUID-8EF36D7D-59B6-4C74- B1AA-4A9D18AB6250.html",
    "function_names": [
      "snmp_service_disabled_if_unused",
      "snmp_protocol_version_v3_enabled",
      "snmp_authentication_enabled",
      "snmp_encryption_enabled",
      "snmp_community_strings_secure",
      "snmp_access_control_restricted",
      "snmp_trap_destinations_configured",
      "snmp_logging_enabled",
      "snmp_default_community_strings_removed",
      "snmp_weak_credentials_absent"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.monitoring.doc/GUID-8EF36D7D-59B6-4C74- B1AA-4A9D18AB6250.html"
  },
  {
    "id": "2.6",
    "title": "Prevent unintended use of dvfilter network APIs",
    "assessment": "Scored",
    "description": "Confirm that dvfilter API is not configured if not is use. If you are using virtual security appliances that leverage this API then configuration may be necessary.",
    "rationale": "If you are not using products that make use of the dvfilter network API (e.g. VMSafe), the host should not be configured to send network information to a VM. If the API is enabled, an attacker might attempt to connect a VM to it, thereby potentially providing access to the network of other VMs on the host. If you are using a product that makes use of this API then verify that the host has been configured correctly.",
    "audit": "If a dvfilter-based network security appliance is not being used on the host, ensure that the following kernel parameter has a blank value: /Net/DVFilterBindIpAddress. 1. From the vSphere web client, select the host and click \"Manage\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 2. Enter Net.DVFilterBindIpAddress in the filter. 3. Verify Net.DVFilterBindIpAddress has an empty value. 4. If an appliance is being used, then make sure the value of this parameter is set to the proper IP address. Additionally, the following PowerCLI command may be used: # List Net.DVFilterBindIpAddress for each host Get-VMHost | Select Name, @{N=\"Net.DVFilterBindIpAddress\";E={$_ | Get- VMHostAdvancedConfiguration Net.DVFilterBindIpAddress | Select -ExpandProperty Values}}",
    "remediation": "Perform the following from the vSphere web client: 1. Select the host and click \"Manage\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 2. Enter Net.DVFilterBindIpAddress in the filter. 3. Verify Net.DVFilterBindIpAddress has an empty value. 4. If an appliance is being used, then make sure the value of this parameter is set to the proper IP address. Page | 20 5. Make sure the attribute is highlighted, then click the pencil icon. 6. Enter the proper IP address. 7. Click \"OK\". To implement the recommended configuration state, run the following PowerCLI command: # Set Net.DVFilterBindIpAddress to null on all hosts Get-VMHost HOST1 | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name Net.DVFilterBindIpAddress -Value \"\" } Impact: This will prevent a dvfilter-based network security appliance such as a firewall from functioning if not configured correctly. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A-B821- ED17A77B0206.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.ext_solutions.doc/GUID-6013E15D-92CE-4970- 953C-ACCB36ADA8AD.html",
    "function_names": [
      "compute_vm_dvfilter_disabled",
      "compute_network_dvfilter_unused",
      "compute_vm_dvfilter_unconfigured",
      "compute_network_dvfilter_api_restricted",
      "compute_vm_dvfilter_secure_config"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "This will prevent a dvfilter-based network security appliance such as a firewall from functioning if not configured correctly. Default Value: The prescribed state is the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A-B821- ED17A77B0206.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.ext_solutions.doc/GUID-6013E15D-92CE-4970- 953C-ACCB36ADA8AD.html"
  },
  {
    "id": "2.7",
    "title": "Remove expired or revoked SSL certificates from the ESXi server",
    "assessment": "Not Scored",
    "description": "Remove expired or revoked SSL Certificates from the ESXi server.",
    "rationale": "Leaving expired or revoked certificates on your vCenter Server system can compromise your environment. By default, each ESXi host does not have Certificate Revocation Lists (CRL) checking available. Revoked certificates must be checked and removed Page | 21 manually. Replacing certificates will avoid having users get used to clicking through browser warnings. The warning might be an indication of a man-in-the-middle attack, and only inspection of the certificate and thumbprint can guard against such attacks.",
    "audit": "Using the script called out in \"verify-ssl-certificates\" PowerCLI script to assess if there are revoked SSL certificates on your ESXi server. If a revoked certificate is found, replace the SSL certificate with a valid one.",
    "remediation": "Replace self-signed certificates with certificates from a trusted CA, either a commercial CA or an organizational CA. Certificates can be replaced in a number of ways: 1. Replace a Default ESXi Certificate and Key from the ESXi Shell 2. Replace a Default ESXi Certificate and Key by Using the vifs Command 3. Replace a Default ESXi Certificate and Key Using HTTPS PUT If you accidentally deleted the default self-signed certificate and key or you changed the host name, you can generate a new self-signed certificate and key from the ESXi Shell. See Generate New Self-Signed Certificates for ESXi. Impact: If expired or revoked certificates are not removed from the ESXi system, the environment can be subject to a MiTM attack. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-AC7E6DD7-F984-4E0F-983A- 463031BA5FE7.html 2. http://en-us.sysadmins.lv/Lists/Posts/Post.aspx?List=332991f0-bfed-4143-9eea- f521167d287c&ID=60  Page | 22 3 Logging This section contains recommendations related to ESXi's logging capabilities.",
    "function_names": [
      "compute_ssl_certificate_expired_removed",
      "compute_ssl_certificate_revoked_removed",
      "compute_ssl_certificate_validity_verified",
      "compute_ssl_certificate_expiry_monitored",
      "compute_ssl_certificate_revocation_checked"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "If expired or revoked certificates are not removed from the ESXi system, the environment can be subject to a MiTM attack.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-AC7E6DD7-F984-4E0F-983A- 463031BA5FE7.html 2. http://en-us.sysadmins.lv/Lists/Posts/Post.aspx?List=332991f0-bfed-4143-9eea- f521167d287c&ID=60  Page | 22 3 Logging This section contains recommendations related to ESXi's logging capabilities."
  },
  {
    "id": "3.1",
    "title": "Configure a centralized location to collect ESXi host core dumps",
    "assessment": "Scored",
    "description": "In order to configure a centralized location to collect ESXi host core dumps, use the \"ESXi Dump Collector\". The VMware vSphere Network Dump Collector service allows for collecting diagnostic information from a host that experiences a critical fault.",
    "rationale": "When a host crashes, an analysis of the resultant core dump is essential to being able to identify the cause of the crash to identify a resolution. Installing a centralized dump collector helps ensure that core files are successfully saved and made available in the event an ESXi host should ever panic.",
    "audit": "Run the following ESXi shell command to determine if the host is configured as prescribed: esxcli system coredump network get",
    "remediation": "To implement the recommended configuration state, run the following ESXi shell command: # Configure remote Dump Collector Server esxcli system coredump network set -v [VMK#] -i [DUMP_SERVER] -o [PORT] # Enable remote Dump Collector esxcli system coredump network set -e true Impact: No impact on functionality. Default Value: Page | 23 The prescribed state is not the default state. References: 1. http://kb.vmware.com/kb/1032051 2. http://kb.vmware.com/kb/2003042 3. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vcli.examples.doc/cli_performance.12.4.html 4. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.install.doc/GUID-64213886-7181-4767-9ED5- D8C989B9ECAE.html 5. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.install.doc/GUID-775F602C-7432-4259-B132- 4EC1F38A7EE7.html 6. http://www.youtube.com/watch?v=veE6M7Na8-A",
    "function_names": [
      "esxi_host_core_dump_collector_configured",
      "esxi_host_dump_collector_centralized",
      "esxi_host_core_dump_collector_enabled",
      "esxi_host_dump_collector_network_configured",
      "esxi_host_core_dump_collector_service_active"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "No impact on functionality. Default Value: Page | 23 The prescribed state is not the default state.",
    "references": "1. http://kb.vmware.com/kb/1032051 2. http://kb.vmware.com/kb/2003042 3. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vcli.examples.doc/cli_performance.12.4.html 4. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.install.doc/GUID-64213886-7181-4767-9ED5- D8C989B9ECAE.html 5. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.install.doc/GUID-775F602C-7432-4259-B132- 4EC1F38A7EE7.html 6. http://www.youtube.com/watch?v=veE6M7Na8-A"
  },
  {
    "id": "3.2",
    "title": "Configure persistent logging for all ESXi host",
    "assessment": "Scored",
    "description": "System logs are required for auditing and diagnostic purposes. If you do not store system logs permanently, for example on a datastore, they disappear after a reboot. Ensuring persistent logging is set can prevent the loss of logs on reboot.",
    "rationale": "ESXi can be configured to store log files on an in-memory file system. This occurs when the host's Syslog.global.LogDir property is set to a non-persistent location, such as  /scratch. When this is done only a single day's worth of logs are stored at any time. Additionally, log files will be reinitialized upon each reboot. This presents a security risk as user activity logged on the host is only stored temporarily and will not be preserved across reboots. This can also complicate auditing and make it harder to monitor events and diagnose issues. ESXi host logging should always be configured to a persistent datastore.",
    "audit": "Perform the following from the vSphere web client 1. Select the host and go to \"Manage\" -> \"Settings\" -> \"Advanced System Settings\". 2. Enter Syslog.global.LogDir in the filter. Page | 24 3. Ensure the Syslog.global.LogDir is not set to /scratch or any other non-persistent datastore. Additionally, the following PowerCLI command may be used: # List Syslog.global.logDir for each host Get-VMHost | Select Name, @{N=\"Syslog.global.logDir\";E={$_ | Get- VMHostAdvancedConfiguration Syslog.global.logDir | Select -ExpandProperty Values}}",
    "remediation": "Perform the following from the vSphere web client: 1. Select the host and go to \"Manage\" -> \"Settings\" -> \"Advanced System Settings\". 2. Enter Syslog.global.LogDir in the filter. 3. Set the Syslog.global.LogDir to the desired datastore path. 4. Make sure the attribute is highlighted, then click the pencil icon. Alternatively, run the following PowerCLI command: # Set Syslog.global.logDir for each host Get-VMHost | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name Syslog.global.logDir -Value \"<NewLocation>\" }   Impact: Additional disk space will be required to store log files. Default Value: When booting from a local disk: YES When booting from USB/SD: NO When using Auto Deploy Stateless Installs: NO References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F-B6C8- DAE8D95976E7.html 2. http://kb.vmware.com/kb/1033696",
    "function_names": [
      "esxi_host_logging_persistent_enabled",
      "esxi_host_logging_datastore_configured",
      "esxi_host_logging_reboot_persistent",
      "esxi_host_logging_audit_retention_enabled",
      "esxi_host_logging_diagnostic_storage_configured"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Additional disk space will be required to store log files. Default Value: When booting from a local disk: YES When booting from USB/SD: NO When using Auto Deploy Stateless Installs: NO",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F-B6C8- DAE8D95976E7.html 2. http://kb.vmware.com/kb/1033696"
  },
  {
    "id": "3.3",
    "title": "Configure remote logging for ESXi hosts",
    "assessment": "Scored",
    "description": "By default ESXI logs are stored on a local scratch volume or ramdisk. To preserve logs further configure centralized logging for the ESXI hosts.",
    "rationale": "Remote logging to a central log host provides a secure, centralized store for ESXi logs. By gathering host log files onto a central host, you can more easily monitor all hosts with a single tool. You can also do aggregate analysis and searching to look for such things as coordinated attacks on multiple hosts. Logging to a secure, centralized log server also helps prevent log tampering and also provides a long-term audit record. To facilitate remote logging provides the vSphere Syslog Collector.",
    "audit": "Perform the following: 1. Install/Enable a syslog host (i.e vSphere Syslog Collector). 2. From the vSphere web client select the host and click \"Manage\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 3. Enter Syslog.global.logHost in the filter. 4. Verify the Syslog.global.logHost is set to the hostname of your syslog server. Additionally, the following PowerCLI command may be used: # List Syslog.global.logHost for each host Get-VMHost | Select Name, @{N=\"Syslog.global.logHost\";E={$_ | Get- VMHostAdvancedConfiguration Syslog.global.logHost | Select -ExpandProperty Values}}",
    "remediation": "Perform the following: 1. Install/Enable a syslog host (i.e vSphere Syslog Collector). 2. From the vSphere web client select the host. 3. Click \"Manage\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 4. Enter Syslog.global.logHost in the filter. 5. Make sure Syslog.global.logHost is highlighted, then click the pencil icon. 6. Set the Syslog.global.logHost to the hostname or IP address of your syslog server. 7. Click \"OK\". Page | 26 To implement the recommended configuration state, run the following PowerCLI command: # Set Syslog.global.logHost for each host Get-VMHost | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name Syslog.global.logHost -Value \"<NewLocation>\" } Note: When setting a remote log host it is also recommended to set the \"Syslog.global.logDirUnique\" to true. You must configure the syslog settings for each host. The host syslog parameters can also be configured using the vCLI or PowerCLI, or using an API client. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F-B6C8- DAE8D95976E7.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.install.doc/GUID-775F602C-7432-4259-B132- 4EC1F38A7EE7.html  Page | 27 4 Access This section contains recommendations related to ESXi access management.",
    "function_names": [
      "esxi_host_remote_logging_enabled",
      "esxi_host_logs_centralized",
      "esxi_host_logs_remote_storage_enabled",
      "esxi_host_logs_persistent_storage_enabled",
      "esxi_host_logs_external_destination_configured"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F-B6C8- DAE8D95976E7.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.install.doc/GUID-775F602C-7432-4259-B132- 4EC1F38A7EE7.html  Page | 27 4 Access This section contains recommendations related to ESXi access management."
  },
  {
    "id": "4.1",
    "title": "Create a non-root user account for local admin access",
    "assessment": "Scored",
    "description": "Create at least one named user account and use this account in lieu of a shared \"root\" account.",
    "rationale": "By default each ESXi host has a single \"root\" admin account that is used for local administration and to connect the host to vCenter Server. To avoid sharing a common root account it is recommended on each host to create at least one named user account and assign it full admin privileges and to use this account in lieu of a shared \"root\" account. Set a highly complex password for the \"root\" account and secure it in a safe location. Limit the use of \"root\" but do not remove the \"root\" account.",
    "audit": "Perform the following: 1. Connect directly to the ESXi host using the vSphere Client. 2. Login as root or another authorized user. 3. Select the \"Local Users & Groups\" tab and view the local users. 4. Ensure at least one user exists that posses the following: 1. Shell access has been granted to this user. 2. Select the \"Permissions\" tab and verify the \"Administrator\" role has been granted to the user. 5. Repeat this for each ESXi hosts.",
    "remediation": "Local ESXi user accounts cannot be created using the vSphere web client, you must use the vSphere client. 1. Connect directly to the ESXi host using the vSphere Client. 2. Login as root. Page | 28 3. Select the \"Local Users & Groups\" tab 4. Add a local user, be sure to grant shell access to this user. 5. Select the \"Permissions\" tab. 6. Assign the \"Administrator\" role to the user. 7. Repeat this for each ESXi hosts. Notes: 1. Even if you add your ESXi host to an Active Directory domain it is still recommended to add at least one local user account to ensure admins can still login in the event the host ever becomes isolated and unable to access Active Directory. 2. Adding local user accounts can be automated using Host Profiles. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.hostclient.doc/GUID-670B9B8C-3810-4790-AC83- 57142A9FE16F.html",
    "function_names": [
      "iam_user_non_root_exists",
      "iam_user_local_admin_configured",
      "iam_root_usage_restricted",
      "iam_user_admin_privileges_assigned",
      "iam_root_access_avoided"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.hostclient.doc/GUID-670B9B8C-3810-4790-AC83- 57142A9FE16F.html"
  },
  {
    "id": "4.2",
    "title": "Establish a password policy for password complexity",
    "assessment": "Scored",
    "description": "Require the use of passwords that are not easily guessed and that are difficult for password generators to determine.",
    "rationale": "ESXi uses the pam_passwdqc.so plug-in to set password strength and complexity. It is important to use passwords that are not easily guessed and that are difficult for password generators to determine. Note: ESXi imposes no restrictions on the root password. Password strength and complexity rules only apply to non-root users.",
    "audit": "Page | 29 Perform the following: 1. Login to the ESXi shell as a user with administrator privileges. 2. Open /etc/pam.d/passwd 3. Locate the following line: password requisite /lib/security/$ISA/pam_passwdqc.so retry=N min=N0,N1,N2,N3,N4 4. Confirm N is less than or equal to 5 5. Confirm N0 is set to disabled 6. Confirm N1 is set to disabled 7. Confirm N2 is set to disabled 8. Confirm N3 is set to disabled 9. Confirm N4 is set to 14 or greater This above requires all passwords to be 14 or more characters long and comprised of at least one character from four distinct character sets. Additionally, a maximum of 5 login attempts are permitted.",
    "remediation": "Perform the following: 1. Login to the ESXi shell as a user with administrator privileges. 2. Open /etc./pam.d/passwd 3. Locate the following line: password requisite /lib/security/$ISA/pam_passwdqc.so retry=N min=N0,N1,N2,N3,N4 4. Set N is less than or equal to 5 5. Set N0 to disabled 6. Set N1 to disabled 7. Set N2 to disabled 8. Set N3 to disabled 9. Set N4 to 14 or greater This above requires all passwords to be 14 or more characters long and comprised of at least one character from four distinct character sets. Additionally, a maximum of 5 login attempts are permitted. Impact: Page | 30 Do not create a user named ALL . Privileges associated with the name ALL might not be available to all users in some situations. For example, if a user named ALL has Administrator privileges, a user with ReadOnly privileges might be able to log in to the host remotely. This is not the intended behavior. An uppercase character that begins a password does not count toward the number of character classes used. A number that ends a password does not count toward the number of character classes used. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.hostclient.doc/GUID-2DA83B47-86E5-4BE3-920E- C2504400102E.html 2. http://www.openwall.com/passwdqc/README.shtml 3. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-DC96FFDB-F5F2-43EC-8C73- 05ACDAE6BE43.html 4. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.hostclient.doc/GUID-DC96FFDB-F5F2-43EC-8C73- 05ACDAE6BE43.html",
    "function_names": [
      "iam_password_policy_complexity_enabled",
      "iam_password_policy_min_length_14",
      "iam_password_policy_require_uppercase",
      "iam_password_policy_require_lowercase",
      "iam_password_policy_require_numbers",
      "iam_password_policy_require_symbols",
      "iam_password_policy_no_reuse_over_24",
      "iam_password_policy_max_age_90d",
      "iam_password_policy_expire_passwords_enabled",
      "iam_password_policy_prevent_common_passwords"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Page | 30 Do not create a user named ALL . Privileges associated with the name ALL might not be available to all users in some situations. For example, if a user named ALL has Administrator privileges, a user with ReadOnly privileges might be able to log in to the host remotely. This is not the intended behavior. An uppercase character that begins a password does not count toward the number of character classes used. A number that ends a password does not count toward the number of character classes used. Default Value: The prescribed state is the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.hostclient.doc/GUID-2DA83B47-86E5-4BE3-920E- C2504400102E.html 2. http://www.openwall.com/passwdqc/README.shtml 3. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-DC96FFDB-F5F2-43EC-8C73- 05ACDAE6BE43.html 4. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.hostclient.doc/GUID-DC96FFDB-F5F2-43EC-8C73- 05ACDAE6BE43.html"
  },
  {
    "id": "4.3",
    "title": "Use Active Directory for local user authentication",
    "assessment": "Scored",
    "description": "ESXi can be configured to use a directory service such as Active Directory to manage users and groups. It is recommended that a directory service be used.",
    "rationale": "Join ESXi hosts to an Active Directory (AD) domain to eliminate the need to create and maintain multiple local user accounts. Using AD for user authentication simplifies the ESXi host configuration, ensures password complexity and reuse policies are enforced and reduces the risk of security breaches and unauthorized access. Note: If the AD group \"ESX Admins\" (default) is created, all users and groups that are Page | 31 assigned as members to this group will have full administrative access to all ESXi hosts the domain. Refer to the \"verify-admin-group\" recommendation for more information.",
    "audit": "From the vSphere Web Client: 1. Select the host and go to \"Manage\" -> \"Settings\" -> \"System\" -> \"Authentication Services\". 2. Ensure the domain settings are in accordance with the user credentials for an AD user that has the rights to join computers to the domain. Execute the following PowerCLI command: # Check each host and their domain membership status Get-VMHost | Get-VMHostAuthentication | Select VmHost, Domain, DomainMembershipStatus",
    "remediation": "From the vSphere Web Client: 1. Select the host and go to \"Manage\" -> \"Settings\" -> \"System\" -> \"Authentication Services\". 2. Click the \"Join Domain\" button. 3. Provide the domain name along with the user credentials for an AD user that has the rights to join computers to the domain. 4. Click \"OK\". To implement the recommended configuration state, run the following PowerCLI command: # Join the ESXI Host to the Domain Get-VMHost HOST1 | Get-VMHostAuthentication | Set-VMHostAuthentication -Domain domain.local -User Administrator -Password Passw0rd -JoinDomain  Notes : 1. Host Profiles can be used to automate adding hosts to an AD domain. 2. Consider using the vSphere Authentication proxy to avoid transmitting AD credentials over the network. 3. If the AD group \"ESX Admins\" (default) is created all users and groups that are assigned as members to this group will have full administrative access to all ESXi hosts the domain.  Page | 32 References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.hostclient.doc/GUID-A61A8FA4-A4AF-475C-860E- 3FD8947F0D0B.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-28650C2C-93E3-4C00-B78A- 7B785AA42D92.html 3. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-63D22519-38CC-4A9F-AE85- 97A53CB0948A.html",
    "function_names": [
      "esxi_host_active_directory_authentication_enabled",
      "esxi_host_local_user_authentication_disabled",
      "esxi_host_directory_service_integration_required",
      "esxi_host_ldap_authentication_enabled",
      "esxi_host_external_identity_provider_required"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.hostclient.doc/GUID-A61A8FA4-A4AF-475C-860E- 3FD8947F0D0B.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-28650C2C-93E3-4C00-B78A- 7B785AA42D92.html 3. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-63D22519-38CC-4A9F-AE85- 97A53CB0948A.html"
  },
  {
    "id": "4.4",
    "title": "Verify Active Directory group membership for the \"ESX Admins\" group",
    "assessment": "Not Scored",
    "description": "The AD group used by vSphere is defined by the esxAdminsGroup attribute. By default, this attribute is set to \"ESX Admins\". All members of the \"ESX Admins\" group are granted full administrative access to all ESXi hosts in the domain. Monitor AD for the creation of this group and limit membership to highly trusted users and groups.",
    "rationale": "An unauthorized user having membership in the group set by the esxAdminsGroup attribute will have full administrative access to all ESXi hosts. Given this, such users may compromise the confidentiality, availability, and integrity of the all ESXi hosts and the respective data and processes they influence.",
    "audit": "From Active Directory, monitor the membership of the group name that is defined by the advanced host setting: Config.HostAgent.plugins.hostsvc.esxAdminsGroup. As with any default group, consider changing this name to avoid possible exploits) and verify only authorized user and group accounts are members of this group. If full admin access for the AD ESX admins group is not desired you can disable this behavior using the advanced host setting: \"Config.HostAgent.plugins.hostsvc.esxAdminsGroupAutoAdd\" Page | 33",
    "remediation": "1. Verify the setting of the esxAdminsGroup attribute (\"ESX Admins\" by default). 2. Check the list of members for that Microsoft Active Directory group. 3. Remove any unauthorized users from that group.  Impact: Coordination between vSphere admins and Active Directory admins is needed. Default Value: The AD group used by vSphere is defined by the esxAdminsGroup attribute. By default, this attribute is set to \"ESX Admins\" References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.wssdk.apiref.doc/vim.host.AuthenticationManager.html  Page | 34 5 Console This section contains recommendations related to ESXi consoles.",
    "function_names": [
      "active_directory_group_membership_restricted",
      "active_directory_group_esx_admins_monitored",
      "active_directory_group_esx_admins_limited",
      "active_directory_group_esx_admins_audited",
      "active_directory_group_esx_admins_high_trust_only"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Coordination between vSphere admins and Active Directory admins is needed. Default Value: The AD group used by vSphere is defined by the esxAdminsGroup attribute. By default, this attribute is set to \"ESX Admins\"",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.wssdk.apiref.doc/vim.host.AuthenticationManager.html  Page | 34 5 Console This section contains recommendations related to ESXi consoles."
  },
  {
    "id": "5.1",
    "title": "Disable DCUI to prevent local administrative control",
    "assessment": "Scored",
    "description": "The Direct Console User Interface (DCUI) can be disabled to prevent any local administration from the Host.  Once the DCUI is disabled any administration of the ESXi host will be done through vCenter.",
    "rationale": "The DCUI allows for low-level host configuration such as configuring IP address, hostname and root password as well as diagnostic capabilities such as enabling the ESXi shell, viewing log files, restarting agents, and resetting configurations. Actions performed from the DCUI are not tracked by vCenter Server. Even if Lockdown Mode is enabled, users who are members of the DCUI.Access list can perform administrative tasks in the DCUI bypassing RBAC and auditing controls provided through vCenter. DCUI access can be disabled. Disabling it prevents all local activity and thus forces actions to be performed in vCenter Server where they can be centrally audited and monitored.",
    "audit": "Perform the following: 1. From the vSphere web client select the host. 2. Select \"Manage\" -> \"Settings\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"Direct Console UI\". 6. Verify the Startup Policy is set to \"Start and Stop Manually\". Additionally, the following PowerCLI command may be used: # List DCUI settings for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"DCUI\" }",
    "remediation": "Page | 35 Perform the following: 1. From the vSphere web client select the host. 2. Select \"Manage\" -> \"Settings\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"Direct Console UI\". 6. Click \"Stop\". 7. Change the Startup Policy \"Start and Stop Manually\". 8. Click \"OK\". Additionally, the following PowerCLI command will implement the recommended configuration state: # Set DCUI to start manually rather than automatic for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"DCUI\" } | Set-VMHostService - Policy Off Impact: Disabling the DCUI can create a potential \"lock out\" situation should the host become isolated from vCenter Server. Recovering from a \"lock out\" scenario requires re-installing ESXi. Consider leaving DCUI enabled and instead enable lockdown mode and limit the users allowed to access the DCUI using the DCUI.Access list. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116- A8353D19FF56.html",
    "function_names": [
      "esxi_host_dcui_disabled",
      "esxi_host_local_admin_disabled",
      "esxi_host_console_access_disabled",
      "esxi_host_direct_console_disabled",
      "esxi_host_remote_management_only"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Disabling the DCUI can create a potential \"lock out\" situation should the host become isolated from vCenter Server. Recovering from a \"lock out\" scenario requires re-installing ESXi. Consider leaving DCUI enabled and instead enable lockdown mode and limit the users allowed to access the DCUI using the DCUI.Access list. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116- A8353D19FF56.html"
  },
  {
    "id": "5.2",
    "title": "Disable ESXi Shell unless needed for diagnostics or troubleshooting",
    "assessment": "Scored",
    "description": "Page | 36 The ESXi shell should only be enabled when running diagnostics or troubleshooting. Otherwise, it should be disabled on each host.",
    "rationale": "ESXi Shell is an interactive command line environment available from the Direct Console User Interface (DCUI) or remotely via SSH. Access to this mode requires the root password of the server. The ESXi Shell can be turned on and off for individual hosts. Activities performed from the ESXi Shell bypass vCenter RBAC and audit controls. The ESXi shell should only be turned on when needed to troubleshoot/resolve problems that cannot be fixed through the vSphere web client or vCLI/PowerCLI. You can use the vSphere Web Client to enable local and remote (SSH) access to the ESXi Shell and to set the idle timeout and availability timeout.",
    "audit": "Perform the following: 1. From the vSphere web client select the host. 2. Select \"Manage\" -> \"Settings\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"ESXi Shell\". 6. Click \"Stop\". 7. Ensure the Startup Policy is set \"Start and Stop Manually\" Additionally, the following PowerCLI command may be used: # Check if ESXi Shell is running and set to start Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM\" } | Select VMHost, Key, Label, Policy, Running, Required Note: A host warning is displayed in the web client anytime the ESXi Shell is enabled on a host.",
    "remediation": "Perform the following: 1. From the vSphere web client select the host. 2. Select \"Manage\" -> \"Settings\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"ESXi Shell\". 6. Click \"Stop\". 7. Change the Startup Policy \"Start and Stop Manually\" Page | 37 8. Click \"OK\". Additionally, the following PowerCLI command will implement the recommended configuration state: # Set ESXi Shell to start manually rather than automatic for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM\" } | Set-VMHostService - Policy Off Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-B5144CE9-F8BB-494D-8F5D- 0D5621D65DAE.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-DFA67697-232E-4F7D-860F- 96C0819570A8.html",
    "function_names": [
      "compute_esxi_shell_disabled",
      "compute_esxi_shell_diagnostics_enabled",
      "compute_esxi_shell_troubleshooting_enabled",
      "compute_esxi_shell_disabled_by_default",
      "compute_esxi_shell_restricted_access"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-B5144CE9-F8BB-494D-8F5D- 0D5621D65DAE.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-DFA67697-232E-4F7D-860F- 96C0819570A8.html"
  },
  {
    "id": "5.3",
    "title": "Disable SSH",
    "assessment": "Scored",
    "description": "Disable Secure Shell (SSH) for each ESXi host to prevent remote access to the ESXi shell. only enable if needed for troubleshooting or diagnostics.",
    "rationale": "The ESXi shell, when enabled, can be accessed directly from the host console through the DCUI or remotely using SSH. Remote access to the host should be limited to the vSphere Client, remote command-line tools (vCLI/PowerCLI), and through the published APIs. Under normal circumstances remote access to the host using SSH should be disabled.",
    "audit": "Perform the following: 1. From the vSphere web client select the host. 2. Select \"Manage\" -> \"Settings\" -> \"System\" -> \"Security Profile\". Page | 38 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"SSH\". 6. Ensure the Startup Policy is set to \"Start and Stop Manually\". Additionally, the following PowerCLI command may be used: # Check if SSH is running and set to start Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM-SSH\" } | Select VMHost, Key, Label, Policy, Running, Required Note: A host warning is displayed in the web client anytime SSH is enabled on a host.",
    "remediation": "Perform the following: 1. From the vSphere web client select the host. 2. Select \"Manage\" -> \"Settings\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"SSH\". 6. Click \"Stop\". 7. Change the Startup Policy \"to Start and Stop Manually\". 8. Click \"OK\". Additionally, the following PowerCLI command will implement the recommended configuration state: # Set SSH to start manually rather than automatic for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM-SSH\" } | Set-VMHostService - Policy Off Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-12E27BF3-3769-4665-8769- DA76C2BC9FFE.html",
    "function_names": [
      "compute_esxi_host_ssh_disabled",
      "compute_esxi_host_ssh_restricted",
      "compute_esxi_host_remote_access_disabled",
      "compute_esxi_host_shell_access_disabled",
      "compute_esxi_host_ssh_troubleshooting_only"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-12E27BF3-3769-4665-8769- DA76C2BC9FFE.html"
  },
  {
    "id": "5.4",
    "title": "Limit CIM Access",
    "assessment": "Not Scored",
    "description": "Do not provide administrator level access (i.e. root) to CIM-based hardware monitoring tools or other 3rd party applications. Create a service account specific for each CIM application with the minimal needed access for each application.",
    "rationale": "The Common Information Model (CIM) system provides an interface that enables hardware-level management from remote applications using a set of standard APIs. To ensure that the CIM interface remains secure, provide only the minimum access necessary to these applications. Do not provision CIM and other 3rd party tools to run as root or another administrator account. Instead, use a dedicated service account with a limited privilege set. If CIM or other 3rd party are granted unneeded administrator level access, they could potentially be use to compromise the security of the host.",
    "audit": "1. Create a limited-privileged service account for CIM and other 3rd party applications. 2. This account should access the system via vCenter. 3. This account needs to be provided with only the \"CIM Interaction\" privilege. 4. This will enable the account to obtain a CIM ticket, which can then be used to perform both read and write CIM operations on the target host. 5. If an account must connect to the host directly, then this account must be granted the full \"Administrator\" role on the host. This is not recommended unless required by the monitoring software being used. Additionally, the following PowerCLI command may be used: # List all user accounts on the Host -Host Local connection required- Get-VMHostAccount",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Create a new host user account -Host Local connection required- New-VMHostAccount -ID ServiceUser -Password <password> -UserAccount Impact: Page | 40 When a user logs into the host with the service account you created for CIM applications, the user has only the privileges SystemManagement and CIMInteraction , or read-only access. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.cimsdk.smashpg.doc/03_CIM_SMASH_PG_Use_Cases.5.1.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-645EBD81-CF86-44D7-BE77- 224EF963D145.html",
    "function_names": [
      "iam_service_account_no_admin_privileges",
      "iam_service_account_minimal_access",
      "compute_cim_tool_restricted_access",
      "compute_cim_tool_service_account",
      "iam_root_access_restricted",
      "iam_third_party_app_no_admin",
      "compute_monitoring_tool_service_account",
      "iam_service_account_application_specific"
    ],
    "profile_applicability": "Page | 39 \uf0b7  Level 1",
    "impact": "Page | 40 When a user logs into the host with the service account you created for CIM applications, the user has only the privileges SystemManagement and CIMInteraction , or read-only access. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.cimsdk.smashpg.doc/03_CIM_SMASH_PG_Use_Cases.5.1.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-645EBD81-CF86-44D7-BE77- 224EF963D145.html"
  },
  {
    "id": "5.5",
    "title": "Enable lockdown mode to restrict remote access",
    "assessment": "Scored",
    "description": "Lockdown mode disables local access to the ESXi host.  All management must be done from vCenter to ensure proper permissions and roles are being applied when using lockdown mode.",
    "rationale": "Enabling lockdown mode disables direct access to an ESXi host requiring the host be managed remotely from vCenter Server. Lockdown limits ESXi host access to the vCenter server. This is done to ensure the roles and access controls implemented in vCenter are always enforced and users cannot bypass them by logging into a host directly. By forcing all interaction to occur through vCenter Server, the risk of someone inadvertently attaining elevated privileges or performing tasks that are not properly audited is greatly reduced. Note: Lockdown mode does not apply to users who log in using authorized keys. When you use an authorized key file for root user authentication, root users are not prevented from accessing a host with SSH even when the host is in lockdown mode. Note that users listed in the DCUI.Access list for each host are allowed to override lockdown mode and login to the DCUI. By default the \"root\" user is the only user listed in the DCUI.Access list.",
    "audit": "Page | 41 From the vSphere web client: 1. Select the host 2. Select \"Manage\" -> \"Settings\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Lockdown Mode\". 4. Click \"Edit...\". 5. Ensure the \"Enable Lockdown Mode\" checkbox is checked. Additionally, the following PowerCLI command may be used: # To check if Lockdown mode is enabled Get-VMHost | Select Name,@{N=\"Lockdown\";E={$_.Extensiondata.Config.adminDisabled}}",
    "remediation": "From the vSphere web client: 1. Select the host 2. Select \"Manage\" -> \"Settings\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Lockdown Mode\". 4. Click \"Edit...\". 5. Select the \"Enable Lockdown Mode\" checkbox. 6. Click \"OK\". To implement the recommended configuration state, run the following PowerCLI command: # Enable lockdown mode for each host Get-VMHost | Foreach { $_.EnterLockdownMode() } Impact: There are some operations, such as backup and troubleshooting, that require direct access to the host. In these cases Lockdown Mode can be disabled on a temporary basis for specific hosts as needed, and then re-enabled when the task is completed. Note: Lockdown mode does not apply to users listed in the DCUI.Access list, which by default includes the root user. Default Value: The prescribed state is not the default state. References: Page | 42 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2-B838- 225F5FF480FF.html 2. http://kb.vmware.com/kb/1008077",
    "function_names": [
      "compute_esxi_host_lockdown_mode_enabled",
      "compute_esxi_host_remote_access_restricted",
      "compute_esxi_host_vcenter_management_required",
      "compute_esxi_host_local_access_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "There are some operations, such as backup and troubleshooting, that require direct access to the host. In these cases Lockdown Mode can be disabled on a temporary basis for specific hosts as needed, and then re-enabled when the task is completed. Note: Lockdown mode does not apply to users listed in the DCUI.Access list, which by default includes the root user. Default Value: The prescribed state is not the default state.",
    "references": "Page | 42 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2-B838- 225F5FF480FF.html 2. http://kb.vmware.com/kb/1008077"
  },
  {
    "id": "5.6",
    "title": "Remove keys from SSH authorized_keys file",
    "assessment": "Scored",
    "description": "For day-to-day operations the ESXi host should be in Lockdown mode with the Secure Shell (SSH) service disabled. Lockdown mode does not prevent root users from logging in using authorized keys. When you use an authorized key file for root user authentication, root users are not prevented from accessing a host with SSH even when the host is in lockdown mode.",
    "rationale": "ESXi hosts come with SSH, which can be configured to authenticate remote users using public key authentication. To enable public key authentication, copy the remote users public key into the /etc/ssh/keys-root/authorized_keys file on the ESXi host. The presence of the remote user's public key in the authorized_keys file identifies the user as trusted, meaning the user is granted access to the host without providing a password. Note: Lockdown mode does not apply to root users who log in using authorized keys. When you use an authorized key file for root user authentication, root users are not prevented from accessing a host with SSH even when the host is in lockdown mode.",
    "audit": "To check for SSH keys added to the authorized_keys file: 1. Logon to the ESXi shell as root or an authorized admin user. 2. Verify the /etc/ssh/keys-root/authorized_keys file is empty.",
    "remediation": "To check for SSH keys added to the authorized_keys file: 1. Logon to the ESXi shell as root or an authorized admin user. 2. Verify the contents of the /etc/ssh/keys-root/authorized_keys file. Page | 43 3. If the file is not empty remove any keys found in the file. Impact: Disabling the SSH authorized_keys access may limit your ability to run unattended remote scripts. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-392ADDE9-FD3B-49A2-BF64- 4ACBB60EB149.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-ED477079-1E7E-4EBA-AAFE- 019FB335DABC.html",
    "function_names": [
      "compute_ssh_authorized_keys_removed",
      "compute_ssh_authorized_keys_empty",
      "compute_ssh_root_access_disabled",
      "compute_ssh_lockdown_mode_enforced",
      "compute_ssh_root_login_restricted",
      "compute_ssh_authorized_keys_no_root",
      "compute_ssh_lockdown_no_authorized_keys"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Disabling the SSH authorized_keys access may limit your ability to run unattended remote scripts. Default Value: The prescribed state is the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-392ADDE9-FD3B-49A2-BF64- 4ACBB60EB149.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-ED477079-1E7E-4EBA-AAFE- 019FB335DABC.html"
  },
  {
    "id": "5.7",
    "title": "Set a timeout to automatically terminate idle ESXi Shell and SSH sessions",
    "assessment": "Scored",
    "description": "Set a timeout to automatically terminate any idle ESXi shell and SSH sessions.",
    "rationale": "If a user forgets to logout of their SSH session, then the idle connection will remain indefinitely, increasing the potential for someone to gain privileged access to the host. The ESXiShellInteractiveTimeOut allows you to automatically terminate idle shell sessions.",
    "audit": "From the vSphere web client: 1. Select the host. 2. Click \"Manage\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 3. Type ESXiShellInteractiveTimeOut in the filter. 4. Verify that the attribute is set to 300 or less. Page | 44 Note: A value of 0 disables the ESXi ShellInteractiveTimeOut. It is recommended to set the ESXiShellTimeOut together with ESXiShellInteractiveTimeOut. Additionally, the following PowerCLI command may be used: # List UserVars.ESXiShellInteractiveTimeOut for each host Get-VMHost | Select Name, @{N=\"UserVars.ESXiShellInteractiveTimeOut\";E={$_ | Get- VMHostAdvancedConfiguration UserVars.ESXiShellInteractiveTimeOut | Select - ExpandProperty Values}}",
    "remediation": "From the vSphere web client: 1. Select the host. 2. Click \"Manage\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 3. Type ESXiShellInteractiveTimeOut in the filter. 4. Click on the attribute to highlight it. 5. Click the pencil icon to edit. 6. Set the attribute to the desired value (300 or less). 7. Click \"OK\". Note: A value of 0 disables the ESXi ShellInteractiveTimeOut. Additionally, the following PowerCLI command will implement the recommended configuration state: # Set Remove UserVars.ESXiShellInteractiveTimeOut to 300 on all hosts Get-VMHost | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name UserVars.ESXiShellInteractiveTimeOut -Value 300 } Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-439FEC2A-6E5F-4D5E-88A0- 54D31BC9D119.html 2. http://kb.vmware.com/kb/2004746 3. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3-4E16-8027- 0280B9ED1009.html Page | 45",
    "function_names": [
      "esxi_shell_idle_timeout_enabled",
      "esxi_ssh_idle_timeout_enabled",
      "esxi_session_auto_termination_enabled",
      "esxi_shell_session_timeout_configured",
      "esxi_ssh_session_timeout_configured",
      "esxi_idle_session_termination_enabled",
      "esxi_shell_auto_termination_enabled",
      "esxi_ssh_auto_termination_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-439FEC2A-6E5F-4D5E-88A0- 54D31BC9D119.html 2. http://kb.vmware.com/kb/2004746 3. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3-4E16-8027- 0280B9ED1009.html Page | 45"
  },
  {
    "id": "5.8",
    "title": "Set a timeout for Shell Services",
    "assessment": "Scored",
    "description": "In order to limit how long the services are allowed to run, set a timeout to automatically stop the service for ESXi shell and SSH sessions.",
    "rationale": "When the ESXi Shell or SSH services are enabled on a host, they will run indefinitely. To avoid having these services left running, set the ESXiShellTimeOut. The ESXiShellTimeOut defines a window of time after which the ESXi Shell and SSH services will automatically be terminated.",
    "audit": "From the vSphere web client: 1. Select the host and click \"Manage\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 2. Type ESXiShellTimeOut in the filter. 3. Ensure the attribute is set to 3600 seconds (1 hour) or less. Additionally, the following PowerCLI command may be used: # List UserVars.ESXiShellTimeOut in minutes for each host Get-VMHost | Select Name, @{N=\"UserVars.ESXiShellTimeOut\";E={$_ | Get- VMHostAdvancedConfiguration UserVars.ESXiShellTimeOut | Select -ExpandProperty Values}}",
    "remediation": "From the vSphere web client: 1. Select the host and click \"Manage\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 2. Type ESXiShellTimeOut in the filter. 3. Click on the attribute to highlight it. 4. Click the pencil icon to edit. 5. Set the attribute to 3600 seconds (1 hour) or less. 6. Click \"OK\". Page | 46 Note: A value of 0 disables the ESXi ShellTimeOut. It is recommended to set the ESXiShellInteractiveTimeOut together with ESXiShellTimeOut.  To implement the recommended configuration state, run the following PowerCLI command: # Set UserVars.ESXiShellTimeOut to 3660 on all hosts Get-VMHost | Foreach { Set-VMHostAdvancedConfiguration -VMHost $_ -Name UserVars.ESXiShellTimeOut -Value 3600 } Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-6E1ECA4D-B617-4D42-B40B- 71E4C83DEEFB.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-B314F79B-2BDD-4D68-8096- F009B87ACB33.html 3. http://kb.vmware.com/kb/2004746 4. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3-4E16-8027- 0280B9ED1009.html",
    "function_names": [
      "esxi_shell_timeout_enabled",
      "esxi_ssh_timeout_enabled",
      "esxi_shell_session_timeout_configured",
      "esxi_ssh_session_timeout_configured",
      "esxi_shell_service_timeout_set",
      "esxi_ssh_service_timeout_set",
      "esxi_shell_idle_timeout_enabled",
      "esxi_ssh_idle_timeout_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-6E1ECA4D-B617-4D42-B40B- 71E4C83DEEFB.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-B314F79B-2BDD-4D68-8096- F009B87ACB33.html 3. http://kb.vmware.com/kb/2004746 4. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3-4E16-8027- 0280B9ED1009.html"
  },
  {
    "id": "5.9",
    "title": "Set DCUI.Access to allow trusted users to override lockdown mode",
    "assessment": "Not Scored",
    "description": "Create a list of highly trusted users that would be able to override lockdown mode and access the DCUI in the event a host became isolated.",
    "rationale": "Lockdown disables direct host access requiring admins manage hosts from vCenter. However, if a host becomes isolated from vCenter the admin would become locked out and Page | 47 can no longer manage the host. To avoid potentially becoming locked out of an ESXi hosts that is running in locked down mode, set the DCUI.Access to a list of highly trusted users that are allowed to override the lockdown mode and access the DCUI.",
    "audit": "From the vSphere web client: 1. Select the host. 2. Select \"Manage\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 3. Type DCUI.Access in the filter. 4. Ensure the DCUI.Access attribute is set to a comma-separated list of the users who are allowed to override lockdown mode. Additionally, the following Power shell command may be used: Get-VMHost | Get-AdvancedSetting -Name DCUI.Access",
    "remediation": "From the vSphere web client: 1. Select the host. 2. Select \"Manage\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 3. Type DCUI.Access in the filter. 4. Click on the attribute to highlight it. 5. Click the pencil icon to edit. 6. Set the DCUI.Access attribute to a comma-separated list of the users who are allowed to override lockdown mode. 7. Click \"OK\" Impact: When you disable lockdown mode using the DCUI, all users with the DCUI Access privilege are granted the Administrator role on the host. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116- A8353D19FF56.html Page | 48",
    "function_names": [
      "esxi_host_dcui_access_trusted_users_configured",
      "esxi_host_lockdown_mode_override_allowed",
      "esxi_host_dcui_access_whitelist_configured",
      "esxi_host_isolation_recovery_users_defined",
      "esxi_host_lockdown_override_users_configured"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "When you disable lockdown mode using the DCUI, all users with the DCUI Access privilege are granted the Administrator role on the host. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116- A8353D19FF56.html Page | 48"
  },
  {
    "id": "5.10",
    "title": "Verify contents of exposed configuration files",
    "assessment": "Not Scored",
    "description": "Monitor exposed configuration files to verify no unauthorized modifications have been made.",
    "rationale": "Although most configurations on ESXi are controlled via an API, there are a limited set of configuration files that are used directly to govern host behavior. These specific files are exposed via the vSphere HTTPS-based file transfer API. Any changes to these files should be correlated with an approved administrative action, such as an authorized configuration change. Tampering with these files has the potential to enable unauthorized access to the host configuration and virtual machines. WARNING: do not attempt to monitor files that are NOT exposed via this file-transfer API, since this can result in a destabilized system",
    "audit": "1. Open a web browser. 2. ESXi Configuration files can be found by browsing to https://<hostname>/host (not available if MOB is disabled). NOTE: not all the files listed are modifiable. The files can also be retrieved using the vCLI or PowerCLI. Implement a procedure to track the files and their contents over time to ensure that they are not improperly modified. Be sure not to monitor log files and other files whose content is expected to change regularly due to system activity. Also, account for configuration file changes that are due to deliberate administrative activity. It is recommended to keep reoccurring backups of a host configuration. Note: Host Profiles may also be used to track configuration changes on the host; however Host Profiles do not track all configuration changes. Page | 49",
    "remediation": "During a configuration backup, the serial number is backed up with the configuration. The number is restored when you restore the configuration. The number is not preserved when you run the Recovery CD (ESXi Embedded) or perform a repair operation (ESXi Installable). You can back up and restore configuration information as follows. 1. Back up the configuration by using the vicfg-cfgbackup command. 2. Run the Recovery CD or repair operation 3. Restore the configuration by using the vicfg-cfgbackup command. When you restore a configuration, you must make sure that all virtual machines on the host are stopped.  Impact: After you configure an ESXi host, you can back up the host configuration data. Always back up your host configuration after you change the configuration or upgrade the ESXi image. Important The vicfg-cfgbackup command is available only for ESXi hosts. The command is not available through a vCenter Server system connection. No equivalent ESXCLI command is supported.  References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116- A8353D19FF56.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vcli.examples.doc/cli_manage_hosts.4.4.html  Page | 50 6 Storage This section contains recommendations related to ESXi disk an storage-related settings.",
    "function_names": [
      "compute_instance_config_files_no_unauthorized_changes",
      "compute_instance_config_files_exposed_monitoring_enabled",
      "compute_instance_config_files_integrity_verified",
      "compute_instance_config_files_unauthorized_modifications_detected",
      "compute_instance_config_files_exposed_alerting_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "After you configure an ESXi host, you can back up the host configuration data. Always back up your host configuration after you change the configuration or upgrade the ESXi image. Important The vicfg-cfgbackup command is available only for ESXi hosts. The command is not available through a vCenter Server system connection. No equivalent ESXCLI command is supported.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116- A8353D19FF56.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vcli.examples.doc/cli_manage_hosts.4.4.html  Page | 50 6 Storage This section contains recommendations related to ESXi disk an storage-related settings."
  },
  {
    "id": "6.1",
    "title": "Enable bidirectional CHAP authentication for iSCSI traffic.",
    "assessment": "Scored",
    "description": "By enabling bidirectional CHAP, also known as Mutual CHAP, an additional level of security enables the initiator to authenticate the target.",
    "rationale": "vSphere allows for the use of bidirectional authentication of both the iSCSI target and host. Choosing not to enforce more stringent authentication can make sense if you create a dedicated network or VLAN to service all your iSCSI devices. By not authenticating both the iSCSI target and host, there is a potential for a MiTM attack in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication can mitigate this risk. If the iSCSI facility is isolated from general network traffic, it is less vulnerable to exploitation.",
    "audit": "Perform the following: 1. From the vSphere Web Client, navigate to \"Hosts\". 2. Click on a host. 3. Click on \"Manage\" -> \"Storage\" -> \"Storage Adapters\". 4. Select the iSCSI adapter. 5. Under Adapter Details, click the Properties tab. 6. Verify authentication method (Use bidirectional CHAP). Additionally, the following PowerCLI command may be used: # List Iscsi Initiator and CHAP Name if defined Get-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Select VMHost, Device, ChapType, @{N=\"CHAPName\";E={$_.AuthenticationProperties.ChapName}}",
    "remediation": "Perform the following: Page | 51 1. From the vSphere Web Client, navigate to \"Hosts\". 2. Click on a host. 3. Click on \"Manage\" -> \"Storage\" -> \"Storage Adapters\". 4. Select the iSCSI adapter to configure OR click the green plus symbol to create a new adapter. 5. Under Adapter Details, click the Properties tab and click \"Edit\" in the Authentication panel. 6. Specify authentication method: \"Use bidirectional CHAP\". 7. Specify the outgoing CHAP name. o Make sure that the name you specify matches the name configured on the storage side. \uf0a7 To set the CHAP name to the iSCSI adapter name, select Use initiator name. \uf0a7 To set the CHAP name to anything other than the iSCSI initiator name, deselect Use initiator name and type a name in the Name text box. 8. Enter an outgoing CHAP secret to be used as part of authentication. Use the same secret as your storage side secret. 9. Specify incoming CHAP credentials. Make sure your outgoing and incoming secrets do not match. 10. Click OK. 11. Click the second to last symbol to rescan the iSCSI adapter. To implement the recommended configuration state, run the following PowerCLI command: # Set the Chap settings for the Iscsi Adapter Get-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Set-VMHostHba # Use desired parameters here Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD- 49B433E2F266.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18-A083- 8E65FE380899.html",
    "function_names": [
      "compute_iscsi_chap_authentication_enabled",
      "compute_iscsi_mutual_chap_enabled",
      "compute_iscsi_bidirectional_authentication_required",
      "compute_iscsi_target_authentication_enabled",
      "compute_iscsi_initiator_authentication_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD- 49B433E2F266.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18-A083- 8E65FE380899.html"
  },
  {
    "id": "6.2",
    "title": "Ensure uniqueness of CHAP authentication secrets",
    "assessment": "Not Scored",
    "description": "CHAP (Challenge-Handshake Authentication Protocol) requires both Client and Host to know the secret (Password) to establish connection. When setting up CHAP ensure each host connects with a unique secret.",
    "rationale": "The mutual authentication secret for each host should be different; if possible, the secret should be different for each client authenticating to the server as well. This ensures that if a single host is compromised, an attacker cannot create another arbitrary host and authenticate to the storage device. With a single shared secret, compromise of one host can allow an attacker to authenticate to the storage device.",
    "audit": "For each CHAP-enabled iSCSI adapter, confirm the the CHAP secrets used are unique. The following will list all iSCSI adapters and their corresponding CHAP configuration: # List Iscsi Initiator and CHAP Name if defined Get-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Select VMHost, Device, ChapType, @{N=\"CHAPName\";E={$_.AuthenticationProperties.ChapName}}",
    "remediation": "Perform the following: 1. From the vSphere Web Client, navigate to \"Hosts\". 2. Click on a host. 3. Click on \"Manage\" -> \"Storage\" -> \"Storage Adapters\". 4. Select the iSCSI adapter to configure OR click the green plus symbol to create a new adapter. 5. Under Adapter Details, click the Properties tab and click \"Edit\" in the Authentication panel. 6. Specify authentication method. 1. \uf0a7 None \uf0a7 Use unidirectional CHAP if required by target \uf0a7 Use unidirectional CHAP unless prohibited by target \uf0a7 Use unidirectional CHAP \uf0a7 Use bidirectional CHAP. 7. Specify the outgoing CHAP name. o Make sure that the name you specify matches the name configured on the storage side. Page | 53 \uf0a7 To set the CHAP name to the iSCSI adapter name, select Use initiator name. \uf0a7 To set the CHAP name to anything other than the iSCSI initiator name, deselect Use initiator name and type a name in the Name text box. 8. Enter an outgoing CHAP secret to be used as part of authentication. Use the same secret as your storage side secret. 9. If configuring with bidirectional CHAP, specify incoming CHAP credentials. o Make sure your outgoing and incoming secrets do not match. 10. Click OK. 11. Click the second to last symbol to rescan the iSCSI adapter. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD- 49B433E2F266.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18-A083- 8E65FE380899.html",
    "function_names": [
      "storage_iscsi_chap_secret_unique",
      "storage_iscsi_chap_unique_authentication",
      "storage_iscsi_chap_no_shared_secrets",
      "storage_iscsi_chap_secret_per_host",
      "storage_iscsi_chap_unique_per_connection"
    ],
    "profile_applicability": "Page | 52 \uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD- 49B433E2F266.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18-A083- 8E65FE380899.html"
  },
  {
    "id": "6.3",
    "title": "Mask and zone SAN resources appropriately",
    "assessment": "Not Scored",
    "description": "Use zoning and LUN masking to segregate SAN activity. For example, zones defined for testing should be managed independently within the SAN so they do not interfere with activity in the production zones. Similarly, you can set up different zones for different departments. Zoning must take into account any host groups that have been set up on the SAN device. LUN masking is a process that makes a LUN available to some hosts and unavailable to other hosts.",
    "rationale": "Zoning provides access control in the SAN topology. Zoning defines which HBAs can connect to which targets. The devices outside a zone are not visible to the devices inside the zone when SAN zoning is configured. Page | 54 Zoning has the following effects: \uf0b7 Reduces the number of targets and LUNs presented to a host. \uf0b7 Can prevent non-ESXi systems from accessing a particular storage system, and from possibly destroying VMFS data. \uf0b7 Can be used to separate different environments, for example, a test from a production environment.",
    "audit": "Zoning and masking capabilities for each SAN switch and disk array are vendor specific, as are the tools for managing LUN masking.",
    "remediation": "With ESXi hosts, use a single-initiator zoning or a single-initiator-single-target zoning. The latter is a preferred zoning practice. Using the more restrictive zoning prevents problems and misconfigurations that can occur on the SAN. For detailed instructions and best zoning practices, contact storage array or switch vendors. Zoning and masking capabilities for each SAN switch and disk array are vendor specific. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-6029358F-8EE8-4143-9BB0- 16ABB3CA0FE3.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-BFE9046A-2278-4026-809A- ED8F9D8FDACE.html 3. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-39A4551F-4B03-43A6-BEDF- FAB1528C070D.html",
    "function_names": [
      "san_storage_zoning_configured",
      "san_storage_lun_masking_enabled",
      "san_storage_production_zones_isolated",
      "san_storage_test_zones_segregated",
      "san_storage_department_zones_defined",
      "san_storage_host_groups_configured",
      "san_storage_lun_access_restricted"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-6029358F-8EE8-4143-9BB0- 16ABB3CA0FE3.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-BFE9046A-2278-4026-809A- ED8F9D8FDACE.html 3. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-39A4551F-4B03-43A6-BEDF- FAB1528C070D.html"
  },
  {
    "id": "6.4",
    "title": "Zero out VMDK files prior to deletion",
    "assessment": "Not Scored",
    "description": "Page | 55 Zeroing out a VMDK before deleting can help prevent users from reconstructing the original contents of the disk.",
    "rationale": "To help prevent sensitive data in VMDK files from being read off the physical disk after it is deleted, the virtual disk should be zeroed out prior to deletion. This will make it more difficult for someone to reconstruct the contents of the VMDK file. The CLI command 'vmkfstools -writezeroes' can be used to write zeros to the entire contents of a VMDK file prior to its deletion.",
    "audit": "Not applicable",
    "remediation": "When deleting a VMDK file with sensitive data: 1. Shut down or stop the virtual machine. 2. Issue the CLI command 'vmkfstools -writezeroes' on that file prior to deleting it from the datastore. Impact: CAUTION: When you use this command, you lose any existing data on the virtual disk. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-050C0FEE-2C75-4356-B9E0- CC802333FF41.html  Page | 56 7 vNetwork This section contains recommendations related to configuring vNetwork.",
    "function_names": [
      "compute_vmdk_zero_out_before_deletion",
      "compute_vmdk_secure_deletion_enabled",
      "compute_vmdk_data_wipe_on_deletion",
      "compute_vmdk_sanitization_required",
      "compute_vmdk_pre_deletion_zeroing",
      "compute_vmdk_secure_erase_enabled",
      "compute_vmdk_content_scrubbing_required",
      "compute_vmdk_deletion_sanitization_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "CAUTION: When you use this command, you lose any existing data on the virtual disk.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.storage.doc/GUID-050C0FEE-2C75-4356-B9E0- CC802333FF41.html  Page | 56 7 vNetwork This section contains recommendations related to configuring vNetwork."
  },
  {
    "id": "7.1",
    "title": "Ensure that the vSwitch Forged Transmits policy is set to reject",
    "assessment": "Scored",
    "description": "Set the vSwitch Forged Transmits policy is set to reject for each vSwitch.",
    "rationale": "If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. Forged transmissions should be set to accept by default. This means the virtual switch does not compare the source and effective MAC addresses. To protect against MAC address impersonation, all virtual switches should have forged transmissions set to reject. Reject Forged Transmit can be set at the vSwitch and/or the Portgroup level. You can override switch level settings at the Portgroup level.",
    "audit": "1. In the vSphere Web Client, navigate to the host. 2. \"Hosts and Clusters\" -> \"vCenter\" -> host. 3. On the Manage tab, click Networking, and select Virtual switches. 4. Select a standard switch from the list and click the pencil icon to edit settings. 5. Select Security. 6. Verify Forged transmits is set to \"Reject\". Additionally, the following PowerCLI command may be used: # List all vSwitches and their Security Settings Get-VirtualSwitch -Standard | Select VMHost, Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Spec.Policy.Security.MacChanges) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Spec.Policy.Security.PromiscuousMode) { \"Accept\" } Else { \"Reject\"} }}, ` Page | 57 @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Spec.Policy.Security.ForgedTransmits) { \"Accept\" } Else { \"Reject\"} }}",
    "remediation": "1. In the vSphere Web Client, navigate to the host. 2. \"Hosts and Clusters\" -> \"vCenter\" -> host. 3. On the Manage tab, click Networking, and select Virtual switches. 4. Select a standard switch from the list and click the pencil icon to edit settings. 5. Select Security. 6. Set Forged transmits to \"Reject\". 7. Click \"OK\". Additionally, the following ESXi shell command may be used: # esxcli network vswitch standard policy security set -v vSwitch2 -f false Impact: This will prevent VMs from changing their effective MAC address. This will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html",
    "function_names": [
      "compute_vswitch_forged_transmits_reject",
      "compute_vswitch_forged_transmits_reject_all_regions",
      "vswitch_forged_transmits_reject",
      "vswitch_forged_transmits_reject_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "This will prevent VMs from changing their effective MAC address. This will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html"
  },
  {
    "id": "7.2",
    "title": "Ensure that the vSwitch MAC Address Change policy is set to reject",
    "assessment": "Scored",
    "description": "Ensure that the MAC Address Change policy within the vSwitch is set to reject.",
    "rationale": "Page | 58 If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to. Reject MAC Changes can be set at the vSwitch and/or the Portgroup level. You can override switch level settings at the Portgroup level.",
    "audit": "1. In the vSphere Web Client, navigate to the host. 2. \"Hosts and Clusters\" -> \"vCenter\" -> host. 3. On the Manage tab, click Networking, and select Virtual switches. 4. Select a standard switch from the list and click the pencil icon to edit settings. 5. Select Security. 6. Verify MAC Address Changes is set to \"Reject\". 7. Click \"OK\". Additionally, the following PowerCLI command may be used: # List all vSwitches and their Security Settings Get-VirtualSwitch -Standard | Select VMHost, Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Spec.Policy.Security.MacChanges) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Spec.Policy.Security.PromiscuousMode) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Spec.Policy.Security.ForgedTransmits) { \"Accept\" } Else { \"Reject\"} }}",
    "remediation": "1. In the vSphere Web Client, navigate to the host. 2. \"Hosts and Clusters\" -> \"vCenter\" -> host. 3. On the Manage tab, click Networking, and select Virtual switches. 4. Select a standard switch from the list and click the pencil icon to edit settings. 5. Select Security. 6. Set MAC Address Changes to \"Reject\". 7. Click \"OK\". Additionally, perform the following to implement the recommended configuration state using the ESXi shell: # esxcli network vswitch standard policy security set -v vSwitch2 -m false Page | 59 Impact: This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html",
    "function_names": [
      "vpc_vswitch_mac_address_change_reject",
      "vpc_vswitch_mac_address_change_reject_enabled",
      "vpc_vswitch_mac_address_change_policy_reject",
      "vpc_vswitch_mac_address_change_deny",
      "vpc_vswitch_mac_address_change_protection_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the port groups that these applications are connected to.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html"
  },
  {
    "id": "7.3",
    "title": "Ensure that the vSwitch Promiscuous Mode policy is set to reject",
    "assessment": "Scored",
    "description": "Ensure that the Promiscuous Mode Policy within the vSwitch is set to reject.",
    "rationale": "When promiscuous mode is enabled for a virtual switch all virtual machines connected to the dvPortgroup have the potential of reading all packets crossing that network. Promiscuous mode is disabled by default on the ESXi Server, and this is the recommended setting. However, there might be a legitimate reason to enable it for debugging, monitoring or troubleshooting reasons. Security devices might require the ability to see all packets on a vSwitch. An exception should be made for the dvPortgroups that these applications are connected to, in order to allow for full-time visibility to the traffic on that dvPortgroup. Promiscous mode can be set at the vSwitch and/or the Portgroup level. You can override switch level settings at the Portgroup level.",
    "audit": "1. In the vSphere Web Client, navigate to the host. 2. \"Hosts and Clusters\" -> \"vCenter\" -> host. 3. On the Manage tab, click Networking, and select Virtual switches. Page | 60 4. Select a standard switch from the list and click the pencil icon to edit settings. 5. Select Security. 6. Verify Promiscuous Mode is set to \"Reject\". 7. Click \"OK\". Additionally, the following PowerCLI command may be used: # List all vSwitches and their Security Settings Get-VirtualSwitch -Standard | Select VMHost, Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Spec.Policy.Security.MacChanges) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Spec.Policy.Security.PromiscuousMode) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Spec.Policy.Security.ForgedTransmits) { \"Accept\" } Else { \"Reject\"} }}",
    "remediation": "1. In the vSphere Web Client, navigate to the host. 2. \"Hosts and Clusters\" -> \"vCenter\" -> host. 3. On the Manage tab, click Networking, and select Virtual switches. 4. Select a standard switch from the list and click the pencil icon to edit settings. 5. Select Security. 6. Set Promiscuous Mode to \"Reject\". 7. Click \"OK\". Additionally, perform the following to implement the recommended configuration state via the ESXi shell: # esxcli network vswitch standard policy security set -v vSwitch2 -p false Impact: Security devices that require the ability to see all packets on a vSwitch will not operate properly if the Promiscuous Mode parameter is set to Reject. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html Page | 61",
    "function_names": [
      "compute_vswitch_promiscuous_mode_rejected",
      "network_vswitch_promiscuous_mode_disabled",
      "vpc_vswitch_promiscuous_mode_rejected",
      "cloud_network_vswitch_promiscuous_mode_disabled",
      "vswitch_promiscuous_mode_rejected"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Security devices that require the ability to see all packets on a vSwitch will not operate properly if the Promiscuous Mode parameter is set to Reject. Default Value: The prescribed state is the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html Page | 61"
  },
  {
    "id": "7.4",
    "title": "Ensure that port groups are not configured to the value of the native VLAN",
    "assessment": "Scored",
    "description": "Do not use Native VLAN ID 1.",
    "rationale": "ESXi does not use the concept of native VLAN. Frames with VLAN specified in the port group will have a tag, but frames with VLAN not specified in the port group are not tagged and therefore will end up as belonging to native VLAN of the physical switch. For example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a \u201c1\u201d; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a \u201c1\u201d instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged). If the ESXi virtual switch port group uses the native VLAN ID, traffic from those VMs will not be visible to the native VLAN on the switch, because the switch is expecting untagged traffic.",
    "audit": "If the default value of 1 for the native VLAN is being used, the ESXi Server virtual switch port groups should be configured with any value between 2 and 4094. Otherwise, ensure that the port group is not configured to use whatever value is set for the native VLAN.  1. From the vSphere web client select the host. 2. On the Manage tab, click Networking, and select Virtual switches. 3. Select a standard switch from the list. 4. The topology diagram of the switch appears showing the various port groups associated with that switch. 5. For each port group on the vSwitch, verify and record the VLAN IDs used. Additionally, the following PowerCLI command may be used: # List all vSwitches, their Portgroups and VLAN IDs Get-VirtualPortGroup -Standard | Select virtualSwitch, Name, VlanID Page | 62",
    "remediation": "If the default value of 1 for the native VLAN is being used, the ESXi Server virtual switch port groups should be configured with any value between 2 and 4094. Otherwise, ensure that the port group is not configured to use whatever value is set for the native VLAN.  1. From the vSphere web client select the host. 2. On the Manage tab, click Networking, and select Virtual switches. 3. Select a standard switch from the list. 4. The topology diagram of the switch appears showing the various port groups associated with that switch. 5. For each port group on the vSwitch, verify and record the VLAN IDs used. 6. If a VLAN ID change is needed click the name of the port group in the topology diagram of the virtual switch. 7. Click the \"Edit settings\" pencil icon under the topology diagram title. 8. In the Properties section, name the port group in the Network Label text field. 9. Choose an existing VLAN ID drop-down menu or type in a new one.   References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vcli.migration.doc/cos_upgrade_technote.1.9.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.networking.doc/GUID-3A9D9911-3632-4B81- 9D2E-A2F9F2D01180.html",
    "function_names": [
      "network_port_group_native_vlan_disabled",
      "network_port_group_non_default_vlan_id",
      "network_port_group_vlan_id_not_one",
      "network_port_group_secure_vlan_configuration",
      "network_port_group_native_vlan_restricted"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vcli.migration.doc/cos_upgrade_technote.1.9.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.networking.doc/GUID-3A9D9911-3632-4B81- 9D2E-A2F9F2D01180.html"
  },
  {
    "id": "7.5",
    "title": "Ensure that port groups are not configured to VLAN values reserved by upstream physical switches",
    "assessment": "Not Scored",
    "description": "Ensure that port groups are not configured to VLAN values reserved by upstream physical switches.",
    "rationale": "Page | 63 Certain physical switches reserve certain VLAN IDs for internal purposes and often disallow traffic configured to these values. For example, Cisco Catalyst switches typically reserve VLANs 1001 through 1024 and 4094, while Nexus switches typically reserve 3968 through 4047 and 4094. Check with the documentation for your specific switch. Using a reserved VLAN might result in a denial of service on the network.",
    "audit": "VLAN ID setting on all port groups should not be set to reserved values of the physical switch.  1. From the vSphere web client select the host. 2. On the Manage tab, click Networking, and select Virtual switches. 3. Select a standard switch from the list. 4. The topology diagram of the switch appears showing the various port groups associated with that switch. 5. For each port group on the vSwitch, verify and record the VLAN IDs used. Additionally, the following PowerCLI command may be used: # List all vSwitches, their Portgroups and VLAN IDs Get-VirtualPortGroup -Standard | Select virtualSwitch, Name, VlanID",
    "remediation": "VLAN ID setting on all port groups should not be set to reserved values of the physical switch. 1. From the vSphere web client select the host. 2. On the Manage tab, click Networking, and select Virtual switches. 3. Select a standard switch from the list. 4. The topology diagram of the switch appears showing the various port groups associated with that switch. 5. For each port group on the vSwitch, verify and record the VLAN IDs used. 6. If a VLAN ID change is needed click the name of the port group in the topology diagram of the virtual switch. 7. Click the \"Edit settings\" pencil icon under the topology diagram title. 8. In the Properties section, name the port group in the Network Label text field. 9. Choose an existing VLAN ID drop-down menu or type in a new one. References: Page | 64 1. http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12- 2/20ew/configuration/guide/config/vlans.html#wp1038758 2. http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5500/sw/laye r2/7x/b_5500_Layer2_Config_7x/b_5500_Layer2_Config_7x_chapter_010.html#con_ 1143823",
    "function_names": [
      "compute_port_group_reserved_vlan_avoided",
      "compute_port_group_vlan_reserved_avoided",
      "compute_port_group_vlan_conflict_avoided",
      "compute_port_group_vlan_upstream_avoided",
      "compute_port_group_vlan_physical_avoided"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "Page | 64 1. http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12- 2/20ew/configuration/guide/config/vlans.html#wp1038758 2. http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5500/sw/laye r2/7x/b_5500_Layer2_Config_7x/b_5500_Layer2_Config_7x_chapter_010.html#con_ 1143823"
  },
  {
    "id": "7.6",
    "title": "Ensure that port groups are not configured to VLAN 4095 except for Virtual Guest Tagging (VGT)",
    "assessment": "Scored",
    "description": "Don't use VLAN 4095 except for Virtual Guest Tagging (VGT).",
    "rationale": "When a port group is set to VLAN 4095, this activates VGT mode. In this mode, the vSwitch passes all network frames to the guest VM without modifying the VLAN tags, leaving it up to the guest to deal with them. VLAN 4095 should be used only if the guest has been specifically configured to manage VLAN tags itself. If VGT is enabled inappropriately, it might cause denial of service or allow a guest VM to interact with traffic on an unauthorized VLAN.",
    "audit": "VLAN ID setting on all port groups should not be set to 4095 unless VGT is required.  1. From the vSphere web client select the host. 2. On the Manage tab, click Networking, and select Virtual switches. 3. Select a standard switch from the list. 4. The topology diagram of the switch appears showing the various port groups associated with that switch. 5. For each port group on the vSwitch, verify and record the VLAN IDs used. Additionally, the following PowerCLI command may be used: # List all vSwitches, their Portgroups and VLAN IDs Get-VirtualPortGroup -Standard | Select virtualSwitch, Name, VlanID Page | 65",
    "remediation": "VLAN ID setting on all port groups should not be set to 4095 unless VGT is required. 1. From the vSphere web client select the host. 2. On the Manage tab, click Networking, and select Virtual switches. 3. Select a standard switch from the list. 4. The topology diagram of the switch appears showing the various port groups associated with that switch. 5. For each port group on the vSwitch, verify and record the VLAN IDs used. 6. If a VLAN ID change is needed click the name of the port group in the topology diagram of the virtual switch. 7. Click the \"Edit settings\" pencil icon under the topology diagram title. 8. In the Properties section, name the port group in the Network Label text field. 9. Choose an existing VLAN ID drop-down menu or type in a new one. References: 1. http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12- 2/20ew/configuration/guide/config/vlans.html#wp1038758  Page | 66 8 Virtual Machines This section contains recommendations for settings related to guest virtual machines. 8.1 Communication",
    "function_names": [
      "compute_port_group_vlan_not_4095",
      "compute_port_group_vgt_vlan_4095_only",
      "compute_port_group_vlan_restricted",
      "compute_port_group_vgt_vlan_4095_allowed",
      "compute_port_group_vlan_4095_prohibited"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12- 2/20ew/configuration/guide/config/vlans.html#wp1038758  Page | 66 8 Virtual Machines This section contains recommendations for settings related to guest virtual machines. 8.1 Communication"
  },
  {
    "id": "8.1.1",
    "title": "Limit informational messages from the VM to the VMX file",
    "assessment": "Scored",
    "description": "Limit informational messages from the virtual machine to the VMX file to avoid filling the datastore and causing a Denial of Service (DoS).",
    "rationale": "The configuration file containing these name-value pairs is limited to a size of 1MB. This 1MB capacity should be sufficient for most cases, but you can change this value if necessary. You might increase this value if large amounts of custom information are being stored in the configuration file. The default limit is 1MB; this limit is applied even when the sizeLimit parameter is not listed in the .vmx file. Uncontrolled size for the VMX file can lead to denial of service if the datastore is filled.",
    "audit": "Check virtual machine configuration file and verify that tools.setInfo.sizeLimit is set to 1048576. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"tools.setInfo.sizeLimit\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"tools.setInfo.sizeLimit\" -value 1048576 Page | 67 Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_vm_informational_messages_limited",
      "compute_vm_vmx_file_logging_restricted",
      "compute_vm_datastore_dos_protection_enabled",
      "compute_vm_logging_threshold_enforced",
      "compute_vmx_file_message_limit_set"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html"
  },
  {
    "id": "8.1.2",
    "title": "Limit sharing of console connections",
    "assessment": "Scored",
    "description": "Limit the max number of console connections to prevent non-administrators from observing the VMs screen.",
    "rationale": "By default, remote console sessions can be connected to by more than one user at a time. When multiple sessions are activated, each terminal window gets a notification about the new session. If an administrator in the VM logs in using a VMware remote console during their session, a non-administrator in the VM can connect to the console and observe the administrator's actions. Also, this could result in an administrator losing console access to a virtual machine. For example, if a jump box is being used for an open console session, and the admin loses connection to that box, then the console session remains open. Allowing two console sessions permits debugging via a shared session. For highest security, only one remote console session at a time should be allowed.",
    "audit": "Check virtual machine configuration file and verify that RemoteDisplay.maxConnections is set to 1. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"RemoteDisplay.maxConnections\" | Select Entity, Name, Value",
    "remediation": "Page | 68 To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"RemoteDisplay.maxConnections\" -value 1 Impact: Only one remote console connection to the VM will be permitted. Other attempts will be rejected until the first session disconnects. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vcli.examples.doc/cli_manage_vms.10.4.html 2. http://www.ibenit.com/post/85227299008/security-benchmark-hardening-guide- policies-and-profile  Page | 69 8.2 Devices",
    "function_names": [
      "compute_vm_console_connection_limit",
      "compute_vm_console_sharing_disabled",
      "compute_vm_console_access_restricted",
      "compute_vm_console_session_limit",
      "compute_vm_console_observation_prevented"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Only one remote console connection to the VM will be permitted. Other attempts will be rejected until the first session disconnects. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vcli.examples.doc/cli_manage_vms.10.4.html 2. http://www.ibenit.com/post/85227299008/security-benchmark-hardening-guide- policies-and-profile  Page | 69 8.2 Devices"
  },
  {
    "id": "8.2.1",
    "title": "Disconnect unauthorized devices - Floppy Devices",
    "assessment": "Scored",
    "description": "Any enabled or connected device represents a potential attack channel. Users and processes without privileges on a virtual machine can connect or disconnect hardware devices, such as network adapters and CD-ROM drives. Attackers can use this capability to breach virtual machine security. Removing unnecessary hardware devices can help prevent attacks.",
    "rationale": "Ensure that no device is connected to a virtual machine if it is not required. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE.  NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel.",
    "audit": "The following parameters should either NOT be present or should be set to FALSE, unless Floppy drives are required: floppyX.present  Additionally, the following PowerCLI command may be used: # Check for Floppy Devices attached to VMs Get-VM | Get-FloppyDrive | Select Parent, Name, ConnectionState",
    "remediation": "Page | 70 To implement the recommended configuration state, run the following PowerCLI command: # Remove all Floppy drives attached to VMs Get-VM | Get-FloppyDrive | Remove-FloppyDrive Impact: Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "function_names": [
      "compute_vm_floppy_disabled",
      "compute_vm_unauthorized_devices_disconnected",
      "compute_vm_floppy_device_removed",
      "compute_vm_external_devices_restricted",
      "compute_vm_floppy_attachment_blocked",
      "compute_vm_hardware_devices_minimized",
      "compute_vm_floppy_access_denied",
      "compute_vm_unnecessary_devices_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html"
  },
  {
    "id": "8.2.2",
    "title": "Disconnect unauthorized devices - CD/DVD Devices",
    "assessment": "Scored",
    "description": "Any enabled or connected device represents a potential attack channel. Users and processes without privileges on a virtual machine can connect or disconnect hardware devices, such as network adapters and CD-ROM drives. Attackers can use this capability to breach virtual machine security. Removing unnecessary hardware devices can help prevent attacks.",
    "rationale": "Ensure that no device is connected to a virtual machine if it is not required. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE. Page | 71 NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel.",
    "audit": "The following parameters should either NOT be present or should be set to FALSE, unless CD-ROM is required: ideX:Y.present  Additionally, the following PowerCLI command may be used: # Check for CD/DVD Drives attached to VMs Get-VM | Get-CDDrive",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Remove all CD/DVD Drives attached to VMs Get-VM | Get-CDDrive | Remove-CDDrive Impact: Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "function_names": [
      "compute_vm_cd_dvd_disabled",
      "compute_vm_unauthorized_devices_disconnected",
      "compute_vm_removable_media_restricted",
      "compute_vm_hardware_devices_minimized",
      "compute_vm_external_media_blocked",
      "compute_vm_device_attachments_audited",
      "compute_vm_physical_media_disabled",
      "compute_vm_unnecessary_hardware_removed"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html"
  },
  {
    "id": "8.2.3",
    "title": "Disconnect unauthorized devices - Parallel Devices",
    "assessment": "Scored",
    "description": "Page | 72 Any enabled or connected device represents a potential attack channel. Users and processes without privileges on a virtual machine can connect or disconnect hardware devices, such as network adapters and CD-ROM drives. Attackers can use this capability to breach virtual machine security. Removing unnecessary hardware devices can help prevent attacks.",
    "rationale": "Ensure that no device is connected to a virtual machine if it is not required. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE.  NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel.",
    "audit": "The following parameters should either NOT be present or should be set to FALSE, unless Parallel ports are required: parallelX.present  Additionally, the following PowerCLI command may be used: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html # Check for Parallel ports attached to VMs Get-VM | Get-ParallelPort",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html # Remove all Parallel Ports attached to VMs Get-VM | Get-ParallelPort | Remove-ParallelPort Impact: Page | 73 Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "function_names": [
      "compute_vm_unauthorized_devices_disconnected",
      "compute_vm_parallel_devices_disabled",
      "compute_vm_hardware_devices_restricted",
      "compute_vm_network_adapters_removed",
      "compute_vm_cd_rom_drives_disabled",
      "compute_vm_device_connection_restricted",
      "compute_vm_unnecessary_devices_removed",
      "compute_vm_attack_surface_reduced"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Page | 73 Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html"
  },
  {
    "id": "8.2.4",
    "title": "Disconnect unauthorized devices - Serial Devices",
    "assessment": "Scored",
    "description": "Any enabled or connected device represents a potential attack channel. Users and processes without privileges on a virtual machine can connect or disconnect hardware devices, such as network adapters and CD-ROM drives. Attackers can use this capability to breach virtual machine security. Removing unnecessary hardware devices can help prevent attacks.",
    "rationale": "Ensure that no device is connected to a virtual machine if it is not required. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE.  NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel.",
    "audit": "Page | 74 The following parameters should either NOT be present or should be set to FALSE, unless Serial ports are required: serialX.present  Additionally, the following PowerCLI command may be used: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html # Check for Serial ports attached to VMs Get-VM | Get-SerialPort",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in-powercli.html # Remove all Serial Ports attached to VMs Get-VM | Get-SerialPort | Remove-SerialPort Impact: Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "function_names": [
      "compute_vm_serial_device_disabled",
      "compute_vm_unauthorized_device_disconnected",
      "compute_vm_serial_port_restricted",
      "compute_vm_hardware_device_minimized",
      "compute_vm_device_privileges_restricted"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html"
  },
  {
    "id": "8.2.5",
    "title": "Disconnect unauthorized devices - USB Devices",
    "assessment": "Scored",
    "description": "Any enabled or connected device represents a potential attack channel. Users and processes without privileges on a virtual machine can connect or disconnect hardware devices, such as network adapters and CD-ROM drives. Attackers can use this capability to Page | 75 breach virtual machine security. Removing unnecessary hardware devices can help prevent attacks.",
    "rationale": "Ensure that no device is connected to a virtual machine if it is not required. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE.  NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel.",
    "audit": "The following parameters should either NOT be present or should be set to FALSE, unless USB controllers are required: usb.present  Additionally, the following PowerCLI command may be used: # Check for USB Devices attached to VMs Get-VM | Get-USBDevice",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Remove all USB Devices attached to VMs Get-VM | Get-USBDevice | Remove-USBDevice Impact: Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state. References: Page | 76 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html",
    "function_names": [
      "compute_vm_unauthorized_usb_disconnected",
      "compute_vm_hardware_device_restricted",
      "compute_vm_unnecessary_devices_removed",
      "compute_vm_usb_device_disabled",
      "compute_vm_peripheral_access_controlled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Virtual machine will need to be powered off to reverse change if any of these devices are needed at a later time. Default Value: The prescribed state is not the default state.",
    "references": "Page | 76 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-822B2ED3-D8D2-4F57-8335- CA46E915A729.html"
  },
  {
    "id": "8.2.6",
    "title": "Prevent unauthorized removal and modification of devices.",
    "assessment": "Scored",
    "description": "Prevent unauthorized removal and modification of devices.",
    "rationale": "In a virtual machine, users and processes without root or administrator privileges can connect or disconnect devices, such as network adaptors and CD-ROM drives, and can modify device settings. Use the virtual machine settings editor or configuration editor to remove unneeded or unused hardware devices. If you want to use the device again, you can prevent a user or running process in the virtual machine from connecting, disconnecting, or modifying a device from within the guest operating system. By default, a rogue user with nonadministrator privileges in a virtual machine can: \u2022 - Connect a disconnected CD-ROM drive and access sensitive information on the media left in the drive - Disconnect a network adaptor to isolate the virtual machine from its network, which is a denial of service - Modify settings on a device",
    "audit": "Check virtual machine configuration file and verify that isolation.device.edit.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.device.edit.disable\" | Select Entity, Name, Value",
    "remediation": "Page | 77 To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.device.edit.disable\" -value $true Impact: Device interaction is blocked inside the guest OS using VMware tools. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9-A168- C62D9306DBD6.html",
    "function_names": [
      "compute_device_removal_restricted",
      "compute_device_modification_restricted",
      "compute_device_immutable_config",
      "compute_device_protection_enabled",
      "compute_device_tamper_proofing_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Device interaction is blocked inside the guest OS using VMware tools. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9-A168- C62D9306DBD6.html"
  },
  {
    "id": "8.2.7",
    "title": "Prevent unauthorized connection of devices.",
    "assessment": "Scored",
    "description": "Prevent unauthorized connection of devices.",
    "rationale": "In a virtual machine, users and processes without root or administrator privileges can connect or disconnect devices, such as network adaptors and CD-ROM drives, and can modify device settings. Use the virtual machine settings editor or configuration editor to remove unneeded or unused hardware devices. If you want to use the device again, you can prevent a user or running process in the virtual machine from connecting, disconnecting, or modifying a device from within the guest operating system. By default, a rogue user with non-administrator privileges in a virtual machine can: \u2022 \uf0b7 Connect a disconnected CD-ROM drive and access sensitive information on the media left in the drive Page | 78 \uf0b7 Disconnect a network adaptor to isolate the virtual machine from its network, which is a denial of service \uf0b7 Modify settings on a device",
    "audit": "Check virtual machine configuration file and verify that isolation.device.connectable.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.device.connectable.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.device.connectable.disable\" -value $true Impact: Device interaction is blocked inside the guest OS using VMware tools Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9-A168- C62D9306DBD6.html  Page | 79 8.3 Guest",
    "function_names": [
      "compute_instance_unauthorized_device_connection_prevented",
      "network_interface_unauthorized_device_blocked",
      "device_management_unauthorized_connection_restricted",
      "endpoint_unauthorized_device_access_denied",
      "security_group_unauthorized_device_traffic_blocked",
      "firewall_unauthorized_device_connection_prevented",
      "vpc_unauthorized_device_connection_restricted",
      "cloud_cdn_unauthorized_device_access_blocked"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Device interaction is blocked inside the guest OS using VMware tools Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9-A168- C62D9306DBD6.html  Page | 79 8.3 Guest"
  },
  {
    "id": "8.3.1",
    "title": "Disable unnecessary or superfluous functions inside VMs",
    "assessment": "Not Scored",
    "description": "Reduce the number of potential attack vectors by disabling unnecessary system components that are not needed to support the application or service running on the virtual machine.",
    "rationale": "By disabling unnecessary system components that are not needed to support the application or service running on the system, you reduce the number of parts that can be attacked. VMs often don't require as many services or functions as ordinary physical servers; so when virtualizing, you should evaluate whether a particular service or function is truly needed. Any service running in a VM provides a potential avenue of attack.",
    "audit": "Verify the following are disabled: 1. Unused services in the operating system. For example, if the system runs a file server, make sure to turn off any Web services. 2. Unused physical devices, such as CD/DVD drives, floppy drives, and USB adaptors. This is described in the Removing Unnecessary Hardware Devices section in the ESXI Configuration Guide. 3. Screen savers. X-Windows if using a Linux, BSD, or Solaris guest operating system.",
    "remediation": "Some of these steps include: 1. Disable unused services in the operating system. For example, if the system runs a file server, make sure to turn off any Web services. 2. Disconnect unused physical devices, such as CD/DVD drives, floppy drives, and USB adaptors. This is described in the Removing Unnecessary Hardware Devices section in the ESXI Configuration Guide. Page | 80 3. Turn off any screen savers. If using a Linux, BSD, or Solaris guest operating system, do not run the X Window system unless it is necessary. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-6BFA8CA7-610F-4E6B-9FC6- D656917B7E7A.html",
    "function_names": [
      "compute_vm_unnecessary_functions_disabled",
      "compute_vm_superfluous_components_disabled",
      "compute_vm_attack_vectors_reduced",
      "compute_vm_unused_services_disabled",
      "compute_vm_nonessential_functions_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-6BFA8CA7-610F-4E6B-9FC6- D656917B7E7A.html"
  },
  {
    "id": "8.3.2",
    "title": "Minimize use of the VM console",
    "assessment": "Not Scored",
    "description": "Grant access to the Virtual Machine console only when needed. Use custom roles to provide fine grained permissions.",
    "rationale": "The VM console enables you to connect to the console of a virtual machine, in effect seeing what a monitor on a physical server would show. The VM console also provides power management and removable device connectivity controls, which might potentially allow a malicious user to bring down a virtual machine. In addition, it also has a performance impact on the service console, especially if many VM console sessions are open simultaneously.",
    "audit": "Instead of VM console, use native remote management services, such as terminal services and ssh, to interact with virtual machines. Grant VM console access only when necessary. 1. From the vSphere Client, select an object in the inventory. 2. Click the Permissions tab to view the user and role pair assignments for that object. 3. Next, navigate to Administration\\Roles section of vCenter. 4. Select the role in question and choose edit to see which effective privileges are enabled. 5. Only Authorized users should have a role which allows them a privilege under the Virtual Machine\\Interaction section of the role editor.",
    "remediation": "Page | 81 By default the vCenter roles \"Virtual Machine Power User\" and \"Virtual Machine Administrator\" have the \"Virtual Machine.Interaction.Console Interaction\" privilege. Do not allow unauthorized individuals to have these roles on a virtual machine or folder of virtual machines. 1. From the vSphere Client, navigate to Administration\\Roles section of vCenter. 2. Create a custom role and choose edit to enable only the minimum needed effective privileges. 3. Next, select an object in the inventory. 4. Click the Permissions tab to view the user and role pair assignments for that object. 5. Remove any default \"Admin\" or \"Power User\" roles and assign the new custom role as needed. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-41E5E52E-A95B-4E81-9724- 6AD6800BEF78.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-3D47149A-947D-4608-88B3- E5811129EFA8.html",
    "function_names": [
      "compute_vm_console_access_restricted",
      "compute_vm_custom_role_required",
      "compute_vm_console_access_minimized",
      "iam_role_vm_console_permissions_fine_grained",
      "compute_vm_console_access_just_in_time"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-41E5E52E-A95B-4E81-9724- 6AD6800BEF78.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-3D47149A-947D-4608-88B3- E5811129EFA8.html"
  },
  {
    "id": "8.3.3",
    "title": "Use secure protocols for virtual serial port access",
    "assessment": "Not Scored",
    "description": "Virtual serial ports allow virtual machines to communicate over the network. Doing so allows you to redirect the virtual serial port connection to a TCP/IP connection on the ESXi host. If virtual serial ports are needed be sure they are configured to use secure protocols.",
    "rationale": "Serial ports are interfaces for connecting peripherals to the virtual machine. They are often used on physical systems to provide a direct, low-level connection to the console of a server. Serial ports allow for debug level access, which often does not have strong controls like logging or privileges. Page | 82",
    "audit": "Check that no clear text protocols are configured: \uf0b7 tcp - an unencrypted TCP connection (IPv4 or IPv6) \uf0b7 tcp4 - an unencrypted TCP connection (IPv4 only) \uf0b7 tcp6 - an unencrypted TCP connection (IPv6 only) \uf0b7 telnet telnet over TCP without SSL. The virtual machine and remote system can negotiate and use SSL if the remote system supports the telnet authentication option. If not, the connection uses unencrypted text (plain text) Only these secure protocols should be configured: \uf0b7 ssl - the equivalent of TCP+SSL \uf0b7 tcp+ssl - SSL over TCP over IPv4 or IPv6 \uf0b7 tcp4+ssl - SSL over TCP over IPv4 \uf0b7 tcp6+ssl - SSL over TCP over IPv6 \uf0b7 telnet over TCP with SSL. The virtual machine and remote system can negotiate and use SSL if the remote system supports the telnet authentication option. If not, the connection uses unencrypted text (plain text) \uf0b7 telnets - telnet over SSL over TCP. In this case, SSL negotiation begins immediately and you cannot use the telnet authentication option.",
    "remediation": "Configuring Virtual Serial Port Communications with Secure Network Protocols: \uf0b7 ssl - the equivalent of TCP+SSL \uf0b7 tcp+ssl - SSL over TCP over IPv4 or IPv6 \uf0b7 tcp4+ssl - SSL over TCP over IPv4 \uf0b7 tcp6+ssl - SSL over TCP over IPv6 \uf0b7 telnet over TCP with SSL. The virtual machine and remote system can negotiate and use SSL if the remote system supports the telnet authentication option. If not, the connection uses unencrypted text (plain text) \uf0b7 telnets - telnet over SSL over TCP. In this case, SSL negotiation begins immediately and you cannot use the telnet authentication option.  References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.wssdk.apiref.doc/vim.vm.device.VirtualSerialPort.URIBackin gInfo.html Page | 83 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.wssdk.vsp.doc/virtual_serial_port_using_proxy_Chapter1.3.2. html 3. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-462B8B04-29DF-406B-9585- 12D2588A6A48.html",
    "function_names": [
      "compute_virtual_serial_port_secure_protocol_enabled",
      "compute_serial_port_tcp_redirect_secure",
      "compute_vm_serial_port_encrypted_connection",
      "compute_serial_port_network_access_secure",
      "compute_virtual_serial_port_tls_enabled",
      "compute_serial_port_secure_communication",
      "compute_vm_serial_port_protocol_restricted",
      "compute_serial_port_secure_redirect_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.wssdk.apiref.doc/vim.vm.device.VirtualSerialPort.URIBackin gInfo.html Page | 83 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.wssdk.vsp.doc/virtual_serial_port_using_proxy_Chapter1.3.2. html 3. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-462B8B04-29DF-406B-9585- 12D2588A6A48.html"
  },
  {
    "id": "8.3.4",
    "title": "Use templates to deploy VMs whenever possible",
    "assessment": "Not Scored",
    "description": "Use a hardened base operating system template image to create other, application-specific templates and use the application-specific templates to deploy virtual machines.",
    "rationale": "By capturing a hardened base operating system image (with no applications installed) in a template, you can ensure that all your virtual machines are created with a known baseline level of security. You can then use this template to create other, application-specific templates, or you can use the application template to deploy virtual machines. Manual installation of the OS and applications into a VM introduces the risk of misconfiguration due to human or process error.",
    "audit": "Verify that new virtual machine deployments are completed using hardened, patched, and properly configured OS templates.",
    "remediation": "Provide templates for VM creation that contain hardened, patched, and properly configured OS deployments. If possible, pre-deploy applications in templates as well, although care should be taken that the application doesn't depend upon VM-specific information to be deployed. In vSphere, you can convert a template to a virtual machine and back again quickly, which makes updating templates quite easy. Impact: Ensure that the applications do not depend on information specific to the virtual machine to be deployed. Page | 84 References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-8254CD05-CC06-491D-BA56- A773A32A8130.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-3399BC47-45E8-494B-9B57- E498DD294A47.html 8.4 Monitor",
    "function_names": [
      "compute_vm_template_used",
      "compute_vm_hardened_base_image",
      "compute_vm_application_template_used",
      "compute_vm_deployment_from_template",
      "compute_image_hardened_base_required",
      "compute_template_application_specific",
      "compute_vm_template_compliance",
      "compute_image_standardized_deployment"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Ensure that the applications do not depend on information specific to the virtual machine to be deployed. Page | 84",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-8254CD05-CC06-491D-BA56- A773A32A8130.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-3399BC47-45E8-494B-9B57- E498DD294A47.html 8.4 Monitor"
  },
  {
    "id": "8.4.1",
    "title": "Control access to VMs through the dvfilter network APIs",
    "assessment": "Not Scored",
    "description": "Configure VMs protected by dvfilter network APIs correctly.",
    "rationale": "A VM must be configured explicitly to accept access by the dvfilter network API. Only configure VMs that will be specifically accessed by the API. An attacker might compromise a VM by making use the dvFilter API.",
    "audit": "If a VM is supposed to be protected: \uf0b7 Verify that the following in its VMX file: ethernet0.filter1.name = dv- filter1 where ethernet0 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and dv- filter1 is the name of the particular data path kernel module that is protecting the VM. \uf0b7 Ensure that the name of the data path kernel is set correctly. If a VM is not supposed to be protected: \uf0b7 Verify that the following is not in its VMX file: ethernet0.filter1.name = dv- filter1 where ethernet0 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and dv- Page | 85 filter1 is the name of the particular data path kernel module that is protecting the VM.",
    "remediation": "If a VM is supposed to be protected: \uf0b7 Configure the following in its VMX file: ethernet0.filter1.name = dv- filter1 where ethernet0 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and dv- filter1 is the name of the particular data path kernel module that is protecting the VM. \uf0b7 Ensure that the name of the data path kernel is set correctly. If a VM is not supposed to be protected: \uf0b7 Remove the following from its VMX file: ethernet0.filter1.name = dv- filter1 where ethernet0 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and dv- filter1 is the name of the particular data path kernel module that is protecting the VM. Impact: Incorrectly configuring this option can negatively impact functionality of tools that use vmsafe API. It can also prevent VMs from connecting to the network.  Default Value: The prescribed state is the default state. References: 1. http://kb.vmware.com/kb/1714 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A-B821- ED17A77B0206.html",
    "function_names": [
      "compute_vm_dvfilter_api_access_controlled",
      "compute_vm_dvfilter_network_protected",
      "compute_vm_dvfilter_api_restricted",
      "compute_vm_network_api_access_secure",
      "compute_vm_dvfilter_security_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Incorrectly configuring this option can negatively impact functionality of tools that use vmsafe API. It can also prevent VMs from connecting to the network.  Default Value: The prescribed state is the default state.",
    "references": "1. http://kb.vmware.com/kb/1714 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A-B821- ED17A77B0206.html"
  },
  {
    "id": "8.4.2",
    "title": "Control VMsafe Agent Address",
    "assessment": "Not Scored",
    "description": "Configure the vmsafe.agentAddress option in the virtual machine configuration file correctly.",
    "rationale": "The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks. However, an attacker might compromise the VM by making use of this introspection channel; therefore you should monitor for unauthorized usage of this API. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters to perform the following: 1. Enable the API 2. Set the IP address used by the security virtual appliance on the introspection vSwitch 3. Set the port number for that IP address. If the VM is being protected by such a product, then make sure the latter two parameters are set correctly. This should be done only for specific VMs for which you want this protection.",
    "audit": "If the VM is not being protected by a VMsafe CPU/memory product, then check virtual machine configuration file and verify that vmsafe.agentAddress is not present. If it is being protected by a VMsafe CPU/Memory product then make sure the vmsafe.agentAddress is set to the correct value. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"vmsafe.agentAddress\" | Select Entity, Name, Value",
    "remediation": "If the VM is not being protected by a VMsafe CPU/memory product, then check virtual machine configuration file and verify that vmsafe.agentAddress is not present. Page | 87 If it is being protected by a VMsafe CPU/Memory product then make sure this is set to the correct value Impact: Incorrectly configuring this option can negatively impact functionality of tools that use VMsafe API. Default Value: The prescribed state is the default state. References: 1. http://kb.vmware.com/kb/1714 2. http://www.vmware.com/files/xls/HardeningGuide-vSphere5-5-Update-1-GA.xlsx",
    "function_names": [
      "compute_vm_vmsafe_agent_address_configured",
      "compute_vm_vmsafe_agent_address_valid",
      "compute_vm_vmsafe_agent_address_secure",
      "compute_vm_vmsafe_agent_address_restricted",
      "compute_vm_vmsafe_agent_address_compliant"
    ],
    "profile_applicability": "\uf0b7  Level 1 Page | 86",
    "impact": "Incorrectly configuring this option can negatively impact functionality of tools that use VMsafe API. Default Value: The prescribed state is the default state.",
    "references": "1. http://kb.vmware.com/kb/1714 2. http://www.vmware.com/files/xls/HardeningGuide-vSphere5-5-Update-1-GA.xlsx"
  },
  {
    "id": "8.4.3",
    "title": "Control VMsafe Agent Port",
    "assessment": "Not Scored",
    "description": "Configure the vmsafe.agentPort option in the virtual machine configuration file correctly.",
    "rationale": "The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks. However, an attacker might compromise the VM by making use of this introspection channel; therefore you should monitor for unauthorized usage of this API. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters to perform the following: 1. Enable the API 2. Set the IP address used by the security virtual appliance on the introspection vSwitch 3. Set the port number for that IP address. Page | 88 If the VM is being protected by such a product, then make sure the latter two parameters are set correctly. This should be done only for specific VMs for which you want this protection.",
    "audit": "If the VM is not being protected by a VMsafe CPU/memory product, then check virtual machine configuration file and verify that vmsafe.agentPort is not present. If it is being protect by a VMsafe CPU/Memory product, make sure this is set to the correct value Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"vmsafe.agentPort\"| Select Entity, Name, Value",
    "remediation": "If the VM is not being protected by a VMsafe CPU/memory product, then check virtual machine configuration file and verify that vmsafe.agentPort is not present. If it is being protect by a VMsafe CPU/Memory product, make sure vmsafe.agentPort is set to the correct value. Impact: Incorrectly configuring this option can negatively impact functionality of tools that use VMsafe API. Default Value: The prescribed state is the default state. References: 1. http://kb.vmware.com/kb/1714 2. http://www.vmware.com/files/xls/HardeningGuide-vSphere5-5-Update-1-GA.xlsx",
    "function_names": [
      "compute_virtual_machine_vmsafe_agent_port_configured",
      "compute_vm_vmsafe_agent_port_secure",
      "compute_vm_vmsafe_agent_port_valid",
      "compute_vm_vmsafe_agent_port_correct",
      "compute_vm_vmsafe_agent_port_compliant"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Incorrectly configuring this option can negatively impact functionality of tools that use VMsafe API. Default Value: The prescribed state is the default state.",
    "references": "1. http://kb.vmware.com/kb/1714 2. http://www.vmware.com/files/xls/HardeningGuide-vSphere5-5-Update-1-GA.xlsx"
  },
  {
    "id": "8.4.4",
    "title": "Control VMsafe Agent Configuration",
    "assessment": "Not Scored",
    "description": "Page | 89 Configure the vmsafe.enable option in the virtual machine configuration file correctly. It should either be non-existent or set to FALSE.",
    "rationale": "The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks. However, an attacker might compromise the VM by making use of this introspection channel; therefore you should monitor for unauthorized usage of this API. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters to perform the following: 1. Enable the API 2. Set the IP address used by the security virtual appliance on the introspection vSwitch 3. Set the port number for that IP address. If the VM is being protected by such a product, then make sure the latter two parameters are set correctly. This should be done only for specific VMs for which you want this protection.",
    "audit": "If the VM is not being protected by a VMsafe CPU/memory product, then check virtual machine configuration file and verify that vmsafe.enable is either not present, or set to FALSE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"vmsafe.enable\"| Select Entity, Name, Value",
    "remediation": "If the VM is not being protected by a VMsafe CPU/memory product, then check virtual machine configuration file and set vmsafe.enable to FALSE. Impact: Incorrectly configuring this option can negatively impact functionality of tools that use vmsafe API. Page | 90 Default Value: The prescribed state is the default state. References: 1. http://kb.vmware.com/kb/1714 2. http://www.vmware.com/files/xls/HardeningGuide-vSphere5-5-Update-1-GA.xlsx",
    "function_names": [
      "compute_virtual_machine_vmsafe_disabled",
      "compute_vm_vmsafe_agent_config_secure",
      "compute_vm_vmsafe_option_false_or_absent",
      "compute_vm_config_vmsafe_disabled",
      "compute_vm_vmsafe_setting_compliant"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Incorrectly configuring this option can negatively impact functionality of tools that use vmsafe API. Page | 90 Default Value: The prescribed state is the default state.",
    "references": "1. http://kb.vmware.com/kb/1714 2. http://www.vmware.com/files/xls/HardeningGuide-vSphere5-5-Update-1-GA.xlsx"
  },
  {
    "id": "8.4.5",
    "title": "Disable Autologon",
    "assessment": "Scored",
    "description": "Disable unneeded autologon to reduce the potential for vulnerabilities.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.ghi.autologon.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.ghi.autologon.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: Page | 91 # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.autologon.disable\" -value $true Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "windows_autologon_disabled",
      "windows_autologon_credentials_removed",
      "windows_autologon_registry_disabled",
      "windows_autologon_policy_disabled",
      "windows_autologon_feature_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.6",
    "title": "Disable BIOS BBS",
    "assessment": "Scored",
    "description": "Disable BIOS BBS to reduce the potential for vulnerabilities.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.bios.bbs.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.bios.bbs.disable\"| Select Entity, Name, Value",
    "remediation": "Page | 92 To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.bios.bbs.disable\" -value $true Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_instance_bios_bbs_disabled",
      "compute_vm_bios_bbs_disabled",
      "compute_bios_bbs_disabled",
      "compute_firmware_bbs_disabled",
      "compute_boot_security_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.7",
    "title": "Disable Guest Host Interaction Protocol Handler",
    "assessment": "Scored",
    "description": "Disable Guest Host Interaction Protocol Handle to reduce opportunity for vulnerabilities.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.ghi.protocolhandler.info.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.ghi.protocolhandler.info.disable\" | Select Entity, Name, Value Page | 93",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.protocolhandler.info.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_vm_guest_host_interaction_disabled",
      "compute_instance_guest_protocol_handler_disabled",
      "compute_vm_guest_interaction_protocol_disabled",
      "compute_vm_guest_host_communication_disabled",
      "compute_instance_guest_host_interaction_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.8",
    "title": "Disable Unity Taskbar",
    "assessment": "Scored",
    "description": "Disable unexposed Unity Taskbar feature.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Page | 94 Check virtual machine configuration file and verify that isolation.tools.unity.taskbar.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unity.taskbar.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unity.taskbar.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "desktop_unity_taskbar_disabled",
      "unity_taskbar_feature_disabled",
      "desktop_unity_taskbar_hidden",
      "unity_taskbar_unexposed_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.9",
    "title": "Disable Unity Active",
    "assessment": "Scored",
    "description": "Disable unexposed Unity Active feature.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features Page | 95 reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.unityActive.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unityActive.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unityActive.disable\" -value $True Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "unity_active_disabled",
      "unity_feature_unexposed_disabled",
      "unity_active_unexposed_disabled",
      "unity_active_feature_disabled",
      "unity_unexposed_feature_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html"
  },
  {
    "id": "8.4.10",
    "title": "Disable Unity Window Contents",
    "assessment": "Scored",
    "description": "Disable unexposed Unity Window Contents feature. Page | 96",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.unity.windowContents.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unity.windowContents.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unity.windowContents.disable\" - value $True Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html Page | 97",
    "function_names": [
      "unity_window_contents_disabled",
      "unity_unexposed_contents_disabled",
      "unity_window_contents_feature_disabled",
      "unity_window_contents_config_disabled",
      "unity_window_contents_security_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html Page | 97"
  },
  {
    "id": "8.4.11",
    "title": "Disable Unity Push Update",
    "assessment": "Scored",
    "description": "Disable unexposed Unity Push Update features",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.unity.push.update.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unity.push.update.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unity.push.update.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. Page | 98 References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "unity_push_update_disabled",
      "unity_feature_unexposed_disabled",
      "unity_push_update_unexposed_disabled",
      "unity_unexposed_features_disabled",
      "unity_push_update_restricted"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. Page | 98",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html"
  },
  {
    "id": "8.4.12",
    "title": "Disable Drag and Drop Version Get",
    "assessment": "Scored",
    "description": "Disable unexposed Drag and Drop Version Get feature.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.vmxDnDVersionGet.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.vmxDnDVersionGet.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: Page | 99 # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.vmxDnDVersionGet.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "cloud_cdn_distribution_drag_and_drop_disabled",
      "cloud_cdn_distribution_version_get_disabled",
      "cloud_cdn_distribution_unexposed_feature_disabled",
      "cloud_cdn_distribution_legacy_feature_disabled",
      "cloud_cdn_distribution_drag_and_drop_version_get_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html"
  },
  {
    "id": "8.4.13",
    "title": "Disable Drag and Drop Version Set",
    "assessment": "Scored",
    "description": "Disable unexposed Drag and Drop Version Set feature.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.guestDnDVersionSet.disable is set to TRUE. Additionally, the following PowerCLI command may be used: Page | 100 # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.guestDnDVersionSet.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.guestDnDVersionSet.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "cloud_cdn_distribution_drag_and_drop_disabled",
      "cloud_cdn_distribution_version_set_disabled",
      "cloud_cdn_distribution_unexposed_feature_disabled",
      "cloud_cdn_distribution_drag_and_drop_version_set_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html"
  },
  {
    "id": "8.4.14",
    "title": "Disable Shell Action",
    "assessment": "Scored",
    "description": "Disable unexposed Shell Action feature.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value. Page | 101",
    "audit": "Check virtual machine configuration file and verify that isolation.ghi.host.shellAction.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.ghi.host.shellAction.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.ghi.host.shellAction.disable\" -value $true Impact: Some automated tools and process may cease to function Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "cloud_shell_shell_action_disabled",
      "cloud_shell_unexposed_feature_disabled",
      "cloud_shell_shell_access_restricted",
      "cloud_shell_shell_action_restricted",
      "cloud_shell_shell_feature_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.15",
    "title": "Disable Request Disk Topology",
    "assessment": "Scored",
    "description": "Disable unexposed Request Disk Topology feature.",
    "rationale": "Page | 102 Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.dispTopoRequest.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.dispTopoRequest.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.dispTopoRequest.disable\" -value $true Impact: Some automated tools and process may cease to function Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.16",
    "title": "Disable Trash Folder State",
    "assessment": "Scored",
    "description": "Disable unexposed Trash Folder State feature.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.trashFolderState.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.trashFolderState.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.trashFolderState.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: Page | 104 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "cloud_storage_bucket_trash_disabled",
      "cloud_storage_bucket_trash_folder_disabled",
      "cloud_storage_bucket_unexposed_trash_disabled",
      "cloud_storage_bucket_trash_state_disabled",
      "cloud_storage_bucket_trash_feature_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "Page | 104 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.17",
    "title": "Disable Guest Host Interaction Tray Icon",
    "assessment": "Scored",
    "description": "Disable unexposed Guest Host Interaction Tray Icon feature.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.ghi.trayicon.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.ghi.trayicon.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.trayicon.disable\" -value $true Page | 105 Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_vm_guest_host_interaction_disabled",
      "compute_vm_tray_icon_disabled",
      "compute_vm_guest_interaction_disabled",
      "compute_vm_host_interaction_disabled",
      "compute_vm_guest_host_tray_icon_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.18",
    "title": "Disable Unity",
    "assessment": "Scored",
    "description": "Disable unexposed Unity feature.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The codepaths for these features is not implementing in ESX. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are documented for customers that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.unity.disable is set to TRUE. Additionally, the following PowerCLI command may be used: Page | 106 # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unity.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unity.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "unity_feature_disabled",
      "unity_unexposed_feature_disabled",
      "unity_unused_feature_disabled",
      "unity_service_disabled",
      "unity_component_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html"
  },
  {
    "id": "8.4.19",
    "title": "Disable Unity Interlock",
    "assessment": "Scored",
    "description": "Disable unexposed Unity Interlock feature.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any Page | 107 documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.unityInterlockOperation.disable is set to TRUE.  Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unityInterlockOperation.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unityInterlockOperation.disable\" - value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "unity_interlock_disabled",
      "unity_feature_unexposed",
      "unity_interlock_unexposed",
      "unity_unexposed_feature_disabled",
      "unity_interlock_feature_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.20",
    "title": "Disable GetCreds",
    "assessment": "Scored",
    "description": "Disable unexposed GetCreds feature.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.getCreds.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.getCreds.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.getCreds.disable\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html Page | 109 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "iam_role_getcreds_disabled",
      "iam_role_unexposed_feature_disabled",
      "iam_role_credential_retrieval_disabled",
      "iam_role_getcreds_feature_disabled",
      "iam_role_secure_credential_access_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2 Page | 108",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html Page | 109 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.21",
    "title": "Disable Host Guest File System Server",
    "assessment": "Scored",
    "description": "Disable unexposed Host Guest File System Server.",
    "rationale": "Certain automated operations such as automated tools upgrades use a component into the hypervisor called Host Guest File System (HGFS) and an attacker could potentially use this to transfer files inside the guest OS. These VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.hgfsServerSet.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.hgfsServerSet.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.hgfsServerSet.disable\" -value $true Page | 110 Impact: This will cause the VMX process to not respond to commands from the tools process. It may also have a negative impact on operations such as automated tools upgrades. Setting isolation.tools.hgfsServerSet.disable to TRUE disables the registration of the guest's HGFS server with the host. APIs that use HGFS to transfer files to and from the guest operating system, such as some VIX commands or the VMware Tools auto-upgrade utility, will not function. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_vm_host_guest_file_system_disabled",
      "compute_instance_host_guest_file_system_disabled",
      "compute_virtual_machine_host_guest_file_system_disabled",
      "compute_vm_host_guest_fs_server_disabled",
      "compute_instance_host_guest_fs_server_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "This will cause the VMX process to not respond to commands from the tools process. It may also have a negative impact on operations such as automated tools upgrades. Setting isolation.tools.hgfsServerSet.disable to TRUE disables the registration of the guest's HGFS server with the host. APIs that use HGFS to transfer files to and from the guest operating system, such as some VIX commands or the VMware Tools auto-upgrade utility, will not function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html"
  },
  {
    "id": "8.4.22",
    "title": "Disable Guest Host Interaction Launch Menu",
    "assessment": "Scored",
    "description": "Disable unexposed Guest Host Interaction Launch Menu feature.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Page | 111 Check virtual machine configuration file and verify that isolation.tools.ghi.launchmenu.change is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.ghi.launchmenu.change\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.launchmenu.change\" -value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_vm_guest_host_interaction_disabled",
      "compute_vm_launch_menu_disabled",
      "compute_vm_unexposed_features_disabled",
      "compute_vm_guest_interaction_restricted",
      "compute_vm_host_interaction_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. https://pubs.vmware.com/vsphere- 51/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.23",
    "title": "Disable memSchedFakeSampleStats",
    "assessment": "Scored",
    "description": "Disable unexposed memSchedFakeSampleStats feature.",
    "rationale": "Page | 112 Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.memSchedFakeSampleStats.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.memSchedFakeSampleStats.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.memSchedFakeSampleStats.disable\" - value $true Impact: Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_vm_memsched_fake_sample_stats_disabled",
      "compute_instance_memsched_fake_sample_stats_disabled",
      "compute_node_memsched_fake_sample_stats_disabled",
      "compute_cluster_memsched_fake_sample_stats_disabled",
      "compute_host_memsched_fake_sample_stats_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Some automated tools and process may cease to function. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.24",
    "title": "Disable VM Console Copy operations",
    "assessment": "Scored",
    "description": "Disable VM console copy and paste operations.",
    "rationale": "Copy and paste operations are disabled by default; however, by explicitly disabling this feature, it will enable audit controls to check that this setting is correct.",
    "audit": "Check virtual machine configuration and verify that isolation.tools.copy.disable option is missing or set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.copy.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.copy.disable\" -value $true Impact: This is the default setting so functionality remains the same. If you require copy and paste operations, you must enable them using the vSphere Client. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3-AA05- 85033136A667.html Page | 114 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_vm_console_copy_disabled",
      "compute_vm_clipboard_disabled",
      "compute_vm_console_operations_restricted",
      "compute_vm_console_copy_paste_disabled",
      "compute_vm_console_clipboard_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "This is the default setting so functionality remains the same. If you require copy and paste operations, you must enable them using the vSphere Client. Default Value: The prescribed state is the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3-AA05- 85033136A667.html Page | 114 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html"
  },
  {
    "id": "8.4.25",
    "title": "Disable VM Console Drag and Drop operations",
    "assessment": "Scored",
    "description": "Disable VM Console Drag and Drop operations.",
    "rationale": "Copy and paste operations are disabled by default; however, by explicitly disabling this feature, it will enable audit controls to check that this setting is correct.",
    "audit": "Check virtual machine configuration and verify that isolation.tools.dnd.disable is missing or set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.dnd.disable\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.dnd.disable\" -value $true Impact: This is the default setting so functionality remains the same. Default Value: The prescribed state is the default state. References: Page | 115 1. http://pubs.vmware.com/vsphere- 50/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "function_names": [
      "compute_vm_console_drag_and_drop_disabled",
      "compute_vm_console_file_transfer_disabled",
      "compute_vm_console_clipboard_disabled",
      "compute_vm_console_guest_operations_disabled",
      "compute_vm_console_serial_port_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "This is the default setting so functionality remains the same. Default Value: The prescribed state is the default state.",
    "references": "Page | 115 1. http://pubs.vmware.com/vsphere- 50/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html"
  },
  {
    "id": "8.4.26",
    "title": "Disable VM Console GUI Options",
    "assessment": "Scored",
    "description": "Disable VM Console and Paste GUI Options.",
    "rationale": "Copy and paste operations are disabled by default; however, by explicitly disabling this feature, it will enable audit controls to check that this setting is correct.",
    "audit": "Check virtual machine configuration and verify that isolation.tools.setGUIOptions.enable option is missing or set to FALSE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.setGUIOptions.enable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.setGUIOptions.enable\" -value $false Impact: This is the default setting so functionality remains the same. Default Value: The prescribed state is the default state. References: Page | 116 1. http://pubs.vmware.com/vsphere- 50/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html",
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "This is the default setting so functionality remains the same. Default Value: The prescribed state is the default state.",
    "references": "Page | 116 1. http://pubs.vmware.com/vsphere- 50/topic/com.vmware.vmtools.install.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html"
  },
  {
    "id": "8.4.27",
    "title": "Disable VM Console Paste operations",
    "assessment": "Scored",
    "description": "Disable VM Console Paste operations.",
    "rationale": "Copy and paste operations are disabled by default; however, by explicitly disabling this feature, it will enable audit controls to check that this setting is correct.",
    "audit": "Check virtual machine configuration and verify that isolation.tools.paste.disable is missing or set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.paste.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.paste.disable\" -value $true Impact: This is the default setting so functionality remains the same. If you require copy and paste operations, you must enable them using the vSphere Web Client. Default Value: The prescribed state is the default state. Page | 117 References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3-AA05- 85033136A667.html",
    "function_names": [
      "compute_vm_console_paste_disabled",
      "compute_vm_console_paste_restricted",
      "compute_vm_console_clipboard_disabled",
      "compute_vm_console_clipboard_restricted",
      "compute_vm_console_input_disabled",
      "compute_vm_console_input_restricted"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "This is the default setting so functionality remains the same. If you require copy and paste operations, you must enable them using the vSphere Web Client. Default Value: The prescribed state is the default state. Page | 117",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3-AA05- 85033136A667.html"
  },
  {
    "id": "8.4.28",
    "title": "Control access to VM console via VNC protocol",
    "assessment": "Scored",
    "description": "Minimize access to the Virtual Machine via VNC protocol.",
    "rationale": "The VM console enables you to connect to the console of a virtual machine, in effect seeing what a monitor on a physical server would show. This console is also available via the VNC protocol. Setting up this access also involves setting up firewall rules on each ESXi server the virtual machine will run on.",
    "audit": "Check virtual machine configuration and verify that RemoteDisplay.vnc.enabled is missing or set to FALSE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"RemoteDisplay.vnc.enabled\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"RemoteDisplay.vnc.enabled\" -value $false Page | 118 Impact: Configuring VM settings and opening up the firewall means multiple steps to be configured and monitored. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-BB1F20D3-339F-46F3-B020- D19C9322C001.html 2. http://kb.vmware.com/kb/1246",
    "function_names": [
      "compute_instance_vnc_access_restricted",
      "compute_instance_vnc_protocol_disabled",
      "compute_instance_console_access_minimized",
      "compute_instance_vnc_connection_limited",
      "compute_instance_vnc_authentication_required",
      "compute_instance_vnc_network_restricted",
      "compute_instance_vnc_access_controlled",
      "compute_instance_vnc_secure_config_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Configuring VM settings and opening up the firewall means multiple steps to be configured and monitored.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-BB1F20D3-339F-46F3-B020- D19C9322C001.html 2. http://kb.vmware.com/kb/1246"
  },
  {
    "id": "8.4.29",
    "title": "Disable all but VGA mode on virtual machines.",
    "assessment": "Not Scored",
    "description": "Enable VGA Only mode for the Virtual Machine video card.",
    "rationale": "Many Server-class virtual machines need only a standard VGA console (typically a Unix/Linux server or Windows Server Core system). Enabling this setting removes additional unnecessary graphics functionality beyond disabling 3D. This reduces the potential attack surface available for malicious attacks.",
    "audit": "Check that the virtual machine advanced setting of \"svga.vgaonly\" is set to TRUE.  Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"svga.vgaOnly\" | Select Entity, Name, Value     Page | 119",
    "remediation": "Check that the virtual machine advanced setting of \"svga.vgaonly\" is set to TRUE. To modify the advanced settings of a virtual machine using the vSphere Client: 1. Ensure that the virtual machine has been shutdown and is powered off. 2. Right-click on the virtual machine. 3. Click Edit Settings... to open the Virtual Machine Properties window. 4. Click the Options tab. 5. From the list on the left, click Advanced > General. 6. On the Configuration Parameters frame on the right, click Configuration Parameters.... 7. Click Add Row. 8. On the new row, click under the Name column and specify the configuration option name. 9. On the new row, click under the Value column and specify the configuration value. 10. Start the virtual machine for the settings take effect. Additionally, the following PowerCLI command may be used:  # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"svga.vgaOnly\" -value $true   Impact: Configuring this setting to True will not allow any advanced graphics functions to work. Only character-cell console mode will be available. Use of this setting renders mks.enable3d moot. The mks.enable3d has no effect. Note: this setting should only be applied to those virtual machines for which a video card is not needed such as Windows Server Core and UNIX / Linux servers. Default Value: The prescribed state is not the default state. Page | 120 References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.wssdk.apiref.doc/vim.option.OptionValue.html 8.5 Resources",
    "function_names": [
      "compute_virtual_machine_vga_only_mode_enabled",
      "compute_vm_video_card_vga_mode_enabled",
      "compute_vm_non_vga_modes_disabled",
      "compute_vm_video_card_non_vga_modes_disabled",
      "compute_vm_video_card_vga_only_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Configuring this setting to True will not allow any advanced graphics functions to work. Only character-cell console mode will be available. Use of this setting renders mks.enable3d moot. The mks.enable3d has no effect. Note: this setting should only be applied to those virtual machines for which a video card is not needed such as Windows Server Core and UNIX / Linux servers. Default Value: The prescribed state is not the default state. Page | 120",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.wssdk.apiref.doc/vim.option.OptionValue.html 8.5 Resources"
  },
  {
    "id": "8.5.1",
    "title": "Prevent virtual machines from taking over resources",
    "assessment": "Not Scored",
    "description": "Use limits, shares, and reservations to prevent virtual machines from taking over resources.",
    "rationale": "By default, all virtual machines on an ESXi host share the resources equally. By using the resource management capabilities of ESXi, such as shares and limits, you can control the server resources that a virtual machine consumes. A denial of service can cause one virtual machine to consume so much of the host's resources that other virtual machines on the same host cannot perform their intended functions. You can use this mechanism to prevent such an occurrence.",
    "audit": "Use shares or reservations to guarantee resources to critical VMs. Use limits to constrain resource consumption by virtual machines that have a greater risk of being exploited or attacked, or that run applications that are known to have the potential to greatly consume resources. Additionally, the following PowerCLI command may be used: # List all Resource shares on all VMs Get-VM | Get-VMResourceConfiguration",
    "remediation": "\uf0b7 Use shares or reservations to guarantee resources to critical VMs. \uf0b7 Use limits to constrain resource consumption by virtual machines that have a greater risk of being exploited or attacked, or that run applications that are known to have the potential to greatly consume resources. Page | 121 References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-E6262360-9300-4E10-ADE0- D4BED08DB5CA.html 8.6 Storage",
    "function_names": [
      "compute_vm_resource_limits_enabled",
      "compute_vm_cpu_shares_configured",
      "compute_vm_memory_reservation_set",
      "compute_vm_disk_io_limits_enabled",
      "compute_vm_network_bandwidth_limits_set",
      "compute_vm_resource_allocation_restricted",
      "compute_vm_overcommit_protection_enabled",
      "compute_vm_resource_quota_enforced"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-E6262360-9300-4E10-ADE0- D4BED08DB5CA.html 8.6 Storage"
  },
  {
    "id": "8.6.1",
    "title": "Avoid using nonpersistent disks",
    "assessment": "Scored",
    "description": "Virtual Machine Disks are created as Dependent by default and are affected by snapshots. To ensure a virtual machine disk is not affected by snapshots the disk mode can be set to Independent. Disks set to Independent mode can be Independent Persistent or Independent Nonpersistent. Disks with Independent persistent mode have their data written permanently to the disk. Independent Nonpersistent disks lose any changes made to the disk when the system is rebooted and can mask any trace of an attack on the system.",
    "rationale": "The security issue with nonpersistent disk mode is that successful attackers, with a simple shutdown or reboot, might undo or remove any traces that they were ever on the machine. To safeguard against this risk, production virtual machines should be configured as follows: 1. Independent setting not enabled 2. Independent persistent 3. Independent nonpersistent with remote logging Without a persistent record of activity on a VM, administrators might never know whether they have been attacked or hacked.",
    "audit": "Page | 122 If remote logging of events and activity is not configured for the guest, scsiX:Y.mode should be either: 1. Not present. This is the default. 2. Not set to independent nonpersistent  Additionally, the following PowerCLI command may be used: #List the VM's and their disk types Get-VM | Get-HardDisk | Select Parent, Name, Filename, DiskType, Persistence",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: #Alter the parameters for the following cmdlet to set the VM Disk Type: Get-VM | Get-HardDisk | Set-HardDisk Impact: Won't be able to make use of nonpersistent mode, which allows rollback to a known state when rebooting the VM. Default Value: The default mode is the correct mode. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.wssdk.apiref.doc/vim.vm.device.VirtualDiskOption.DiskMod e.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.hostclient.doc/GUID-81629CAB-72FA-42F0-9F86- F8FD0DE39E57.html",
    "function_names": [
      "compute_virtual_machine_disk_independent_persistent",
      "compute_virtual_machine_disk_nonpersistent_avoided",
      "compute_disk_independent_mode_enabled",
      "compute_disk_persistent_mode_required",
      "compute_vm_disk_snapshot_protected",
      "compute_disk_nonpersistent_disabled",
      "compute_virtual_machine_disk_mode_independent",
      "compute_disk_persistence_enforced"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Won't be able to make use of nonpersistent mode, which allows rollback to a known state when rebooting the VM. Default Value: The default mode is the correct mode.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.wssdk.apiref.doc/vim.vm.device.VirtualDiskOption.DiskMod e.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.hostclient.doc/GUID-81629CAB-72FA-42F0-9F86- F8FD0DE39E57.html"
  },
  {
    "id": "8.6.2",
    "title": "Disable virtual disk shrinking",
    "assessment": "Scored",
    "description": "Page | 123 If Virtual disk shrinking is done repeatedly it will cause the virtual disk to become unavailable resulting in a denial of service. You can prevent virtual disk shrinking by disabling it.",
    "rationale": "Shrinking a virtual disk reclaims unused space in it. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. Normal users and processes\u2014that is, users and processes without root or administrator privileges\u2014within virtual machines have the capability to invoke this procedure. However, if this is done repeatedly, the virtual disk can become unavailable while this shrinking is being performed, effectively causing a denial of service. In most datacenter environments, disk shrinking is not done, so you should disable this feature. Repeated disk shrinking can make a virtual disk unavailable. This capability is available to nonadministrative users in the guest.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.diskShrink.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.diskShrink.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.diskShrink.disable\" -value $true Impact: Inability to shrink virtual machine disks in the event that a datastore runs out of space. Default Value: The prescribed state is not the default state. References: Page | 124 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28- 5B34FEB264B6.html",
    "function_names": [
      "compute_virtual_disk_shrinking_disabled",
      "compute_disk_shrink_protection_enabled",
      "compute_vm_disk_shrinking_restricted",
      "compute_virtual_disk_integrity_preserved",
      "compute_disk_shrink_operation_blocked"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "Inability to shrink virtual machine disks in the event that a datastore runs out of space. Default Value: The prescribed state is not the default state.",
    "references": "Page | 124 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28- 5B34FEB264B6.html"
  },
  {
    "id": "8.6.3",
    "title": "Disable virtual disk wiping",
    "assessment": "Scored",
    "description": "If Virtual disk wiping is done repeatedly, it will cause the virtual disk to become unavailable resulting in a denial of service. You can prevent virtual disk wiping by disabling it.",
    "rationale": "Wiping a virtual disk reclaims ALL unused space in it. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. Normal users and processes\u2014that is, users and processes without root or administrator privileges\u2014within virtual machines have the capability to invoke this procedure. However, if this is done repeatedly, the virtual disk can become unavailable while this wiping is being performed, effectively causing a denial of service. In most datacenter environments, disk wiping is not done, so you should disable this feature. Repeated disk wiping can make a virtual disk unavailable. This capability is available to nonadministrative users in the guest.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.diskWiper.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.diskWiper.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: Page | 125 # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.diskWiper.disable\" -value $true Impact: When you disable this feature, you cannot wipe virtual machine disks when a datastore runs out of space. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28- 5B34FEB264B6.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 8.7 Tools",
    "function_names": [
      "compute_virtual_disk_wiping_disabled",
      "compute_disk_wipe_protection_enabled",
      "compute_virtual_disk_dos_prevention_enabled",
      "compute_disk_wiping_disabled",
      "compute_virtual_disk_availability_protected"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "When you disable this feature, you cannot wipe virtual machine disks when a datastore runs out of space. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28- 5B34FEB264B6.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 8.7 Tools"
  },
  {
    "id": "8.7.1",
    "title": "Disable VIX messages from the VM",
    "assessment": "Scored",
    "description": "If you do not make use of custom VIX programming in your environment then you should disable this feature to reduce the potential for vulnerabilities.",
    "rationale": "The VIX API is a library for writing scripts and programs to manipulate virtual machines. If you do not make use of custom VIX programming in your environment, then you should disable certain features to reduce the potential for vulnerabilities. The ability to send messages from the VM to the host is one of these features. Note: Disabling this feature does NOT adversely affect the functioning of VIX operations that originate outside the guest, so certain VMware and 3rd party solutions that rely upon this capability should continue to work. This is a deprecated interface. Ensure that any deprecated interface is turned off for audit purposes. Page | 126",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.vixMessage.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.vixMessage.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.vixMessage.disable\" -value $true Impact: Guest will no longer be able to send messages via VIX API. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vddk.pg.doc/vddkTasks.8.8.html",
    "function_names": [
      "compute_vm_vix_messages_disabled",
      "compute_vm_vix_communication_disabled",
      "compute_vm_vix_api_disabled",
      "compute_vm_vix_feature_disabled",
      "compute_vm_vix_protocol_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Guest will no longer be able to send messages via VIX API. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vddk.pg.doc/vddkTasks.8.8.html"
  },
  {
    "id": "8.7.2",
    "title": "Limit number of VM log files",
    "assessment": "Scored",
    "description": "Configure VM settings to prevent uncontrolled logging.",
    "rationale": "You can use log settings to limit the total size and number of log files. Normally a new log file is created only when a host is rebooted, so the file can grow to be quite large. You can ensure that new log files are created more frequently by limiting the maximum size of the Page | 127 log files. If you want to restrict the total size of logging data, VMware recommends saving 10 log files, each one limited to 1,000KB. Datastores are likely to be formatted with a block size of 2MB or 4MB, so a size limit too far below this size would result in unnecessary storage utilization. Each time an entry is written to the log, the size of the log is checked; if it is over the limit, the next entry is written to a new log. If the maximum number of log files already exists, when a new one is created, the oldest log file is deleted. A denial-of-service attack that avoids these limits might be attempted by writing an enormous log entry. But each log entry is limited to 4KB, so no log files are ever more than 4KB larger than the configured limit. A second option is to disable logging for the virtual machine. Disabling logging for a virtual machine makes troubleshooting challenging and support difficult. You should not consider disabling logging unless the log file rotation approach proves insufficient. Uncontrolled logging can lead to denial of service due to the datastore's being filled.",
    "audit": "Check virtual machine configuration file and verify that log.keepOld is set to 10. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"log.keepOld\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"log.keepOld\" -value \"10\" Impact: A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient. Default Value: The prescribed state is not the default state. References: Page | 128 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-D8ABEF05-D304-40CA-8B59- D62510BE63C9.html",
    "function_names": [
      "compute_vm_log_file_limit",
      "compute_vm_log_rotation_enabled",
      "compute_vm_log_retention_configured",
      "compute_vm_log_size_restricted",
      "compute_vm_log_count_threshold",
      "compute_vm_log_storage_quota",
      "compute_vm_log_cleanup_enabled",
      "compute_vm_log_max_files_enforced"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient. Default Value: The prescribed state is not the default state.",
    "references": "Page | 128 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.vm_admin.doc/GUID-685722FA-9009-439C-9142- 18A9E7C592EA.html 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-D8ABEF05-D304-40CA-8B59- D62510BE63C9.html"
  },
  {
    "id": "8.7.3",
    "title": "Do not send host information to guests",
    "assessment": "Scored",
    "description": "Configure VMware Tools to disable host info from being sent to guests.",
    "rationale": "By enabling a VM to get detailed information about the physical host, an adversary could potentially use this information to inform further attacks on the host. If set to TRUE, a VM can obtain detailed information about the physical host. The default value for the parameter is FALSE. This setting should not be TRUE unless a particular VM requires this information for performance monitoring.",
    "audit": "Check virtual machine configuration file and verify that tools.guestlib.enableHostInfo is set to FALSE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"tools.guestlib.enableHostInfo\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"tools.guestlib.enableHostInfo\" -value $false Impact: Page | 129 You cannot retrieve performance information about the host from inside the guest virtual machine, there are times when this can be useful for troubleshooting. Default Value: The prescribed state is the default state. References: 1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-2CF880DA-2435-4201-9AFB- A16A11951A2D.html",
    "function_names": [
      "compute_vmware_tools_host_info_disabled",
      "compute_guest_host_info_sharing_disabled",
      "vmware_tools_host_info_blocked",
      "compute_vm_host_info_to_guest_disabled",
      "vmware_guest_host_info_access_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Page | 129 You cannot retrieve performance information about the host from inside the guest virtual machine, there are times when this can be useful for troubleshooting. Default Value: The prescribed state is the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-2CF880DA-2435-4201-9AFB- A16A11951A2D.html"
  },
  {
    "id": "8.7.4",
    "title": "Limit VM log file size",
    "assessment": "Scored",
    "description": "Configure VM settings to prevent uncontrolled logging. Virtual machines write troubleshooting information into a virtual machine log file stored on the VMFS volume. Virtual machine users and processes can abuse logging either on purpose or inadvertently so that large amounts of data flood the log file. Over time, the log file can consume enough file system space to cause a denial of service.",
    "rationale": "You can use log settings to limit the total size and number of log files. Normally a new log file is created only when a host is rebooted, so the file can grow to be quite large. You can ensure that new log files are created more frequently by limiting the maximum size of the log files. If you want to restrict the total size of logging data, VMware recommends saving 10 log files, each one limited to 1,000KB (1,024,000 bytes). Datastores are likely to be formatted with a block size of 2MB or 4MB, so a size limit too far below this size would result in unnecessary storage utilization. Each time an entry is written to the log, the size of the log is checked; if it is over the limit, the next entry is written to a new log. If the maximum number of log files already exists, when a new one is created, the oldest log file is deleted. A denial-of-service attack that avoids these limits might be attempted by writing an enormous log entry. But each log entry is limited to 4KB, so no log files are ever more than 4KB larger than the configured limit. A second option is to disable logging for the virtual machine. Disabling logging for a virtual machine makes troubleshooting challenging and support difficult. You should not consider disabling logging unless the log file rotation Page | 130 approach proves insufficient. Uncontrolled logging can lead to denial of service due to the datastores being filled.",
    "audit": "Check virtual machine configuration file and verify that log.rotateSize is set to 1024000. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"log.rotateSize\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"log.rotateSize\" -value \"1024000\" Impact: A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient. Default Value: The prescribed state is not the default state. References: 1. http://kb.vmware.com/kb/8182749 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-F465D340-6556-49E8-B137- C0B4A060E83B.html   Page | 131 Appendix: Change History Date Version Changes for this version 09-05-2014 1.1.0 6.2 \"uniqueness of CHAP authentication\" set to Not Scored per Ticket #63 09-05-2014 1.1.0 8.4.28 \"Control access to VM console via VNC protocol\" - Set to Scored per Ticket #68 09-05-2014 1.1.0 8.2.7 \"Prevent unauthorized connection of devices\" - Set to Scored per Ticket #67 09-05-2014 1.1.0 3.2 \"Configure persistent logging for all ESXi host\" - clarified audit and remediation per Ticket #66 09-05-2014 1.1.0 5.10 \"Verify contents of exposed configuration files\" - set to Not Scored Ticket #61 09-05-2014 1.1.0 5.6 \"Remove keys from SSH authorized_keys file\" - updated rationale per Ticket #57 09-05-2014 1.1.0 1.1 \"Keep ESXi system properly patched\" - updated audit procedure per Ticket #64 09-05-2014 1.1.0 2.2 \"Configure the ESXi host firewall to restrict access to services running on the host\" remediation updated per Ticket #59 09-05-2014 1.1.0 5.9 \"Set DCUI.Access to allow trusted users to override lockdown mode\" updated audit procedure per Ticket #58 09-05-2014 1.1.0 2.5 \"Ensure proper SNMP configuration\" set to Not Scored per Ticket #60 09-05-2014 1.1.0 8.1.3 \"Limit sharing of console connections - Level 1\" was removed per Ticket #62 09-05-2014 1.1.0 5.6 \"Remove keys from SSH authorized_keys file\" moved to Level 2 per Ticket #70 12-16-2014 1.2.0 Expanded scope to include ESXi 5.5 Update 2",
    "function_names": [
      "compute_vm_log_file_size_limited",
      "compute_vm_log_file_size_configured",
      "compute_vm_log_file_size_restricted",
      "compute_vm_log_file_size_capped",
      "compute_vm_log_file_size_controlled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient. Default Value: The prescribed state is not the default state.",
    "references": "1. http://kb.vmware.com/kb/8182749 2. http://pubs.vmware.com/vsphere- 55/topic/com.vmware.vsphere.security.doc/GUID-F465D340-6556-49E8-B137- C0B4A060E83B.html   Page | 131 Appendix: Change History Date Version Changes for this version 09-05-2014 1.1.0 6.2 \"uniqueness of CHAP authentication\" set to Not Scored per Ticket #63 09-05-2014 1.1.0 8.4.28 \"Control access to VM console via VNC protocol\" - Set to Scored per Ticket #68 09-05-2014 1.1.0 8.2.7 \"Prevent unauthorized connection of devices\" - Set to Scored per Ticket #67 09-05-2014 1.1.0 3.2 \"Configure persistent logging for all ESXi host\" - clarified audit and remediation per Ticket #66 09-05-2014 1.1.0 5.10 \"Verify contents of exposed configuration files\" - set to Not Scored Ticket #61 09-05-2014 1.1.0 5.6 \"Remove keys from SSH authorized_keys file\" - updated rationale per Ticket #57 09-05-2014 1.1.0 1.1 \"Keep ESXi system properly patched\" - updated audit procedure per Ticket #64 09-05-2014 1.1.0 2.2 \"Configure the ESXi host firewall to restrict access to services running on the host\" remediation updated per Ticket #59 09-05-2014 1.1.0 5.9 \"Set DCUI.Access to allow trusted users to override lockdown mode\" updated audit procedure per Ticket #58 09-05-2014 1.1.0 2.5 \"Ensure proper SNMP configuration\" set to Not Scored per Ticket #60 09-05-2014 1.1.0 8.1.3 \"Limit sharing of console connections - Level 1\" was removed per Ticket #62 09-05-2014 1.1.0 5.6 \"Remove keys from SSH authorized_keys file\" moved to Level 2 per Ticket #70 12-16-2014 1.2.0 Expanded scope to include ESXi 5.5 Update 2"
  }
]