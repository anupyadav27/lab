[
  {
    "id": "1.1",
    "title": "(L1) Host hardware must have auditable, authentic, and up to date system & device firmware",
    "assessment": "Manual",
    "description": "Hardware firmware is not immune to serious issues affecting confidentiality, integrity, or availability. Vulnerable system management controllers & management engines can provide places for attackers to establish persistence, in order to re-infect and re- compromise hosts after reboots and updates. Ensure that the latest firmware updates are applied to all components of your systems and that the firmware is authentic and supplied by your hardware manufacturer.",
    "rationale": "To ensure the integrity, security, and optimal performance of server hardware, it is essential to maintain system and device firmware that is verifiable, genuine, and current. Impact: If you are a vSAN customer please ensure that storage device & controller firmware versions are certified.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_firmware_authentic",
      "compute_host_firmware_auditable",
      "compute_host_firmware_up_to_date",
      "compute_host_firmware_manufacturer_signed",
      "compute_host_firmware_vulnerability_free",
      "compute_host_firmware_persistence_protected",
      "compute_host_firmware_integrity_verified",
      "compute_host_firmware_boot_protected",
      "compute_host_firmware_secure_boot_enabled",
      "compute_host_firmware_tpm_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "If you are a vSAN customer please ensure that storage device & controller firmware versions are certified."
  },
  {
    "id": "1.2",
    "title": "(L1) Host hardware must enable UEFI Secure Boot",
    "assessment": "Manual",
    "description": "UEFI Secure Boot is a security feature of the Unified Extensible Firmware Interface (UEFI) specification. Its primary purpose is to ensure that only signed and trusted boot loaders and operating system kernels are allowed to execute during the system startup. This helps protect systems from malware and unauthorized software that might try to run before the operating system loads. By verifying the digital signatures of bootable applications and drivers, Secure Boot prevents potentially harmful code from compromising the boot process.",
    "rationale": "Enabling UEFI Secure Boot on the ESXi host hardware helps prevent malware and untrusted configurations. Impact: Enabling this after installation may render the host unbootable. Refer to the vSphere documentation for more information about enabling Secure Boot.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_instance_secure_boot_enabled",
      "compute_vm_secure_boot_enabled",
      "compute_host_secure_boot_enabled",
      "compute_uefi_secure_boot_enabled",
      "compute_firmware_secure_boot_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Enabling this after installation may render the host unbootable. Refer to the vSphere documentation for more information about enabling Secure Boot."
  },
  {
    "id": "1.3",
    "title": "(L1) Host hardware must enable Intel TXT, if available",
    "assessment": "Manual",
    "description": "Intel Xeon Scalable Processor platforms have Trusted Execution Technology, or TXT, that help harden systems against malware, rootkits, BIOS & firmware attacks, and more. When enabled, ESXi will take advantage of security benefits offered by this technology.",
    "rationale": "Enabling Intel TXT (Trusted Execution Technology) on host hardware, when available, provides a hardware-based foundation for security. Impact: In early implementations, operations such as firmware updates and abrupt system shutdowns may activate attestation alarms in vCenter Server or cause boot failures. Typically, a cold system restart offers a temporary fix, while a system firmware update provides a permanent solution. Refer to KB 78243.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_txt_enabled",
      "compute_host_txt_available",
      "compute_host_hardware_security_enabled",
      "compute_host_trusted_execution_enabled",
      "compute_host_firmware_protection_enabled",
      "compute_host_malware_protection_enabled",
      "compute_host_rootkit_protection_enabled",
      "compute_host_bios_security_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "In early implementations, operations such as firmware updates and abrupt system shutdowns may activate attestation alarms in vCenter Server or cause boot failures. Typically, a cold system restart offers a temporary fix, while a system firmware update provides a permanent solution. Refer to KB 78243."
  },
  {
    "id": "1.4",
    "title": "(L1) Host hardware must enable and configure a TPM 2.0",
    "assessment": "Manual",
    "description": "ESXi can use Trusted Platform Modules (TPM) 2.0 to enable advanced security features that prevent malware, remove dependencies, and secure hardware lifecycle operations.",
    "rationale": "Enabling and configuring TPM 2.0 on host hardware ensures enhanced security by providing hardware-level cryptographic operations and secure storage for sensitive data and keys. Impact: No impact noted.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_tpm2_enabled",
      "compute_host_tpm2_configured",
      "compute_host_tpm2_min_version_2_0",
      "compute_host_tpm2_hardware_lifecycle_secure",
      "compute_host_tpm2_malware_protection_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No impact noted."
  },
  {
    "id": "1.5",
    "title": "(L1) Host integrated hardware management controller must be secure",
    "assessment": "Manual",
    "description": "Many servers have integrated hardware management controllers that can be extremely helpful when monitoring and updating hardware, settings, and firmware. These controllers should be checked to ensure that ALL unused functionality is disabled, ALL unused access methods are disabled, passwords and password controls are set, and firewalling and access control is in place so that the only access is from authorized access workstations for the virtualization administration team. All \"first boot\" configuration options should be disabled, especially ones that reconfigure the system from USB devices that are inserted. Disable or protect USB ports attached to the management controllers. Where possible, USB ports should be set to only permit keyboards. Default passwords for accounts should be changed. External information displays should be secured to prevent information leakage. Power and information buttons should be secured against unauthorized use. Many hardware management controllers provide mechanisms for alerting when hardware faults & configuration changes occur. You should consider those if you are not using another method for hardware monitoring.",
    "rationale": "Impact: Disablement of connection methods may mean that future monitoring and management efforts require changes to the hardware management controller configurations across your fleet of servers. Most hardware management controllers have CLI and API management methods that can be scripted and used from a management workstation, in lieu of additional management software or applications. Learning these techniques saves time, avoids the additional effort of installing and maintaining additional tools, and allows for timely changes to configurations.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_hardware_management_controller_unused_functionality_disabled",
      "compute_hardware_management_controller_unused_access_methods_disabled",
      "compute_hardware_management_controller_passwords_configured",
      "compute_hardware_management_controller_firewall_access_control_enabled",
      "compute_hardware_management_controller_first_boot_options_disabled",
      "compute_hardware_management_controller_usb_ports_restricted",
      "compute_hardware_management_controller_default_passwords_changed",
      "compute_hardware_management_controller_external_displays_secured",
      "compute_hardware_management_controller_power_buttons_secured",
      "compute_hardware_management_controller_alerting_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Disablement of connection methods may mean that future monitoring and management efforts require changes to the hardware management controller configurations across your fleet of servers. Most hardware management controllers have CLI and API management methods that can be scripted and used from a management workstation, in lieu of additional management software or applications. Learning these techniques saves time, avoids the additional effort of installing and maintaining additional tools, and allows for timely changes to configurations."
  },
  {
    "id": "1.6",
    "title": "(L1) Host integrated hardware management controller must enable time synchronization",
    "assessment": "Manual",
    "description": "Cryptography, audit logging, cluster operations, and incident response/forensics depend deeply on synchronized time. This recommendation extends to all devices in infrastructure. The recommendation for NTP is to have at least four sources.",
    "rationale": "Ensuring the host integrated hardware management controller enables time synchronization provides a consistent and accurate timestamp for logs and events, which is crucial for auditing, troubleshooting, and identifying security incidents. Impact: No impact noted.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_hardware_controller_time_sync_enabled",
      "compute_hardware_controller_ntp_sources_min_four",
      "compute_hardware_controller_ntp_sources_configured",
      "compute_hardware_controller_time_sync_ntp_enabled",
      "compute_hardware_controller_time_sync_sources_valid"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No impact noted."
  },
  {
    "id": "1.7",
    "title": "(L1) Host integrated hardware management controller must enable remote logging of events",
    "assessment": "Manual",
    "description": "The host's integrated hardware management controller provides critical out-of-band server oversight. For enhanced security, it is essential to configure this controller to log events remotely. This practice ensures that hardware-related logs are sent to an off-site location, protecting them from potential tampering and offering a centralized record of server health and activities.",
    "rationale": "Enabling remote logging of events on the integrated hardware management controller ensures that all hardware-level activities are securely recorded off-site, providing traceability, mitigating data tampering risks, and facilitating incident response. Impact: No impact noted.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_hardware_controller_remote_logging_enabled",
      "compute_hardware_controller_event_logging_remote",
      "hardware_controller_remote_logging_enabled",
      "hardware_controller_event_logging_remote",
      "compute_hardware_controller_logging_remote_enabled",
      "hardware_controller_logging_remote_enabled",
      "compute_hardware_controller_logging_centralized",
      "hardware_controller_logging_centralized"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No impact noted."
  },
  {
    "id": "1.8",
    "title": "(L1) Host integrated hardware management controller must secure authentication",
    "assessment": "Manual",
    "description": "Connections to centralized authentication sources, like Active Directory, should be disabled or carefully considered as attack vectors and dependency loops (for authentication, authorization, DNS, DHCP, and time). Consider managing local accounts on these devices through the APIs and CLI interfaces provided. If Active Directory must be used for authentication do authorization locally so that an attacker with access to Active Directory cannot promote themselves through group membership.",
    "rationale": "To prevent unauthorized access and potential malicious control of server hardware functions, it's essential to ensure that the integrated hardware management controller utilizes secure authentication mechanisms. Impact: Not connecting hardware management controllers to centralized authentication & authorization sources entails additional management. Most hardware management controllers have CLI toolkits or APIs to automate management of user accounts and/or authorization levels.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_hardware_controller_auth_local_accounts",
      "compute_hardware_controller_auth_ad_disabled",
      "compute_hardware_controller_auth_local_authorization",
      "compute_hardware_controller_auth_no_dependency_loops",
      "compute_hardware_controller_auth_api_cli_managed",
      "compute_hardware_controller_auth_ad_restricted_groups"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "Not connecting hardware management controllers to centralized authentication & authorization sources entails additional management. Most hardware management controllers have CLI toolkits or APIs to automate management of user accounts and/or authorization levels."
  },
  {
    "id": "1.9",
    "title": "(L2) Host hardware must enable AMD SEV-ES, if available",
    "assessment": "Manual",
    "description": "AMD EPYC platforms support SEV-ES, a technology to encrypt memory and CPU register state, and limit visibility to the hypervisor, in order to increase workload security and decrease exposure to certain types of attacks. When configured properly, vSphere supports the use of SEV-ES inside guest virtual machines and containers under vSphere and vSphere with Tanzu. Enabling SEV-ES in system firmware eases future enablement inside virtual machines, containers, and guest OSes.",
    "rationale": "Enabling AMD SEV-ES (Secure Encrypted Virtualization-Encrypted State) on host hardware enhances the security of virtual machines by encrypting their memory and CPU state, reducing the risk of unauthorized data access and tampering from compromised hypervisors or malicious actors. Impact: Use of SEV-ES in a particular VM requires the guest OS to support it, and will limit some operational features such as vMotion, snapshots, and so on. Consult the documentation for more information about these tradeoffs.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vm_sev_es_enabled",
      "compute_host_hardware_sev_es_enabled",
      "compute_amd_sev_es_required",
      "compute_firmware_sev_es_enabled",
      "compute_vm_memory_encryption_enabled",
      "compute_hardware_sev_es_available",
      "compute_vm_sev_es_required",
      "compute_host_sev_es_config_valid"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "Use of SEV-ES in a particular VM requires the guest OS to support it, and will limit some operational features such as vMotion, snapshots, and so on. Consult the documentation for more information about these tradeoffs."
  },
  {
    "id": "1.10",
    "title": "(L2) Host hardware must enable Intel SGX, if available",
    "assessment": "Manual",
    "description": "Intel Xeon Scalable Processor platforms have Software Guard Extensions, or SGX, a technology that helps applications protect data in system memory. When configured properly, vSphere supports the use of SGX inside guest virtual machines. Enabling SGX in system firmware eases future enablement inside virtual machines and guest OSes.",
    "rationale": "Intel SGX (Software Guard Extensions) provides hardware-based memory encryption that protects sensitive data from unauthorized access or modification by malicious software running at higher privilege levels, enhancing server security. Impact: Use of SGX requires guest OS support, and will limit some operational features inside vSphere, such as vMotion, snapshots, fault tolerance, and suspend/resume.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_hardware_sgx_enabled",
      "compute_host_hardware_sgx_available",
      "compute_vm_sgx_support_enabled",
      "compute_firmware_sgx_configuration_valid",
      "compute_system_memory_protection_enabled",
      "compute_vm_guest_sgx_enabled",
      "compute_host_sgx_feature_activated",
      "compute_virtualization_sgx_compatibility_verified"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "Use of SGX requires guest OS support, and will limit some operational features inside vSphere, such as vMotion, snapshots, fault tolerance, and suspend/resume."
  },
  {
    "id": "1.11",
    "title": "(L2) Host hardware must secure unused external hardware ports",
    "assessment": "Manual",
    "description": "Unused ports, especially USB, can be used by attackers to attach storage, networking, and keyboards. Take reasonable steps to control access to these ports through disablement, access control, and/or with other means such as solid rack doors, rack side panels, and flooring that makes the ports inaccessible from outside the rack when the rack door is closed. Cables fit easily through many gaps in and around racks and rack doors, and stiff wires can be used to push them into sockets from outside the rack, as well as to dislodge cables to create a service disruption. Where possible, USB ports should also be set to only permit keyboards. When disabling functionality like this please consider that you may need to access the server using a USB keyboard during an outage or as part of lifecycle operations, and plan accordingly.",
    "rationale": "Unused external hardware ports can be exploited as potential entry points for unauthorized devices and malicious activity, thereby compromising server security. Impact: Security involves balancing risks, including ease of recovery from outages. Disabling external ports can hinder emergency use of the ESXi console. Servers can often toggle USB port access; ensure your choice aligns with organizational needs and is tested prior to incidents.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_unused_ports_disabled",
      "compute_host_usb_ports_keyboard_only",
      "compute_host_external_ports_physically_secured",
      "compute_host_rack_access_controlled",
      "compute_host_ports_cable_protected",
      "compute_host_usb_ports_restricted",
      "compute_host_ports_lifecycle_access_planned"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "Security involves balancing risks, including ease of recovery from outages. Disabling external ports can hinder emergency use of the ESXi console. Servers can often toggle USB port access; ensure your choice aligns with organizational needs and is tested prior to incidents."
  },
  {
    "id": "1.12",
    "title": "(L2) Host integrated hardware management controller must deactivate internal networking",
    "assessment": "Manual",
    "description": "Many servers have integrated hardware management controllers with the ability to present virtual network interfaces to ESXi as a management interface. These approaches create potential backdoors for access and are used by adversaries to circumvent network-based/perimeter firewalls, in either direction, and avoid observation by IDS/IPS/threat analysis tools. In many cases this functionality is not strictly necessary to manage hosts.",
    "rationale": "Using integrated hardware management controllers to present virtual network interfaces to ESXi can inadvertently create backdoors, allowing adversaries to bypass firewalls and evade detection by security tools; often, this functionality isn't essential for host management. Impact: Disablement of internal networking may limit vendor management tool effectiveness.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_internal_networking_disabled",
      "compute_management_controller_networking_deactivated",
      "compute_hardware_controller_internal_networking_blocked",
      "compute_esxi_host_management_interface_disabled",
      "compute_integrated_controller_network_isolation_enabled",
      "compute_host_backdoor_network_access_prevented",
      "compute_hardware_management_network_interface_disabled"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "Disablement of internal networking may limit vendor management tool effectiveness."
  },
  {
    "id": "2.1",
    "title": "(L1) Host must run software that has not reached End of General Support status",
    "assessment": "Manual",
    "description": "The \"End of General Support\" (EOGS) status indicates that the software version has exceeded its primary support lifecycle, during which VMware provides new security patches, bug fixes, and technical assistance. When a product reaches this status, VMware no longer releases security updates for that version for customers outside of an extended support contract. Thus, systems still running software past its EOGS are potentially exposed to unpatched vulnerabilities and other security risks.",
    "rationale": "Running software beyond its EOGS can compromise the integrity, availability, and confidentiality of virtual environments. Keeping VMware ESXi software versions within the support period ensures that organizations have access to the latest security patches, critical updates, and vendor support. Impact: Failing to update and maintain software versions within the support period can lead to potential security breaches, data losses, and reduced operational efficiency, as the software might become incompatible with newer technologies and lack support for emerging security threats.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vm_software_supported",
      "compute_vm_eogs_avoided",
      "compute_vm_patch_status_current",
      "compute_vm_version_supported",
      "compute_vm_security_patches_active",
      "compute_vm_unsupported_software_absent",
      "compute_vm_general_support_active",
      "compute_vm_vulnerable_versions_absent"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Failing to update and maintain software versions within the support period can lead to potential security breaches, data losses, and reduced operational efficiency, as the software might become incompatible with newer technologies and lack support for emerging security threats."
  },
  {
    "id": "2.2",
    "title": "(L1) Host must have all software updates installed",
    "assessment": "Manual",
    "description": "Applying updates in a timely manner according to the severity of issues contributes greatly to the resilience of an environment. When applying updates, it is recommended to update vCenter Server first, if an update is available, and then proceed with updating ESXi. This sequence ensures that the management layer is updated before updating the ESXi hosts. VMware publishes advisories on security vulnerabilities; for proactive notifications please subscribe to the mailing list at https://www.vmware.com/security/advisories.html",
    "rationale": "Issues in software that impact confidentiality, integrity, and/or availability can only be removed through patching to a version that resolves the issue. Threat actors exploit known vulnerabilities when attempting to gain unauthorized access or elevate privileges on an ESXi host. Impact: ESXi servers must be in Maintenance Mode to apply patches. This implies all VMs must be moved or powered off on the ESXi server, so the patching process may necessitate brief outages. ESXi hosts that are compatible with Quick Boot may be able to greatly minimize the host restart time. VMware vSphere Update releases add and change system functionality, whereas Patch releases only resolve issues.",
    "audit": "Verify that the patches are up to date. The following PowerCLI snippet will provide a list of all installed patches: Foreach ($VMHost in Get-VMHost ) { $EsxCli = Get-EsxCli -VMHost $VMHost -V2 $EsxCli.software.vib.list.invoke() | Select-Object @{N=\"VMHost\";E={$VMHost}},* } You may also manage updates via VMware Lifecycle Manager located under Menu, Lifecycle Manager.",
    "remediation": "Use VMware Lifecycle Manager to update and upgrade hosts when ESXi is managed through VMware vCenter. For standalone hosts use esxcli or API-driven methods for applying updates. Employ a process to keep ESXi hosts up to date with patches in accordance with industry standards and internal guidelines. Leverage the VMware Lifecycle Manager to test and apply patches as they become available. Default Value: N/A References: 1. https://docs.vmware.com/en/VMware-vSphere/8.0/vsphere-lifecycle- manager/GUID-74295A37-E8BB-4EB9-BFBA-47B78F0C570D.html 2. https://kb.vmware.com/s/article/52477",
    "function_names": [
      "compute_host_updates_installed",
      "compute_host_updates_installed_over_30d",
      "compute_host_updates_installed_critical",
      "compute_host_updates_installed_security",
      "compute_host_updates_installed_latest",
      "compute_host_updates_installed_auto",
      "compute_host_updates_installed_vcenter_first",
      "compute_host_updates_installed_esxi_secondary",
      "compute_host_updates_installed_vmware_advisory",
      "compute_host_updates_installed_subscription_active"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "ESXi servers must be in Maintenance Mode to apply patches. This implies all VMs must be moved or powered off on the ESXi server, so the patching process may necessitate brief outages. ESXi hosts that are compatible with Quick Boot may be able to greatly minimize the host restart time. VMware vSphere Update releases add and change system functionality, whereas Patch releases only resolve issues.",
    "references": "1. https://docs.vmware.com/en/VMware-vSphere/8.0/vsphere-lifecycle- manager/GUID-74295A37-E8BB-4EB9-BFBA-47B78F0C570D.html 2. https://kb.vmware.com/s/article/52477"
  },
  {
    "id": "2.3",
    "title": "(L1) Host must enable Secure Boot enforcement",
    "assessment": "Manual",
    "description": "Enabling Secure Boot enforcement ensures that the host only loads UEFI drivers and applications with valid digital signatures, as part of the UEFI firmware standard. It requires support from the server's BIOS and hypervisor boot loader, and mandates that all ESXi kernel modules, drivers, and VIBs be signed by VMware or a trusted partner subordinate.",
    "rationale": "Organizations should enable Secure Boot enforcement to enhance the security of their virtual environments. Requiring valid digital signatures for UEFI drivers and apps mitigates the risk of offline attacks, where an attacker could transfer the ESXi install drive to a non-Secure Boot host and boot it without detection. This control establishes a trusted boot process, reducing the risk of unauthorized access and maintaining the integrity of the ESXi host. Impact: Failing to enable Secure Boot enforcement exposes the ESXi host to potential security breaches. Without this control, an attacker could compromise the ESXi host by booting it on a non-Secure Boot host, bypassing ESXi's protections. This could lead to unauthorized access, data breaches, and compromise of the virtual environment's integrity. Enabling Secure Boot enforcement is crucial for maintaining a secure and trusted ESXi host, mitigating potential negative impacts, and safeguarding the virtual infrastructure.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_secure_boot_enabled",
      "compute_host_secure_boot_enforced",
      "compute_host_uefi_signature_validation_enabled",
      "compute_host_boot_integrity_verified",
      "compute_host_vmware_signed_modules_required",
      "compute_host_trusted_partner_signatures_allowed",
      "compute_host_esxi_kernel_signature_enforced",
      "compute_host_boot_loader_security_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Failing to enable Secure Boot enforcement exposes the ESXi host to potential security breaches. Without this control, an attacker could compromise the ESXi host by booting it on a non-Secure Boot host, bypassing ESXi's protections. This could lead to unauthorized access, data breaches, and compromise of the virtual environment's integrity. Enabling Secure Boot enforcement is crucial for maintaining a secure and trusted ESXi host, mitigating potential negative impacts, and safeguarding the virtual infrastructure."
  },
  {
    "id": "2.4",
    "title": "(L1) Host image profile acceptance level must be PartnerSupported or higher",
    "assessment": "Automated",
    "description": "The acceptance level on ESXi regulates the type of software that can be installed on the system, with four distinct levels: VMwareCertified, VMwareAccepted, PartnerSupported, and CommunitySupported. It's advised to set the acceptance level to PartnerSupported or higher to ensure that only tested and digitally signed vSphere Installation Bundles (VIBs) are allowed for installation.",
    "rationale": "The ESXi Image Profile should only allow signed VIBs because an unsigned VIB represents untested code installed on an ESXi host. Also, use of unsigned VIBs will cause hypervisor Secure Boot to fail to configure. Community Supported VIBs do not have digital signatures. To protect the security and integrity of your ESXi hosts, do not allow unsigned (CommunitySupported) VIBs to be installed on your hosts. Impact: Restricting the acceptance level to PartnerSupported or higher prevents the installation of CommunitySupported packages, which are unsigned and hence, potentially unreliable or insecure. This restriction, while enhancing security, might limit the range of software that can be installed on the ESXi host.",
    "audit": "To verify the host image profile acceptance level perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure, then under System select Security Profile. 3. Under Host Image Profile Acceptance Level ensure it is set to one of the following - \"VMware Certified\", \"VMware Accepted\", or \"Partner Supported\". This may also be performed as follows: 1. Connect to each ESX/ESXi host using the ESXi Shell or vCLI, and execute the command esxcli software acceptance get to verify the acceptance level is at either \"VMware Certified\", \"VMware Accepted\", or \"Partner Supported\". 2. Connect to each ESX/ESXi host using the vCLI, and execute the command esxcli software vib list to verify the acceptance level for each VIB is either \"VMware Certified\", \"VMware Accepted\", or \"Partner Supported\". Additionally, the following PowerCLI command may be used: # List the Software AcceptanceLevel for each host Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $VMHost | Select Name, @{N=\"AcceptanceLevel\";E={$ESXCli.software.acceptance.get()}} } # List only the vibs which are not at \"VMwareCertified\" or \"VMwareAccepted\" or \"PartnerSupported\" acceptance level Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $ESXCli.software.vib.list() | Where { ($_.AcceptanceLevel -ne \"VMwareCertified\") -and ($_.AcceptanceLevel -ne \"VMwareAccepted\") -and ($_.AcceptanceLevel -ne \"PartnerSupported\") } }",
    "remediation": "To verify the host image profile acceptance level perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure, then under System select Security Profile. 3. Under Host Image Profile Acceptance Level select Edit 4. In the dropdown select one of the following - VMware Certified, VMware Accepted, or Partner Supported. To implement the recommended configuration state, run the following PowerCLI command (in the example code, the level is Partner Supported): # Set the Software AcceptanceLevel for each host<span> Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $ESXCli.software.acceptance.Set(\"PartnerSupported\") } Default Value: Partner Supported References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A- 8335-CFBCE0DD2167.html",
    "function_names": [
      "compute_host_image_profile_acceptance_level_partner_supported",
      "compute_host_image_profile_acceptance_level_min_vmware_accepted",
      "compute_host_image_profile_acceptance_level_no_community_supported",
      "compute_host_image_profile_acceptance_level_highest",
      "compute_host_image_profile_vib_signature_required"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Restricting the acceptance level to PartnerSupported or higher prevents the installation of CommunitySupported packages, which are unsigned and hence, potentially unreliable or insecure. This restriction, while enhancing security, might limit the range of software that can be installed on the ESXi host.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A- 8335-CFBCE0DD2167.html"
  },
  {
    "id": "2.5",
    "title": "(L1) Host must only run binaries delivered via signed VIB",
    "assessment": "Manual",
    "description": "The ESXi host is configured to only execute binaries originating from a valid, signed vSphere Installable Bundle (VIB) to enhance the integrity of the system. This measure thwarts attackers' attempts to use prebuilt toolkits on the host. The parameter governing this behavior is VMkernel.Boot.execInstalledOnly with a recommended setting of True.",
    "rationale": "Ensuring the execution of only signed binaries significantly mitigates the risk of running malicious or unverified code, thus enhancing the host\u2019s security posture. Impact: This security control may hinder the installation or execution of third-party unsigned software, potentially impacting the flexibility and extensibility of the ESXi host environment.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "esxi_host_vib_signed_only",
      "esxi_host_exec_installed_only",
      "esxi_vmkernel_boot_exec_installed_only",
      "esxi_host_unsigned_binaries_blocked",
      "esxi_vib_integrity_enforced"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "This security control may hinder the installation or execution of third-party unsigned software, potentially impacting the flexibility and extensibility of the ESXi host environment."
  },
  {
    "id": "2.6",
    "title": "(L1) Host must have reliable time synchronization sources",
    "assessment": "Automated",
    "description": "Ensuring reliable time synchronization is crucial as various functions like cryptography, audit logging, cluster operations, and incident response/forensics are heavily dependent on synchronized time. Utilizing at least four NTP sources is recommended for achieving reliable time synchronization. Alternatively, PTP can be employed for sub-millisecond time accuracy, with NTP configured as a backup to maintain time synchronization resilience in case of primary server failure.",
    "rationale": "Reliable time synchronization supports accurate auditing, cryptographic integrity, cluster operations, and effective incident response/forensics. Having multiple time sources enhances the reliability and accuracy of time synchronization, which is fundamental for secure and efficient system operations. Impact: Inadequate time synchronization may lead to erroneous system logs, compromised cryptographic operations, inefficient cluster operations, and hindered incident response efforts. The resilience and accuracy of time synchronization are vital for maintaining operational integrity and security posture.",
    "audit": "To confirm NTP synchronization is enabled and properly configured, perform the following from the vSphere Web Client: 1. Select a host 2. Click Configure then expand System then select Time Configuration. 3. Verify that Time Synchronization is set to Automatic 4. Verify that the NTP Client is set to Enabled 5. Verify that the NTP Service Status is Running 6. Verify that appropriate NTP servers are set. Additionally, the following PowerCLI command may be used: # List the NTP Settings for all hosts Get-VMHost | Select Name, @{N=\"NTPSetting\";E={$_ | Get-VMHostNtpServer}}",
    "remediation": "To enable and properly configure NTP synchronization, perform the following from the vSphere web client: 1. Select a host 2. Click Configure then expand System then select Time Configuration. 3. Select Edit next to Network Time Protocol 4. Select the Enable box, then fill in the appropriate NTP Servers. 5. in the NTP Service Startup Policy drop down select Start and stop with host. 6. Click OK. To implement the recommended configuration state, run the following PowerCLI command: # Set the NTP Settings for all hosts # If an internal NTP server is used, replace pool.ntp.org with # the IP address or the Fully Qualified Domain Name (FQDN) of the internal NTP server $NTPServers = \"pool.ntp.org\", \"pool2.ntp.org\" Get-VMHost | Add-VmHostNtpServer $NTPServers References: 1. https://docs.vmware.com/en/VMware- vSphere/6.7/com.vmware.vsphere.security.doc/GUID-2553C86E-7981-4F79- B9FC-A6CECA52F6CC.html Additional Information: Notes: Verify the NTP firewall ports are open. It is recommended to synchronize the ESXi clock with a time server that is located on the management network rather than directly with a time server on a public network. This time server can then synchronize with a public source through a strictly controlled network connection with a firewall.",
    "function_names": [
      "compute_instance_ntp_sources_min_four",
      "compute_instance_ntp_sources_reliable",
      "compute_instance_ptp_enabled",
      "compute_instance_ptp_ntp_backup_enabled",
      "compute_instance_time_sync_resilient",
      "compute_instance_time_sync_configured",
      "compute_instance_time_sources_diverse",
      "compute_instance_ntp_sources_high_availability"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Inadequate time synchronization may lead to erroneous system logs, compromised cryptographic operations, inefficient cluster operations, and hindered incident response efforts. The resilience and accuracy of time synchronization are vital for maintaining operational integrity and security posture.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.7/com.vmware.vsphere.security.doc/GUID-2553C86E-7981-4F79- B9FC-A6CECA52F6CC.html Additional Information: Notes: Verify the NTP firewall ports are open. It is recommended to synchronize the ESXi clock with a time server that is located on the management network rather than directly with a time server on a public network. This time server can then synchronize with a public source through a strictly controlled network connection with a firewall."
  },
  {
    "id": "2.7",
    "title": "(L1) Host must have time synchronization services enabled and running",
    "assessment": "Manual",
    "description": "Ensure the host has time synchronization services enabled and operational as many functions such as cryptography, audit logging, cluster operations, and incident response/forensics depend on synchronized time. Services like NTP or PTP should be configured to start with the host and remain running to maintain time synchronization.",
    "rationale": "Having accurate time synchronization is crucial for the correct operation and auditing of the system. This will assist in incident response, forensics, and ensure that cryptographic functions operate correctly. Impact: Failure to maintain time synchronization can lead to inaccurate logging, which could complicate incident response and forensic analysis. It may also affect the functioning of cluster operations and cryptographic protocols.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_instance_time_sync_enabled",
      "compute_instance_ntp_service_running",
      "compute_instance_ptp_service_running",
      "compute_instance_time_sync_configured",
      "compute_instance_ntp_configured_on_boot",
      "compute_instance_ptp_configured_on_boot",
      "compute_instance_time_sync_operational",
      "compute_instance_ntp_peer_configured",
      "compute_instance_time_sync_service_active"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Failure to maintain time synchronization can lead to inaccurate logging, which could complicate incident response and forensic analysis. It may also affect the functioning of cluster operations and cryptographic protocols."
  },
  {
    "id": "2.8",
    "title": "(L1) Host must require TPM-based configuration encryption",
    "assessment": "Manual",
    "description": "The host should enforce TPM-based configuration encryption to secure its configuration files, notably within the /etc/ directory or other namespaces. From vSphere 7.0 Update 2 onwards, configuration files archived are encrypted, leveraging a Trusted Platform Module (TPM) to \"seal\" the configuration to the host, thereby enhancing security against offline attacks. This encryption, once enabled, is irreversible and utilizes the physical TPM present during installation or upgrade.",
    "rationale": "Implementing TPM-based configuration encryption significantly bolsters security by protecting configuration files from unauthorized access and alterations. This measure is crucial for safeguarding the integrity of host configurations and preventing potential offline attacks. Impact: Enabling TPM-based configuration encryption alongside Secure Boot renders traditional root password recovery methods ineffective. It's imperative to ensure continued access to administrator accounts on ESXi to avoid access issues.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_tpm_encryption_enabled",
      "compute_host_config_encryption_required",
      "compute_host_tpm_sealing_enabled",
      "compute_host_etc_encryption_enabled",
      "compute_host_offline_attack_protection_enabled",
      "compute_host_config_encryption_irreversible",
      "compute_host_tpm_based_encryption_enabled",
      "compute_host_vsphere_7u2_encryption_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Enabling TPM-based configuration encryption alongside Secure Boot renders traditional root password recovery methods ineffective. It's imperative to ensure continued access to administrator accounts on ESXi to avoid access issues."
  },
  {
    "id": "2.9",
    "title": "(L1) Host must not suppress warnings about unmitigated hyperthreading vulnerabilities",
    "assessment": "Manual",
    "description": "It is imperative to retain hyperthreading security warnings as they indicate unmitigated CPU vulnerabilities. The parameter governing this behavior is UserVars.SuppressHyperthreadWarning, with a recommended setting of 0.",
    "rationale": "Retaining these warnings ensures that potential CPU vulnerabilities are not overlooked, promoting a proactive approach towards addressing hardware-related security concerns. Impact: No functional impact is associated with this security control, however, ignoring hyperthreading warnings could obscure existing CPU vulnerabilities, potentially jeopardizing system security.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_suppress_hyperthread_warning_disabled",
      "compute_host_hyperthread_warning_enabled",
      "compute_host_unmitigated_hyperthread_warning_visible",
      "compute_host_suppress_hyperthread_warning_set_to_zero"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No functional impact is associated with this security control, however, ignoring hyperthreading warnings could obscure existing CPU vulnerabilities, potentially jeopardizing system security."
  },
  {
    "id": "2.10",
    "title": "(L1) Host must restrict inter-VM transparent page sharing",
    "assessment": "Automated",
    "description": "Transparent Page Sharing (TPS) aids in optimizing memory usage among virtual machines but under certain circumstances can be exploited to access data on adjacent virtual machines unauthorizedly. By configuring the Mem.ShareForceSalting parameter, inter-VM TPS is restricted, enhancing isolation and security. The parameter governing this behavior is Mem.ShareForceSalting with a recommended setting of 2.",
    "rationale": "Restricting inter-VM TPS is crucial to prevent potential unauthorized access to data, ensuring an extra layer of isolation and security between virtual machines which is indispensable especially in a multi-tenant environment. Impact: There is no noted functional impact, indicating that restricting inter-VM TPS does not adversely affect the system\u2019s performance or operations while bolstering security against potential data access exploits.",
    "audit": "From the vSphere Web Client: 1. Select a host 2. Click Configure then expand System then select Advanced System settings. 3. Click Edit then Filter for Mem.ShareForceSalting. 4. Verify that it is set to 2. Additionally the following PowerCLI command can be used: Get-VMHost | Get-AdvancedSetting -Name Mem.ShareForceSalting",
    "remediation": "From the vSphere Web Client: 1. Select a host 2. Click Configure then expand System then select Advanced System settings. 3. Click Edit then Filter for Mem.ShareForceSalting. 4. Set the value to 2. 5. Click OK. Additionally, the following PowerCLI command can be used: Get-VMHost | Get-AdvancedSetting -Name Mem.ShareForceSalting | Set- AdvancedSetting -Value 2 References: 1. https://kb.vmware.com/s/article/2097593 2. https://blogs.vmware.com/vsphere/2015/01/assess-the-performance-impact-of- the-security-change-in-transparent-page-sharing-behaviour.html",
    "function_names": [
      "compute_vm_tps_restricted",
      "compute_vm_share_force_salting_enabled",
      "compute_vm_memory_isolation_enabled",
      "compute_vm_tps_salting_set_to_2"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no noted functional impact, indicating that restricting inter-VM TPS does not adversely affect the system\u2019s performance or operations while bolstering security against potential data access exploits.",
    "references": "1. https://kb.vmware.com/s/article/2097593 2. https://blogs.vmware.com/vsphere/2015/01/assess-the-performance-impact-of- the-security-change-in-transparent-page-sharing-behaviour.html"
  },
  {
    "id": "2.11",
    "title": "(L1) Host must use sufficient entropy for cryptographic operations",
    "assessment": "Manual",
    "description": "Starting with vSphere 8.0, ESXi has enhanced its entropy implementation to align with FIPS 140-3 and EAL4 certifications, ensuring a robust foundation for cryptographic operations. Kernel boot options dictate the activation of entropy sources on an ESXi host. The parameter governing this behavior is disableHwrng = FALSE and entropySources = 0.",
    "rationale": "Employing adequate entropy is crucial for ensuring the strength of cryptographic operations. Impact: There is no functional impact noted.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "esxi_host_sufficient_entropy_enabled",
      "esxi_host_entropy_sources_configured",
      "esxi_host_disable_hwrng_false",
      "esxi_host_entropy_fips_compliant",
      "esxi_host_entropy_eal4_compliant",
      "esxi_host_kernel_entropy_boot_options_valid",
      "esxi_host_cryptographic_entropy_sources_enabled",
      "esxi_host_entropy_sources_minimum_required"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact noted."
  },
  {
    "id": "2.12",
    "title": "(L2) Host must enable volatile key destruction",
    "assessment": "Manual",
    "description": "By default, ESXi ensures that pages allocated for virtual machines (VMs), userspace applications, and kernel threads are zeroed out at the time of allocation, to prevent the exposure of sensitive data like cryptographic keys to other clients. However, these keys can remain in host memory for an extended period if the memory is not reused. The Mem.MemEagerZero parameter can be configured to enforce the zeroing out of userworld and guest memory pages when a userworld process or guest exits, and for kernel threads, memory spaces holding keys are zeroed out as soon as the secret is no longer needed. This practice adheres to the NIAP Virtualization Protection Profile and Server Virtualization Extended Package requirements of zeroing memory that may contain cryptographic keys upon process exit. The parameter governing this behavior is Mem.MemEagerZero with a recommended setting of 1.",
    "rationale": "Enabling volatile key destruction through the Mem.MemEagerZero parameter enhances the security posture by ensuring that sensitive information such as cryptographic keys are not left residually in the system memory, which could be exploited by malicious entities. This configuration aligns with the guidelines provided by the NIAP Virtualization Protection Profile and Server Virtualization Extended Package, indicating its criticality in maintaining a secure virtualized environment. Impact: Activating volatile key destruction through the Mem.MemEagerZero parameter results in additional shutdown time required for virtual machines, corresponding to the amount of allocated memory. While this may extend the downtime during reboots or migrations, the trade-off ensures a higher level of security by preventing the potential exposure of sensitive data, fulfilling compliance requirements, and aiding in the effective management of cryptographic materials within the virtualized environment.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_volatile_key_destruction_enabled",
      "compute_host_mem_eager_zero_set",
      "compute_host_memory_zeroing_enabled",
      "compute_host_crypto_key_cleanup_enabled",
      "compute_host_secure_memory_management_enabled"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "Activating volatile key destruction through the Mem.MemEagerZero parameter results in additional shutdown time required for virtual machines, corresponding to the amount of allocated memory. While this may extend the downtime during reboots or migrations, the trade-off ensures a higher level of security by preventing the potential exposure of sensitive data, fulfilling compliance requirements, and aiding in the effective management of cryptographic materials within the virtualized environment."
  },
  {
    "id": "3.1",
    "title": "(L1) Host should deactivate SSH",
    "assessment": "Automated",
    "description": "Secure Shell (SSH) provides remote access to the ESXi shell, enabling direct host console access or remote connectivity. Deactivating SSH is a security measure aimed at minimizing remote access channels to the ESXi host, restricting it to essential connections only through vSphere Client, vCLI/PowerCLI, or published APIs. The service status should be set to \"Stopped\", allowing manual start and stop for troubleshooting or diagnostic activities when necessary.",
    "rationale": "Limiting remote access by deactivating SSH reduces potential attack vectors, promoting a secure operating environment. Enabling SSH only for diagnostics or troubleshooting ensures controlled access, aligning with security best practices. Impact: There is no functional impact noted; however, the measure requires alternative methods for remote management, such as vSphere Client or command-line tools, which may demand additional configurations or toolset proficiency.",
    "audit": "To verify SSH is disabled, perform the following: 1. From the vSphere Web Client, select the host. 2. Select Configure then expand System and select Services. 3. Click on SSH then click Edit Startup Policy. 4. Verify the Startup Policy is set to Start and Stop Manually. Alternately, the following PowerCLI command may be used: # Check if SSH is running and set to start Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM-SSH\" } | Select VMHost, Key, Label, Policy, Running, Required Note: A host warning is displayed in the web client whenever SSH is enabled on a host.",
    "remediation": "To disable SSH, perform the following: 1. From the vSphere Web Client, select the host. 2. Select Configure then expand System and select Services. 3. Click on SSH then click Edit Startup Policy. 4. Set the Startup Policy is set to Start and Stop Manually. 5. Click OK. 6. While ESXi Shell is still selected click Stop. Alternately, use the following PowerCLI command: # Set SSH to start manually rather than automatically for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM-SSH\" } | Set- VMHostService -Policy Off References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-12E27BF3-3769-4665- 8769-DA76C2BC9FFE.html",
    "function_names": [
      "compute_host_ssh_deactivated",
      "compute_host_ssh_stopped",
      "compute_host_remote_access_restricted",
      "compute_host_ssh_manual_start_only",
      "compute_host_ssh_diagnostic_mode_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact noted; however, the measure requires alternative methods for remote management, such as vSphere Client or command-line tools, which may demand additional configurations or toolset proficiency.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-12E27BF3-3769-4665- 8769-DA76C2BC9FFE.html"
  },
  {
    "id": "3.2",
    "title": "(L1) Host must deactivate the ESXi shell",
    "assessment": "Automated",
    "description": "The ESXi shell is an interactive command line environment available from the Direct Console User Interface (DCUI) or remotely via SSH. Activities performed from the ESXi Shell bypass all access controls, but are logged. The recommended setting for the ESXi shell is to be stopped and only started manually when needed, such as when running diagnostics or troubleshooting.",
    "rationale": "Ensuring non-essential services like the ESXi Shell are deactivated enhances the security posture. Impact: No functional impact is recorded. However, if ESXi shell functionalities are needed, manual activation is required.",
    "audit": "To verify the ESXi shell is disabled, perform the following: 1. From the vSphere Web Client, select the host. 2. Select Configure then expand System and select Services. 3. Click on ESXi Shell then click Edit Startup Policy. 4. Verify the Startup Policy is set to Start and Stop Manually. Alternately, the following PowerCLI command may be used: # Check if the ESXi shell is running and set to start Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM\" } | Select VMHost, Key, Label, Policy, Running, Required Note: A host warning is displayed in the web client whenever the ESXi shell is enabled on a host.",
    "remediation": "To disable the ESXi shell, perform the following: 1. From the vSphere Web Client, select the host. 2. Select Configure then expand System and select Services. 3. Click on ESXi Shell then click Edit Startup Policy. 4. Set the Startup Policy is set to Start and Stop Manually. 5. Click on OK. Alternately, use the following PowerCLI command: # Set the ESXi shell to start manually rather than automatically for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM\" } | Set- VMHostService -Policy Off References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-B5144CE9-F8BB-494D- 8F5D-0D5621D65DAE.html 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-DFA67697-232E-4F7D- 860F-96C0819570A8.html",
    "function_names": [
      "compute_host_esxi_shell_disabled",
      "compute_host_esxi_shell_stopped",
      "compute_host_esxi_shell_manual_activation_only",
      "compute_host_esxi_shell_access_restricted",
      "compute_host_esxi_shell_logging_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No functional impact is recorded. However, if ESXi shell functionalities are needed, manual activation is required.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-B5144CE9-F8BB-494D- 8F5D-0D5621D65DAE.html 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-DFA67697-232E-4F7D- 860F-96C0819570A8.html"
  },
  {
    "id": "3.3",
    "title": "(L1) Host must deactivate the ESXi Managed Object Browser (MOB)",
    "assessment": "Automated",
    "description": "The Managed Object Browser (MOB) is a web-based server application that lets you examine and change system objects and configurations. It is a prudent security measure to deactivate the MOB unless it's essential for operations. The parameter governing this behavior is Config.HostAgent.plugins.solo.enableMob with a recommended setting of False.",
    "rationale": "Deactivating non-essential services like MOB adheres to the principle of least functionality, reducing potential attack vectors. Impact: There is no specified functional impact; however, if MOB functionalities are needed later, manual reactivation is required.",
    "audit": "To confirm whether MOB is enabled, perform the following from the vSphere Web Client: 1. Select a host 2. Click Configure then expand System then select Advanced System Settings. 3. Click Edit then search for Config.HostAgent.plugins.solo.enableMob 4. Verify the value is set to false. To determine if the MOB is enabled, run the following command from the ESXi shell: vim-cmd proxysvc/service_list Additionally, the following PowerCLI command may be used: Get-VMHost | Get-AdvancedSetting -Name Config.HostAgent.plugins.solo.enableMob",
    "remediation": "To disabled MOB, perform the following from the vSphere Web Client: 1. Select a host 2. Click Configure then expand System then select Advanced System Settings. 3. Click Edit then search for Config.HostAgent.plugins.solo.enableMob 4. Set the value to false. 5. Click OK. Note: You cannot disable the MOB while a host is in lockdown mode. Note 2: You must disable MOB from the vSphere interface not via the vim-cmd command. References: 1. https://docs.vmware.com/en/VMware- vSphere/6.7/com.vmware.vsphere.security.doc/GUID-0EF83EA7-277C-400B- B697-04BDC9173EA3.html Additional Information: Some third-party tools use the MOB to gather information. Use the following command to re-enable the MOB temporarily for third-party tool usage: To disabled MOB, perform the following from the vSphere Web Client: 1. Select a host 2. Click Configure then expand System then select Advanced System Settings. 3. Click Edit then search for Config.HostAgent.plugins.solo.enableMob 4. Set the value to true. 5. Click OK. Note 2: You must enable MOB from the vSphere interface not via the vim-cmd command.",
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no specified functional impact; however, if MOB functionalities are needed later, manual reactivation is required.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.7/com.vmware.vsphere.security.doc/GUID-0EF83EA7-277C-400B- B697-04BDC9173EA3.html Additional Information: Some third-party tools use the MOB to gather information. Use the following command to re-enable the MOB temporarily for third-party tool usage: To disabled MOB, perform the following from the vSphere Web Client: 1. Select a host 2. Click Configure then expand System then select Advanced System Settings. 3. Click Edit then search for Config.HostAgent.plugins.solo.enableMob 4. Set the value to true. 5. Click OK. Note 2: You must enable MOB from the vSphere interface not via the vim-cmd command."
  },
  {
    "id": "3.4",
    "title": "(L1) Host must deactivate SLP",
    "assessment": "Manual",
    "description": "The Service Location Protocol (SLP) is used for the discovery and selection of network services in local area networks, which simplifies configuration by allowing computers to find necessary services automatically. The practice of deactivating SLP when not in use aligns with the principle of minimizing the attack surface by shutting down non-essential services. The recommended setting is to have the SLP service stopped, with the ability to start and stop it manually as required.",
    "rationale": "Deactivating non-essential services like SLP minimizes potential vectors of attack, thereby enhancing the host's security posture. Impact: There is no functional impact noted, however, manual intervention is required to start the SLP service when needed.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_instance_slp_deactivated",
      "compute_host_slp_disabled",
      "network_slp_service_stopped",
      "network_slp_protocol_disabled",
      "compute_slp_auto_start_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact noted, however, manual intervention is required to start the SLP service when needed."
  },
  {
    "id": "3.5",
    "title": "(L1) Host must deactivate CIM",
    "assessment": "Manual",
    "description": "Deactivating the Common Information Model (CIM) service, when not in use, aligns with the principle of minimizing the attack surface by disabling non-essential services. This action helps in reducing the potential vectors of attack, thus bolstering the host's security posture.",
    "rationale": "Deactivating non-essential services like CIM mitigates potential security risks associated with these services. This measure adheres to the principle of least functionality, which posits that only necessary services should be active to fulfill operational requirements. Impact: No functional impact has been specified. However, the deactivation of CIM might require administrators to manually start or stop the service when needed, potentially affecting operational workflows if CIM is required at a later stage.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_cim_deactivated",
      "compute_host_unnecessary_service_disabled",
      "compute_host_attack_surface_reduced",
      "compute_host_non_essential_service_deactivated",
      "compute_host_security_posture_improved"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No functional impact has been specified. However, the deactivation of CIM might require administrators to manually start or stop the service when needed, potentially affecting operational workflows if CIM is required at a later stage."
  },
  {
    "id": "3.6",
    "title": "(L1) Host should deactivate SNMP",
    "assessment": "Manual",
    "description": "Simple Network Management Protocol (SNMP) facilitates the management of networked devices. Minimize attack surface by disabling non-essential services. The recommended setting is to have the SNMP service stopped unless required and configured securely.",
    "rationale": "Deactivating SNMP when it's not needed reduces the attack surface, adhering to a minimalistic approach in service operation. Impact: While there isn't a direct functional impact, the absence of SNMP may require alternative methods for network management and monitoring.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_instance_snmp_deactivated",
      "compute_vm_snmp_disabled",
      "network_host_snmp_service_stopped",
      "network_device_snmp_inactive",
      "host_snmp_protocol_disabled",
      "host_snmp_service_deactivated",
      "host_snmp_unused_service_stopped",
      "network_snmp_non_essential_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "While there isn't a direct functional impact, the absence of SNMP may require alternative methods for network management and monitoring."
  },
  {
    "id": "3.7",
    "title": "(L1) Host must automatically terminate idle DCUI sessions",
    "assessment": "Automated",
    "description": "By configuring a session timeout, unattended console sessions are automatically terminated, thereby reducing the potential security risks associated with lingering active sessions. The parameter governing this behavior is UserVars.DcuiTimeOut, with a recommended setting of 600 (10 minutes).",
    "rationale": "Automated termination of idle DCUI sessions enhances the security posture by minimizing the window of opportunity for unauthorized access through unattended sessions. It enforces a good security hygiene practice by ensuring that inactive sessions do not remain open indefinitely, which is in line with the principle of least privilege. Impact: While there's no functional impact specified, setting a timeout value that's too short may inconvenience users by terminating sessions prematurely, possibly interrupting workflow. Conversely, a timeout value that's too long may not adequately mitigate the risks associated with idle sessions. Hence, a balanced approach in configuring the session timeout value, aligned with the organizational security policy and user workflow, is crucial.",
    "audit": "To verify the DCUI timeout setting, perform the following steps: 1. From the vSphere Web Client, select the host. 2. Click Configure, then under System select Advanced System Settings. 3. Select Edit then enter UserVars.DcuiTimeOut in the filter. 4. Verify that the value for this parameter is 600 seconds or less. Alternately, the following PowerCLI command may be used: Get-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut",
    "remediation": "To correct the DCUI timeout setting, perform the following steps: 1. From the vSphere Web Client, select the host. 2. Click Configure, then under System select Advanced System Settings. 3. Select Edit then enter UserVars.DcuiTimeOut in the filter. 4. Click in the box for the current value, then set the value to 600 seconds or less. Alternately, use the following PowerCLI command: Get-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut | Set- AdvancedSetting -Value 600",
    "function_names": [
      "compute_host_dcui_session_timeout_enabled",
      "compute_host_idle_session_termination_enabled",
      "compute_host_dcui_timeout_set",
      "compute_host_session_timeout_configured",
      "compute_host_dcui_auto_termination_enabled",
      "compute_host_idle_dcui_session_termination_enabled",
      "compute_host_dcui_timeout_min_600",
      "compute_host_session_timeout_min_10m"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "While there's no functional impact specified, setting a timeout value that's too short may inconvenience users by terminating sessions prematurely, possibly interrupting workflow. Conversely, a timeout value that's too long may not adequately mitigate the risks associated with idle sessions. Hence, a balanced approach in configuring the session timeout value, aligned with the organizational security policy and user workflow, is crucial."
  },
  {
    "id": "3.8",
    "title": "(L1) Host must automatically terminate idle shells",
    "assessment": "Automated",
    "description": "The host should be configured to automatically terminate idle shell sessions to prevent potential unauthorized access due to forgotten logouts. Setting a timeout for idle SSH connections ensures that any unattended sessions are closed, thereby reducing the security risk. The parameter governing this behavior is UserVars.ESXiShellInteractiveTimeOut with a recommended setting of 900.",
    "rationale": "Automatically terminating idle shells minimizes the risks associated with unattended sessions. It is a proactive measure to prevent potential unauthorized access to the host. Impact: There is no identified negative impact associated with enforcing this control as it serves to bolster the host's security posture.",
    "audit": "To verify the timeout is set correctly, perform the following from the vSphere web client: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand System. 3. Select Advanced System Settings then click Edit. 4. Enter ESXiShellInteractiveTimeOut in the filter. 5. Verify that the value for this parameter is set to 300 or less. Note: A value of 0 disables the ESXiShellInteractiveTimeOut. Alternately, the following PowerCLI command may be used: # List UserVars.ESXiShellInteractiveTimeOut for each host Get-VMHost | Select Name, @{N=\"UserVars.ESXiShellInteractiveTimeOut\";E={$_ | Get-AdvancedSetting UserVars.ESXiShellInteractiveTimeOut | Select - ExpandProperty Values}}",
    "remediation": "To set the timeout to the desired value, perform the following from the vSphere web client: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand System. 3. Select Advanced System Settings then click Edit. 4. Enter ESXiShellInteractiveTimeOut in the filter. 5. Set the value for this parameter is set to the appropriate value (300 seconds or less). 6. Click OK. Note: A value of 0 disables the ESXi ShellInteractiveTimeOut. Alternately, use the following PowerCLI command: # Set Remove UserVars.ESXiShellInteractiveTimeOut to 300 on all hosts Get-VMHost | Get-AdvancedSetting -Name 'UserVars.ESXiShellInteractiveTimeOut' | Set-AdvancedSetting -Value \"300\" References: 1. http://kb.vmware.com/kb/2004746 Additional Information: It is recommended to set the ESXiShellTimeOut together with ESXiShellInteractiveTimeOut.",
    "function_names": [
      "compute_host_idle_shell_termination_enabled",
      "compute_host_shell_timeout_configured",
      "compute_host_esxi_shell_interactive_timeout_set",
      "compute_host_idle_session_termination_enabled",
      "compute_host_shell_inactivity_timeout_set"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no identified negative impact associated with enforcing this control as it serves to bolster the host's security posture.",
    "references": "1. http://kb.vmware.com/kb/2004746 Additional Information: It is recommended to set the ESXiShellTimeOut together with ESXiShellInteractiveTimeOut."
  },
  {
    "id": "3.9",
    "title": "(L1) Host must automatically deactivate shell services",
    "assessment": "Automated",
    "description": "Enabling the automatic deactivation of shell services minimizes the attack surface on the host. The time window for the ESXi Shell and SSH services' availability is defined by UserVars.ESXiShellTimeOut, after which these services are terminated. The recommended setting for this parameter is 600.",
    "rationale": "Automatically deactivating shell services after a defined time window helps in reducing the risk associated with potential unauthorized access, ensuring a more secure ESXi host environment. Impact: There's no negative functional impact identified with this control; it contributes towards enhancing the host's security posture by limiting the availability of shell services.",
    "audit": "To verify the timeout is set to one hour or less, perform the following from the vSphere web client: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand System. 3. Select Advanced System Settings then click Edit. 4. Enter ESXiShellTimeOut in the filter. 5. Verify that the value for this parameter is set to 3600 (1 hour) or less. Alternately, the following PowerCLI command may be used: # List UserVars.ESXiShellTimeOut in minutes for each host Get-VMHost | Select Name, @{N=\"UserVars.ESXiShellTimeOut\";E={$_ | Get- AdvancedSettings UserVars.ESXiShellTimeOut | Select -ExpandProperty Values}}",
    "remediation": "To set the timeout to the desired value, perform the following from the vSphere web client: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand System. 3. Select Advanced System Settings then click Edit. 4. Enter ESXiShellTimeOut in the filter. 5. Set the value for this parameter is set to 3600 (1 hour) or less 6. Click OK. Note: A value of 0 disables the ESXiShellTimeOut. Alternately, run the following PowerCLI command: # Set UserVars.ESXiShellTimeOut to 3600 on all hosts Get-VMHost | Get-AdvancedSetting -Name 'UserVars.ESXiShellTimeOut' | Set- AdvancedSetting -Value \"3600\" References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-6E1ECA4D-B617-4D42- B40B-71E4C83DEEFB.html 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-B314F79B-2BDD-4D68- 8096-F009B87ACB33.html 3. http://kb.vmware.com/kb/2004746 4. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3-4E16- 8027-0280B9ED1009.html Additional Information: This value can be set in minutes via the DCUI. When using the vCenter GUI or PowerShell API, the value is set in seconds.",
    "function_names": [
      "compute_host_shell_auto_deactivate",
      "compute_host_shell_timeout_configured",
      "compute_host_ssh_auto_deactivate",
      "compute_host_ssh_timeout_configured",
      "compute_host_shell_timeout_min_600s",
      "compute_host_ssh_timeout_min_600s",
      "compute_host_shell_services_auto_terminate",
      "compute_host_esxi_shell_timeout_set"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There's no negative functional impact identified with this control; it contributes towards enhancing the host's security posture by limiting the availability of shell services.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-6E1ECA4D-B617-4D42- B40B-71E4C83DEEFB.html 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-B314F79B-2BDD-4D68- 8096-F009B87ACB33.html 3. http://kb.vmware.com/kb/2004746 4. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3-4E16- 8027-0280B9ED1009.html Additional Information: This value can be set in minutes via the DCUI. When using the vCenter GUI or PowerShell API, the value is set in seconds."
  },
  {
    "id": "3.10",
    "title": "(L1) Host must not suppress warnings that the shell is enabled",
    "assessment": "Manual",
    "description": "Having warnings for enabled SSH or ESXi Shell provides insight into potential security risks. Disabling such warnings can mask ongoing attacks. The parameter governing this behavior is UserVars.SuppressShellWarning with a recommended value of 0.",
    "rationale": "Maintaining visibility of shell service status through warnings is crucial for monitoring and early detection of unauthorized activities, helping in promptly addressing potential security threats. Impact: No negative functional impact is associated with this control; it enhances monitoring and response to potential security threats by ensuring warnings are visible and not suppressed.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "esxi_host_shell_warning_enabled",
      "esxi_host_suppress_shell_warning_disabled",
      "esxi_host_shell_warning_not_suppressed",
      "esxi_host_shell_warning_visible",
      "esxi_host_shell_warning_active"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No negative functional impact is associated with this control; it enhances monitoring and response to potential security threats by ensuring warnings are visible and not suppressed."
  },
  {
    "id": "3.11",
    "title": "(L1) Host must enforce password complexity",
    "assessment": "Manual",
    "description": "The enforcement of password complexity is managed through the Security.PasswordQualityControl parameter, allowing configuration of password length, character set requirements, and failed logon attempt restrictions. The recommended setting is \"retry=3 min=disabled,15,15,15,15 max=64 similar=deny passphrase=3\".",
    "rationale": "Abiding by NIST 800-63B Section 5.1.1.2 guidelines, not enforcing traditional composition rules facilitates the adoption of longer, more secure passphrases, enhancing overall security. Impact: Altering password complexity via Security.PasswordQualityControl may cause installation issues with other products and services within the VMware ecosystem not expecting such changes.",
    "audit": "To confirm password complexity requirements are set, perform the following: 1. Login to the ESXi shell as a user with administrator privileges. 2. Open /etc/pam.d/passwd. 3. Locate the following line: password requisite /lib/security/$ISA/pam_passwdqc.so retry=N min=N0,N1,N2,N3,N4  4. Confirm N0 is set to disabled. 5. Confirm N1 is set to disabled. 6. Confirm N2 is set to disabled. 7. Confirm N3 is set to disabled. 8. Confirm N4 is set to 14 or greater. The above requires all passwords to be 14 or more characters long and comprised of at least one character from four distinct character sets.",
    "remediation": "To set the password complexity requirements, perform the following: 1. Login to the ESXi shell as a user with administrator privileges. 2. Open /etc./pam.d/passwd. 3. Locate the following line: password requisite /lib/security/$ISA/pam_passwdqc.so retry=N min=N0,N1,N2,N3,N4  4. Set N0 to disabled. 5. Set N1 to disabled. 6. Set N2 to disabled. 7. Set N3 to disabled. 8. Set N4 to 14 or greater. The above requires all passwords to be 14 or more characters long and comprised of at least one character from four distinct character sets. References: 1. http://www.openwall.com/passwdqc/README.shtml 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-DC96FFDB-F5F2-43EC- 8C73-05ACDAE6BE43.html 3. https://www.cisecurity.org/white-papers/cis-password-policy-guide/",
    "function_names": [
      "compute_instance_password_complexity_enabled",
      "compute_instance_password_min_length_15",
      "compute_instance_password_retry_limit_3",
      "compute_instance_password_max_length_64",
      "compute_instance_password_similar_deny_enabled",
      "compute_instance_password_passphrase_min_3",
      "compute_instance_password_quality_control_configured"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Altering password complexity via Security.PasswordQualityControl may cause installation issues with other products and services within the VMware ecosystem not expecting such changes.",
    "references": "1. http://www.openwall.com/passwdqc/README.shtml 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-DC96FFDB-F5F2-43EC- 8C73-05ACDAE6BE43.html 3. https://www.cisecurity.org/white-papers/cis-password-policy-guide/"
  },
  {
    "id": "3.12",
    "title": "(L1) Host must lock an account after a specified number of failed login attempts",
    "assessment": "Automated",
    "description": "The security control involves restricting account access following a specified number of failed login attempts, acting as a deterrent against brute-force attacks. This control is applicable for SSH and vSphere Web Services SDK access, though not for the Direct Console Interface (DCUI) and the ESXi Shell. A default setting allows five failed attempts before account lockout, with automatic unlock after 15 minutes. The parameter governing this behavior is Security.AccountLockFailures with a recommended setting of 5.",
    "rationale": "Implementing this control bolsters the host's resilience against unauthorized access attempts, safeguarding system integrity. By thwarting brute-force attacks, it significantly elevates the security posture, making unauthorized access more challenging. Impact: A potential downside is the inadvertent denial-of-service scenario, especially with a low threshold for login failures. This could be exploited maliciously or trigger accidental lockouts, impacting system accessibility and possibly demanding additional administrative effort for account resets.",
    "audit": "To verify the maximum failed login attempts is set properly, perform the following steps: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand System. 3. Select Advanced System Settings then click Edit. 4. Enter Security.AccountLockFailures in the filter. 5. Verify that the value for this parameter is set to 5. Alternately, the following PowerCLI command may be used: Get-VMHost | Get-AdvancedSetting -Name Security.AccountLockFailures",
    "remediation": "To set the maximum failed login attempts correctly, perform the following steps: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand System. 3. Select Advanced System Settings then click Edit. 4. Enter Security.AccountLockFailures in the filter. 5. Set the value for this parameter to 5. Alternately, use the following PowerCLI command: Get-VMHost | Get-AdvancedSetting -Name Security.AccountLockFailures | Set- AdvancedSetting -Value 5 References: 1. https://code.vmware.com/apis/196/vsphere#https://vdc-repo.vmware.com/vmwb- repository/dcr-public/6b586ed2-655c-49d9-9029-bc416323cb22/fa0b429a-a695- 4c11-b7d2-2cbc284049dc/doc/vim.option.OptionManager.html 2. https://www.cisecurity.org/white-papers/cis-password-policy-guide/",
    "function_names": [
      "compute_host_account_lockout_enabled",
      "compute_host_failed_login_threshold",
      "compute_host_account_lockout_duration",
      "compute_host_account_lockout_failures",
      "compute_host_ssh_login_attempts_lockout",
      "compute_host_vsphere_login_attempts_lockout",
      "compute_host_account_lockout_auto_unlock",
      "compute_host_security_account_lock_failures",
      "compute_host_brute_force_protection_enabled",
      "compute_host_failed_attempts_lockout_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "A potential downside is the inadvertent denial-of-service scenario, especially with a low threshold for login failures. This could be exploited maliciously or trigger accidental lockouts, impacting system accessibility and possibly demanding additional administrative effort for account resets.",
    "references": "1. https://code.vmware.com/apis/196/vsphere#https://vdc-repo.vmware.com/vmwb- repository/dcr-public/6b586ed2-655c-49d9-9029-bc416323cb22/fa0b429a-a695- 4c11-b7d2-2cbc284049dc/doc/vim.option.OptionManager.html 2. https://www.cisecurity.org/white-papers/cis-password-policy-guide/"
  },
  {
    "id": "3.13",
    "title": "(L1) Host must unlock accounts after a specified timeout period",
    "assessment": "Automated",
    "description": "Ensuring that user accounts on the ESXi host are automatically unlocked after a specified period contributes to a balance between security and operational usability. This mechanism reactivates idle accounts promptly while mitigating potential unauthorized access risks. It's configured through a specific parameter which, when adjusted, defines the duration of the lockout period. The parameter governing this behavior is Security.AccountUnlockTime with a recommended setting of 900 seconds.",
    "rationale": "This setting reduces the inconvenience for benign users and the overhead on administrators, while also slowing down brute force credential stuffing attacks. Impact: No functional impact noted. The parameter\u2019s configuration ensures a security-usability balance, although misconfiguration could either expose the system to unauthorized access or disrupt user operations.",
    "audit": "To verify the account lockout is set to 15 minutes, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand System. 3. Select Advanced System Settings then click Edit. 4. Enter Security.AccountUnlockTime in the filter. 5. Verify that the value for this parameter is set to 900. Alternately, the following PowerCLI command may be used: Get-VMHost | Get-AdvancedSetting -Name Security.AccountUnlockTime",
    "remediation": "To set the account lockout to 15 minutes, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand System. 3. Select Advanced System Settings then click Edit. 4. Enter Security.AccountUnlockTime in the filter. 5. Set the value for this parameter to 900. Alternately, use the following PowerCLI command: Get-VMHost | Get-AdvancedSetting -Name Security.AccountUnlockTime | Set- AdvancedSetting -Value 900 References: 1. https://code.vmware.com/apis/1067/vsphere 2. https://www.cisecurity.org/white-papers/cis-password-policy-guide/",
    "function_names": [
      "esxi_host_account_unlock_timeout_enabled",
      "esxi_host_account_unlock_time_900s",
      "esxi_host_security_account_unlock_time_set",
      "esxi_host_account_lockout_duration_configured",
      "esxi_host_account_unlock_time_within_recommended_range"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No functional impact noted. The parameter\u2019s configuration ensures a security-usability balance, although misconfiguration could either expose the system to unauthorized access or disrupt user operations.",
    "references": "1. https://code.vmware.com/apis/1067/vsphere 2. https://www.cisecurity.org/white-papers/cis-password-policy-guide/"
  },
  {
    "id": "3.14",
    "title": "(L1) Host must configure the password history setting to restrict the reuse of passwords",
    "assessment": "Manual",
    "description": "The goal is to inhibit the reuse of past passwords, acting as a deterrent against potential security breaches stemming from the exploitation of old, compromised credentials. This is achieved by configuring the Security.PasswordHistory parameter, which specifies the number of unique passwords a user must cycle through before a previous password can be reused. The recommended setting for this parameter is 5.",
    "rationale": "By enforcing a password history policy, organizations make it harder for malicious actors to gain unauthorized access using old passwords. This in turn elevates the overall security posture. Impact: The impact of altering the Security.PasswordHistory parameter is dependent on the chosen value. A lower value might diminish security by allowing password reuse sooner, while a higher value increases security but may also increase the likelihood of user frustration.",
    "audit": "To verify the password history is set to 5, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand System. 3. Select Advanced System Settings then click Edit. 4. Enter Security.PasswordHistory in the filter. 5. Verify that the value for this parameter is set to 5. Alternately, the following PowerCLI command may be used: Get-VMHost | Get-AdvancedSetting Security.PasswordHistory",
    "remediation": "To set the password history 5, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand System. 3. Select Advanced System Settings then click Edit. 4. Enter Security.PasswordHistory in the filter. 5. Set the value for this parameter is set to 5. Alternately, the following PowerCLI command may be used: Get-VMHost | Get-AdvancedSetting Security.PasswordHistory | Set- AdvancedSetting -Value 5 Default Value: None References: 1. https://www.cisecurity.org/white-papers/cis-password-policy-guide/",
    "function_names": [
      "compute_instance_password_history_restricted",
      "compute_vm_password_reuse_prevented",
      "compute_host_password_history_enabled",
      "compute_security_password_history_min_5",
      "compute_password_history_restriction_active",
      "compute_instance_password_reuse_limit_set",
      "compute_host_password_history_compliance",
      "compute_security_password_history_enforced"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "The impact of altering the Security.PasswordHistory parameter is dependent on the chosen value. A lower value might diminish security by allowing password reuse sooner, while a higher value increases security but may also increase the likelihood of user frustration.",
    "references": "1. https://www.cisecurity.org/white-papers/cis-password-policy-guide/"
  },
  {
    "id": "3.15",
    "title": "(L1) Host must be configured with an appropriate maximum password age",
    "assessment": "Manual",
    "description": "Implementing a maximum password age, as determined by the Security.PasswordMaxDays parameter, is aligned with modern password policies outlined in NIST 800-63B Section 5.1.1.2, which argue against forced periodic password changes provided that passwords have sufficient complexity. The parameter governing this behavior is Security.PasswordMaxDays with a recommended setting of 99999.",
    "rationale": "Aligning with modern security standards by configuring an appropriate maximum password age can help in maintaining a balance between security and usability. This setting negates the need for periodic password changes, which have not been shown to significantly enhance security. Impact: Adjusting the Security.PasswordMaxDays parameter may affect vSphere UIs, requiring an email address for alert configurations. This necessitates either the provision of an email address or the use of PowerCLI for configuration, with the latter also requiring the configuration of an SMTP server in vCenter Server for email alerts. Various regulatory compliance frameworks have differing opinions of this practice.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_instance_password_max_age",
      "compute_instance_password_policy_compliant",
      "compute_instance_password_max_days_configured",
      "compute_instance_password_max_days_nist_compliant",
      "compute_instance_password_max_days_within_limit",
      "compute_instance_password_max_days_not_exceeded",
      "compute_instance_password_max_days_99999",
      "compute_instance_password_policy_enforced",
      "compute_instance_password_max_age_valid",
      "compute_instance_password_max_age_set"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Adjusting the Security.PasswordMaxDays parameter may affect vSphere UIs, requiring an email address for alert configurations. This necessitates either the provision of an email address or the use of PowerCLI for configuration, with the latter also requiring the configuration of an SMTP server in vCenter Server for email alerts. Various regulatory compliance frameworks have differing opinions of this practice."
  },
  {
    "id": "3.16",
    "title": "(L1) Host must configure a session timeout for the API",
    "assessment": "Manual",
    "description": "A designated timeout ensures that sessions are not left open indefinitely, thereby reducing the exposure window for potential security threats. The parameter governing this behavior is Config.HostAgent.vmacore.soap.sessionTimeout with a recommended setting of 30 seconds.",
    "rationale": "A session timeout ensures that potential security threats from unauthorized users or malicious software exploiting open sessions are significantly reduced. Impact: There is no functional impact noted when configuring this security control, making it a low-risk enhancement towards securing the ESXi environment.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_session_timeout_configured",
      "compute_host_session_timeout_30s",
      "compute_host_soap_session_timeout_configured",
      "compute_host_soap_session_timeout_30s",
      "compute_host_agent_session_timeout_configured",
      "compute_host_agent_session_timeout_30s",
      "compute_vmacore_soap_session_timeout_configured",
      "compute_vmacore_soap_session_timeout_30s"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact noted when configuring this security control, making it a low-risk enhancement towards securing the ESXi environment."
  },
  {
    "id": "3.17",
    "title": "(L1) Host must automatically terminate idle host client sessions",
    "assessment": "Manual",
    "description": "Configuring the host to automatically terminate idle host client sessions helps mitigate security risks associated with unattended sessions, which could potentially be exploited. The recommended setting for this control is a timeout value of 900. The parameter governing this behavior is UserVars.HostClientSessionTimeout.",
    "rationale": "Automatic termination of idle sessions is crucial for preventing potential unauthorized access or exploitation of unattended sessions, thereby enhancing the host's security posture. Impact: There is no functional impact mentioned, but ensuring a balanced timeout value is essential to prevent inadvertent session terminations while maintaining security.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_client_session_timeout_enabled",
      "compute_host_idle_session_termination_enabled",
      "compute_host_session_timeout_900s",
      "compute_host_user_vars_session_timeout_set",
      "compute_host_auto_terminate_idle_sessions",
      "compute_host_client_session_timeout_configured",
      "compute_host_session_termination_policy_enabled",
      "compute_host_idle_timeout_900_seconds"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact mentioned, but ensuring a balanced timeout value is essential to prevent inadvertent session terminations while maintaining security."
  },
  {
    "id": "3.18",
    "title": "(L1) Host must have an accurate DCUI.Access list",
    "assessment": "Manual",
    "description": "The DCUI.Access parameter in VMware ESXi is used to specify a list of users who are permitted to access the Direct Console User Interface (DCUI) of the ESXi host, especially when Lockdown Mode is enabled. This parameter helps in controlling and securing access to the ESXi host by allowing only authorized users to override Lockdown Mode and access the DCUI, particularly in scenarios where the host becomes isolated from vCenter. The parameter governing this behavior is DCUI.Access.",
    "rationale": "A properly configured DCUI.Access list ensures that only authorized users can override Lockdown Mode to access DCUI, providing a fail-safe against loss of management capability especially if the host loses connection to vCenter. Impact: Misconfiguration could lead to unauthorized access or potential lockout scenarios, making it crucial to validate the list and ensure the host's attachment to vCenter alongside correctly configured access and exception lists prior to Lockdown Mode activation.",
    "audit": "To verify a proper trusted users list is set for DCUI, perform the following from the vSphere web client: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand System. 3. Select Advanced System Settings then click Edit. 4. Enter DCUI.Access in the filter. 5. Verify that the DCUI.Access attribute is set to a comma-separated list of the users who are allowed to override lockdown mode. Alternately, the following PowerCLI command may be used: Get-VMHost | Get-AdvancedSetting -Name DCUI.Access",
    "remediation": "To set a trusted users list for DCUI, perform the following from the vSphere web client: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand System. 3. Select Advanced System Settings then click Edit. 4. Enter DCUI.Access in the filter. 5. Set the DCUI.Access attribute is set to a comma-separated list of the users who are allowed to override lockdown mode. References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22- B116-A8353D19FF56.html Additional Information: Note: By default only the \"root\" user is a member of the DCUI.Access list. It is not recommended to remove root from the DCUI.Access list, as this will revoke the root user's admin privileges on the host.",
    "function_names": [
      "esxi_host_dcui_access_authorized_users",
      "esxi_host_dcui_access_lockdown_mode_configured",
      "esxi_host_dcui_access_restricted",
      "esxi_host_dcui_access_no_unauthorized_users",
      "esxi_host_dcui_access_override_protected"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Misconfiguration could lead to unauthorized access or potential lockout scenarios, making it crucial to validate the list and ensure the host's attachment to vCenter alongside correctly configured access and exception lists prior to Lockdown Mode activation.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22- B116-A8353D19FF56.html Additional Information: Note: By default only the \"root\" user is a member of the DCUI.Access list. It is not recommended to remove root from the DCUI.Access list, as this will revoke the root user's admin privileges on the host."
  },
  {
    "id": "3.19",
    "title": "(L1) Host must have an accurate Exception Users list",
    "assessment": "Manual",
    "description": "Establishing an accurate Exception Users list is essential for managing user privileges during lockdown mode. Users on this list retain their privileges, making it imperative to include only those necessary for direct host access like service accounts for third-party solutions. Ensuring a well-maintained list mitigates the risk associated with unauthorized actions, especially during host isolation scenarios in lockdown mode.",
    "rationale": "The Exception Users list is crucial for preserving necessary operational capabilities while maintaining a secure environment. By carefully managing this list, organizations can balance between security and functionality, ensuring that critical operations continue unhindered during lockdown mode. Impact: An improperly managed Exception Users list could potentially undermine the security posture by allowing unauthorized access, increasing the risk of malicious actions. It's vital to review and update this list regularly to align with the current operational and security requirements.",
    "audit": "To verify the membership of the \"Exception Users\" list, perform the following in the vSphere Web Client: 1. Select the host. 2. Click on Configure then expand System and select Security Profile. 3. Under Lockdown Mode view and verify the list of Exception Users for accuracy.",
    "remediation": "To correct the membership of the Exception Users list, perform the following in the vSphere Web Client: 1. Select the host. 2. Click on Configure then expand System and select Security Profile. 3. Select Edit next to Lockdown Mode. 4. Click on Exception Users. 5. Add or delete users as appropriate. 6. Click OK. References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-6CD8C2E3-7925-4706- 8271- F42F2BCFF95D.html?hWord=N4IghgNiBcIQ9gYwNYBN4HcB2ACAtvKgKYgC+ QA",
    "function_names": [
      "compute_host_exception_users_accurate",
      "compute_host_exception_users_maintained",
      "compute_host_lockdown_users_accurate",
      "compute_host_lockdown_users_valid",
      "compute_host_exception_users_authorized",
      "compute_host_lockdown_users_authorized",
      "compute_host_exception_users_minimized",
      "compute_host_lockdown_users_minimized"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "An improperly managed Exception Users list could potentially undermine the security posture by allowing unauthorized access, increasing the risk of malicious actions. It's vital to review and update this list regularly to align with the current operational and security requirements.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-6CD8C2E3-7925-4706- 8271- F42F2BCFF95D.html?hWord=N4IghgNiBcIQ9gYwNYBN4HcB2ACAtvKgKYgC+ QA"
  },
  {
    "id": "3.20",
    "title": "(L1) Host must enable normal lockdown mode",
    "assessment": "Automated",
    "description": "Implementing normal lockdown mode restricts direct access to ESXi hosts, mandating management via vCenter Server to uphold defined roles and access controls, mitigating risks associated with unauthorized or insufficiently audited activities. Exception Users list serves as an override mechanism, permitting specified users direct access even in lockdown mode. This mode offers a balanced approach between security and operational flexibility compared to the stricter lockdown mode which, if connectivity to vCenter Server is lost, necessitates host rebuilding.",
    "rationale": "Enabling normal lockdown mode enforces centralized management through vCenter Server, ensuring adherence to organizational access controls and auditing policies. This measure significantly lowers the risk of unauthorized activities by restricting direct host access, promoting a more controlled and auditable operational environment. Impact: The activation of lockdown mode may impede direct host access for certain operations like backup and troubleshooting. Although temporary deactivation is an option, ensuring proper reactivation post-operation is crucial to maintain the intended security posture.",
    "audit": "To verify lockdown mode is enabled, perform the following from the vSphere web client: 1. From the vSphere Web Client, select the host. 2. Select Configure then expand System and select Security Profile. 3. Verify that Lockdown Mode is set to Normal. Alternately, the following PowerCLI command may be used: # To check if Lockdown mode is enabled Get-VMHost | Select Name,@{N=\"Lockdown\";E={$_.Extensiondata.Config.adminDisabled}}",
    "remediation": "To enable lockdown mode, perform the following from the vSphere web client: 1. From the vSphere Web Client, select the host. 2. Select Configure then expand System and select Security Profile. 3. Across from Lockdown Mode click on Edit. 4. Click the radio button for Normal. 5. Click OK. Alternately, run the following PowerCLI command: # Enable lockdown mode for each host Get-VMHost | Foreach { $_.EnterLockdownMode() } References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2- B838-225F5FF480FF.html",
    "function_names": [
      "compute_host_normal_lockdown_enabled",
      "compute_host_lockdown_exception_users_restricted",
      "compute_host_lockdown_mode_vcenter_managed",
      "compute_host_direct_access_disabled",
      "compute_host_lockdown_override_users_limited"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "The activation of lockdown mode may impede direct host access for certain operations like backup and troubleshooting. Although temporary deactivation is an option, ensuring proper reactivation post-operation is crucial to maintain the intended security posture.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2- B838-225F5FF480FF.html"
  },
  {
    "id": "3.21",
    "title": "(L2) Host should enable strict lockdown mode",
    "assessment": "Automated",
    "description": "Enabling lockdown mode disables direct local access to an ESXi host, requiring the host be managed remotely from vCenter Server. There are some operations, such as backup and troubleshooting, that require direct access to the host. In these cases, lockdown mode can be disabled on a temporary basis for specific hosts as needed, and then re-enabled when the task is completed. Note: Lockdown mode does not apply to users who log in using authorized keys. Also, users in the DCUI.Access list for each host are allowed to override lockdown mode and log in to the DCUI. By default, the \"root\" user is the only user listed in the DCUI.Access list.",
    "rationale": "Lockdown mode limits ESXi host access to the vCenter server to ensure the roles and access controls implemented in vCenter are always enforced and users cannot bypass them by logging into a host directly. By forcing all interaction to occur through vCenter Server, the risk of someone inadvertently attaining elevated privileges or performing tasks that are not properly audited is greatly reduced. Additionally strict lockdown move will disabled DCUI - Disabling DCUI prevents all local activity, and thus forces actions to be performed in vCenter Server, where they can be centrally audited and monitored. Impact: With lockdown mode enabled the host will only be accessible through vCenter preventing 'local' access. Disabling the DCUI can create a potential \"lockout\" situation, should the host become isolated from vCenter Server. Recovering from a \"lockout\" scenario requires reinstalling ESXi. Consider leaving DCUI enabled, and instead enable lockdown mode and limit the users allowed to access the DCUI using the DCUI.Access list.",
    "audit": "To verify lockdown mode is enabled, perform the following from the vSphere web client: 1. From the vSphere Web Client, select the host. 2. Select Configure then expand System and select Security Profile. 3. Verify that Lockdown Mode is set to Strict. Alternately, the following PowerCLI command may be used: # To check if Lockdown mode is enabled Get-VMHost | Select Name,@{N=\"Lockdown\";E={$_.Extensiondata.Config.adminDisabled}}",
    "remediation": "To enable lockdown mode, perform the following from the vSphere web client: 1. From the vSphere Web Client, select the host. 2. Select Configure then expand System and select Security Profile. 3. Across from Lockdown Mode click on Edit. 4. Click the radio button for Strict. 5. Click OK. Alternately, run the following PowerCLI command: # Enable lockdown mode for each host Get-VMHost | Foreach { $_.EnterLockdownMode() } References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2- B838-225F5FF480FF.html",
    "function_names": [
      "compute_host_lockdown_mode_enabled",
      "compute_host_lockdown_mode_strict",
      "compute_host_dcui_access_restricted",
      "compute_host_local_access_disabled",
      "compute_host_remote_management_required",
      "compute_host_lockdown_mode_temporary_override_disabled",
      "compute_host_root_dcui_access_restricted"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "With lockdown mode enabled the host will only be accessible through vCenter preventing 'local' access. Disabling the DCUI can create a potential \"lockout\" situation, should the host become isolated from vCenter Server. Recovering from a \"lockout\" scenario requires reinstalling ESXi. Consider leaving DCUI enabled, and instead enable lockdown mode and limit the users allowed to access the DCUI using the DCUI.Access list.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2- B838-225F5FF480FF.html"
  },
  {
    "id": "3.22",
    "title": "(L1) Host must deny shell access for the dcui account",
    "assessment": "Manual",
    "description": "The dcui account, utilized for process isolation for the Direct Console User Interface (DCUI), possesses shell access which, when deactivated, minimizes the attack surface. This action is a proactive measure to enhance system security.",
    "rationale": "Deactivating shell access for the dcui account reduces the avenues of exploitation available to potential attackers. It is a prudent step towards a hardened security posture. Impact: There is no functional impact noted from denying shell access for the dcui account, making it a low-risk yet effective security control.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vm_dcui_shell_disabled",
      "compute_host_dcui_shell_access_denied",
      "vmware_host_dcui_shell_restricted",
      "esxi_host_dcui_shell_disabled",
      "compute_dcui_account_shell_blocked"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact noted from denying shell access for the dcui account, making it a low-risk yet effective security control."
  },
  {
    "id": "3.23",
    "title": "(L2) Host must deny shell access for the vpxuser account",
    "assessment": "Manual",
    "description": "Deactivating shell access for the vpxuser account enhances security by enforcing an \"API only\" stance for predefined non-root ESXi users such as vpxuser and dcui.",
    "rationale": "This control reduces the attack surface by limiting the avenues through which system configurations can be altered, aligning with modern least privilege principles and ensuring that privileged authentication through vCenter Server remains tightly controlled. Impact: Deactivating shell access prevents users from granting shell access to others or changing passwords of users who have shell access, necessitating host-by-host reconfiguration through an authorized account if changes are required. This could potentially impact third-party workflows and necessitates the retention of at least one fully privileged user for necessary configurations.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "esxi_user_shell_access_denied",
      "esxi_vpxuser_shell_disabled",
      "esxi_account_api_only_enforced",
      "esxi_predefined_user_shell_restricted",
      "esxi_non_root_user_shell_denied"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "Deactivating shell access prevents users from granting shell access to others or changing passwords of users who have shell access, necessitating host-by-host reconfiguration through an authorized account if changes are required. This could potentially impact third-party workflows and necessitates the retention of at least one fully privileged user for necessary configurations."
  },
  {
    "id": "3.24",
    "title": "(L1) Host must display a login banner for the DCUI and Host Client",
    "assessment": "Manual",
    "description": "Enabling a login banner on the Direct Console User Interface (DCUI) and the Host Client interfaces provides a mechanism to display legal notices or organizational announcements at login. The parameter governing this behavior is Annotations.WelcomeMessage, with the recommended value being a text string aligned with organizational or legal advisories.",
    "rationale": "A login banner serves as a first line of legal defense against unauthorized access and misuse, stating the terms and conditions of system use. It also aids in reinforcing organizational security policies among authorized users. Impact: Implementation masks the \"F2/F12\" options and IP address information on the DCUI, potentially requiring additional documentation or training to ensure users are aware of these changes.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_login_banner_enabled",
      "compute_host_welcome_message_configured",
      "compute_dcui_banner_displayed",
      "compute_host_client_banner_displayed",
      "compute_host_annotations_welcome_message_set"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Implementation masks the \"F2/F12\" options and IP address information on the DCUI, potentially requiring additional documentation or training to ensure users are aware of these changes."
  },
  {
    "id": "3.25",
    "title": "(L1) Host must display a login banner for SSH connections",
    "assessment": "Manual",
    "description": "ESXi facilitates the display of a login message, primarily aimed to deter unauthorized access and inform legitimate users regarding system usage obligations, particularly during SSH connections. The text for this display is defined by a specific parameter, which is advisable to be configured, especially when SSH is active, albeit it's recommended to keep SSH in a stopped state barring troubleshooting scenarios. The parameter governing this behavior is Config.Etc.Issue.",
    "rationale": "Displaying a login banner serves as a preliminary deterrent to unauthorized users while reinforcing legal and policy compliances for authorized users. It encapsulates a proactive security measure, alongside aligning with several compliance mandates that necessitate the use of login banners. Impact: There is no functional impact associated with this security control; however, the absence of a login banner might pose a risk in terms of legal protection and compliance adherence, especially during SSH connections where potential misuse could occur. It's prudent to consult with legal advisors to craft a banner text that aligns with organizational and legal requisites.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_ssh_login_banner_enabled",
      "compute_host_ssh_banner_configured",
      "compute_host_issue_file_configured",
      "compute_host_ssh_warning_displayed",
      "compute_host_ssh_access_deterrent_enabled",
      "compute_host_ssh_usage_obligations_displayed",
      "compute_host_ssh_banner_text_defined",
      "compute_host_ssh_banner_parameter_set"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact associated with this security control; however, the absence of a login banner might pose a risk in terms of legal protection and compliance adherence, especially during SSH connections where potential misuse could occur. It's prudent to consult with legal advisors to craft a banner text that aligns with organizational and legal requisites."
  },
  {
    "id": "3.26",
    "title": "(L1) Host must enable the highest version of TLS supported",
    "assessment": "Manual",
    "description": "The host should be configured to operate using the highest version of TLS supported to ensure secure communications. ESXi 8, by default, comes with TLS 1.2 enabled, although re-enabling other protocols is possible if required. Employing the highest version of TLS aids in protecting against known vulnerabilities present in older versions. The parameter governing this behavior is UserVars.ESXiVPsDisabledProtocols with the recommended setting of \"sslv3,tlsv1,tlsv1.1\".",
    "rationale": "Employing the highest version of TLS supported enhances the security posture by ensuring that communications are protected with modern encryption standards. This mitigates risks associated with known vulnerabilities in outdated TLS versions. Impact: Failure to enable the highest version of TLS supported may expose the host to vulnerabilities present in older versions, potentially compromising the confidentiality and integrity of communications.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "esxi_host_tls_highest_version_enabled",
      "esxi_host_tls_legacy_protocols_disabled",
      "esxi_host_tls_sslv3_disabled",
      "esxi_host_tls_tlsv1_disabled",
      "esxi_host_tls_tlsv1_1_disabled",
      "esxi_host_tls_min_version_enforced",
      "esxi_host_tls_secure_protocols_only",
      "esxi_host_tls_user_vars_configured",
      "esxi_host_tls_vulnerable_protocols_disabled",
      "esxi_host_tls_default_secure_settings"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Failure to enable the highest version of TLS supported may expose the host to vulnerabilities present in older versions, potentially compromising the confidentiality and integrity of communications."
  },
  {
    "id": "4.1",
    "title": "(L1) Host must configure a persistent log location for all locally stored system logs",
    "assessment": "Manual",
    "description": "Configure the Syslog.global.logDir parameter to specify a persistent directory for system logs, ensuring they are retained across reboots. This can be set to a directory on mounted NFS or VMFS volumes, other than the default which is an in-memory filesystem that retains only a single day's worth of logs.",
    "rationale": "Storing logs persistently is crucial for auditing, monitoring events, and diagnosing issues. Without persistent logging, critical indicators of compromise and user activity logs are lost at each reboot, which can hinder incident response and forensic investigations. Impact: There is no specified functional impact, however, consideration should be given to storage capacity as increased log retention will require more storage space. If the only local, non-vSAN storage is unreliable SD or USB media, configuring a remote logging host is advised.",
    "audit": "To verify persistent logging is configured properly, perform the following from the vSphere web client: 1. Select the host 2. Click Configure then expand System then select Advanced System Settings. 3. Select Edit then enter Syslog.global.LogDir in the filter. 4. Ensure Syslog.global.logDir field is not empty (null value) or is not set explicitly to a non-persistent datastore or a scratch partition. If the Syslog.global.logDir parameter is pointing to 'Scratch' location (i.e. empty (null value) or is not set explicitly to a non-persistent datastore or a scratch partition), then ensure that the 'ScratchConfig.CurrentScratchLocation' parameter is also pointing to persistent storage. Alternatively, the following PowerCLI command may be used: # List Syslog.global.logDir for each host Get-VMHost | Select Name, @{N=\"Syslog.global.logDir\";E={$_ | Get- AdvancedConfiguration Syslog.global.logDir | Select -ExpandProperty Values}}",
    "remediation": "To configure persistent logging properly, perform the following from the vSphere web client: 1. Select the host 2. Click Configure then expand System then select Advanced System Settings. 3. Select Edit then enter Syslog.global.LogDir in the filter. 4. Set Syslog.global.logDir to a persistent location specified as [datastorename] path_to_file where the path is relative to the datastore. For example, [datastore1] /systemlogs. 5. Click OK. Alternatively, run the following PowerCLI command: # Set Syslog.global.logDir for each host Get-VMHost | Foreach { Set-AdvancedConfiguration -VMHost $_ -Name Syslog.global.logDir -Value \"<NewLocation>\" } References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F- B6C8-DAE8D95976E7.html 2. http://kb.vmware.com/kb/1033696 Additional Information: Note: Syslog.global.LogDir must be set for each host. The host syslog parameters can also be configured using the vCLI or PowerCLI, or using an API client.",
    "function_names": [
      "compute_host_log_dir_persistent",
      "compute_host_log_dir_non_ephemeral",
      "compute_host_log_dir_mounted_volume",
      "compute_host_log_dir_retained_across_reboots",
      "compute_host_log_dir_nfs_or_vmfs",
      "compute_host_log_dir_not_in_memory",
      "compute_host_log_dir_multi_day_retention"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no specified functional impact, however, consideration should be given to storage capacity as increased log retention will require more storage space. If the only local, non-vSAN storage is unreliable SD or USB media, configuring a remote logging host is advised.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F- B6C8-DAE8D95976E7.html 2. http://kb.vmware.com/kb/1033696 Additional Information: Note: Syslog.global.LogDir must be set for each host. The host syslog parameters can also be configured using the vCLI or PowerCLI, or using an API client."
  },
  {
    "id": "4.2",
    "title": "(L1) Host must transmit system logs to a remote log collector",
    "assessment": "Automated",
    "description": "Transmitting system logs to a remote log collector ensures that ESXi logs are stored in a secure and centralized manner. This centralization not only allows for the streamlined monitoring of all hosts through a single tool but also facilitates aggregate analysis and searching capabilities.",
    "rationale": "Centralizing log storage on a remote log collector greatly enhances the ability to monitor, search, and analyze logs across multiple hosts. This central repository ensures that logs are protected from potential tampering, while also providing a robust long-term audit trail. By analyzing these logs, coordinated attacks or anomalies that might go unnoticed on individual hosts can be detected. Impact: There is no immediate functional impact when transmitting logs to a remote log collector. However, it is essential to ensure that the remote log collector is adequately secured and has sufficient storage capacity.",
    "audit": "To ensure remote logging is configured properly, perform the following from the vSphere web client: 1. Select the host 2. Click Configure then expand System then select Advanced System Settings. 3. Select Edit then enter Syslog.global.logHost in the filter. 4. Verify the Syslog.global.logHost is set to the hostname of the central log server. Alternately, the following PowerCLI command may be used: # List Syslog.global.logHost for each host Get-VMHost | Select Name, @{N=\"Syslog.global.logHost\";E={$_ | Get- AdvancedSetting Syslog.global.logHost}}",
    "remediation": "To configure remote logging properly, perform the following from the vSphere web client: 1. Select the host 2. Click Configure then expand System then select Advanced System Settings. 3. Select Edit then enter Syslog.global.logHost in the filter. 4. Set the Syslog.global.logHost to the hostname or IP address of the central log server. 5. Click OK. Alternately, run the following PowerCLI command: # Set Syslog.global.logHost for each host Get-VMHost | Foreach { Set-AdvancedSetting -VMHost $_ -Name Syslog.global.logHost -Value \"<NewLocation>\" } Note: When setting a remote log host, it is also recommended to set the \"Syslog.global.logDirUnique\" to true. You must configure the syslog settings for each host. References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F- B6C8-DAE8D95976E7.html",
    "function_names": [
      "compute_host_remote_logging_enabled",
      "compute_host_log_collector_configured",
      "compute_host_system_logs_centralized",
      "compute_host_log_transmission_secure",
      "compute_host_log_forwarding_enabled",
      "compute_host_remote_log_storage_configured",
      "compute_host_log_aggregation_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no immediate functional impact when transmitting logs to a remote log collector. However, it is essential to ensure that the remote log collector is adequately secured and has sufficient storage capacity.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F- B6C8-DAE8D95976E7.html"
  },
  {
    "id": "4.3",
    "title": "(L1) Host must log sufficient information for events",
    "assessment": "Manual",
    "description": "Set the Syslog.global.logLevel parameter to \"info\" to ensure that audit logs capture sufficient information for diagnosing issues and investigating security events. This setting strikes a balance between log verbosity and storage utilization. The parameter governing this behavior is Syslog.global.logLevel with a recommended setting of info.",
    "rationale": "Adequate log data is crucial for identifying indicators of compromise, enabling timely and effective response to cybersecurity incidents. The \"info\" level provides essential details without excessively consuming storage resources. Impact: More verbose logging levels will demand additional storage space while potentially burying critical entries under less significant data. Conversely, less verbose levels might miss capturing crucial information, hindering effective diagnostics and incident response.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_log_level_info",
      "compute_syslog_global_log_level_info",
      "compute_host_audit_logs_sufficient",
      "compute_syslog_log_level_info",
      "compute_host_logging_info_enabled",
      "compute_syslog_global_log_level_set",
      "compute_host_event_logging_sufficient",
      "compute_syslog_log_level_configured"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "More verbose logging levels will demand additional storage space while potentially burying critical entries under less significant data. Conversely, less verbose levels might miss capturing crucial information, hindering effective diagnostics and incident response."
  },
  {
    "id": "4.4",
    "title": "(L1) Host must set the logging informational level to info",
    "assessment": "Manual",
    "description": "Set the logging informational level to \"info\" via the Config.HostAgent.log.level parameter to ensure audit logs contain adequate data for diagnostics and forensics. This level provides a balanced amount of detail, suitable for routine analysis and investigation. The parameter governing this behavior is Config.HostAgent.log.level with a recommended setting of info.",
    "rationale": "The \"info\" level balances the detail in logs, aiding in diagnostics and forensics without overwhelming storage resources. Impact: A more verbose log level increases data volume, demanding additional storage, while a less verbose level may lack crucial information for effective diagnostics and forensics.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_agent_log_level_info",
      "compute_host_logging_info_level",
      "host_agent_log_level_info",
      "host_logging_level_info",
      "compute_host_log_level_info"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "A more verbose log level increases data volume, demanding additional storage, while a less verbose level may lack crucial information for effective diagnostics and forensics."
  },
  {
    "id": "4.5",
    "title": "(L1) Host must deactivate log filtering",
    "assessment": "Manual",
    "description": "Log filtering can be employed to diminish the frequency of repetitive log entries and to preclude specific log events entirely. By employing the Syslog.global.logFilters configuration parameter, one can stipulate filtering criteria, which when met, will cause the designated log events to be excluded from the system logs. The control aids in maintaining a clean, informative logging environment by filtering out unwanted or redundant log entries. The parameter governing this behavior is Syslog.global.logFiltersEnable with a recommended setting of FALSE.",
    "rationale": "Comprehensive logging is crucial for understanding and monitoring system behavior. By deactivating log filtering, administrators can capture all log events, regardless of their frequency or perceived importance. This guarantees a complete record of system activity, which can be invaluable for incident response and post-incident analysis. Impact: There is no direct functional impact from deactivating log filtering. However, it may result in increased storage requirements for log files due to the additional log entries being stored. Organizations should ensure adequate storage space is available for logs and consider adjusting log retention policies if necessary.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "syslog_global_log_filters_disabled",
      "syslog_global_log_filters_no_filtering",
      "syslog_global_log_filters_deactivated",
      "syslog_global_log_filters_unset",
      "syslog_global_log_filters_false",
      "syslog_global_log_filters_empty",
      "syslog_global_log_filters_none",
      "syslog_global_log_filters_absent"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no direct functional impact from deactivating log filtering. However, it may result in increased storage requirements for log files due to the additional log entries being stored. Organizations should ensure adequate storage space is available for logs and consider adjusting log retention policies if necessary."
  },
  {
    "id": "4.6",
    "title": "(L1) Host must enable audit record logging",
    "assessment": "Manual",
    "description": "Enabling audit record logging on ESXi hosts ensures the local storage of audit records, providing a trail of activities performed on the host. This measure is pivotal for accountability, troubleshooting, and security investigations. The parameter governing this behavior is Syslog.global.auditRecord.storageEnable with a recommended setting of TRUE.",
    "rationale": "Enabling audit record logging is crucial for maintaining a secure and compliant operational environment. It provides visibility into host activities, aiding in identifying and investigating unauthorized or malicious actions. Impact: While beneficial for security and compliance, enabling audit record logging consumes additional storage space on the host, which may necessitate enhanced storage management practices to ensure optimal performance.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "esxi_host_audit_record_logging_enabled",
      "esxi_host_audit_record_storage_enabled",
      "esxi_host_syslog_audit_record_enabled",
      "esxi_host_audit_logging_enabled",
      "esxi_host_audit_storage_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "While beneficial for security and compliance, enabling audit record logging consumes additional storage space on the host, which may necessitate enhanced storage management practices to ensure optimal performance."
  },
  {
    "id": "4.7",
    "title": "(L1) Host must configure a persistent log location for all locally stored audit records",
    "assessment": "Manual",
    "description": "Configuring a persistent log location for locally stored audit records on ESXi hosts is critical to ensure audit continuity. When the \"/scratch\" directory is linked to \"/tmp/scratch\", only a day's worth of records are retained, and they are reinitialized upon each reboot, creating a security risk. A persistent datastore, except a vSAN datastore, should be designated for audit record logging to preserve records across reboots. The parameter governing this behavior is Syslog.global.auditRecord.storageDirectory.",
    "rationale": "A persistent log location safeguards audit records, enhancing the auditability and diagnosability of system events. This setup helps in adhering to compliance requirements and facilitating future audits. Impact: Implementing this control will consume additional storage space for logs, necessitating a balanced approach to storage management, especially when local non-vSAN storage options are limited.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "esxi_host_audit_logs_persistent_storage",
      "esxi_host_audit_logs_storage_directory_configured",
      "esxi_host_audit_logs_scratch_directory_not_tmp",
      "esxi_host_audit_logs_datastore_persistent",
      "esxi_host_audit_logs_vsan_datastore_excluded",
      "esxi_host_audit_logs_syslog_global_storage_directory_set"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Implementing this control will consume additional storage space for logs, necessitating a balanced approach to storage management, especially when local non-vSAN storage options are limited."
  },
  {
    "id": "4.8",
    "title": "(L1) Host must store one week of audit records",
    "assessment": "Manual",
    "description": "Ensuring a local storage capacity for a week's worth of audit records is imperative, especially when a remote audit record storage facility is used. This provision is critical during anticipated interruptions in record delivery to the remote facility, preventing loss or overwriting of audit records. The parameter governing this behavior is Syslog.global.auditRecord.storageCapacity with a recommended setting of 100.",
    "rationale": "Storing a week of audit records locally safeguards against data loss during interruptions with remote storage facilities, maintaining compliance and audit trail continuity. Impact: This security control entails additional storage space consumption for logs, requiring possible adjustments in storage management.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_audit_records_retained_7d",
      "compute_host_audit_storage_capacity_sufficient",
      "compute_host_audit_logs_min_retention_7d",
      "compute_host_audit_storage_min_capacity_100",
      "compute_host_audit_logs_storage_configured",
      "compute_host_audit_logs_retention_compliance",
      "compute_host_audit_storage_threshold_set",
      "compute_host_audit_logs_local_storage_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "This security control entails additional storage space consumption for logs, requiring possible adjustments in storage management."
  },
  {
    "id": "4.9",
    "title": "(L1) Host must transmit audit records to a remote log collector",
    "assessment": "Manual",
    "description": "This control enables the forwarding of audit records from the ESXi host to a designated log collector, aiding in real-time monitoring and analysis. The parameter governing this behavior is Syslog.global.auditRecord.remoteEnable with a recommended setting of TRUE.",
    "rationale": "Centralized logging facilitates a consolidated view of activities across ESXi hosts, enhancing the monitoring and rapid detection of unauthorized or anomalous activities. Impact: There is no noted functional impact from enabling this control; however, proper configuration is crucial to ensure reliable log transmission and to maintain the integrity and availability of audit records.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "esxi_host_audit_records_remote_forwarding_enabled",
      "esxi_host_syslog_audit_record_remote_enabled",
      "esxi_host_audit_log_remote_collector_enabled",
      "esxi_host_audit_log_forwarding_enabled",
      "esxi_host_syslog_global_audit_remote_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no noted functional impact from enabling this control; however, proper configuration is crucial to ensure reliable log transmission and to maintain the integrity and availability of audit records."
  },
  {
    "id": "4.10",
    "title": "(L1) Host must verify certificates for TLS remote logging endpoints",
    "assessment": "Manual",
    "description": "When engaging in remote logging activities, it is of utmost importance to ensure that the logging endpoint is genuine and secure. To achieve this, hosts should verify the TLS certificates of these endpoints. This verification provides assurance that the endpoint is both authentic and trustworthy, mitigating the risk of transmitting logs to potentially malicious or untrusted entities. The parameter governing this behavior is Syslog.global.certificate.checkSSLCerts with a recommended setting of TRUE.",
    "rationale": "Ensuring the authenticity and trustworthiness of remote logging endpoints is crucial for maintaining the security and integrity of the transmitted log data. By verifying the TLS certificates of these endpoints, the potential risk of man-in-the-middle attacks, data breaches, or unintended exposure of sensitive log information is significantly reduced. Impact: There is no direct functional impact when verifying certificates for TLS remote logging endpoints. However, it is essential to ensure that the certificates used by the logging endpoints are valid and up-to-date. If not, there might be interruptions in log transmissions or potential trust issues, necessitating certificate management and regular updates.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "logging_host_tls_certificate_verification_enabled",
      "logging_host_remote_endpoint_certificate_verified",
      "syslog_global_certificate_check_enabled",
      "remote_logging_endpoint_tls_verification_enabled",
      "logging_host_ssl_certificate_validation_required",
      "syslog_remote_endpoint_certificate_check_enabled",
      "logging_tls_endpoint_verification_enabled",
      "host_remote_logging_certificate_verification_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no direct functional impact when verifying certificates for TLS remote logging endpoints. However, it is essential to ensure that the certificates used by the logging endpoints are valid and up-to-date. If not, there might be interruptions in log transmissions or potential trust issues, necessitating certificate management and regular updates."
  },
  {
    "id": "4.11",
    "title": "(L1) Host must use strict x509 verification for TLS-enabled remote logging endpoints",
    "assessment": "Manual",
    "description": "When employing remote logging with TLS-enabled endpoints, it is essential to ensure the utmost integrity and authenticity of the certificates in use. The \"x509-strict\" option provides a higher level of security by performing additional validity checks on CA root certificates during the verification process. This increased scrutiny ensures that only genuinely authenticated and trusted certificates are accepted, minimizing potential vulnerabilities. The parameter governing this behavior is Syslog.global.certificate.strictX509Compliance with a recommended setting of TRUE.",
    "rationale": "Ensuring stringent verification of CA root certificates provides a higher level of trust and security in the remote logging process. Adopting the \"x509-strict\" option minimizes the risk of accepting compromised or malicious certificates, thereby reducing the potential for data breaches, man-in-the-middle attacks, or other security compromises. Impact: There is no immediate functional impact from using strict x509 verification for TLS- enabled remote logging endpoints. However, organizations must ensure that their CA root certificates meet the strict criteria set by this option. If certificates do not meet these criteria, there may be disruptions in log transmissions, necessitating adjustments or updates to the certificates in use.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "logging_remote_endpoint_x509_strict_verification_enabled",
      "logging_tls_endpoint_strict_x509_compliance_enabled",
      "syslog_global_certificate_strict_x509_compliance_enabled",
      "remote_logging_endpoint_x509_verification_strict_enabled",
      "tls_logging_endpoint_strict_x509_validation_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no immediate functional impact from using strict x509 verification for TLS- enabled remote logging endpoints. However, organizations must ensure that their CA root certificates meet the strict criteria set by this option. If certificates do not meet these criteria, there may be disruptions in log transmissions, necessitating adjustments or updates to the certificates in use."
  },
  {
    "id": "5.1",
    "title": "(L1) Host firewall must only allow traffic from authorized networks",
    "assessment": "Manual",
    "description": "The host's firewall is designed to block all incoming and outgoing network traffic by default, unless exceptions are explicitly made, thus minimizing the attack surface and barring unauthorized access. The firewall settings, while simplistic, are akin to router ACLs, and might require reflexive rules to be configured for certain network scenarios. Through the VMware Host Client, restrictions can be placed on a per-IP basis to only allow traffic from authorized networks, aligning with the security control's recommended value of permitting connections solely from authorized infrastructure and administration workstations.",
    "rationale": "Implementing a policy where only traffic from authorized networks is allowed, significantly enhances the host\u2019s security posture. It not only minimizes the attack surface but also helps in maintaining a clean network traffic flow, which is crucial for organizational security and operational efficiency. Impact: While this security control is instrumental in preventing unauthorized access, its simplistic firewall may necessitate additional configuration like reflexive rules, depending on the network setup. This could potentially require more administrative effort for correct configuration and management, ensuring that necessary communications are not inadvertently blocked.",
    "audit": "To confirm access to services running on an ESXi host is properly restricted, perform the following from the vSphere web client: 1. Select a host 2. Click Configure then expand System then select Firewall. 3. Click Edit to view services which are enabled (indicated by a check). 4. For each enabled service, (e.g., ssh, vSphere Web Access, http client) check to ensure that the list of allowed IP addresses specified is correct. Additionally, the following PowerCLI command may be used: # List all services for a host Get-VMHost HOST1 | Get-VMHostService # List the services which are enabled and have rules defined for specific IP ranges to access the service Get-VMHost HOST1 | Get-VMHostFirewallException | Where {$_.Enabled -and (-not $_.ExtensionData.AllowedHosts.AllIP)} # List the services which are enabled and do not have rules defined for specific IP ranges to access the service Get-VMHost HOST1 | Get-VMHostFirewallException | Where {$_.Enabled -and ($_.ExtensionData.AllowedHosts.AllIP)}",
    "remediation": "To properly restrict access to services running on an ESXi host, perform the following from the vSphere web client: 1. Select a host 2. Click Configure then expand System then select Firewall. 3. Click Edit to view services which are enabled (indicated by a check). 4. For each enabled service, (e.g., ssh, vSphere Web Access, http client) provide a list of allowed IP addresses. 5. Click OK. References: 1. https://docs.vmware.com/en/VMware- vSphere/6.7/com.vmware.vsphere.security.doc/GUID-8912DD42-C6EA-4299- 9B10-5F3AEA52C605.html",
    "function_names": [
      "compute_host_firewall_authorized_networks_only",
      "compute_host_firewall_default_deny_enabled",
      "compute_host_firewall_reflexive_rules_configured",
      "compute_host_firewall_ip_restrictions_enabled",
      "compute_host_firewall_admin_workstation_access_only"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "While this security control is instrumental in preventing unauthorized access, its simplistic firewall may necessitate additional configuration like reflexive rules, depending on the network setup. This could potentially require more administrative effort for correct configuration and management, ensuring that necessary communications are not inadvertently blocked.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.7/com.vmware.vsphere.security.doc/GUID-8912DD42-C6EA-4299- 9B10-5F3AEA52C605.html"
  },
  {
    "id": "5.2",
    "title": "(L1) Host must block network traffic by default",
    "assessment": "Manual",
    "description": "By default, the host is configured to block all incoming and outgoing network traffic, except for the traffic pertaining to services enabled in the host security profile. This configuration is pivotal in reducing the attack surface and averting unauthorized access to the host. Even though there isn't a specific configuration parameter provided, the firewall settings are manageable through the VMware Host Client, wherein rules can be specified to allow or deny traffic for each service on a per-IP basis, ensuring only authorized networks have access.",
    "rationale": "Adhering to a policy of blocking network traffic by default significantly minimizes the risk of unauthorized access and potential external attacks. This posture promotes a principle of least privilege on the network level, ensuring only explicitly allowed traffic can communicate with the host, thereby enhancing the security posture. Impact: There is no functional impact mentioned for this security control. However, overly restrictive configurations might impede necessary communications if not properly managed, potentially affecting service availability and operational efficiency. Therefore, careful consideration and testing are advised when adjusting firewall settings to ensure essential traffic is not inadvertently blocked.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_network_traffic_blocked_by_default",
      "compute_host_firewall_default_deny_all",
      "compute_host_security_profile_traffic_restricted",
      "compute_host_inbound_traffic_blocked_by_default",
      "compute_host_outbound_traffic_blocked_by_default",
      "compute_host_firewall_rules_default_deny",
      "compute_host_network_access_restricted_by_default",
      "compute_host_security_profile_default_deny_all"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact mentioned for this security control. However, overly restrictive configurations might impede necessary communications if not properly managed, potentially affecting service availability and operational efficiency. Therefore, careful consideration and testing are advised when adjusting firewall settings to ensure essential traffic is not inadvertently blocked."
  },
  {
    "id": "5.3",
    "title": "(L1) Host must restrict use of the dvFilter network API",
    "assessment": "Manual",
    "description": "The Net.DVFilterBindIpAddress parameter controls the use of the dvFilter network API, allowing network information to be sent to a specified IP address. If enabled with a compromised IP address, unauthorized network access to other virtual machines on the host could occur. It's essential to keep this parameter unconfigured, unless required by a product like VMware NSX. The parameter governing this behavior is Net.DVFilterBindIpAddress with a recommended setting of \"\".",
    "rationale": "Limiting the use of the dvFilter network API by keeping the Net.DVFilterBindIpAddress parameter unconfigured helps in reducing potential security risks. This restriction aids in maintaining secure network communication and minimizes the attack surface. Impact: No functional impact is identified when restricting the dvFilter network API. However, incorrect configuration can lead to insecure network communication, posing a risk to the network security of virtual machines on the host.",
    "audit": "If the dvfilter network API is not being used on the host, ensure that the following kernel parameter has a blank value: Net.DVFilterBindIpAddress. 1. From the vSphere web client, select the host and click Configure then expand System 2. Click on Advanced System Settings then Edit. 3. Search for Net.DVFilterBindIpAddress in the filter. 4. Verify Net.DVFilterBindIpAddress has an empty value. 5. If an appliance is being used, then ensure the value of this parameter is set to the proper IP address. Additionally, the following PowerCLI command may be used to verify the setting: # List Net.DVFilterBindIpAddress for each host Get-VMHost | Select Name, @{N=\"Net.DVFilterBindIpAddress\";E={$_ | Get- AdvancedSetting Net.DVFilterBindIpAddress | Select -ExpandProperty Values}}",
    "remediation": "To remove the configuration for the dvfilter network API, perform the following from the vSphere web client: 1. From the vSphere web client, select the host and click Configure then expand System 2. Click on Advanced System Settings then Edit. 3. Search for Net.DVFilterBindIpAddress in the filter. 4. Set Net.DVFilterBindIpAddress has an empty value. 5. If an appliance is being used, make sure the value of this parameter is set to the proper IP address. 6. Enter the proper IP address. 7. Click OK. To implement the recommended configuration state, run the following PowerCLI command: # Set Net.DVFilterBindIpAddress to null on all hosts Get-VMHost HOST1 | Foreach { Set-AdvancedSetting -VMHost $_ -Name Net.DVFilterBindIpAddress -IPValue \"\" } Default Value: Not configured References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A- B821-ED17A77B0206.html",
    "function_names": [
      "compute_host_dvfilter_api_restricted",
      "compute_host_dvfilter_bind_ip_unconfigured",
      "compute_host_network_api_restricted",
      "compute_host_dvfilter_bind_ip_empty",
      "compute_host_dvfilter_api_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No functional impact is identified when restricting the dvFilter network API. However, incorrect configuration can lead to insecure network communication, posing a risk to the network security of virtual machines on the host.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A- B821-ED17A77B0206.html"
  },
  {
    "id": "5.4",
    "title": "(L1) Host must filter Bridge Protocol Data Unit (BPDU) packets",
    "assessment": "Manual",
    "description": "To prevent cascading lockout of uplink interfaces from the ESXi host, the Net.BlockGuestBPDU parameter can be set to 1, enabling BPDU Filter to drop BPDU packets sent from virtual machines to the physical switch. This is crucial as ESXi's Standard and Distributed Virtual Switches do not support STP, making them prone to network loops if BPDUs are unfiltered. The parameter governing this behavior is Net.BlockGuestBPDU with a recommended setting of 1.",
    "rationale": "Configuring Net.BlockGuestBPDU aids in maintaining network stability by preventing potential disruptions caused by BPDU packets. This configuration is vital for avoiding unintended network lockouts and ensuring robust network communications. Impact: While beneficial for network stability, enabling BPDU filtering could block legitimate BPDU packets from network-oriented workloads. Ensure no legitimate BPDU packets are generated by virtual machines on the ESXi host before enabling this control.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_host_bpdu_filter_enabled",
      "compute_host_net_block_guest_bpdu_set",
      "compute_host_network_loop_protection_enabled",
      "compute_host_stp_bpdu_filtering_enabled",
      "compute_host_virtual_switch_bpdu_filter_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "While beneficial for network stability, enabling BPDU filtering could block legitimate BPDU packets from network-oriented workloads. Ensure no legitimate BPDU packets are generated by virtual machines on the ESXi host before enabling this control."
  },
  {
    "id": "5.5",
    "title": "(L2) Host should deactivate virtual hardware management network interfaces",
    "assessment": "Manual",
    "description": "Hardware management controllers may present virtual or USB NICs to the host, potentially serving as backdoors if left active. It's recommended to deactivate these interfaces both in the hardware configuration and within ESXi to prevent unauthorized access. The parameter governing this behavior is Net.BMCNetworkEnable with a recommended value of 0.",
    "rationale": "Deactivating virtual hardware management network interfaces minimizes the attack surface, thereby enhancing the security posture of the host. Impact: While this control enhances security, it may impact third-party managed solutions that require these interfaces, necessitating alternative configurations or additional management considerations.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_virtual_hardware_network_interface_deactivated",
      "compute_management_network_interface_disabled",
      "esxi_bmc_network_interface_deactivated",
      "esxi_net_bmc_network_enable_disabled",
      "hardware_management_controller_network_interface_deactivated"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "While this control enhances security, it may impact third-party managed solutions that require these interfaces, necessitating alternative configurations or additional management considerations."
  },
  {
    "id": "5.6",
    "title": "(L1) Host should reject forged transmits on standard virtual switches and port groups",
    "assessment": "Automated",
    "description": "Setting the \"Forged transmits\" option to \"Reject\" helps prevent MAC impersonation by comparing the source MAC address from the guest operating system with the effective MAC address of its virtual machine adapter. If there's a mismatch, the packet is dropped, preventing potential malicious activities through impersonated MAC addresses.",
    "rationale": "Rejecting forged transmits enhances network security by preventing unauthorized network access and malicious activities stemming from MAC impersonation. This setting upholds network integrity by ensuring only authorized communications occur within the network. Impact: This setting may affect workloads like clustered applications and network devices/functions that rely on MAC address modifications. Creating a separate port group for authorized virtual machines that require such behavior is recommended to balance operational needs with network security.",
    "audit": "To verify the policy is set to reject forged transmissions, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand Networking. 3. Select Virtual switches then click Edit. 4. Click on Security. 5. Verify that Forged transmits is set to Reject in the dropdown. Alternately, the following PowerCLI command may be used: # List all vSwitches and their Security Settings Get-VirtualSwitch -Standard | Select VMHost, Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Spec.Policy.Security.MacChanges) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Spec.Policy.Security.PromiscuousMode) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Spec.Policy.Security.ForgedTransmits) { \"Accept\" } Else { \"Reject\"} }}",
    "remediation": "To set the policy to reject forged transmissions, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand Networking. 3. Select Virtual switches then click Edit. 4. Click on Security. 5. Set Forged transmits to Reject in the dropdown. 6. Click on OK. Alternately, the following ESXi shell command may be used: # esxcli network vswitch standard policy security set -v vSwitch2 -f false References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html",
    "function_names": [
      "compute_virtual_switch_forged_transmits_rejected",
      "compute_port_group_forged_transmits_rejected",
      "compute_virtual_switch_mac_impersonation_prevented",
      "compute_port_group_mac_impersonation_prevented",
      "compute_virtual_switch_source_mac_validation_enabled",
      "compute_port_group_source_mac_validation_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "This setting may affect workloads like clustered applications and network devices/functions that rely on MAC address modifications. Creating a separate port group for authorized virtual machines that require such behavior is recommended to balance operational needs with network security.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html"
  },
  {
    "id": "5.7",
    "title": "(L1) Host should reject MAC address changes on standard virtual switches and port groups",
    "assessment": "Automated",
    "description": "Enforcing MAC address stability on standard virtual switches and port groups prevents MAC impersonation by disallowing changes to the MAC address by virtual machines. This mitigates the risk of malicious activities initiated by impersonating authorized network adapters.",
    "rationale": "Preventing MAC address changes hinders unauthorized network access and potential malicious acts, contributing to a more secure network environment. This control aids in maintaining network integrity by ensuring only authorized network communications occur. Impact: Certain workloads and operations reliant on MAC address modifications could be affected. Creating a separate port group for authorized virtual machines that require MAC address changes is recommended to balance operational and security needs.",
    "audit": "To verify the policy is set to reject, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand Networking. 3. Select Virtual switches then click Edit. 4. Click on Security. 5. Verify that MAC address changes is set to Reject in the dropdown. Alternately, the following PowerCLI command may be used: # List all vSwitches and their Security Settings Get-VirtualSwitch -Standard | Select VMHost, Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Spec.Policy.Security.MacChanges) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Spec.Policy.Security.PromiscuousMode) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Spec.Policy.Security.ForgedTransmits) { \"Accept\" } Else { \"Reject\"} }}",
    "remediation": "To set the policy to reject, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand Networking. 3. Select Virtual switches then click Edit. 4. Click on Security. 5. Set MAC address changes to Reject in the dropdown. 6. Click on OK. Alternately, perform the following using the ESXi shell: # esxcli network vswitch standard policy security set -v vSwitch2 -m false References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html",
    "function_names": [
      "compute_virtual_switch_mac_change_rejected",
      "compute_port_group_mac_change_rejected",
      "compute_standard_switch_mac_stability_enforced",
      "compute_port_group_mac_stability_enforced",
      "compute_virtual_switch_mac_impersonation_prevented",
      "compute_port_group_mac_impersonation_prevented"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Certain workloads and operations reliant on MAC address modifications could be affected. Creating a separate port group for authorized virtual machines that require MAC address changes is recommended to balance operational and security needs.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html"
  },
  {
    "id": "5.8",
    "title": "(L1) Host should reject promiscuous mode requests on standard virtual switches and port groups",
    "assessment": "Automated",
    "description": "Enabling promiscuous mode allows all virtual machines in a port group to read all packets transmitted across it, regardless of the intended recipient. Rejecting promiscuous mode requests on standard virtual switches and port groups prevents unauthorized packet inspection, enhancing network isolation and data privacy.",
    "rationale": "Rejecting promiscuous mode requests helps maintain network isolation and data privacy by ensuring packets reach only their intended recipients. This control minimizes the risk of data interception or unauthorized packet inspection. Impact: Some workloads like DHCP servers or security monitoring may require promiscuous mode. In such cases, a separate port group allowing this behavior, with only authorized virtual machines connected, is advisable to balance operational needs with security controls.",
    "audit": "To verify the policy is set to reject, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand Networking. 3. Select Virtual switches then click Edit. 4. Click on Security. 5. Verify that Promiscuous mode is set to Reject in the dropdown. Alternately, the following PowerCLI command may be used: # List all vSwitches and their Security Settings Get-VirtualSwitch -Standard | Select VMHost, Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Spec.Policy.Security.MacChanges) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Spec.Policy.Security.PromiscuousMode) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Spec.Policy.Security.ForgedTransmits) { \"Accept\" } Else { \"Reject\"} }}",
    "remediation": "To set the policy to reject, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand Networking. 3. Select Virtual switches then click Edit. 4. Click on Security. 5. Set Promiscuous mode to Reject in the dropdown. 6. Click on OK. Alternately, perform the following via the ESXi shell: # esxcli network vswitch standard policy security set -v vSwitch2 -p false Default Value: Reject References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html",
    "function_names": [
      "compute_virtual_switch_promiscuous_mode_rejected",
      "compute_port_group_promiscuous_mode_rejected",
      "compute_virtual_switch_standard_promiscuous_mode_disabled",
      "compute_port_group_standard_promiscuous_mode_disabled",
      "compute_network_switch_promiscuous_mode_blocked",
      "compute_network_port_group_promiscuous_mode_blocked"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Some workloads like DHCP servers or security monitoring may require promiscuous mode. In such cases, a separate port group allowing this behavior, with only authorized virtual machines connected, is advisable to balance operational needs with security controls.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html"
  },
  {
    "id": "5.9",
    "title": "(L1) Host must restrict access to a default or native VLAN on standard virtual switches",
    "assessment": "Automated",
    "description": "ESXi does not use the concept of native VLAN, so do not configure port groups to use the native VLAN ID. If the default value of 1 for the native VLAN is being used, the ESXi Server virtual switch port groups should be configured with any value between 2 and 4094. Otherwise, ensure that the port group is not configured to use whatever value is set for the native VLAN.",
    "rationale": "Frames with VLAN specified in the port group will have a tag, but frames without a VLAN specified in the port group are not tagged and therefore will end up as belonging to the native VLAN of the physical switch. For example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a \u201c1\u201d; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a \u201c1\u201d instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged). If the ESXi virtual switch port group uses the native VLAN ID, traffic from those VMs will not be visible to the native VLAN on the switch, because the switch is expecting untagged traffic.",
    "audit": "To verify the native VLAN ID is not being used for port groups, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand Networking. 3. Select Virtual switches. 4. Expand the Standard vSwitch. 5. View the topology diagram of the switch, which shows the various port groups associated with that switch. 6. For each port group on the vSwitch, verify and record the VLAN IDs used. Alternately, the following PowerCLI command may be used: # List all vSwitches, their Portgroups and VLAN IDs Get-VirtualPortGroup -Standard | Select virtualSwitch, Name, VlanID",
    "remediation": "To stop using the native VLAN ID for port groups, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand Networking. 3. Select Virtual switches. 4. Expand the Standard vSwitch. 5. View the topology diagram of the switch, which shows the various port groups associated with that switch. 6. For each port group on the vSwitch, verify and record the VLAN IDs used. 7. If a VLAN ID change is needed, click the name of the port group in the topology diagram of the virtual switch. 8. Click the Edit settings option. 9. In the Properties section, enter an appropriate name in the Network label field. 10. In the VLAN ID dropdown select or type a new VLAN. 11. Click OK. References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.networking.doc/GUID-3A9D9911-3632-4B81- 9D2E-A2F9F2D01180.html",
    "function_names": [
      "esxi_port_group_native_vlan_restricted",
      "esxi_virtual_switch_default_vlan_disabled",
      "esxi_port_group_non_default_vlan_assigned",
      "esxi_virtual_switch_vlan_id_outside_native_range",
      "esxi_port_group_vlan_id_valid_range",
      "esxi_virtual_switch_native_vlan_avoided",
      "esxi_port_group_vlan_id_not_native",
      "esxi_virtual_switch_vlan_id_compliant"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.networking.doc/GUID-3A9D9911-3632-4B81- 9D2E-A2F9F2D01180.html"
  },
  {
    "id": "5.10",
    "title": "(L1) Host must restrict the use of Virtual Guest Tagging (VGT) on standard virtual switches",
    "assessment": "Automated",
    "description": "When a port group is set to VLAN 4095 on standard virtual switches, it enables Virtual Guest Tagging (VGT), letting all network frames pass to the attached virtual machines (VMs) without altering the VLAN tags. This requires VMs to process VLAN information themselves via an 802.1Q driver. Only authorized and capable VMs should be allowed to use VGT to prevent potential network issues like denial of service or unauthorized VLAN traffic interaction.",
    "rationale": "Restricting VGT use helps maintain network security by ensuring controlled VLAN tag management. It mitigates risks associated with denial of service or unauthorized VLAN interactions, contributing to a stable network environment. Impact: Incorrect VGT configuration can lead to denial of service or unauthorized VLAN traffic interaction. Restricting VGT may require alternative configurations for VMs needing independent VLAN tag management, potentially affecting network operation.",
    "audit": "To verify port groups are not set to 4095 unless VGT is required, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand Networking. 3. Select Virtual switches. 4. Expand the Standard vSwitch. 5. View the topology diagram of the switch, which shows the various port groups associated with that switch. 6. For each port group on the vSwitch, verify and record the VLAN IDs used. Additionally, the following PowerCLI command may be used: # List all vSwitches, their Portgroups and VLAN IDs Get-VirtualPortGroup -Standard | Select virtualSwitch, Name, VlanID",
    "remediation": "To set port groups to values other than 4095 and 0 unless VGT is required, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand Networking. 3. Select Virtual switches. 4. Expand the Standard vSwitch. 5. View the topology diagram of the switch, which shows the various port groups associated with that switch. 6. For each port group on the vSwitch, verify and record the VLAN IDs used. 7. If a VLAN ID change is needed, click the name of the port group in the topology diagram of the virtual switch. 8. Click the Edit settings option. 9. In the Properties section, enter an appropriate name in the Network label field. 10. In the VLAN ID dropdown select or type a new VLAN. 11. Click OK. References: 1. http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12- 2/20ew/configuration/guide/config/vlans.html#wp1038758",
    "function_names": [
      "compute_virtual_switch_vgt_restricted",
      "compute_port_group_vlan_4095_disabled",
      "compute_vm_vgt_usage_authorized",
      "compute_standard_switch_vgt_protected",
      "compute_vlan_tagging_vm_approved_only"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Incorrect VGT configuration can lead to denial of service or unauthorized VLAN traffic interaction. Restricting VGT may require alternative configurations for VMs needing independent VLAN tag management, potentially affecting network operation.",
    "references": "1. http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12- 2/20ew/configuration/guide/config/vlans.html#wp1038758"
  },
  {
    "id": "5.11",
    "title": "(L1) Host must isolate management communications",
    "assessment": "Manual",
    "description": "Ensure that only vmk interfaces designated for management purposes have management services enabled to uphold network isolation and security. Incorrect configuration may undermine security efforts by breaching network isolation principles.",
    "rationale": "Restricting management services to designated vmk interfaces minimizes the attack surface and ensures that management communications are isolated from other traffic, adhering to network segmentation best practices. Impact: This control may affect third-party managed solutions requiring specific configurations. Configurations may need to be tailored based on the particular environment and third- party solutions in use.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vmk_interface_management_services_restricted",
      "compute_management_network_isolation_enabled",
      "compute_vmk_interface_management_only",
      "compute_management_traffic_isolated",
      "compute_vmk_interface_no_non_management_services",
      "compute_management_network_security_enforced",
      "compute_vmk_interface_management_services_exclusive",
      "compute_management_traffic_restricted_to_vmk"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "This control may affect third-party managed solutions requiring specific configurations. Configurations may need to be tailored based on the particular environment and third- party solutions in use."
  },
  {
    "id": "6.1.1",
    "title": "(L1) Host CIM services, if enabled, must limit access",
    "assessment": "Manual",
    "description": "The Common Information Model (CIM) system allows for hardware-level management from remote applications through standard APIs. Ensuring only minimal access necessary to these applications is imperative to prevent potential security compromises. A dedicated service account, specific to each CIM application, should be created to limit access and privileges.",
    "rationale": "Restricting access to CIM services is essential to prevent unauthorized or over- privileged access, which could lead to potential security vulnerabilities. This practice adheres to the principle of least privilege, promoting a more secure environment. Impact: If improper access is granted to CIM-based hardware monitoring tools or other third- party applications, they may not function as expected or could be exploited to compromise the host's security.",
    "audit": "To verify CIM access is limited, check for a limited-privileged service account with the following CIM roles applied: Host.Config.SystemManagement Host.CIM.CIMInteraction Alternately, the following PowerCLI command may be used: # List all user accounts on the Host -Host Local connection required- Get-VMHostAccount",
    "remediation": "To limit CIM access, perform the following: 1. Create a limited-privileged service account for CIM and other third-party applications. 2. This account should access the system via vCenter. 3. Give the account the CIM Interaction privilege only. This will enable the account to obtain a CIM ticket, which can then be used to perform both read and write CIM operations on the target host. If an account must connect to the host directly, this account must be granted the full \"Administrator\" role on the host. This is not recommended unless required by the monitoring software being used. Alternately, run the following PowerCLI command: # Create a new host user account -Host Local connection required- New-VMHostAccount -ID ServiceUser -Password <password> -UserAccount References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-645EBD81-CF86-44D7- BE77-224EF963D145.html",
    "function_names": [
      "compute_cim_service_access_restricted",
      "compute_cim_service_dedicated_account_required",
      "compute_cim_service_minimal_privileges_enforced",
      "compute_cim_service_remote_access_limited",
      "compute_cim_service_api_access_controlled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "If improper access is granted to CIM-based hardware monitoring tools or other third- party applications, they may not function as expected or could be exploited to compromise the host's security.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-645EBD81-CF86-44D7- BE77-224EF963D145.html"
  },
  {
    "id": "6.2.1",
    "title": "(L1) Host must isolate storage communications",
    "assessment": "Manual",
    "description": "Isolating storage communications through zoning and Logical Unit Number (LUN) masking is instrumental in segregating Storage Area Network (SAN) activity. Zoning defines the connections between host bus adapters (HBAs) and targets, ensuring devices outside a zone remain invisible to the devices within, thus facilitating the independent management of zones such as testing and production. On the other hand, LUN masking controls the visibility and accessibility of LUNs to different hosts, further enhancing the granularity of access control within the storage network. By implementing these measures, the attack surface of the SAN is reduced, non-ESXi systems are prevented from accessing the SAN, and separation of environments like test and production is achieved.",
    "rationale": "Employing zoning and LUN masking to isolate storage communications is vital to reduce the risk of unauthorized access and potential cross-contamination between different operational environments. It allows for a more structured and secure management of storage resources, ensuring that unauthorized or incompatible systems are prevented from interacting with or accessing the SAN, thus contributing to the overall security and operational integrity of the environment. Impact: Failing to isolate storage communications can lead to an increased risk of unauthorized access to storage resources, potential data leakage, or interference between different operational zones. The lack of segregation might also pose challenges in managing and troubleshooting storage network activities, leading to operational inefficiencies and potential security risks.",
    "audit": "The audit procedures to verify SAN activity is properly segregated are SAN vendor or product-specific.",
    "remediation": "The remediation procedures to properly segregate SAN activity are SAN vendor or product-specific. In general, with ESXi hosts, use a single-initiator zoning or a single-initiator-single-target zoning. The latter is a preferred zoning practice. Using the more restrictive zoning prevents problems and misconfigurations that can occur on the SAN. References: 1. https://docs.vmware.com/en/VMware- vSphere/6.7/com.vmware.vsphere.storage.doc/GUID-6029358F-8EE8-4143- 9BB0-16ABB3CA0FE3.html 2. https://docs.vmware.com/en/VMware- vSphere/6.7/com.vmware.vsphere.security.doc/GUID-BFE9046A-2278-4026- 809A-ED8F9D8FDACE.html 3. https://docs.vmware.com/en/VMware- vSphere/6.7/com.vmware.vsphere.storage.doc/GUID-39A4551F-4B03-43A6- BEDF-FAB1528C070D.html",
    "function_names": [
      "storage_host_zoning_enabled",
      "storage_host_lun_masking_enabled",
      "storage_host_san_isolation_enabled",
      "storage_host_production_test_separation_enabled",
      "storage_host_hba_target_zoning_enabled",
      "storage_host_non_esxi_access_blocked",
      "storage_host_san_attack_surface_reduced"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Failing to isolate storage communications can lead to an increased risk of unauthorized access to storage resources, potential data leakage, or interference between different operational zones. The lack of segregation might also pose challenges in managing and troubleshooting storage network activities, leading to operational inefficiencies and potential security risks.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.7/com.vmware.vsphere.storage.doc/GUID-6029358F-8EE8-4143- 9BB0-16ABB3CA0FE3.html 2. https://docs.vmware.com/en/VMware- vSphere/6.7/com.vmware.vsphere.security.doc/GUID-BFE9046A-2278-4026- 809A-ED8F9D8FDACE.html 3. https://docs.vmware.com/en/VMware- vSphere/6.7/com.vmware.vsphere.storage.doc/GUID-39A4551F-4B03-43A6- BEDF-FAB1528C070D.html"
  },
  {
    "id": "6.2.2",
    "title": "(L1) Host must ensure all datastores have unique names",
    "assessment": "Manual",
    "description": "Ensuring unique naming for datastores is crucial to avoid potential errors that could affect the integrity and availability of data. A descriptive and unique name for each datastore facilitates better identification and management. Although there's no specific parameter to enforce this, manual or automated naming conventions should be adhered to.",
    "rationale": "Unique and descriptive naming for datastores minimizes the risk of errors, improves manageability, and aids in quicker identification, especially in environments with numerous datastores. It's a proactive measure to maintain order and avoid issues that arise from the default names given to VMFS and vSAN datastores. Impact: Not adhering to a unique naming convention can lead to confusion, misconfiguration, or incorrect data access. While renaming datastores could have downstream effects on systems like automation, monitoring, and backup, the benefits of unique naming conventions outweigh the potential negatives.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_datastore_unique_name",
      "compute_datastore_name_unique_all_regions",
      "compute_datastore_naming_convention_compliance",
      "compute_datastore_duplicate_name_prevention",
      "compute_datastore_name_uniqueness_enforced"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Not adhering to a unique naming convention can lead to confusion, misconfiguration, or incorrect data access. While renaming datastores could have downstream effects on systems like automation, monitoring, and backup, the benefits of unique naming conventions outweigh the potential negatives."
  },
  {
    "id": "6.3.1",
    "title": "(L1) Host iSCSI client, if enabled, must employ bidirectional/mutual CHAP authentication",
    "assessment": "Automated",
    "description": "Implementing bidirectional CHAP authentication for iSCSI connections elevates security by necessitating mutual verification between the initiator (client) and target (server), ensuring data integrity during transmission. Configuration involves setting the iSCSI storage adapter authentication to \"Use bidirectional CHAP\" and providing the requisite credentials. This setup ensures that all communication between the client and server remains secure and unaltered, significantly reducing the risk of data interception by unauthorized entities. The parameter governing this behavior is set iSCSI storage adapter authentication to \"Use bidirectional CHAP\" with a recommended setting of Enabled.",
    "rationale": "Employing bidirectional CHAP authentication significantly minimizes risks associated with data interception or alteration by unauthorized entities during transmissions between the initiator and target. This additional layer of security is crucial in maintaining data integrity and confidentiality in iSCSI connections. Impact: No functional impact is anticipated upon the implementation of this control. However, it's imperative to ensure correct configuration to avoid potential communication disruptions between the iSCSI client and server.",
    "audit": "To verify that bidirectional CHAP authentication is enabled for iSCSI traffic, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand Storage. 3. Select Storage Adapters then select the iSCSI Adapter. 4. Under Properties verify that the Authentication method is set to Use bidirectional CHAP. Alternately, the following PowerCLI command may be used: # List Iscsi Initiator and CHAP Name if defined Get-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Select VMHost, Device, ChapType, @{N=\"CHAPName\";E={$_.AuthenticationProperties.ChapName}}",
    "remediation": "To enable bidirectional CHAP authentication for iSCSI traffic, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand Storage. 3. Select Storage Adapters then select the iSCSI Adapter. 4. Under Properties click on Edit next to Authentication. 5. Next to Authentication Method select Use bidirectional CHAP from the dropdown. 6. Specify the outgoing CHAP name. \u2022 Make sure that the name you specify matches the name configured on the storage side. o To set the CHAP name to the iSCSI adapter name, select \"Use initiator name\". o To set the CHAP name to anything other than the iSCSI initiator name, deselect \"Use initiator name\" and type a name in the Name text box.  8. Enter an outgoing CHAP secret to be used as part of authentication. Use the same secret as your storage side secret. 9. Specify incoming CHAP credentials. Make sure your outgoing and incoming secrets do not match. 10. Click OK. 11. Click the second to last symbol labeled Rescan Adapter. Alternately, run the following PowerCLI command: # Set the Chap settings for the Iscsi Adapter Get-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Set-VMHostHba # Use desired parameters here References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109- 96DD-49B433E2F266.html 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18- A083-8E65FE380899.html Additional Information: Prerequisites - Before setting up CHAP parameters for software or dependent hardware iSCSI, determine whether to configure unidirectional or bidirectional CHAP. Independent hardware iSCSI adapters do not support bidirectional CHAP. \u2022 Verify CHAP parameters configured on the storage side. Parameters that you configure must match the ones on the storage side. \u2022 Required privilege: Host.Configuration.Storage Partition Configuration",
    "function_names": [
      "iscsi_client_bidirectional_chap_enabled",
      "iscsi_client_mutual_authentication_required",
      "iscsi_storage_adapter_authentication_configured",
      "iscsi_connection_chap_credentials_set",
      "iscsi_initiator_target_verification_enabled",
      "iscsi_data_integrity_protection_enabled",
      "iscsi_authentication_bidirectional_chap_required"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No functional impact is anticipated upon the implementation of this control. However, it's imperative to ensure correct configuration to avoid potential communication disruptions between the iSCSI client and server.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109- 96DD-49B433E2F266.html 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18- A083-8E65FE380899.html Additional Information: Prerequisites - Before setting up CHAP parameters for software or dependent hardware iSCSI, determine whether to configure unidirectional or bidirectional CHAP. Independent hardware iSCSI adapters do not support bidirectional CHAP. \u2022 Verify CHAP parameters configured on the storage side. Parameters that you configure must match the ones on the storage side. \u2022 Required privilege: Host.Configuration.Storage Partition Configuration"
  },
  {
    "id": "6.3.2",
    "title": "(L1) Host iSCSI client, if enabled, must employ unique CHAP authentication secrets",
    "assessment": "Manual",
    "description": "Challenge-Handshake Authentication Protocol (CHAP) requires both client and host to know a secret to establish a connection. It is essential to employ unique CHAP authentication secrets for each iSCSI session to ensure secure communications. The parameter governing this behavior is outlined in the iSCSI or iSER storage adapter configuration under CHAP settings.",
    "rationale": "Utilizing unique CHAP authentication secrets for each iSCSI session promotes secure data transmission and mitigates the risk of unauthorized access. Impact: While enhancing security, misconfiguration or sharing of CHAP secrets across sessions could potentially lead to connectivity issues or unauthorized access.",
    "audit": "To verify the CHAP secrets are unique, run the following to list all iSCSI adapters and their corresponding CHAP configuration: # List Iscsi Initiator and CHAP Name if defined Get-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Select VMHost, Device, ChapType, @{N=\"CHAPName\";E={$_.AuthenticationProperties.ChapName}}",
    "remediation": "To change the values of CHAP secrets so they are unique, perform the following: 1. From the vSphere Web Client, select the host. 2. Click Configure then expand Storage. 3. Select Storage Adapters then select the iSCSI Adapter. 4. Under Properties click on Edit next to Authentication. 5. Next to Authentication Method specify the authentication method from the dropdown. o None o Use unidirectional CHAP if required by target o Use unidirectional CHAP unless prohibited by target o Use unidirectional CHAP o Use bidirectional CHAP 6. Specify the outgoing CHAP name. \u2022 Make sure that the name you specify matches the name configured on the storage side. o To set the CHAP name to the iSCSI adapter name, select \"Use initiator name\". o To set the CHAP name to anything other than the iSCSI initiator name, deselect \"Use initiator name\" and type a name in the Name text box.  8. Enter an outgoing CHAP secret to be used as part of authentication. Use the same secret as your storage side secret. 9. If configuring with bidirectional CHAP, specify incoming CHAP credentials. \u2022 Make sure your outgoing and incoming secrets do not match.  10. If configuring with bidirectional CHAP, specify incoming CHAP credentials. \u2022 Make sure your outgoing and incoming secrets do not match.  11. Click OK. 12. Click the second to last symbol labeled Rescan Adapter References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109- 96DD-49B433E2F266.html 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18- A083-8E65FE380899.html Additional Information: If you change the CHAP parameters, they are used for new iSCSI sessions. For existing sessions, new settings are not used until you log out and log in again.",
    "function_names": [
      "iscsi_client_chap_auth_unique_secrets",
      "iscsi_client_unique_chap_credentials",
      "iscsi_adapter_chap_secret_uniqueness",
      "iscsi_host_chap_authentication_unique",
      "iscsi_storage_chap_secret_per_session",
      "iscsi_session_unique_chap_required",
      "iscsi_chap_credentials_per_client_unique",
      "iscsi_adapter_chap_unique_secrets_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "While enhancing security, misconfiguration or sharing of CHAP secrets across sessions could potentially lead to connectivity issues or unauthorized access.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109- 96DD-49B433E2F266.html 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18- A083-8E65FE380899.html Additional Information: If you change the CHAP parameters, they are used for new iSCSI sessions. For existing sessions, new settings are not used until you log out and log in again."
  },
  {
    "id": "6.4.1",
    "title": "(L1) Host SNMP services, if enabled, must limit access",
    "assessment": "Manual",
    "description": "To manage hosts securely, if SNMP is enabled, access must be restricted. Preferably, SNMPv3 should be employed as it offers superior security through key authentication and encryption compared to SNMPv1 or SNMPv2. Configuring the destination for SNMP traps is essential for ensuring monitoring data is directed to a legitimate and secure host.",
    "rationale": "Proper SNMP configuration is crucial to reduce the risk of misuse or compromise, especially if other management means are in place. SNMPv3\u2019s enhanced security features are pivotal for secure management and monitoring. Impact: Improper SNMP configuration can redirect sensitive monitoring data to malicious hosts, risking exploitation and compromising host security.",
    "audit": "To confirm the proper configuration of SNMP, perform the following from the ESXi Shell or vCLI: 1. Run the following to determine if SNMP is being used: esxcli system snmp get  2. If SNMP is being used, refer to the vSphere Monitoring and Performance guide, chapter 8 for steps to verify the parameters. Additionally, the following PowerCLI command may be used to view the SNMP configuration: # List the SNMP Configuration of a host (single host connection required) Get-VMHostSnmp",
    "remediation": "To correct the SNMP configuration, perform the following from the ESXi Shell or vCLI: 1. If SNMP is not needed, disable it by running: esxcli system snmp set --enable false  2. If SNMP is needed, refer to the vSphere Monitoring and Performance guide, chapter 8 for steps to configure it. Additionally, the following PowerCLI command may be used to implement the configuration: # Update the host SNMP Configuration (single host connection required) Get-VmHostSNMP | Set-VMHostSNMP -Enabled:$true -ReadOnlyCommunity '<secret>' Notes: \u2022 SNMP must be configured on each ESXi host \u2022 SNMP settings can be configured using Host Profiles References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.monitoring.doc/GUID-8EF36D7D-59B6-4C74- B1AA-4A9D18AB6250.html",
    "function_names": [
      "snmp_service_access_restricted",
      "snmp_service_v3_enabled",
      "snmp_service_trap_destination_configured",
      "snmp_service_authentication_enabled",
      "snmp_service_encryption_enabled",
      "snmp_service_no_v1_v2_enabled",
      "snmp_service_community_strings_secure"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Improper SNMP configuration can redirect sensitive monitoring data to malicious hosts, risking exploitation and compromising host security.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.monitoring.doc/GUID-8EF36D7D-59B6-4C74- B1AA-4A9D18AB6250.html"
  },
  {
    "id": "6.5.1",
    "title": "(L1) Host SSH daemon, if enabled, must use FIPS 140- 2/140-3 validated ciphers",
    "assessment": "Manual",
    "description": "For enhanced security, if the SSH daemon is enabled on the host, it must utilize FIPS 140-2/140-3 validated ciphers. This requirement ensures the encryption standards are robust and compliant with regulatory mandates.",
    "rationale": "Employing FIPS validated ciphers is vital for maintaining a high level of security and integrity in communications. It aligns with industry best practices and regulatory compliance requirements, ensuring secure SSH connections. Impact: There is no functional impact noted for this control; however, it significantly improves the security posture by enforcing the use of strong, validated encryption ciphers for SSH communications.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_ssh_fips_ciphers_enabled",
      "compute_ssh_fips_140_2_ciphers_enabled",
      "compute_ssh_fips_140_3_ciphers_enabled",
      "compute_ssh_daemon_fips_ciphers_enabled",
      "compute_ssh_fips_compliant_ciphers_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact noted for this control; however, it significantly improves the security posture by enforcing the use of strong, validated encryption ciphers for SSH communications."
  },
  {
    "id": "6.5.2",
    "title": "(L1) Host SSH daemon, if enabled, must use FIPS 140- 2/140-3 validated cryptographic modules",
    "assessment": "Manual",
    "description": "When enabled, the SSH daemon on the host should employ FIPS 140-2/140-3 validated cryptographic modules provided by OpenSSH. Although these modules are enabled by default, they can be deactivated for backward compatibility, thus auditing and ensuring the correct setting is crucial for maintaining security standards.",
    "rationale": "Utilizing FIPS validated cryptographic modules ensures adherence to recognized security standards, which is essential for protecting data during SSH sessions. This aligns with industry best practices and compliance requirements, promoting a secure operating environment. Impact: There's no functional impact associated with this control. It significantly enhances the security posture by enforcing the use of validated cryptographic modules, minimizing the risks associated with SSH communications.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_ssh_fips_crypto_enabled",
      "compute_ssh_fips_140_2_enabled",
      "compute_ssh_fips_140_3_enabled",
      "compute_ssh_fips_crypto_default",
      "compute_ssh_fips_compliance",
      "compute_ssh_fips_backward_compatibility_disabled",
      "compute_ssh_fips_module_enabled",
      "compute_ssh_fips_approved_algorithms"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There's no functional impact associated with this control. It significantly enhances the security posture by enforcing the use of validated cryptographic modules, minimizing the risks associated with SSH communications."
  },
  {
    "id": "6.5.3",
    "title": "(L1) Host SSH daemon, if enabled, must not allow use of gateway ports",
    "assessment": "Manual",
    "description": "When enabled, the SSH daemon on the host should have the gateway ports feature disabled to prevent remote hosts from forwarding connections. This is a hardening measure to ensure that the SSH service is securely configured against potential forwarding misuses.",
    "rationale": "Disabling gateway ports is a preventative measure to avoid unauthorized forwarding by remote hosts, thus enhancing the security posture of the system. It is a prudent step in minimizing the attack surface associated with SSH service. Impact: There are no noted functional impacts associated with this control. It is a proactive security measure designed to prevent potential misuse of SSH service forwarding capabilities, without affecting the normal operation of the host.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_ssh_daemon_gateway_ports_disabled",
      "compute_ssh_daemon_no_gateway_ports",
      "compute_ssh_gateway_ports_restricted",
      "compute_ssh_forwarding_disabled",
      "compute_ssh_no_remote_forwarding"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There are no noted functional impacts associated with this control. It is a proactive security measure designed to prevent potential misuse of SSH service forwarding capabilities, without affecting the normal operation of the host."
  },
  {
    "id": "6.5.4",
    "title": "(L1) Host SSH daemon, if enabled, must not allow host- based authentication",
    "assessment": "Manual",
    "description": "Ensuring the SSH daemon on the host disallows host-based authentication is a crucial step towards hardening system services. This prevents a host from authenticating on behalf of the users, thereby enforcing individual accountability and minimizing the risk of unauthorized access.",
    "rationale": "Disallowing host-based authentication enforces a more secure user authentication mechanism, promoting individual accountability. It minimizes the risk associated with trust relationships among hosts, thereby enhancing the overall security of the system. Impact: No functional impact is associated with this control. It solely acts to enhance security by enforcing stricter authentication practices, without hindering system operations.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_ssh_host_based_auth_disabled",
      "compute_ssh_host_authentication_restricted",
      "compute_ssh_host_based_auth_denied",
      "compute_ssh_host_authentication_blocked",
      "compute_ssh_host_based_auth_prohibited"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No functional impact is associated with this control. It solely acts to enhance security by enforcing stricter authentication practices, without hindering system operations."
  },
  {
    "id": "6.5.5",
    "title": "(L1) Host SSH daemon, if enabled, must set a timeout count on idle sessions",
    "assessment": "Manual",
    "description": "Setting a timeout count on idle SSH sessions ensures that inactive sessions are automatically disconnected after a specified period. This period is calculated by multiplying the timeout count with the idle timeout interval. Automatic disconnection of idle sessions reduces the window of opportunity for unauthorized access.",
    "rationale": "Implementing a timeout count on idle sessions promotes better security hygiene by minimizing the exposure of open SSH sessions. It adds a layer of protection against potential unauthorized access arising from forgotten or unattended sessions. Impact: There's no functional impact reported with this control. It's a preventive measure aimed at enhancing the security posture by mitigating the risks associated with lingering idle sessions.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_ssh_idle_timeout_enabled",
      "compute_ssh_idle_timeout_count_configured",
      "compute_ssh_session_timeout_set",
      "compute_ssh_idle_disconnect_enabled",
      "compute_ssh_inactive_session_limit_set",
      "compute_ssh_timeout_count_configured",
      "compute_ssh_idle_session_termination_enabled",
      "compute_ssh_idle_timeout_interval_configured"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There's no functional impact reported with this control. It's a preventive measure aimed at enhancing the security posture by mitigating the risks associated with lingering idle sessions."
  },
  {
    "id": "6.5.6",
    "title": "(L1) Host SSH daemon, if enabled, must set a timeout interval on idle sessions",
    "assessment": "Manual",
    "description": "Implementing a timeout interval on idle SSH sessions ensures that any inactive session gets disconnected after a certain period, improving the security posture. The total timeout duration is calculated by multiplying the timeout count by the idle timeout interval.",
    "rationale": "Enforcing a timeout interval on idle SSH sessions minimizes the risk of unauthorized access through forgotten or unattended sessions, thereby hardening the system services as per security best practices. Impact: No functional impact is reported with this control. The measure is preventive, aiming to mitigate risks associated with open, idle SSH sessions.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_ssh_idle_timeout_enabled",
      "compute_ssh_session_timeout_configured",
      "compute_ssh_idle_disconnect_enabled",
      "compute_ssh_timeout_interval_set",
      "compute_ssh_inactive_session_termination_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No functional impact is reported with this control. The measure is preventive, aiming to mitigate risks associated with open, idle SSH sessions."
  },
  {
    "id": "6.5.7",
    "title": "(L1) Host SSH daemon, if enabled, must display the system login banner before granting access",
    "assessment": "Manual",
    "description": "Implementing a system login banner before granting SSH access ensures that crucial information or notices are conveyed to users attempting to login. The banner text is set through the host's Config.Etc.Issue advanced parameter.",
    "rationale": "Displaying a system login banner helps in providing legal notices or other critical information to users, ensuring they are informed before gaining access, which is a step towards hardening and securing system services. Impact: There is no functional impact reported with the enforcement of this control. It primarily serves to inform users or provide legal disclaimers, aiding in legal and regulatory compliance.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_ssh_banner_displayed",
      "compute_ssh_login_banner_enabled",
      "compute_ssh_issue_banner_configured",
      "compute_ssh_pre_login_banner_required",
      "compute_ssh_etc_issue_banner_set",
      "compute_ssh_system_banner_before_access",
      "compute_ssh_host_banner_enabled",
      "compute_ssh_advanced_banner_configured"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact reported with the enforcement of this control. It primarily serves to inform users or provide legal disclaimers, aiding in legal and regulatory compliance."
  },
  {
    "id": "6.5.8",
    "title": "(L1) Host SSH daemon, if enabled, must ignore .rhosts files",
    "assessment": "Manual",
    "description": "Ignoring .rhosts files is crucial in hardening the SSH daemon on the host, ensuring that trust relationships are explicitly defined and not implicitly accepted, thereby reducing the attack surface.",
    "rationale": "Ignoring .rhosts files removes potential security risks associated with outdated or overly permissive trust relationships, which is a step towards a hardened and more secure system service configuration. Impact: There are no reported functional impacts associated with ignoring .rhosts files; however, this practice enhances the security posture by mitigating risks associated with unauthorized access.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_ssh_ignore_rhosts",
      "compute_ssh_ignore_rhosts_enabled",
      "compute_ssh_rhosts_disabled",
      "compute_ssh_ignore_rhosts_config",
      "compute_ssh_rhosts_ignored"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There are no reported functional impacts associated with ignoring .rhosts files; however, this practice enhances the security posture by mitigating risks associated with unauthorized access."
  },
  {
    "id": "6.5.9",
    "title": "(L1) Host SSH daemon, if enabled, must disable stream local forwarding",
    "assessment": "Manual",
    "description": "Disabling stream local forwarding on the SSH daemon ensures that no Unix domain sockets are forwarded, thus enforcing a security boundary. This measure aids in maintaining the integrity and confidentiality of the system.",
    "rationale": "Disabling stream local forwarding helps in preventing potential misuse of Unix domain sockets which can be a vector for certain types of attacks or data leaks. Impact: There is no functional impact reported, indicating that disabling stream local forwarding is a safe measure towards enhancing system security without affecting operations.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_ssh_daemon_stream_local_forwarding_disabled",
      "compute_ssh_daemon_unix_socket_forwarding_disabled",
      "compute_ssh_daemon_local_forwarding_restricted",
      "compute_ssh_daemon_forwarding_protection_enabled",
      "compute_ssh_daemon_unix_domain_socket_blocked"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact reported, indicating that disabling stream local forwarding is a safe measure towards enhancing system security without affecting operations."
  },
  {
    "id": "6.5.10",
    "title": "(L1) Host SSH daemon, if enabled, must disable TCP forwarding",
    "assessment": "Manual",
    "description": "Disabling TCP forwarding in the SSH daemon is a measure to prevent potential unauthorized tunneling and forwarding activities that could lead to data leaks or unauthorized data access. This measure adds a layer of security to the SSH service when enabled, making the system more resilient against certain types of network attacks.",
    "rationale": "Preventing TCP forwarding aids in ensuring that the SSH daemon is not misused for unauthorized tunneling. This measure assists in maintaining a more secure and controlled network environment. Impact: No functional impact has been reported. This indicates that disabling TCP forwarding is a precautionary measure that does not interfere with the normal operation of the host.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_ssh_tcp_forwarding_disabled",
      "compute_ssh_daemon_tcp_forwarding_disabled",
      "compute_ssh_tcp_forwarding_restricted",
      "compute_ssh_daemon_tcp_forwarding_restricted",
      "compute_ssh_tunneling_disabled",
      "compute_ssh_daemon_tunneling_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No functional impact has been reported. This indicates that disabling TCP forwarding is a precautionary measure that does not interfere with the normal operation of the host."
  },
  {
    "id": "6.5.11",
    "title": "(L1) Host SSH daemon, if enabled, must not permit tunnels",
    "assessment": "Manual",
    "description": "Preventing tunnel creation in the SSH daemon is a security measure aimed at thwarting unauthorized network tunneling through the host. This control, when enforced, helps mitigate the risks associated with potential data exfiltration or unauthorized network access that could occur via SSH tunnels.",
    "rationale": "By disallowing tunnel creation, organizations can ensure that the SSH daemon is not exploited for unauthorized tunneling activities, thus contributing to a more secure network posture. Impact: There is no reported functional impact associated with this security control, indicating that the prevention of SSH tunneling does not adversely affect the host's normal operational behavior.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_ssh_tunnel_disabled",
      "compute_ssh_daemon_tunnel_restricted",
      "compute_host_ssh_tunnel_blocked",
      "compute_ssh_tunnel_creation_denied",
      "compute_ssh_daemon_tunnel_prohibited"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no reported functional impact associated with this security control, indicating that the prevention of SSH tunneling does not adversely affect the host's normal operational behavior."
  },
  {
    "id": "6.5.12",
    "title": "(L1) Host SSH daemon, if enabled, must not permit user environment settings",
    "assessment": "Manual",
    "description": "Preventing user environment settings in the SSH daemon ensures a consistent and controlled environment, reducing the attack surface by limiting the customization of the SSH environment by users.",
    "rationale": "Disallowing user environment settings within the SSH daemon reduces the potential for malicious or inadvertent misconfiguration, thus enhancing the security posture. Impact: There is no functional impact noted, indicating that restricting user environment settings does not adversely affect the operational aspects of the host.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_ssh_daemon_user_environment_disabled",
      "compute_ssh_config_environment_restricted",
      "compute_ssh_daemon_environment_settings_blocked",
      "compute_ssh_user_environment_override_disabled",
      "compute_ssh_config_environment_variables_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact noted, indicating that restricting user environment settings does not adversely affect the operational aspects of the host."
  },
  {
    "id": "7.1",
    "title": "(L1) Virtual machines must enable Secure Boot",
    "assessment": "Manual",
    "description": "Enable Secure Boot on virtual machines to ensure that only authenticated code runs from the firmware up through the operating system, thus providing a fundamental security measure against boot-time malware and unauthorized code execution. Supported by all modern guest operating systems, Secure Boot employs public key cryptography to validate the firmware, boot loader, drivers, and OS kernel at boot time.",
    "rationale": "By enforcing Secure Boot, organizations can mitigate the risk of boot-time malware and unauthorized code execution, which is crucial for maintaining the integrity and trustworthiness of the system from the first instruction. Impact: Activation of Secure Boot post guest OS installation may entail more than merely enabling a setting; consult the respective guest OS documentation for detailed instructions. This may introduce additional steps in the setup process, potentially extending the deployment time.",
    "audit": "The following PowerCLI command may be used: (Get-VM -Name $VM).ExtensionData.Config.BootOptions.EfiSecureBootEnabled",
    "remediation": "The following PowerCLI command may be used: $VMobj = (Get-VM -Name $VM) $ConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec $bootOptions = New-Object VMware.Vim.VirtualMachineBootOptions $bootOptions.EfiSecureBootEnabled = $true $ConfigSpec.BootOptions = $bootOptions $task = $VMobj.ExtensionData.ReconfigVM_Task($ConfigSpec) Default Value: Depends on VM Hardware version and guest OS selection.",
    "function_names": [
      "compute_virtual_machine_secure_boot_enabled",
      "compute_vm_secure_boot_enabled",
      "compute_instance_secure_boot_enabled",
      "compute_vm_firmware_integrity_verified",
      "compute_virtual_machine_boot_protection_enabled",
      "compute_vm_boot_authentication_enabled",
      "compute_instance_trusted_boot_enabled",
      "compute_vm_secure_boot_required",
      "compute_virtual_machine_boot_integrity_enabled",
      "compute_vm_boot_loader_validation_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Activation of Secure Boot post guest OS installation may entail more than merely enabling a setting; consult the respective guest OS documentation for detailed instructions. This may introduce additional steps in the setup process, potentially extending the deployment time."
  },
  {
    "id": "7.2",
    "title": "(L1) Virtual machines must require encryption for vMotion",
    "assessment": "Manual",
    "description": "Requiring encryption for vMotion ensures the secure transfer of data among virtual machines. While the default 'opportunistic' encryption setting generally provides encryption due to prevalent AES-NI support, enforcing 'required' encryption eradicates the possibility of unencrypted transfers. The parameter governing this behavior is VM Configuration with the recommended setting being required.",
    "rationale": "Enforcing encryption for vMotion is crucial to prevent potential data leakage or unauthorized data access during data transfer processes, thereby bolstering the overall security infrastructure. Impact: There is no functional impact noted.",
    "audit": "The following PowerCLI command may be used: (Get-VM -Name $VM).ExtensionData.Config.MigrateEncryption",
    "remediation": "The following PowerCLI command may be used: $VMview = Get-VM -Name $VM | Get-View $ConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec $ConfigSpec.MigrateEncryption = New-Object VMware.Vim.VirtualMachineConfigSpecEncryptedVMotionModes $ConfigSpec.MigrateEncryption = \"required\" $VMview.ReconfigVM_Task($ConfigSpec) Default Value: opportunistic",
    "function_names": [
      "compute_vm_vmotion_encryption_required",
      "compute_vm_vmotion_encryption_enabled",
      "compute_vm_vmotion_encryption_opportunistic_disabled",
      "compute_vm_vmotion_encryption_aes_ni_enabled",
      "compute_vm_vmotion_encryption_config_valid"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact noted."
  },
  {
    "id": "7.3",
    "title": "(L1) Virtual machines must require encryption for Fault Tolerance",
    "assessment": "Manual",
    "description": "Requiring encryption for Fault Tolerance in virtual machines is critical for ensuring secure data transmission between primary and secondary VMs, especially in environments where sensitive data is processed. While the default setting 'opportunistic' may result in encryption due to widespread AES-NI support in vSphere-compatible hardware, enforcing the 'required' setting for encryption guarantees that no unencrypted operations occur. The parameter governing this behavior is VM Configuration with a recommended setting of ftEncryptionRequired.",
    "rationale": "By enforcing encryption for Fault Tolerance, organizations bolster the security posture of their virtual environments against potential data interception or leakage during transmission. This requirement is vital for maintaining data integrity and confidentiality. Impact: There are no identified negative impacts associated with enforcing encryption for Fault Tolerance, and it's instrumental in enhancing the security of data transmission within virtual environments.",
    "audit": "The following PowerCLI command may be used: (Get-VM -Name $VM).ExtensionData.Config.FtEncryptionMode",
    "remediation": "The following PowerCLI command may be used: $VMview = Get-VM -Name $VM | Get-View $ConfigSpec = New-Object VMware.Vim.VirtualMachineConfigSpec $ConfigSpec.FtEncryptionMode = New-object VMware.Vim.VirtualMachineConfigSpecEncryptedFtModes $ConfigSpec.FtEncryptionMode = \"ftEncryptionRequired\" $VMview.ReconfigVM_Task($ConfigSpec) Default Value: ftEncryptionOpportunistic",
    "function_names": [
      "compute_vm_ft_encryption_required",
      "compute_vm_ft_encryption_enabled",
      "compute_vm_fault_tolerance_encryption_required",
      "compute_vm_fault_tolerance_encryption_enabled",
      "compute_vm_ft_encryption_opportunistic_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There are no identified negative impacts associated with enforcing encryption for Fault Tolerance, and it's instrumental in enhancing the security of data transmission within virtual environments."
  },
  {
    "id": "7.4",
    "title": "(L1) Virtual machines should deactivate 3D graphics features when not required",
    "assessment": "Automated",
    "description": "Due to performance reasons, modern graphic rendering is done within a dedicated graphic processing unit (GPU). Virtual machines can use the host-based GPU for such operations as well. Such dedicated hardware is typically accessed by using complex APIs like OpenGL and DirectX. This hardware-based 3D acceleration should be disabled if it is not needed.",
    "rationale": "Security flaws within APIs can lead to serious security breaches like memory corruption, denial of service, and remote code execution. Impact: GPU and Virtual Desktops may require this functionality.",
    "audit": "The following PowerCLI command may be used: Get-VM -Name $VM | Get-AdvancedSetting mks.enable3d",
    "remediation": "The following PowerCLI command may be used: Get-VM -Name $VM | Get-AdvancedSetting mks.enable3d | Set-AdvancedSetting - Value FALSE Default Value: Depends on VM Hardware version and guest OS selection.",
    "function_names": [
      "compute_virtual_machine_3d_graphics_disabled",
      "compute_vm_gpu_acceleration_disabled",
      "compute_virtual_machine_graphics_features_deactivated",
      "compute_vm_3d_rendering_disabled",
      "compute_virtual_machine_gpu_access_restricted"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "GPU and Virtual Desktops may require this functionality."
  },
  {
    "id": "7.5",
    "title": "(L1) Virtual machines must be configured to lock when the last console connection is closed",
    "assessment": "Manual",
    "description": "Configuring virtual machines to lock upon closing the last console connection enhances security by mitigating the risk of unauthorized access via open console sessions. This configuration is particularly useful in environments where multiple users have access to the console. The parameter governing this behavior is tools.guest.desktop.autolock with the recommended setting being TRUE.",
    "rationale": "Implementing this control provides an additional layer of security by ensuring that open console sessions do not remain accessible after the last connection is closed, thus reducing the potential for unauthorized access. Impact: No functional impact is associated with this control; it serves as a proactive measure to prevent unauthorized access through open console sessions.",
    "audit": "The following PowerCLI command may be used: Get-VM -Name $VM | Get-AdvancedSetting tools.guest.desktop.autolock",
    "remediation": "The following PowerCLI command may be used: Get-VM -Name $VM | Remove-AdvancedSetting -Name tools.guest.desktop.autolock Default Value: FALSE",
    "function_names": [
      "compute_virtual_machine_autolock_enabled",
      "compute_vm_console_lock_on_disconnect",
      "compute_vm_guest_desktop_autolock_true",
      "compute_vm_autolock_last_connection_closed",
      "compute_vm_console_session_lock_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No functional impact is associated with this control; it serves as a proactive measure to prevent unauthorized access through open console sessions."
  },
  {
    "id": "7.6",
    "title": "(L1) Virtual machines must limit console sharing.",
    "assessment": "Automated",
    "description": "By default, remote console sessions can be connected to by more than one user at a time. Permit only one remote console connection to a VM at a time. Other attempts will be rejected until the first connection disconnects.",
    "rationale": "When multiple sessions are activated, each terminal window gets a notification about the new session. If an administrator in the VM logs in using a VMware remote console during their session, a non-administrator in the VM can connect to the console and observe the administrator's actions. Also, this could result in an administrator losing console access to a VM. For example, if a jump box is being used for an open console session, and the admin loses a connection to that box, the console session remains open. Allowing two console sessions permits debugging via a shared session. For highest security, only one remote console session at a time should be allowed.",
    "audit": "To verify that only one remote console session is permitted at a time, confirm that RemoteDisplay.maxConnections is set to 1. 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Verify that RemoteDisplay.maxConnections is set to 1. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"RemoteDisplay.maxConnections\" | Select Entity, Name, Value",
    "remediation": "To set this configuration utilize the vSphere interface as follows: 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Click on ADD CONFIGURATION PARAMS then input RemoteDisplay.maxConnections with a value of 1. 5. Click OK, then OK again. Alternatively, run the following PowerCLI command for VMs that do not specify the setting: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"RemoteDisplay.maxConnections\" -value 1 Run the following PowerCLI command for VMs that specify the setting but have the wrong value for it: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"RemoteDisplay.maxConnections\" -value 1 - Force References: 1. http://www.ibenit.com/post/85227299008/security-benchmark-hardening-guide- policies-and-profile 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-27A340F5-DE98-41A8- AC73-01ED4949EEF2.html 3. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.vm_admin.doc/GUID-7FED3B17-E2E9-4360- AAC6-B70F9A9AEB84.html",
    "function_names": [
      "compute_vm_console_sharing_disabled",
      "compute_vm_single_console_connection_enabled",
      "compute_vm_remote_console_restricted",
      "compute_vm_console_session_limit_one",
      "compute_vm_console_sharing_limit_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "references": "1. http://www.ibenit.com/post/85227299008/security-benchmark-hardening-guide- policies-and-profile 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-27A340F5-DE98-41A8- AC73-01ED4949EEF2.html 3. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.vm_admin.doc/GUID-7FED3B17-E2E9-4360- AAC6-B70F9A9AEB84.html"
  },
  {
    "id": "7.7",
    "title": "(L1) Virtual machines must limit PCI/PCIe device passthrough functionality",
    "assessment": "Automated",
    "description": "DirectPath I/O features provide virtual machines the ability to directly access system hardware, which while advantageous for performance, can impact risk mitigation tools like vMotion, DRS, and High Availability. It also opens up a potential attack vector for privileged hardware access. It is crucial to ensure that only necessary VMs have this privilege and that compensatory measures are taken within the guest OS to enhance security.",
    "rationale": "Limiting PCI/PCIe device passthrough functionality is essential for minimizing potential attack vectors and ensuring that risk mitigation tools function as intended. Moreover, audit and documentation of the business need for these VMs are critical for maintaining a secure and compliant environment. Impact: Passthrough devices, like GPUs, may be adversely affected if disconnected. It's imperative to audit and document the business rationale for VMs requiring this functionality to understand the associated risks and ensure adequate compensatory controls are in place.",
    "audit": "The following PowerCLI command can be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"pciPassthru*.present\" | Select Entity, Name, Value ``",
    "remediation": "The following PowerCLI command can be used: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"pciPassthru*.present\" -value \"\" References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-E5CFB1FB-9216-4C1D- B49A-81AAAC414025.html",
    "function_names": [
      "compute_vm_pci_passthrough_disabled",
      "compute_vm_pci_device_restricted",
      "compute_vm_directpath_io_disabled",
      "compute_vm_hardware_access_limited",
      "compute_vm_high_availability_compatible",
      "compute_vm_drs_compatible",
      "compute_vm_vmotion_compatible",
      "compute_vm_privileged_hardware_access_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Passthrough devices, like GPUs, may be adversely affected if disconnected. It's imperative to audit and document the business rationale for VMs requiring this functionality to understand the associated risks and ensure adequate compensatory controls are in place.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-E5CFB1FB-9216-4C1D- B49A-81AAAC414025.html"
  },
  {
    "id": "7.8",
    "title": "(L1) Virtual machines must prevent unauthorized modification of devices",
    "assessment": "Automated",
    "description": "In a virtual machine, users and processes without root or administrator privileges can connect devices, such as network adapters and CD-ROM drives. This should be prevented.",
    "rationale": "Disabling unauthorized connection of devices helps prevents unauthorized changes within the guest operating system, which could be used to gain unauthorized access, cause denial of service conditions, and otherwise negatively affect the security of the guest operating system.",
    "audit": "To verify unauthorized device connections are prevented, access the virtual machine configuration file and verify that isolation.device.connectable.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.device.connectable.disable\" | Select Entity, Name, Value",
    "remediation": "To prevent unauthorized device connections, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.device.connectable.disable\" - value $true References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9- A168-C62D9306DBD6.html",
    "function_names": [
      "compute_virtual_machine_device_modification_restricted",
      "compute_vm_unauthorized_device_attachment_blocked",
      "compute_vm_device_connection_restricted_to_admin",
      "compute_virtual_machine_device_attachment_admin_only",
      "compute_vm_device_modification_admin_required"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9- A168-C62D9306DBD6.html"
  },
  {
    "id": "7.9",
    "title": "(L1) Virtual machines must remove unnecessary audio devices",
    "assessment": "Manual",
    "description": "Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.",
    "rationale": "Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup. Impact: Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vm_audio_device_removed",
      "compute_vm_unnecessary_audio_disabled",
      "compute_vm_audio_hardware_absent",
      "compute_vm_peripheral_audio_removed",
      "compute_vm_audio_component_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service."
  },
  {
    "id": "7.10",
    "title": "(L1) Virtual machines must remove unnecessary AHCI devices",
    "assessment": "Manual",
    "description": "Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.",
    "rationale": "Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup. Impact: Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_virtual_machine_unnecessary_ahci_devices_removed",
      "compute_vm_ahci_devices_minimized",
      "compute_virtual_machine_essential_devices_only",
      "compute_vm_attack_surface_reduced",
      "compute_virtual_machine_ahci_devices_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service."
  },
  {
    "id": "7.11",
    "title": "(L1) Virtual machines must remove unnecessary USB/XHCI devices",
    "assessment": "Automated",
    "description": "Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.",
    "rationale": "Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup. Impact: Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.",
    "audit": "To verify USB devices are not connected, confirm that the following parameter is either NOT present or is set to FALSE: usb.present Alternately, the following PowerCLI command may be used: # Check for USB Devices attached to VMs Get-VM | Get-USBDevice",
    "remediation": "To disconnect all USB devices from VMs, run the following PowerCLI command: # Remove all USB Devices attached to VMs Get-VM | Get-USBDevice | Remove-USBDevice The VM will need to be powered off for this change to take effect. References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.vm_admin.doc/GUID-7FED3B17-E2E9-4360- AAC6-B70F9A9AEB84.html",
    "function_names": [
      "compute_virtual_machine_unnecessary_usb_devices_removed",
      "compute_vm_xhci_devices_disabled",
      "compute_vm_unnecessary_devices_minimized",
      "compute_virtual_machine_attack_surface_reduced",
      "compute_vm_usb_xhci_removed"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.vm_admin.doc/GUID-7FED3B17-E2E9-4360- AAC6-B70F9A9AEB84.html"
  },
  {
    "id": "7.12",
    "title": "(L1) Virtual machines must remove unnecessary serial port devices",
    "assessment": "Automated",
    "description": "Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.",
    "rationale": "Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup. Impact: Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.",
    "audit": "To verify serial ports are not connected, confirm that the following parameter is either NOT present or is set to FALSE: serialX.present The following PowerCLI command may be used: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in- powercli.html # Check for Serial ports attached to VMs Get-VM | Get-SerialPort",
    "remediation": "To disconnect all serial ports from VMs, run the following PowerCLI command: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in- powercli.html # Remove all Serial Ports attached to VMs Get-VM | Get-SerialPort | Remove-SerialPort The VM will need to be powered off for this change to take effect. References: 1. https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in- powercli.html 2. https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in- powercli.html",
    "function_names": [
      "compute_virtual_machine_serial_port_removed",
      "compute_vm_unnecessary_serial_port_disabled",
      "compute_virtual_machine_serial_device_minimized",
      "compute_vm_serial_port_least_functionality",
      "compute_virtual_machine_unused_serial_port_removed"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.",
    "references": "1. https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in- powercli.html 2. https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in- powercli.html"
  },
  {
    "id": "7.13",
    "title": "(L1) Virtual machines must remove unnecessary parallel port devices",
    "assessment": "Automated",
    "description": "Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.",
    "rationale": "Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup. Impact: Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.",
    "audit": "To verify parallel ports are not connected, confirm that the following parameter is either NOT present or is set to FALSE: parallelX.present Alternately, the following PowerCLI command may be used: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in- powercli.html # Check for Parallel ports attached to VMs Get-VM | Get-ParallelPort",
    "remediation": "To disconnect all parallel ports from VMs, run the following PowerCLI command: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in- powercli.html # Remove all Parallel Ports attached to VMs Get-VM | Get-ParallelPort | Remove-ParallelPort The VM will need to be powered off for this change to take effect. References: 1. https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in- powercli.html 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-600D24C8-0F77-4D96- B273-A30F256B29D4.html",
    "function_names": [
      "compute_virtual_machine_unnecessary_parallel_port_removed",
      "compute_vm_parallel_port_disabled",
      "compute_vm_unnecessary_device_removed",
      "compute_virtual_machine_parallel_port_disabled",
      "compute_vm_parallel_port_device_removed"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.",
    "references": "1. https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in- powercli.html 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-600D24C8-0F77-4D96- B273-A30F256B29D4.html"
  },
  {
    "id": "7.14",
    "title": "(L2) Virtual machines must remove unnecessary CD/DVD devices",
    "assessment": "Automated",
    "description": "Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.",
    "rationale": "Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup. Impact: Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.",
    "audit": "To verify CD/DVD drives are not connected, confirm that the following parameter is either NOT present or is set to FALSE: ideX:Y.present Alternately, the following PowerCLI command may be used: # Check for CD/DVD Drives attached to VMs Get-VM | Get-CDDrive",
    "remediation": "To disconnect all CD/DVD drives from VMs, run the following PowerCLI command: # Remove all CD/DVD Drives attached to VMs Get-VM | Get-CDDrive | Remove-CDDrive The VM will need to be powered off for this change to take effect. References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-600D24C8-0F77-4D96- B273-A30F256B29D4.html",
    "function_names": [
      "compute_virtual_machine_unnecessary_cd_dvd_removed",
      "compute_vm_unnecessary_devices_removed",
      "compute_vm_cd_dvd_devices_disabled",
      "compute_virtual_machine_minimal_devices_enabled",
      "compute_vm_essential_devices_only"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-600D24C8-0F77-4D96- B273-A30F256B29D4.html"
  },
  {
    "id": "7.15",
    "title": "(L1) Virtual machines must remove unnecessary floppy devices",
    "assessment": "Automated",
    "description": "Removing unnecessary devices from virtual machines minimizes the attack surface and reduces potential pathways for data exfiltration or unauthorized data capture. This practice aligns with the principle of least functionality, ensuring that VMs have only the essential components required to perform their designated functions.",
    "rationale": "Eliminating unnecessary devices reduces attack surface and streamlines the virtual machine configuration, promoting a cleaner, more manageable, and less vulnerable setup. Impact: Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.",
    "audit": "To verify floppy drives are not connected, confirm that the following parameter is either NOT present or is set to FALSE: floppyX.present Alternately, the following PowerCLI command may be used: # Check for Floppy Devices attached to VMs Get-VM | Get-FloppyDrive | Select Parent, Name, ConnectionState",
    "remediation": "To disconnect all floppy drives from VMs, run the following PowerCLI command: # Remove all Floppy drives attached to VMs Get-VM | Get-FloppyDrive | Remove-FloppyDrive The VM will need to be powered off for this change to take effect. References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-600D24C8-0F77-4D96- B273-A30F256B29D4.html",
    "function_names": [
      "compute_virtual_machine_floppy_device_removed",
      "compute_vm_unnecessary_floppy_disabled",
      "compute_vm_floppy_device_minimized",
      "compute_vm_floppy_removed_least_functionality",
      "compute_vm_floppy_device_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Careful analysis and understanding of the virtual machine's requirements and dependencies are crucial before implementing this security control to avoid unintended disruptions or degradation of service.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-600D24C8-0F77-4D96- B273-A30F256B29D4.html"
  },
  {
    "id": "7.16",
    "title": "(L1) Virtual machines must deactivate console drag and drop operations",
    "assessment": "Automated",
    "description": "VM console drag and drop operations should be disabled.",
    "rationale": "VM console drag and drop operations are disabled by default (not explicitly specified); however, explicitly disabling this feature enables audit controls to check that this setting is correct.",
    "audit": "To verify that VM console drag and drop operations are disabled, verify that isolation.tools.dnd.disable is missing or set to TRUE. 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Verify that isolation.tools.dnd.disable is set to TRUE or missing. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM -Name $VM | Get-AdvancedSetting isolation.tools.dnd.disable",
    "remediation": "To set this configuration utilize the vSphere interface as follows: 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Click on ADD CONFIGURATION PARAMS then input isolation.tools.dnd.disable with a value of TRUE. 5. Click OK, then OK again. To explicitly disable VM console drag and drop operations, run the following PowerCLI command: # Add the setting to all VMs Get-VM -Name $VM | Remove-AdvancedSetting -Name isolation.tools.dnd.disable Default Value: TRUE",
    "function_names": [
      "compute_virtual_machine_console_drag_and_drop_disabled",
      "compute_vm_console_drag_and_drop_deactivated",
      "compute_vm_console_drag_and_drop_blocked",
      "compute_virtual_machine_console_drag_and_drop_deactivated",
      "compute_vm_console_drag_and_drop_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)"
  },
  {
    "id": "7.17",
    "title": "(L1) Virtual machines must deactivate console copy operations",
    "assessment": "Automated",
    "description": "Deactivating console copy operations is critical for preventing data transfer between the virtual machine and the local client, irrespective of the access method, whether via Web Console, VMRC, or others. The parameter governing this behavior is isolation.tools.copy.disable with a recommended setting of TRUE or Undefined.",
    "rationale": "Deactivating console copy operations minimizes the risk of unauthorized data access or leakage, enforcing a higher level of data security and integrity across the virtual environment. Impact: There is no identified functional impact; however, this restriction enhances data security by minimizing unauthorized data transfer channels.",
    "audit": "To verify that VM console copy operations are disabled, verify that the isolation.tools.copy.disable option is missing or set to TRUE. 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Verify that isolation.tools.copy.disable is set to TRUE or missing. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.copy.disable\" | Select Entity, Name, Value",
    "remediation": "To set this configuration utilize the vSphere interface as follows: 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Click on ADD CONFIGURATION PARAMS then input isolation.tools.copy.disable with a value of TRUE. 5. Click OK, then OK again. To explicitly disable VM console copy operations, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.copy.disable\" -value $true Default Value: Disabled References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3- AA05-85033136A667.html 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A- 8335-CFBCE0DD2167.html",
    "function_names": [
      "compute_virtual_machine_console_copy_disabled",
      "compute_vm_isolation_tools_copy_disabled",
      "compute_vm_console_copy_operations_disabled",
      "compute_vm_guest_isolation_copy_disabled",
      "compute_vm_secure_console_copy_setting",
      "compute_vm_isolation_tools_secure_config",
      "compute_vm_console_data_transfer_disabled",
      "compute_vm_guest_operations_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no identified functional impact; however, this restriction enhances data security by minimizing unauthorized data transfer channels.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3- AA05-85033136A667.html 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A- 8335-CFBCE0DD2167.html"
  },
  {
    "id": "7.18",
    "title": "(L1) Virtual machines must deactivate console paste operations",
    "assessment": "Automated",
    "description": "Disabling console paste operations on virtual machines obstructs data transfer from the local client to the VM, irrespective of the access method - be it Web Console, VMRC, or another console. This security measure aims to curtail potential avenues for unauthorized data transfer into the virtual environment. The parameter governing this behavior is isolation.tools.paste.disable with a recommended setting of TRUE or Undefined.",
    "rationale": "By disabling console paste operations, organizations add a layer of security that helps in preventing unauthorized data introduction into the VM, which could potentially lead to various security risks. Impact: There is no functional impact identified. The control simply enhances the security posture by reducing possible data transfer channels into the VM.",
    "audit": "To verify that VM console paste operations are disabled, verify that isolation.tools.paste.disable is missing or set to TRUE. 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Verify that isolation.tools.paste.disable is set to TRUE or missing. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.paste.disable\"| Select Entity, Name, Value",
    "remediation": "To set this configuration utilize the vSphere interface as follows: 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Click on ADD CONFIGURATION PARAMS then input isolation.tools.paste.disable with a value of TRUE. 5. Click OK, then OK again. To explicitly disable VM console paste operations, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.paste.disable\" -value $true Default Value: Disabled References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009- 439C-9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB 2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3- AA05-85033136A667.html",
    "function_names": [
      "compute_virtual_machine_console_paste_disabled",
      "compute_vm_console_paste_operations_deactivated",
      "compute_vm_isolation_tools_paste_disabled",
      "compute_virtual_machine_clipboard_paste_restricted",
      "compute_vm_console_data_transfer_blocked"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact identified. The control simply enhances the security posture by reducing possible data transfer channels into the VM.",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009- 439C-9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB 2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3- AA05-85033136A667.html"
  },
  {
    "id": "7.19",
    "title": "(L1) Virtual machines must limit access through the \"dvfilter\" network API",
    "assessment": "Manual",
    "description": "The dvFilter interface facilitates network traffic filtering and inspection, predominantly via tools like NSX. It's vital to allow only authorized tools to access this interface to uphold network security. Unauthorized access could lead to illicit network traffic inspection or misuse. The parameter governing this behavior is ethernet*.filter*.name with a recommended setting of Not Present.",
    "rationale": "Limiting access through the \"dvfilter\" network API to authorized tools is essential for preserving network integrity and security. This restriction curtails the risk of unauthorized data inspection and potential network vulnerabilities. Impact: While enhancing security by restricting access to the dvFilter interface, this control may hinder the functionality of legitimate network tools like NSX, which necessitate access to the \"dvfilter\" network API for proper operation.",
    "audit": "To verify this information utilize the vSphere interface as follows: 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Verify that ethernet0.filter1.name = dv-filter1 where ethernet0 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and dv-filter1 is the name of the particular data path kernel module that is protecting the VM. \u2022 If dvfilter access should not be permitted: Verify that the following is NOT listed ethernet0.filter1.name = dv-filter.  5. Ensure that the name of the data path kernel is set correctly. You may also perform the following to determine if dvfilter access should be permitted via the VMX file: 1. Verify that the following is in the VMX file: ethernet0.filter1.name = dv- filter1 where ethernet0 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and dv-filter1 is the name of the particular data path kernel module that is protecting the VM. \u2022 If dvfilter access should not be permitted: Verify that the following is not in the VMX file: ethernet0.filter1.name = dv-filter1.  2. Ensure that the name of the data path kernel is set correctly.",
    "remediation": "To set this configuration utilize the vSphere interface as follows: 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Remove the value from ethernet0.filter1.name = dv-filter. \u2022 Parameters are removed when no value is present  5. Click OK. You may also configure a VM to allow dvfilter access via the following method in the VMX file: 1. Configure the following in the VMX file: ethernet0.filter1.name = dv-filter1 where ethernet0 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and dv-filter1 is the name of the particular data path kernel module that is protecting the VM. \u2022 If dvfilter access should not be permitted: Remove the following from its VMX file: ethernet0.filter1.name = dv-filter1.  2. Set the name of the data path kernel correctly. References: 1. http://kb.vmware.com/kb/1714 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A- B821-ED17A77B0206.html",
    "function_names": [
      "compute_virtual_machine_dvfilter_access_restricted",
      "compute_virtual_machine_dvfilter_network_api_disabled",
      "compute_virtual_machine_dvfilter_interface_unauthorized_access_blocked",
      "compute_virtual_machine_ethernet_filter_name_not_present",
      "compute_virtual_machine_dvfilter_secure_configuration_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "While enhancing security by restricting access to the dvFilter interface, this control may hinder the functionality of legitimate network tools like NSX, which necessitate access to the \"dvfilter\" network API for proper operation.",
    "references": "1. http://kb.vmware.com/kb/1714 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A- B821-ED17A77B0206.html"
  },
  {
    "id": "7.20",
    "title": "(L1) Virtual machines must deactivate virtual disk shrinking operations",
    "assessment": "Automated",
    "description": "Disabling virtual disk shrinking on virtual machines prevents potential disk unavailability issues. This operation is usually restricted for non-administrative users within the guest environment. The parameter governing this behavior is isolation.tools.diskShrink.disable with a recommended setting of TRUE or Undefined.",
    "rationale": "Shrinking a virtual disk reclaims unused space in it. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. Normal users and processes\u2014that is, users and processes without root or administrator privileges\u2014within virtual machines have the capability to invoke this procedure. However, if this is done repeatedly, the virtual disk can become unavailable while this shrinking is being performed, effectively causing a denial of service. In most datacenter environments, disk shrinking is not done, so you should disable this feature. Repeated disk shrinking can make a virtual disk unavailable. This capability is available to nonadministrative users in the guest. Impact: There is no functional impact noted.",
    "audit": "Verify that isolation.tools.diskShrink.disable is set to TRUE. 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Verify that isolation.tools.diskShrink.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name  \"isolation.tools.diskShrink.disable\"| Select Entity, Name, Value",
    "remediation": "To set this configuration utilize the vSphere interface as follows: 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Click on ADD CONFIGURATION PARAMS then input isolation.tools.diskShrink.disable with a value of TRUE. 5. Click OK, then OK again. To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.diskShrink.disable\" - value $true Default Value: The prescribed state is not the default state. References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009- 439C-9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB 2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982- 8C28-5B34FEB264B6.html",
    "function_names": [
      "compute_virtual_machine_disk_shrink_disabled",
      "compute_vm_disk_shrink_restricted",
      "compute_vm_isolation_tools_disk_shrink_disabled",
      "compute_vm_disk_shrink_operation_deactivated",
      "compute_vm_disk_shrink_protection_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact noted.",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009- 439C-9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB 2AzhgCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982- 8C28-5B34FEB264B6.html"
  },
  {
    "id": "7.21",
    "title": "(L1) Virtual machines must deactivate virtual disk wiping operations",
    "assessment": "Automated",
    "description": "Wiping a virtual disk reclaims all unused space in it. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. If virtual disk wiping is done repeatedly, it can cause the virtual disk to become unavailable while wiping occurs. In most datacenter environments, disk wiping is not needed, but normal users and processes--without administrative privileges--can issue disk wipes unless the feature is disabled.",
    "rationale": "Deactivating virtual disk wiping operations contributes to maintaining disk availability, which is vital for continuous system operations. Impact: There isn't a functional impact noted",
    "audit": "To verify that virtual disk wiping is disabled, verify that isolation.tools.diskWiper.disable is set to TRUE. 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Verify that isolation.tools.diskWiper.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name  \"isolation.tools.diskWiper.disable\"| Select Entity, Name, Value",
    "remediation": "To set this configuration utilize the vSphere interface as follows: 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Click on ADD CONFIGURATION PARAMS then input isolation.tools.diskWiper.disable with a value of TRUE. 5. Click OK, then OK again. To disable virtual disk wiping, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.diskWiper.disable\" -value $true References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982- 8C28-5B34FEB264B6.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009- 439C-9142-18A9E7C592EA.html",
    "function_names": [
      "compute_virtual_machine_disk_wiping_disabled",
      "compute_vm_disk_wipe_deactivated",
      "compute_virtual_disk_wipe_protection_enabled",
      "compute_vm_disk_wipe_operations_blocked",
      "compute_virtual_machine_disk_wipe_prevention_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There isn't a functional impact noted",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982- 8C28-5B34FEB264B6.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009- 439C-9142-18A9E7C592EA.html"
  },
  {
    "id": "7.22",
    "title": "(L1) Virtual machines must restrict sharing of memory pages with other VMs",
    "assessment": "Manual",
    "description": "Configuring virtual machines with the sched.mem.pshare.salt option restricts Transparent Page Sharing (TPS) among different VMs, mitigating the risk of unauthorized data access under certain conditions. By doing so, each VM operates with a distinct memory sharing pool, thereby enhancing isolation and security. The parameter governing this behavior is sched.mem.pshare.salt.",
    "rationale": "Restricting memory page sharing among VMs minimizes the potential for unauthorized data access, thus aligning with best practices of data isolation and security. This configuration is a proactive measure to mitigate vulnerabilities associated with memory sharing. Impact: There is no functional impact associated with this security control as it serves to bolster the security posture of the VMs without affecting their operational performance or functionality.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_virtual_machine_memory_sharing_restricted",
      "compute_vm_transparent_page_sharing_disabled",
      "compute_vm_memory_isolation_enabled",
      "compute_vm_pshare_salt_configured",
      "compute_vm_memory_sharing_salt_set"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no functional impact associated with this security control as it serves to bolster the security posture of the VMs without affecting their operational performance or functionality."
  },
  {
    "id": "7.23",
    "title": "(L1) Virtual machines must not be able to obtain host information from the hypervisor",
    "assessment": "Automated",
    "description": "Configure VMware Tools to disable host information from being sent to guests unless a particular VM requires this information for performance monitoring purposes.",
    "rationale": "By enabling a VM to get detailed information about the physical host, an adversary could potentially use this information to inform further attacks on the host.",
    "audit": "To verify host information is not sent to guests, verify that tools.guestlib.enableHostInfo is set to FALSE. 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Verify that tools.guestlib.enableHostInfo is set to FALSE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name  \"tools.guestlib.enableHostInfo\"| Select Entity, Name, Value",
    "remediation": "To set this configuration utilize the vSphere interface as follows: 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Click on ADD CONFIGURATION PARAMS then input tools.guestlib.enableHostInfo with a value of FALSE. 5. Click OK, then OK again. To prevent host information from being sent to guests, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"tools.guestlib.enableHostInfo\" -value $false Default Value: FALSE References: 1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-2CF880DA-2435-4201- 9AFB-A16A11951A2D.html",
    "function_names": [
      "compute_virtual_machine_host_info_disabled",
      "compute_vm_hypervisor_info_restricted",
      "vmware_tools_host_info_blocked",
      "compute_guest_hypervisor_metadata_disabled",
      "vmware_vm_host_info_access_denied"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.security.doc/GUID-2CF880DA-2435-4201- 9AFB-A16A11951A2D.html"
  },
  {
    "id": "7.24",
    "title": "(L1) Virtual machines must enable diagnostic logging",
    "assessment": "Manual",
    "description": "Enabling diagnostic logging on virtual machines facilitates forensic analysis and troubleshooting by collecting necessary operational data. The parameter governing this behavior is Enable Logging with a recommended setting of TRUE.",
    "rationale": "Diagnostic logging is crucial for identifying and analyzing issues that may arise within a virtual machine environment. It supports timely resolution of problems, thus maintaining system integrity and operational efficiency. Impact: There is no negative functional impact identified for enabling diagnostic logging. This control significantly aids in issue resolution, enhancing overall system reliability and performance.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_virtual_machine_logging_enabled",
      "compute_vm_diagnostic_logging_enabled",
      "compute_virtual_machine_boot_diagnostics_enabled",
      "compute_vm_os_logging_enabled",
      "compute_virtual_machine_guest_logging_enabled",
      "compute_vm_diagnostics_storage_enabled",
      "compute_virtual_machine_serial_console_logging_enabled",
      "compute_vm_agent_logging_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no negative functional impact identified for enabling diagnostic logging. This control significantly aids in issue resolution, enhancing overall system reliability and performance."
  },
  {
    "id": "7.25",
    "title": "(L1) Virtual machines must limit the number of retained diagnostic logs",
    "assessment": "Automated",
    "description": "Limiting the number of retained diagnostic logs in virtual machines helps in managing datastore space effectively without hampering diagnostic capabilities. The parameter governing this behavior is log.keepOld with a recommended setting of 10 or Undefined.",
    "rationale": "Maintaining a sensible limit on the number of diagnostic logs retained helps in avoiding potential issues related to datastore space exhaustion, while still retaining a useful set of recent logs for troubleshooting purposes. Impact: There is no negative functional impact.",
    "audit": "To verify that log files will be created more frequently, verify that log.keepOld is set to 10. 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Verify that log.keepOld is set to 10. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"log.keepOld\"| Select Entity, Name, Value",
    "remediation": "To set this configuration utilize the vSphere interface as follows: 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Click on ADD CONFIGURATION PARAMS then input log.keepOld with a value of 10. 5. Click OK, then OK again. To set the number of log files to be used to 10, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"log.keepOld\" -value \"10\" References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009- 439C-9142-18A9E7C592EA.html",
    "function_names": [
      "compute_virtual_machine_log_retention_limited",
      "compute_virtual_machine_diagnostic_logs_keep_old_configured",
      "compute_virtual_machine_log_keep_old_max_10",
      "compute_virtual_machine_log_retention_undefined_or_limited"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no negative functional impact.",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009- 439C-9142-18A9E7C592EA.html"
  },
  {
    "id": "7.26",
    "title": "(L1) Virtual machines must limit the size of diagnostic logs",
    "assessment": "Automated",
    "description": "Limiting the size of diagnostic logs on virtual machines ensures efficient utilization of datastore space, particularly beneficial for long-running VMs. This control assists in maintaining an optimal balance between diagnostic capabilities and storage resources. The parameter governing this behavior is log.rotateSize.",
    "rationale": "Setting a limit on the size of diagnostic logs helps in preventing excessive space consumption, thus ensuring that ample storage remains available for other essential operations. Impact: There is no negative functional impact identified by limiting the size of diagnostic logs. This control facilitates proficient management of storage resources, ensuring other vital functions are not compromised due to space exhaustion.",
    "audit": "To verify the maximum log file size is limited properly, verify that log.rotateSize is set to 1024000. 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Verify that log.rotateSize is set to 1024000. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name  \"log.rotateSize\"| Select Entity, Name, Value",
    "remediation": "To set this configuration utilize the vSphere interface as follows: 1. Select the VM then select Actions followed by Edit Settings. 2. Click on the VM Options tab then expand Advanced. 3. Click on EDIT CONFIGURATION. 4. Click on ADD CONFIGURATION PARAMS then input log.rotateSize with a value of 1024000. 5. Click OK, then OK again. To properly limit the maximum log file size, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"log.rotateSize\" -value \"1024000\" References: 1. http://kb.vmware.com/kb/8182749 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.monitoring.doc/GUID-2DD66869-52C7-42C5- 8F5B-145EBD26BBA1.html",
    "function_names": [
      "compute_virtual_machine_log_rotate_size_limited",
      "compute_vm_diagnostic_log_size_limited",
      "compute_vm_log_rotation_size_configured",
      "compute_virtual_machine_log_size_restricted",
      "compute_vm_diagnostic_log_rotate_size_set"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no negative functional impact identified by limiting the size of diagnostic logs. This control facilitates proficient management of storage resources, ensuring other vital functions are not compromised due to space exhaustion.",
    "references": "1. http://kb.vmware.com/kb/8182749 2. https://docs.vmware.com/en/VMware- vSphere/7.0/com.vmware.vsphere.monitoring.doc/GUID-2DD66869-52C7-42C5- 8F5B-145EBD26BBA1.html"
  },
  {
    "id": "7.27",
    "title": "(L1) Virtual machines must limit informational messages from the virtual machine to the VMX file",
    "assessment": "Manual",
    "description": "Limit the number of informational messages from the virtual machine to the VMX file to prevent the file from exceeding its default size of 1MB, thereby avoiding potential denial of service situations due to a full datastore. The parameter governing this behavior is tools.setInfo.sizeLimit with a recommended setting of 1048576 or Undefined.",
    "rationale": "This control helps in maintaining a clutter-free VMX file, ensuring the datastore operates optimally without being overwhelmed by excessive informational messages, which in turn supports system reliability and performance. Impact: No negative functional impact identified.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_virtual_machine_info_messages_limited",
      "compute_vm_tools_set_info_size_limit_configured",
      "compute_vm_vmx_file_size_protected",
      "compute_vm_informational_messages_restricted",
      "compute_vm_tools_set_info_size_limit_undefined_or_default"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "No negative functional impact identified."
  },
  {
    "id": "7.28",
    "title": "(L2) Virtual machines should have virtual machine hardware version 19 or newer",
    "assessment": "Manual",
    "description": "Upgrade to hardware version 19 or newer to access enhanced features and better performance. Test the upgrades and ensure compatibility across all operational landscapes.",
    "rationale": "Upgrading facilitates improved performance and feature access, aligning with ESXi and vSphere updates, while ensuring service continuity across various environments. Impact: Changes in device versions within the guest may occur, requiring thorough testing to prevent service disruptions. Snapshots can aid in testing, allowing you to revert the hardware version if needed.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_virtual_machine_hardware_version_min_v19",
      "compute_vm_hardware_version_current",
      "compute_vm_hardware_version_up_to_date",
      "compute_vm_hardware_version_compatible",
      "compute_vm_hardware_version_supported"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "Changes in device versions within the guest may occur, requiring thorough testing to prevent service disruptions. Snapshots can aid in testing, allowing you to revert the hardware version if needed."
  },
  {
    "id": "8.1",
    "title": "(L1) VMware Tools must be a version that has not reached End of General Support status",
    "assessment": "Manual",
    "description": "Ensuring VMware Tools is running a version that has not reached its End of General Support (EOGS) status is imperative for maintaining a secure and supported environment. A version within its support period guarantees regular updates, security patches, and vendor support. It's advisable to have a procedure in place for regular checking and updating of VMware Tools to a supported version.",
    "rationale": "Running a supported version of VMware Tools ensures that the environment benefits from the latest security patches and updates, thereby reducing the risk of vulnerabilities. It also ensures that the organization can receive necessary support from the vendor when needed. Impact: Using a version of VMware Tools that has reached its EOGS can expose the environment to security risks due to lack of updates and patches. It also may lead to compliance issues and lack of vendor support which could result in operational inefficiencies.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vmware_tools_supported_version",
      "compute_vmware_tools_no_eogs",
      "compute_vmware_tools_version_current",
      "compute_vmware_tools_supported",
      "compute_vmware_tools_version_valid"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Using a version of VMware Tools that has reached its EOGS can expose the environment to security risks due to lack of updates and patches. It also may lead to compliance issues and lack of vendor support which could result in operational inefficiencies."
  },
  {
    "id": "8.2",
    "title": "(L1) VMware Tools must have all software updates installed",
    "assessment": "Manual",
    "description": "Ensuring that all software updates are installed on VMware Tools is crucial for maintaining a healthy and secure virtual environment. These updates provide essential drivers, enable effective management of guest operating systems, and offer features necessary for VM deployment and customization. It's vital to run a supported version compatible with the guest OS, be it Linux or Microsoft Windows, and keep it updated to benefit from the latest enhancements and security patches.",
    "rationale": "Keeping VMware Tools updated ensures that the virtual machines are running efficiently with the latest drivers and features, which in turn supports operational effectiveness. Additionally, updated software mitigates potential security risks, ensuring a more secure environment. Impact: Neglecting to update VMware Tools could result in outdated drivers, lack of new features, and potential security vulnerabilities, which may hinder the performance and security of the virtual environment.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vmware_tools_updates_installed",
      "compute_vmware_tools_latest_version",
      "compute_vmware_tools_patches_applied",
      "compute_vmware_tools_security_updates_installed",
      "compute_vmware_tools_compatible_version",
      "compute_vmware_tools_os_supported_version",
      "compute_vmware_tools_no_pending_updates",
      "compute_vmware_tools_auto_update_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Neglecting to update VMware Tools could result in outdated drivers, lack of new features, and potential security vulnerabilities, which may hinder the performance and security of the virtual environment."
  },
  {
    "id": "8.3",
    "title": "(L1) VMware Tools should configure automatic upgrades as appropriate for the environment",
    "assessment": "Manual",
    "description": "Automatic upgrades of VMware Tools can be managed via vSphere, ensuring VMware Tools versions remain current. This functionality is advisable unless alternative management and update mechanisms are in place. It is recommended to have automatic updates enabled to minimize administrative overhead and maintain up-to- date features and security patches. The parameter governing this behavior is autoupgrade allow-upgrade with a recommended setting of true.",
    "rationale": "Enabling automatic upgrades via vSphere ensures a streamlined process for keeping VMware Tools updated, reducing the administrative burden. It also ensures that VMs are running the latest versions with necessary security patches and updated features. Impact: Disabling automatic upgrades necessitates alternative methods for updating and reconfiguring VMware Tools, which could increase administrative overhead and potentially leave VMs with outdated versions, posing security risks and operational inefficiencies.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vmware_tools_auto_upgrade_enabled",
      "compute_vmware_tools_autoupgrade_allow_upgrade_true",
      "compute_vmware_tools_version_current",
      "compute_vmware_tools_security_patches_updated"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Disabling automatic upgrades necessitates alternative methods for updating and reconfiguring VMware Tools, which could increase administrative overhead and potentially leave VMs with outdated versions, posing security risks and operational inefficiencies."
  },
  {
    "id": "8.4",
    "title": "(L1) VMware Tools on deployed virtual machines must prevent being recustomized",
    "assessment": "Manual",
    "description": "Preventing re-customization of deployed virtual machines is essential to mitigate the risk of adversarial access through cloning and subsequent customization. Once a VM is deployed, it should be safeguarded against further customization to maintain the integrity of its configurations and data. The parameter governing this behavior is deployPkg enable-customization with a recommended setting of false.",
    "rationale": "This control mitigates the risk of unauthorized access and potential data exposure that may arise from cloning and re-customizing a VM. By adhering to this control, organizations uphold the integrity and security of deployed virtual machines. Impact: Disabling re-customization on deployed VMs may affect disaster recovery processes that necessitate IP address modifications. Such processes, facilitated by VMware Site Recovery Manager or VMware Cloud Disaster Recovery, will require alternative strategies for IP address management in recovery scenarios.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_virtual_machine_recustomization_disabled",
      "compute_vmware_tools_customization_prevented",
      "compute_vm_deploy_pkg_customization_disabled",
      "compute_vmware_tools_recustomization_blocked",
      "compute_virtual_machine_customization_locked"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Disabling re-customization on deployed VMs may affect disaster recovery processes that necessitate IP address modifications. Such processes, facilitated by VMware Site Recovery Manager or VMware Cloud Disaster Recovery, will require alternative strategies for IP address management in recovery scenarios."
  },
  {
    "id": "8.5",
    "title": "(L1) VMware Tools must limit the automatic addition of features",
    "assessment": "Manual",
    "description": "Limit the automatic addition of features during VMware Tools upgrade processes to maintain the desired security profile of the guest operating system from vSphere. This control can be managed by setting the configuration parameter to a specified value. The parameter governing this behavior is autoupgrade allow-add-feature with a recommended setting of false.",
    "rationale": "Restricting the automatic addition of features through VMware Tools upgrade processes helps in preserving the security configurations and minimizes the potential introduction of vulnerabilities. Impact: With this control enforced, administrators will need to employ alternative methods to update and reconfigure VMware Tools as required, which might necessitate additional administrative effort and oversight.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vmware_tools_auto_add_features_disabled",
      "compute_vmware_tools_autoupgrade_allow_add_feature_false",
      "compute_vmware_tools_feature_addition_restricted",
      "compute_vmware_tools_automatic_feature_addition_limited",
      "compute_vmware_tools_upgrade_feature_addition_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "With this control enforced, administrators will need to employ alternative methods to update and reconfigure VMware Tools as required, which might necessitate additional administrative effort and oversight."
  },
  {
    "id": "8.6",
    "title": "(L1) VMware Tools must limit the automatic removal of features",
    "assessment": "Manual",
    "description": "Limiting the automatic removal of features by VMware Tools during upgrade processes is crucial to maintain the intended security profile of the guest OS from vSphere. The automatic upgrade could potentially remove essential features, impacting the security posture inadvertently. The parameter governing this behavior is autoupgrade allow- remove-feature with a recommended setting of false.",
    "rationale": "Restricting automatic removal of features ensures that the security configurations and other essential features remain intact during upgrades, thus maintaining a consistent security posture. Impact: With this control, administrators would need to employ alternative methods for updating and reconfiguring VMware Tools, which might necessitate additional administrative effort.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vmware_tools_autoremove_disabled",
      "compute_vmware_tools_feature_removal_blocked",
      "compute_vmware_tools_upgrade_removal_restricted",
      "compute_vmware_tools_autoupgrade_removal_disabled",
      "compute_vmware_tools_autoremove_feature_protected"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "With this control, administrators would need to employ alternative methods for updating and reconfiguring VMware Tools, which might necessitate additional administrative effort."
  },
  {
    "id": "8.7",
    "title": "(L1) VMware Tools must deactivate GlobalConf unless required",
    "assessment": "Manual",
    "description": "The GlobalConf feature within VMware Tools facilitates the delivery of tools.conf configurations to virtual machines, simplifying configuration management. However, if not necessary, it's advisable to deactivate this feature to reduce potential security risks. The parameter governing this behavior is globalconf enabled with a recommended setting of false.",
    "rationale": "Deactivating GlobalConf minimizes the attack surface by reducing the number of channels through which configurations can be pushed to virtual machines, hence enhancing security. Impact: With GlobalConf deactivated, administrators would need to employ alternative methods for updating and reconfiguring VMware Tools, which might require additional steps or tools.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vmware_tools_globalconf_disabled",
      "compute_vmware_tools_globalconf_deactivated",
      "compute_vmware_tools_globalconf_not_required",
      "compute_vmware_tools_globalconf_false",
      "compute_vmware_tools_globalconf_secure_default"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "With GlobalConf deactivated, administrators would need to employ alternative methods for updating and reconfiguring VMware Tools, which might require additional steps or tools."
  },
  {
    "id": "8.8",
    "title": "(L1) VMware Tools must deactivate ContainerInfo unless required",
    "assessment": "Manual",
    "description": "Deactivating the ContainerInfo plugin within VMware Tools is advised unless its functionality is required. This plugin collects data on running containers within a Linux guest operating system. The parameter governing this behavior is containerinfo poll- interval with a recommended setting of 0.",
    "rationale": "Restricting unnecessary data collection is a prudent practice to minimize potential security risks, and to comply with least privilege principles. Impact: Disabling ContainerInfo could affect certain products and services within the VMware ecosystem that rely on this functionality, necessitating other configurations or methods to obtain the required container information.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vmware_tools_container_info_deactivated",
      "compute_vmware_tools_containerinfo_poll_interval_zero",
      "compute_vmware_tools_containerinfo_disabled_unless_required",
      "compute_vmware_tools_containerinfo_plugin_deactivated",
      "compute_vmware_tools_containerinfo_polling_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Disabling ContainerInfo could affect certain products and services within the VMware ecosystem that rely on this functionality, necessitating other configurations or methods to obtain the required container information."
  },
  {
    "id": "8.9",
    "title": "(L1) VMware Tools must deactivate Appinfo information gathering unless required",
    "assessment": "Manual",
    "description": "Deactivating the Appinfo module, unless necessary, through VMware Tools is a prudent measure to minimize the attack surface. This module is designed for application discovery, but if not in use, it should be disabled. The parameter governing this behavior is appinfo disabled with a recommended setting of true.",
    "rationale": "By deactivating the Appinfo module when not in use, potential vectors for unauthorized access or data leakage can be reduced. Impact: Disabling Appinfo may affect products and services within the VMware ecosystem that depend on this functionality, necessitating alternative configurations or solutions to retain those capabilities.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vmware_tools_appinfo_disabled",
      "compute_vmware_tools_appinfo_disabled_unless_required",
      "compute_vmware_tools_appinfo_module_deactivated",
      "compute_vmware_tools_appinfo_discovery_disabled",
      "compute_vmware_tools_appinfo_attack_surface_reduced"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Disabling Appinfo may affect products and services within the VMware ecosystem that depend on this functionality, necessitating alternative configurations or solutions to retain those capabilities."
  },
  {
    "id": "8.10",
    "title": "(L1) VMware Tools must deactivate Guest Store Upgrade operations unless required",
    "assessment": "Manual",
    "description": "The GuestStore feature facilitates the distribution of specific content to multiple guests. If not required, it is advisable to disable this plugin to minimize potential attack vectors. The parameter governing this behavior is gueststoreupgrade policy with a recommended setting of off.",
    "rationale": "Minimizing the attack surface by disabling unnecessary features is a prudent security measure. This control aids in reducing potential exposure points in the system. Impact: Deactivating Guest Store Upgrade operations may affect certain products and services within the VMware ecosystem that rely on this functionality, necessitating alternative configurations or methods to maintain required operational capabilities.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vmware_tools_guest_store_upgrade_disabled",
      "compute_vmware_tools_guest_store_upgrade_off",
      "compute_vmware_guest_store_upgrade_policy_disabled",
      "compute_vmware_guest_store_upgrade_policy_off"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Deactivating Guest Store Upgrade operations may affect certain products and services within the VMware ecosystem that rely on this functionality, necessitating alternative configurations or methods to maintain required operational capabilities."
  },
  {
    "id": "8.11",
    "title": "(L1) VMware Tools must deactivate Service Discovery unless required",
    "assessment": "Manual",
    "description": "The VMware Tools Service Discovery plugin is designed to connect to Aria Operations, furnishing it with additional data concerning guests and workloads. Disabling this plugin, when not in use, is a prudent step to diminish the attack surface. The parameter governing this behavior is servicediscovery disabled with a recommended setting of true.",
    "rationale": "Reducing the attack surface by disabling non-essential features is a fundamental security best practice. This control assists in minimizing potential exposure points, especially when the Service Discovery feature is not in use. Impact: Disabling Service Discovery may affect certain products and services within the VMware ecosystem dependent on this functionality, necessitating alternative configurations or methods to retain required operational capabilities.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vmware_tools_service_discovery_disabled",
      "compute_vmware_tools_service_discovery_disabled_unless_required",
      "compute_vmware_tools_servicediscovery_disabled",
      "compute_vmware_tools_servicediscovery_disabled_unless_required",
      "compute_vmware_tools_aria_operations_discovery_disabled",
      "compute_vmware_tools_guest_data_discovery_disabled",
      "compute_vmware_tools_attack_surface_reduced",
      "compute_vmware_tools_unused_plugins_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Disabling Service Discovery may affect certain products and services within the VMware ecosystem dependent on this functionality, necessitating alternative configurations or methods to retain required operational capabilities."
  },
  {
    "id": "8.12",
    "title": "(L1) VMware Tools must limit the use of MSI transforms when reconfiguring VMware Tools",
    "assessment": "Manual",
    "description": "Limiting the use of MSI transforms during VMware Tools reconfiguration is crucial to prevent unintended alterations to the installation database on Microsoft Windows guest operating systems from vSphere. This control is managed through a specific configuration parameter. The parameter governing this behavior is autoupgrade allow- msi-transforms with a recommended setting of false.",
    "rationale": "By restricting the use of MSI transforms, organizations can maintain a consistent security profile of the guest OS and minimize risks associated with unintended configuration changes during VMware Tools reconfiguration. Impact: Implementing this control will necessitate administrators to leverage alternative methods for updating and reconfiguring VMware Tools as required, which may demand additional administrative effort and oversight.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "vmware_tools_msi_transforms_disabled",
      "vmware_tools_autoupgrade_msi_transforms_false",
      "vmware_tools_reconfig_msi_transforms_restricted",
      "vmware_tools_windows_guest_msi_transforms_blocked",
      "vmware_tools_install_db_protection_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Implementing this control will necessitate administrators to leverage alternative methods for updating and reconfiguring VMware Tools as required, which may demand additional administrative effort and oversight."
  },
  {
    "id": "8.13",
    "title": "(L1) VMware Tools must enable VMware Tools logging",
    "assessment": "Manual",
    "description": "Enable logging within VMware Tools to ensure the collection of pertinent information, facilitating diagnostic or forensic activities. Logging within VMware Tools is highly customizable, allowing for tailored logging setups. The parameter governing this behavior is logging log with a recommended setting of true.",
    "rationale": "Logging is crucial for diagnosing issues and understanding system interactions. It provides a clear trail of events, aiding in the identification and rectification of potential problems. Impact: There is no known negative functional impact from enabling VMware Tools logging. This control solely promotes the capture of essential data for diagnostics and analysis.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vmware_tools_logging_enabled",
      "compute_vmware_tools_logging_configured",
      "compute_vmware_tools_logging_customized",
      "compute_vmware_tools_logging_active",
      "compute_vmware_tools_logging_set_to_true"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "There is no known negative functional impact from enabling VMware Tools logging. This control solely promotes the capture of essential data for diagnostics and analysis."
  },
  {
    "id": "8.14",
    "title": "(L1) VMware Tools must send VMware Tools logs to the system log service",
    "assessment": "Manual",
    "description": "Adjusting the logging destination in VMware Tools from the default file on disk to system log services streamlines log management. It redirects logs to syslog on Linux guests and the Windows Event Service on Microsoft Windows guests for centralized monitoring, management, and archiving. The parameter governing this behavior is logging vmsvc.handler with a recommended setting of syslog.",
    "rationale": "Centralizing log management through system log services enhances monitoring and archival processes. It also fosters a more structured approach to analyzing log data which is crucial for troubleshooting and compliance purposes. Impact: Processes dependent on log files in the default location may require modifications to function correctly with the new logging setup, necessitating updates to ensure proper operation and log data retrieval.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vmware_tools_logs_syslog_enabled",
      "compute_vmware_tools_logs_event_service_enabled",
      "compute_vmware_tools_logs_centralized",
      "compute_vmware_tools_logs_vmsvc_handler_syslog",
      "compute_vmware_tools_logs_redirect_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 (L1) - Corporate/Enterprise Environment (general use)",
    "impact": "Processes dependent on log files in the default location may require modifications to function correctly with the new logging setup, necessitating updates to ensure proper operation and log data retrieval."
  },
  {
    "id": "8.15",
    "title": "(L2) VMware Tools must deactivate Guest Operations unless required",
    "assessment": "Manual",
    "description": "Guest Operations are a set of functions that underpin most host-to-guest interaction. Deactivating them reduces attack surface but also drastically reduces functionality. Ensure that your environment does not require these functions. Do not do this on template VMs. For a list of functions see: https://vdc-download.vmware.com/vmwb-repository/dcr-public/fe08899f-1eec-4d8d- b3bc-a6664c168c2c/7fdf97a1-4c0d-4be0-9d43- 2ceebbc174d9/doc/vim.vm.guest.GuestOperationsManager.html",
    "rationale": "Reducing the attack surface by deactivating unnecessary functions is a standard security measure. This control is crucial for mitigating risks associated with host-to- guest interactions. Impact: Deactivation of Guest Operations can hinder the functionality of certain products and services within the VMware ecosystem, requiring alternative configurations or methods to maintain required functionalities. This includes guest customization.",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_vm_guest_operations_disabled",
      "compute_vm_guest_operations_disabled_non_template",
      "compute_vm_guest_operations_disabled_required_only",
      "compute_vm_guest_operations_disabled_except_essential",
      "compute_vm_guest_operations_disabled_functionality_reduced"
    ],
    "profile_applicability": "\u2022  Level 2 (L2) - High Security/Sensitive Data Environment (limited functionality)",
    "impact": "Deactivation of Guest Operations can hinder the functionality of certain products and services within the VMware ecosystem, requiring alternative configurations or methods to maintain required functionalities. This includes guest customization."
  }
]