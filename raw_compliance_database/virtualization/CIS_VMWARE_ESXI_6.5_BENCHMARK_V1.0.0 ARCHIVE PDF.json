[
  {
    "id": "1.1",
    "title": "(L1) Ensure ESXi is properly patched",
    "assessment": "Scored",
    "description": "VMware Update Manager is a tool used to automate patch management for vSphere hosts and virtual machines. Creating a baseline for patches is a good way to ensure all hosts are at the same patch level. VMware also publishes advisories on security patches and offers a way to subscribe to email alerts for them.",
    "rationale": "By staying up to date on ESXi patches, vulnerabilities in the hypervisor can be mitigated. An educated attacker can exploit known vulnerabilities when attempting to attain access or elevate privileges on an ESXi host.",
    "audit": "Verify that the patches are up to date. The following PowerCLI snippet will provide a list of all installed patches: Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost; (Get-ESXCli).software.vib.list() | Select-Object @{N=\"VMHost\";E={$VMHost}}, Name, AcceptanceLevel, CreationDate, ID, InstallDate, Status, Vendor, Version; }",
    "remediation": "Employ a process to keep ESXi hosts up to date with patches in accordance with industry standards and internal guidelines. Leverage the VMware Update Manager to test and apply patches as they become available.   12 | P a g e Impact: ESXi servers must be in Maintenance Mode to apply patches. This implies all VMs must be moved or powered off on the ESXi server, so the patching process may necessitate having brief outages. References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.update_manager.doc/GUID-EF6BEE4C-4583- 4A8C-81B9-5B074CA2E272.html  13 | P a g e",
    "function_names": [
      "vmware_esxi_patches_up_to_date",
      "vmware_esxi_patch_baseline_configured",
      "vmware_esxi_security_patches_applied",
      "vmware_esxi_patch_alert_subscription_enabled",
      "vmware_esxi_patch_management_automated",
      "vmware_esxi_patch_level_consistent",
      "vmware_esxi_critical_patches_installed",
      "vmware_esxi_patch_compliance_monitored"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "ESXi servers must be in Maintenance Mode to apply patches. This implies all VMs must be moved or powered off on the ESXi server, so the patching process may necessitate having brief outages.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.update_manager.doc/GUID-EF6BEE4C-4583- 4A8C-81B9-5B074CA2E272.html  13 | P a g e"
  },
  {
    "id": "1.2",
    "title": "(L1) Ensure the Image Profile VIB acceptance level is configured properly",
    "assessment": "Scored",
    "description": "A VIB (vSphere Installation Bundle) is a collection of files that are packaged into an archive. The VIB contains a signature file that is used to verify the level of trust. The ESXi Image Profile supports four VIB acceptance levels: 1. VMware Certified - VIBs created, tested, and signed by VMware 2. VMware Accepted - VIBs created by a VMware partner but tested and signed by VMware 3. Partner Supported - VIBs created, tested, and signed by a certified VMware partner 4. Community Supported - VIBs that have not been tested by VMware or a VMware partner",
    "rationale": "The ESXi Image Profile should only allow signed VIBs because an unsigned VIB represents untested code installed on an ESXi host. Also, use of unsigned VIBs will cause hypervisor Secure Boot to fail to configure. Community Supported VIBs do not have digital signatures. To protect the security and integrity of your ESXi hosts, do not allow unsigned (CommunitySupported) VIBs to be installed on your hosts.",
    "audit": "Perform the following to verify unsigned VIBs are not allowed: 1. Connect to each ESX/ESXi host using the ESXi Shell or vCLI, and execute the command \"esxcli software acceptance get\" to verify the acceptance level is at either \"VMware Certified\", \"VMware Accepted\", or \"Partner Supported\". 2. Connect to each ESX/ESXi host using the vCLI, and execute the command \"esxcli software vib list\" to verify the acceptance level for each VIB is either \"VMware Certified\", \"VMware Accepted\", or \"Partner Supported\". Additionally, the following PowerCLI command may be used: # List the Software AcceptanceLevel for each host Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $VMHost | Select Name,  14 | P a g e @{N=\"AcceptanceLevel\";E={$ESXCli.software.acceptance.get()}} } # List only the vibs which are not at \"VMwareCertified\" or \"VMwareAccepted\" or \"PartnerSupported\" acceptance level Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $ESXCli.software.vib.list() | Where { ($_.AcceptanceLevel -ne \"VMwareCertified\") -and ($_.AcceptanceLevel -ne \"VMwareAccepted\") -and ($_.AcceptanceLevel -ne \"PartnerSupported\") } }",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command (in the example code, the level is Partner Supported): # Set the Software AcceptanceLevel for each host<span> Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $ESXCli.software.acceptance.Set(\"PartnerSupported\") } Default Value: Partner Supported References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.install.doc/GUID-7C9A1E23-7FCD-4295-9CB1- C932F2423C63.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335- CFBCE0DD2167.html",
    "function_names": [
      "esxi_image_profile_vib_acceptance_level_certified",
      "esxi_image_profile_vib_acceptance_level_accepted",
      "esxi_image_profile_vib_acceptance_level_partner_supported",
      "esxi_image_profile_vib_acceptance_level_community_supported",
      "esxi_image_profile_vib_acceptance_level_configured_properly"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.install.doc/GUID-7C9A1E23-7FCD-4295-9CB1- C932F2423C63.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335- CFBCE0DD2167.html"
  },
  {
    "id": "1.3",
    "title": "(L1) Ensure no unauthorized kernel modules are loaded on the host",
    "assessment": "Scored",
    "description": "ESXi hosts by default do not permit the loading of kernel modules that lack valid digital signatures. This feature can be overridden, which would allow unauthorized kernel modules to be loaded.",
    "rationale": "VMware provides digital signatures for kernel modules. Untested or malicious kernel modules loaded on the ESXi host can put the host at risk for instability and/or exploitation.",
    "audit": "To list all the loaded kernel modules from the ESXi Shell or vCLI, run: \"esxcli system module list\". For each module, verify the signature by running: esxcli system module get -m <module>. Additionally, the following PowerCLI command may be used: # List the system modules and Signature Info for each host Foreach ($VMHost in Get-VMHost ) { $ESXCli = Get-EsxCli -VMHost $VMHost $ESXCli.system.module.list() | Foreach { $ESXCli.system.module.get($_.Name) | Select @{N=\"VMHost\";E={$VMHost}}, Module, License,      Modulefile, Version, SignedStatus, SignatureDigest, SignatureFingerPrint } }",
    "remediation": "Secure the host by disabling unsigned modules and removing the offending VIBs from the host. To implement the recommended configuration state, run the following PowerCLI command: # To disable a module: $ESXCli = Get-EsxCli -VMHost \"MyHostName_or_IPaddress\" $ESXCli.system.module.set($false, $false, \"MyModuleName\")  16 | P a g e Note: evacuate VMs and place the host into maintenance mode before disabling kernel modules. References: 1. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.security.doc/GUID-E9B71B85-FBA3-447C-8A60- DEE2AE1A405A.html 2. http://kb.vmware.com/kb/2042473",
    "function_names": [
      "esxi_host_kernel_module_signature_enforced",
      "esxi_host_unauthorized_kernel_module_blocked",
      "esxi_host_kernel_module_integrity_verified",
      "esxi_host_kernel_module_loading_restricted",
      "esxi_host_kernel_module_signature_required"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.security.doc/GUID-E9B71B85-FBA3-447C-8A60- DEE2AE1A405A.html 2. http://kb.vmware.com/kb/2042473"
  },
  {
    "id": "2.1",
    "title": "(L1) Ensure NTP time synchronization is configured properly",
    "assessment": "Scored",
    "description": "Network Time Protocol (NTP) synchronization should be configured correctly and enabled on each VMware ESXi host to ensure accurate time for system event logs. The time sources used by the ESXi hosts should be in sync with an agreed-upon time standard such as Coordinated Universal Time (UTC). There should be at minimum two NTP sources in place, and they should sync whenever possible.",
    "rationale": "By ensuring that all systems use the same relative time source (including the relevant localization offset), and that the relative time source can be correlated to an agreed-upon time standard, it is simpler to track and correlate an intruder's actions when reviewing the relevant log files. Incorrect time settings can also make auditing inaccurate.",
    "audit": "To confirm NTP synchronization is enabled and properly configured, perform the following from the vSphere web client: 1. Select the host. 2. Click \"Configure\" -> \"System\" -> \"Time Configuration\". 3. Click the \"Edit...\" button. 4. Verify that the names/IP addresses of the NTP servers are correct. 5. Verify that the NTP service startup policy is \"Start and stop with host\". Additionally, the following PowerCLI command may be used: # List the NTP Settings for all hosts Get-VMHost | Select Name, @{N=\"NTPSetting\";E={$_ | Get-VMHostNtpServer}}   18 | P a g e",
    "remediation": "To enable and properly configure NTP synchronization, perform the following from the vSphere web client: 1. Select the host. 2. Click \"Configure\" -> \"System\" -> \"Time Configuration\". 3. Click the \"Edit...\" button. 4. Click on \"Use Network Time Protocol\". 5. Provide the names or IP addresses of your NTP servers. Separate servers with commas. 6. If the NTP Service Status is \"Stopped\", click on \"Start\". 7. Change the startup policy to \"Start and stop with host\". 8. Click \"OK\". To implement the recommended configuration state, run the following PowerCLI command: # Set the NTP Settings for all hosts # If an internal NTP server is used, replace pool.ntp.org with # the IP address or the Fully Qualified Domain Name (FQDN) of the internal NTP server $NTPServers = \"pool.ntp.org\", \"pool2.ntp.org\" Get-VMHost | Add-VmHostNtpServer $NTPServers References: 1. http://pubs.vmware.com/vsphere-6- 5/index.jsp#com.vmware.vcli.examples.doc/GUID-C937B5AA-8413-4791-AA89- C202143B24D5.html 2. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.security.doc/GUID-2553C86E-7981-4F79-B9FC- A6CECA52F6CC.html",
    "function_names": [
      "compute_esxi_host_ntp_synchronized",
      "compute_esxi_host_ntp_multiple_sources",
      "compute_esxi_host_ntp_utc_time_standard",
      "compute_esxi_host_ntp_sync_frequency_enabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere-6- 5/index.jsp#com.vmware.vcli.examples.doc/GUID-C937B5AA-8413-4791-AA89- C202143B24D5.html 2. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.security.doc/GUID-2553C86E-7981-4F79-B9FC- A6CECA52F6CC.html"
  },
  {
    "id": "2.2",
    "title": "(L1) Ensure the ESXi host firewall is configured to restrict access to services running on the host",
    "assessment": "Scored",
    "description": "The ESXi firewall is enabled by default and allows ping (ICMP) and communication with DHCP/DNS clients. Access to services should only be allowed by authorized IP addresses/networks.",
    "rationale": "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access. Reduce the risk by configuring the ESXi firewall to only allow access from authorized IP addresses and networks.",
    "audit": "To confirm access to services running on an ESXi host is properly restricted, perform the following from the vSphere web client: 1. Select the host. 2. Go to \"Configure\" -> \"System\" -> \"Security Profile\". 3. In the \"Firewall\" section, select \"Edit...\". 4. For each enabled service, (e.g., ssh, vSphere Web Access, http client) check to see if the specified allowed IP addresses are correct. Additionally, the following PowerCLI command may be used: # List all services for a host Get-VMHost HOST1 | Get-VMHostService # List the services which are enabled and have rules defined for specific IP ranges to access the service Get-VMHost HOST1 | Get-VMHostFirewallException | Where {$_.Enabled -and (-not $_.ExtensionData.AllowedHosts.AllIP)} # List the services which are enabled and do not have rules defined for specific IP ranges to access the service Get-VMHost HOST1 | Get-VMHostFirewallException | Where {$_.Enabled -and ($_.ExtensionData.AllowedHosts.AllIP)}   20 | P a g e",
    "remediation": "To properly restrict access to services running on an ESXi host, perform the following from the vSphere web client: 1. Select the host. 2. Go to \"Configure\" -> \"System\" -> \"Security Profile\". 3. In the \"Firewall\" section, select \"Edit...\". 4. For each enabled service, (e.g., ssh, vSphere Web Access, http client) provide the range of allowed IP addresses. 5. Click \"OK\". References: 1. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.security.doc/GUID-8912DD42-C6EA-4299-9B10- 5F3AEA52C605.html",
    "function_names": [
      "esxi_host_firewall_restricted_access",
      "esxi_host_firewall_authorized_ips_only",
      "esxi_host_firewall_service_access_controlled",
      "esxi_host_firewall_default_rules_configured",
      "esxi_host_firewall_icmp_restricted",
      "esxi_host_firewall_dhcp_dns_restricted",
      "esxi_host_firewall_unauthorized_access_blocked",
      "esxi_host_firewall_network_access_limited",
      "esxi_host_firewall_secure_service_rules",
      "esxi_host_firewall_compliance_enabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.security.doc/GUID-8912DD42-C6EA-4299-9B10- 5F3AEA52C605.html"
  },
  {
    "id": "2.3",
    "title": "(L1) Ensure Managed Object Browser (MOB) is disabled",
    "assessment": "Scored",
    "description": "The Managed Object Browser (MOB) is a web-based server application that lets you examine objects that exist on the server side, explore the object model used by the VM kernel to manage the host, and change configurations. It is installed and started automatically when vCenter is installed.",
    "rationale": "The MOB is meant to be used primarily for debugging the vSphere SDK. Because there are no access controls, the MOB could also be used as a method to obtain information about a host being targeted for unauthorized access.",
    "audit": "To determine if the MOB is enabled, run the following command from the ESXi shell: vim-cmd proxysvc/service_list Additionally, the following PowerCLI command may be used: Get-VMHost | Get-AdvancedSetting -Name Config.HostAgent.plugins.solo.enableMob",
    "remediation": "To disable the MOB, run the following ESXi shell command: vim-cmd proxysvc/remove_service \"/mob\" \"httpsWithRedirect\" Additionally, the following PowerCLI command may be used: Get-VMHost | Get-AdvancedSetting -Name Config.HostAgent.plugins.solo.enableMob |Set-AdvancedSetting -value \"false\" Note: You cannot disable the MOB while a host is in lockdown mode.   22 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-0EF83EA7-277C-400B- B697-04BDC9173EA3.html",
    "function_names": [
      "vcenter_mob_disabled",
      "vcenter_server_mob_disabled",
      "vcenter_managed_object_browser_disabled",
      "vcenter_host_mob_disabled",
      "vcenter_vm_kernel_mob_disabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-0EF83EA7-277C-400B- B697-04BDC9173EA3.html"
  },
  {
    "id": "2.4",
    "title": "(L1) Ensure default self-signed certificate for ESXi communication is not used",
    "assessment": "Scored",
    "description": "The default certificate is self-signed, not signed by a trusted certificate authority (CA). It should be replaced with a valid certificate issued by a trusted CA.",
    "rationale": "Using the default self-signed certificate may increase risk related to man-in-the-middle (MITM) attacks.",
    "audit": "View the details of the SSL certificate presented by the ESXi host and determine if it is issued by a trusted CA: 1. Log in to the ESXi Shell, either directly from the DCUI or from an SSH client, as a user with administrator privileges. 2. In the directory /etc/vmware/ssl, rename the existing certificates using the following commands: mv rui.crt orig.rui.crt mv rui.key orig.rui.key  3. Copy the certificates you want to use to /etc/vmware/ssl. 4. Rename the new certificate and key to rui.crt and rui.key. 5. Restart the host after you install the new certificate. Alternatively, you can put the host into maintenance mode, install the new certificate, use the Direct Console User Interface (DCUI) to restart the management agents, and set the host to exit maintenance mode.",
    "remediation": "Leverage VMware's SSL Certificate Automation Tool to install CA-signed SSL certificates. For more information on this tool, please see http://kb.vmware.com/kb/2057340.  24 | P a g e Impact: Replacing the default certificate might cause vCenter Server to stop managing the host. Disconnect and reconnect the host if vCenter Server cannot verify the new certificate. References: 1. https://kb.vmware.com/s/article/2111219 2. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.security.doc/GUID-AC7E6DD7-F984-4E0F-983A- 463031BA5FE7.html  25 | P a g e",
    "function_names": [
      "compute_esxi_certificate_trusted_ca",
      "compute_esxi_default_certificate_not_used",
      "compute_esxi_communication_certificate_valid",
      "compute_esxi_certificate_ca_signed",
      "compute_esxi_self_signed_certificate_replaced"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "Replacing the default certificate might cause vCenter Server to stop managing the host. Disconnect and reconnect the host if vCenter Server cannot verify the new certificate.",
    "references": "1. https://kb.vmware.com/s/article/2111219 2. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.security.doc/GUID-AC7E6DD7-F984-4E0F-983A- 463031BA5FE7.html  25 | P a g e"
  },
  {
    "id": "2.5",
    "title": "(L1) Ensure SNMP is configured properly",
    "assessment": "Not Scored",
    "description": "Simple Network Management Protocol (SNMP) can be used to help manage hosts. Many organizations have other means in place of managing hosts and do not need SNMP enabled. If SNMP is needed, it should be configured properly to reduce the risk of misuse or compromise. For example, ESXi supports SNMPv3, which provides stronger security than SNMPv1 or SNMPv2, including key authentication and encryption. It is also important to configure the destination for SNMP traps.",
    "rationale": "If SNMP is not properly configured, monitoring data containing sensitive information can be sent to a malicious host and used to help exploit the host.",
    "audit": "To confirm the proper configuration of SNMP, perform the following from the ESXi Shell or vCLI: 1. Run the following to determine if SNMP is being used: esxcli system snmp get 2. If SNMP is being used, refer to the vSphere Monitoring and Performance guide, chapter 8 for steps to verify the parameters. Additionally, the following PowerCLI command may be used to view the SNMP configuration: # List the SNMP Configuration of a host (single host connection required) Get-VMHostSnmp",
    "remediation": "To correct the SNMP configuration, perform the following from the ESXi Shell or vCLI: 1. If SNMP is not needed, disable it by running: esxcli system snmp set --enable false  26 | P a g e  2. If SNMP is needed, refer to the vSphere Monitoring and Performance guide, chapter 8 for steps to configure it. Additionally, the following PowerCLI command may be used to implement the configuration: # Update the host SNMP Configuration (single host connection required) Get-VmHostSNMP | Set-VMHostSNMP -Enabled:$true -ReadOnlyCommunity '<secret>' Notes: \u2022 SNMP must be configured on each ESXi host \u2022 SNMP settings can be configured using Host Profiles References: 1. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.monitoring.doc/GUID-8EF36D7D-59B6-4C74- B1AA-4A9D18AB6250.html",
    "function_names": [
      "compute_snmp_protocol_version_min_v3",
      "compute_snmp_authentication_enabled",
      "compute_snmp_encryption_enabled",
      "compute_snmp_trap_destination_configured",
      "compute_snmp_unused_disabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.monitoring.doc/GUID-8EF36D7D-59B6-4C74- B1AA-4A9D18AB6250.html"
  },
  {
    "id": "2.6",
    "title": "(L1) Ensure dvfilter API is not configured if not used",
    "assessment": "Scored",
    "description": "The dvfilter network API is used by some products (e.g., VMSafe). If it is not in use, it should not be configured to send network information to a VM.",
    "rationale": "If the dvfilter network API is enabled in the future and it is already configured, an attacker might attempt to connect a VM to it, thereby potentially providing access to the network of other VMs on the host.",
    "audit": "If the dvfilter network API is not being used on the host, ensure that the following kernel parameter has a blank value: Net.DVFilterBindIpAddress. 1. From the vSphere web client, select the host and click \"Configure\" -> \"System\" -> \"Advanced System Settings\". 2. Enter Net.DVFilterBindIpAddress in the filter. 3. Verify Net.DVFilterBindIpAddress has an empty value. 4. If an appliance is being used, then make sure the value of this parameter is set to the proper IP address. Additionally, the following PowerCLI command may be used to verify the setting: # List Net.DVFilterBindIpAddress for each host Get-VMHost | Select Name, @{N=\"Net.DVFilterBindIpAddress\";E={$_ | Get- AdvancedSetting Net.DVFilterBindIpAddress | Select -ExpandProperty Values}}",
    "remediation": "To remove the configuration for the dvfilter network API, perform the following from the vSphere web client: 1. Select the host and click \"Configure\" -> \"System\" -> \"Advanced System Settings\". 2. Enter Net.DVFilterBindIpAddress in the filter. 3. Set Net.DVFilterBindIpAddress to an empty value. 4. If an appliance is being used, make sure the value of this parameter is set to the proper IP address.  28 | P a g e 5. Make sure the attribute is highlighted, then click the pencil icon. 6. Enter the proper IP address. 7. Click \"OK\". To implement the recommended configuration state, run the following PowerCLI command: # Set Net.DVFilterBindIpAddress to null on all hosts Get-VMHost HOST1 | Foreach { Set-AdvancedSetting -VMHost $_ -Name Net.DVFilterBindIpAddress -IPValue \"\" } Impact: This will prevent a dvfilter-based network security appliance such as a firewall from functioning if not configured correctly. Default Value: Not configured References: 1. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A-B821- ED17A77B0206.html 2. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.ext_solutions.doc/GUID-6013E15D-92CE-4970- 953C-ACCB36ADA8AD.html",
    "function_names": [
      "compute_dvfilter_api_disabled",
      "compute_dvfilter_api_unused_disabled",
      "compute_vm_dvfilter_api_disabled",
      "compute_network_dvfilter_api_disabled",
      "compute_vmsafe_dvfilter_api_disabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "This will prevent a dvfilter-based network security appliance such as a firewall from functioning if not configured correctly. Default Value: Not configured",
    "references": "1. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A-B821- ED17A77B0206.html 2. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.ext_solutions.doc/GUID-6013E15D-92CE-4970- 953C-ACCB36ADA8AD.html"
  },
  {
    "id": "2.7",
    "title": "(L1) Ensure expired and revoked SSL certificates are removed from the ESXi server",
    "assessment": "Not Scored",
    "description": "By default, ESXi hosts do not have Certificate Revocation List (CRL) checking available, so expired and revoked SSL certificates must be checked and removed manually.",
    "rationale": "Leaving expired and revoked certificates on your vCenter Server system can compromise your environment. Replacing certificates will avoid having users get used to clicking through browser warnings. The warning might be an indication of a man-in-the-middle attack, and only inspection of the certificate and thumbprint can guard against such attacks.",
    "audit": "To assess if there are expired or revoked SSL certificates on your ESXi server, use the PowerCLI script called out in \"verify-ssl-certificates\".",
    "remediation": "Replace expired and revoked certificates with certificates from a trusted CA. Certificates can be replaced in a number of ways: Replace a Default ESXi Certificate and Key from the ESXi Shell 1. Log in to the ESXi Shell, either directly from the DCUI or from an SSH client, as a user with administrator privileges. 2. In the directory /etc/vmware/ssl, rename the existing certificates using the following commands: mv rui.crt orig.rui.crt mv rui.key orig.rui.key 3. Copy the certificates that you want to use to /etc/vmware/ssl. 4. Rename the new certificate and key to rui.crt and rui.key. 5. Restart the host after you install the new certificate. Alternatively, you can put the host into maintenance mode, install the new certificate, use the Direct Console User Interface (DCUI) to restart the management agents, and set the  30 | P a g e host to exit maintenance mode. Replace a Default ESI Certificate and Key by Using the vifs Command 1. Back up the existing certificates. 2. Generate a certificate request following the instructions from the certificate authority. 3. At the command line, use the vifs command to upload the certificate to the appropriate location on the host. vifs --server hostname --username username --put rui.crt /host/ssl_cert vifs --server hostname --username username --put rui.key /host/ssl_key 4. Restart the host. Alternatively, you can put the host into maintenance mode, install the new certificate, and then use the Direct Console User Interface (DCUI) to restart the management agents. Replace A Default ESI Certificate and Key Using HTTP PUT 1. Back up the existing certificates. 2. In your upload application, process each file as follows: 3. Open the file. 4. Publish the file to one of these locations: Certificates   https://hostname/host/ssl_cert Keys   https://hostname/host/ssl_key 3. The locations /host/ssl_cert and host/ssl_key link to the certificate files in /etc/vmware/ssl. 4. Restart the host. References: 1. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.security.doc/GUID-AC7E6DD7-F984-4E0F-983A- 463031BA5FE7.html 2. http://en-us.sysadmins.lv/Lists/Posts/Post.aspx?List=332991f0-bfed-4143-9eea- f521167d287c&ID=60  31 | P a g e 3 Logging This section contains recommendations related to ESXi's logging capabilities.",
    "function_names": [
      "compute_ssl_certificate_expired_removed",
      "compute_ssl_certificate_revoked_removed",
      "compute_ssl_certificate_validity_checked",
      "compute_ssl_certificate_crl_verified",
      "compute_ssl_certificate_manual_review_required"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.vsphere.security.doc/GUID-AC7E6DD7-F984-4E0F-983A- 463031BA5FE7.html 2. http://en-us.sysadmins.lv/Lists/Posts/Post.aspx?List=332991f0-bfed-4143-9eea- f521167d287c&ID=60  31 | P a g e 3 Logging This section contains recommendations related to ESXi's logging capabilities."
  },
  {
    "id": "3.1",
    "title": "(L1) Ensure a centralized location is configured to collect ESXi host core dumps",
    "assessment": "Scored",
    "description": "The VMware vSphere Network Dump Collector service allows for collecting diagnostic information from a host that experiences a critical fault. This service provides a centralized location for collecting ESXi host core dumps.",
    "rationale": "When a host crashes, an analysis of the resultant core dump is essential to being able to identify the cause of the crash and determine a resolution. Installing a centralized dump collector helps ensure that core files are successfully saved and made available in the event an ESXi host should ever panic.",
    "audit": "Run the following ESXi shell command to determine if the host is configured as prescribed: esxcli system coredump network get",
    "remediation": "To implement the recommended configuration state, run the following ESXi shell commands: # Configure remote Dump Collector Server esxcli system coredump network set -v [VMK#] -i [DUMP_SERVER] -o [PORT] # Enable remote Dump Collector esxcli system coredump network set -e true References: 1. http://kb.vmware.com/kb/1032051  32 | P a g e 2. http://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.vcli.examples.doc%2Fcli_performance.12.4.htm l 3. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.install.doc/GUID-775F602C-7432-4259-B132- 4EC1F38A7EE7.html 4. http://www.youtube.com/watch?v=veE6M7Na8-A",
    "function_names": [
      "vcenter_host_core_dump_collector_configured",
      "vcenter_host_core_dump_centralized_location_enabled",
      "vsphere_network_dump_collector_service_enabled",
      "esxi_host_core_dump_centralized_collection_enabled",
      "vsphere_host_core_dump_remote_storage_configured"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://kb.vmware.com/kb/1032051  32 | P a g e 2. http://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.vcli.examples.doc%2Fcli_performance.12.4.htm l 3. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.install.doc/GUID-775F602C-7432-4259-B132- 4EC1F38A7EE7.html 4. http://www.youtube.com/watch?v=veE6M7Na8-A"
  },
  {
    "id": "3.2",
    "title": "(L1) Ensure persistent logging is configured for all ESXi hosts",
    "assessment": "Scored",
    "description": "ESXi can be configured to store log files on an in-memory file system. This occurs when the host's Syslog.global.LogDir property is set to a non-persistent location, such as /scratch. When this is done, only a single day's worth of logs are stored at any time. Additionally, log files will be reinitialized upon each reboot.",
    "rationale": "Non-persistent logging presents a security risk because user activity logged on the host is only stored temporarily and will not be preserved across reboots. This can also complicate auditing and make it harder to monitor events and diagnose issues. ESXi host logging should always be configured to a persistent datastore.",
    "audit": "To verify persistent logging is configured properly, perform the following from the vSphere web client: 1. Select the host and go to \"Configure\" -> \"System\" -> \"Advanced System Settings\". 2. Enter Syslog.global.LogDir in the filter. 3. Ensure Syslog.global.LogDir is not set to /scratch or any other non-persistent datastore. Alternatively, the following PowerCLI command may be used: # List Syslog.global.logDir for each host Get-VMHost | Select Name, @{N=\"Syslog.global.logDir\";E={$_ | Get- AdvancedConfiguration Syslog.global.logDir | Select -ExpandProperty Values}}",
    "remediation": "To configure persistent logging properly, perform the following from the vSphere web client: 1. Select the host and go to \"Configure\" -> \"System\" -> \"Advanced System Settings\". 2. Enter Syslog.global.LogDir in the filter.  34 | P a g e 3. Set the Syslog.global.LogDirto the desired datastore path. Note: additional disk space may be required to store the log files. 4. Make sure the attribute is highlighted, then click the pencil icon. Alternatively, run the following PowerCLI command: # Set Syslog.global.logDir for each host Get-VMHost | Foreach { Set-AdvancedConfiguration -VMHost $_ -Name Syslog.global.logDir -Value \"<NewLocation>\" } References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F-B6C8- DAE8D95976E7.html 2. http://kb.vmware.com/kb/1033696",
    "function_names": [
      "esxi_host_log_persistent_storage_enabled",
      "esxi_host_syslog_global_logdir_persistent",
      "esxi_host_log_reboot_reinitialization_disabled",
      "esxi_host_log_retention_over_24h_enabled",
      "esxi_host_log_non_scratch_location_configured"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F-B6C8- DAE8D95976E7.html 2. http://kb.vmware.com/kb/1033696"
  },
  {
    "id": "3.3",
    "title": "(L1) Ensure remote logging is configured for ESXi hosts",
    "assessment": "Scored",
    "description": "By default, ESXI logs are stored on a local scratch volume or ramdisk. To preserve logs, also configure remote logging to a central log host for the ESXI hosts.",
    "rationale": "Remote logging to a central log host provides a secure, centralized store for ESXi logs. You can more easily monitor all hosts with a single tool. You can also do aggregate analysis and searching to look for such things as coordinated attacks on multiple hosts. Logging to a secure, centralized log server helps prevent log tampering and provides a long-term audit record.",
    "audit": "To ensure remote logging is configured properly, perform the following from the vSphere web client: 1. Select the host and click \"Configure\" -> \"System\" -> \"Advanced System Settings\". 2. Enter Syslog.global.logHost in the filter. 3. Verify the Syslog.global.logHost is set to the hostname of the central log server. Alternately, the following PowerCLI command may be used: # List Syslog.global.logHost for each host Get-VMHost | Select Name, @{N=\"Syslog.global.logHost\";E={$_ | Get- AdvancedSetting Syslog.global.logHost}}",
    "remediation": "To configure remote logging properly, perform the following from the vSphere web client: 1. Select the host and click \"Configure\" -> \"System\" -> \"Advanced System Settings\". 2. Enter Syslog.global.logHost in the filter. 3. Make sure Syslog.global.logHost is highlighted, then click the pencil icon. 4. Set Syslog.global.logHost to the hostname or IP address of the central log server. 5. Click \"OK\". Alternately, run the following PowerCLI command:  36 | P a g e # Set Syslog.global.logHost for each host Get-VMHost | Foreach { Set-<span>AdvancedSetting </span><span>-VMHost $_ - Name Syslog.global.logHost -Value \"<NewLocation>\" }</span> Note: When setting a remote log host, it is also recommended to set the \"Syslog.global.logDirUnique\" to true. You must configure the syslog settings for each host. References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F-B6C8- DAE8D95976E7.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.install.doc/GUID-775F602C-7432-4259-B132- 4EC1F38A7EE7.html",
    "function_names": [
      "esxi_host_remote_logging_enabled",
      "esxi_host_log_centralized",
      "esxi_host_log_remote_destination_configured",
      "esxi_host_log_preservation_enabled",
      "esxi_host_log_central_host_configured"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-9F67DB52-F469-451F-B6C8- DAE8D95976E7.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.install.doc/GUID-775F602C-7432-4259-B132- 4EC1F38A7EE7.html"
  },
  {
    "id": "4.1",
    "title": "(L1) Ensure a non-root user account exists for local admin access",
    "assessment": "Scored",
    "description": "By default, each ESXi host has a single \"root\" admin account that is used for local administration and to connect the host to vCenter Server. Use of this shared account should be limited, and named (non-root) user accounts with admin privileges should be used instead.",
    "rationale": "To avoid sharing a common root account, it is recommended on each host to create at least one named user account and assign it full admin privileges, and to use this account in lieu of a shared \"root\" account. Limit the use of \"root\", including setting a highly complex password for the account, but do not remove the \"root\" account.",
    "audit": "To confirm one or more named user accounts have been established, perform the following for each ESXi host: 1. Connect directly to the ESXi host using the vSphere Client. 2. Login as root or another authorized user. 3. Select Manage, then select the Security & Users tab. 4. Select User and view the local users. 5. Ensure at least one user exists that possesses the following: 6. The use has been granted shell access. 7. Select the \"Permissions\" tab and verify the \"Administrator\" role has been granted to the user.",
    "remediation": "To create one or more named user accounts (local ESXi user accounts), perform the following using the vSphere client (not the vSphere web client) for each ESXi host:  38 | P a g e 1. Connect directly to the ESXi host using the vSphere Client. 2. Login as root. 3. Select Manage, then select the Security & Users tab. 4. Select User and view the local users. 5. Add a local user and grant shell access to this user. 6. Select the Host, then select \"Actions\" and \"Permissions\". 7. Assign the \"Administrator\" role to the user. Notes: 1. Even if you add your ESXi host to an Active Directory domain, it is still recommended to add at least one local user account to ensure admins can still login in the event the host ever becomes isolated and unable to access Active Directory. 2. Adding local user accounts can be automated using Host Profiles. References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.html.hostclient.doc/GUID-0898677F-CE98- 41FB-A488-29DF6210CF5D.html",
    "function_names": [
      "compute_host_non_root_admin_exists",
      "compute_host_root_admin_restricted",
      "compute_host_admin_privileges_assigned",
      "compute_host_local_admin_account_configured",
      "compute_host_non_root_admin_privileges_verified"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.html.hostclient.doc/GUID-0898677F-CE98- 41FB-A488-29DF6210CF5D.html"
  },
  {
    "id": "4.2",
    "title": "(L1) Ensure passwords are required to be complex",
    "assessment": "Scored",
    "description": "ESXi uses the pam_passwdqc.so plug-in to set password strength and complexity. Options include setting minimum password length, requiring password characters to come from particular character sets, and restricting the number of consecutive failed logon attempts permitted. The settings should enforce the organization's password policies. Note that an uppercase character that begins a password does not count toward the number of character classes used, and neither does a number that ends a password.",
    "rationale": "All passwords for ESXi hosts should be hard to guess to reduce the risk of unauthorized access. Note: ESXi imposes no restrictions on the root password. Password strength and complexity rules only apply to non-root users.",
    "audit": "To confirm password complexity requirements are set, perform the following: 1. Login to the ESXi shell as a user with administrator privileges. 2. Open /etc/pam.d/passwd. 3. Locate the following line: password requisite /lib/security/$ISA/pam_passwdqc.so retry=N min=N0,N1,N2,N3,N4 4. Confirm N is less than or equal to 5. 5. Confirm N0 is set to disabled. 6. Confirm N1 is set to disabled. 7. Confirm N2 is set to disabled. 8. Confirm N3 is set to disabled. 9. Confirm N4 is set to 14 or greater. The above requires all passwords to be 14 or more characters long and comprised of at least one character from four distinct character sets. Additionally, a maximum of 5 consecutive failed login attempts are permitted.  40 | P a g e",
    "remediation": "To set the password complexity requirements, perform the following: 1. Login to the ESXi shell as a user with administrator privileges. 2. Open /etc./pam.d/passwd. 3. Locate the following line: password requisite /lib/security/$ISA/pam_passwdqc.so retry=N min=N0,N1,N2,N3,N4 4. Set N to less than or equal to 5. 5. Set N0 to disabled. 6. Set N1 to disabled. 7. Set N2 to disabled. 8. Set N3 to disabled. 9. Set N4 to 14 or greater. The above requires all passwords to be 14 or more characters long and comprised of at least one character from four distinct character sets. Additionally, a maximum of 5 consecutive failed login attempts are permitted. References: 1. http://pubs.vmware.com/vsphere- 60/topic/com.vmware.vsphere.hostclient.doc/GUID-2DA83B47-86E5-4BE3-920E- C2504400102E.html 2. http://www.openwall.com/passwdqc/README.shtml 3. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-DC96FFDB-F5F2-43EC- 8C73-05ACDAE6BE43.html",
    "function_names": [
      "esxi_password_complexity_enabled",
      "esxi_password_min_length_required",
      "esxi_password_character_sets_required",
      "esxi_password_consecutive_failed_attempts_limited",
      "esxi_password_policy_enforced",
      "esxi_password_uppercase_required",
      "esxi_password_numeric_required",
      "esxi_password_special_chars_required"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 60/topic/com.vmware.vsphere.hostclient.doc/GUID-2DA83B47-86E5-4BE3-920E- C2504400102E.html 2. http://www.openwall.com/passwdqc/README.shtml 3. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-DC96FFDB-F5F2-43EC- 8C73-05ACDAE6BE43.html"
  },
  {
    "id": "4.3",
    "title": "(L1) Ensure Active Directory is used for local user authentication",
    "assessment": "Scored",
    "description": "ESXi can be configured to use a directory service such as Active Directory to manage users and groups. It is recommended that a directory service be used. Note: If the AD group \"ESX Admins\" (default) is created, all users and groups that are members of this group will have full administrative access to all ESXi hosts in the domain.",
    "rationale": "Joining ESXi hosts to an Active Directory (AD) domain eliminates the need to create and maintain multiple local user accounts. Using AD for user authentication simplifies the ESXi host configuration, ensures password complexity and reuse policies are enforced, and reduces the risk of security breaches and unauthorized access.",
    "audit": "To confirm AD is used for local user authentication, perform the following from the vSphere Web Client: 1. Select the host and go to \"Manage\" -> \"Security & Users\" -> \"Authentication\". 2. Ensure the domain settings are in accordance with the user credentials for an AD user that has the rights to join computers to the domain. Alternately, execute the following PowerCLI command: # Check each host and their domain membership status Get-VMHost | Get-VMHostAuthentication | Select VmHost, Domain, DomainMembershipStatus",
    "remediation": "To use AD for local user authentication, perform the following from the vSphere Web Client: 1. Select the host and go to \"Manage\" -> \"Security & Users\" -> \"Authentication\". 2. Click the \"Join Domain\" button.  42 | P a g e 3. Provide the domain name along with the user credentials for an AD user that has the rights to join computers to the domain. 4. Click \"OK\". Alternately, run the following PowerCLI command: # Join the ESXI Host to the Domain Get-VMHost HOST1 | Get-VMHostAuthentication | Set-VMHostAuthentication - Domain domain.local -User Administrator -Password Passw0rd -JoinDomain Notes : 1. Host Profiles can be used to automate adding hosts to an AD domain. 2. Consider using the vSphere Authentication proxy to avoid transmitting AD credentials over the network. References: 1. https://docs.vmware.com/en/VMware- vSphere/6.0/com.vmware.vsphere.security.doc/GUID-63D22519-38CC-4A9F- AE85-97A53CB0948A.html",
    "function_names": [
      "esxi_local_auth_active_directory_enabled",
      "esxi_user_auth_directory_service_used",
      "esxi_auth_esx_admins_group_restricted",
      "esxi_auth_administrative_access_controlled",
      "esxi_local_user_auth_external_directory_required"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.0/com.vmware.vsphere.security.doc/GUID-63D22519-38CC-4A9F- AE85-97A53CB0948A.html"
  },
  {
    "id": "4.4",
    "title": "(L1) Ensure only authorized users and groups belong to the esxAdminsGroup group",
    "assessment": "Not Scored",
    "description": "The AD group used by vSphere is defined by the esxAdminsGroup attribute. By default, this attribute is set to \"ESX Admins\". All members of the group are granted full administrative access to all ESXi hosts in the domain. Monitor AD for the creation of this group, and limit membership to highly trusted users and groups.",
    "rationale": "An unauthorized user or group having membership in the esxAdminsGroup group will have full administrative access to all ESXi hosts. Such users may compromise the confidentiality, availability, and integrity of the all ESXi hosts and the respective data and processes they influence.",
    "audit": "To verify only authorized users and groups belong to esxAdminsGroup, go to Active Directory and review the membership of the group name that is defined by the advanced host setting: Config.HostAgent.plugins.hostsvc.esxAdminsGroup.",
    "remediation": "To remove unauthorized users and groups belonging to esxAdminsGroup, perform the following steps after coordination between vSphere admins and Active Directory admins: 1. Verify the setting of the esxAdminsGroup attribute. 2. View the list of members for that Microsoft Active Directory group. 3. Remove all unauthorized users and groups from that group. If full admin access for the AD ESX admins group is not desired, you can disable this behavior using the advanced host setting: \"Config.HostAgent.plugins.hostsvc.esxAdminsGroupAutoAdd\". Default Value: \"ESX Admins\"  44 | P a g e References: 1. http://pubs.vmware.com/vsphere- 60/topic/com.vmware.wssdk.apiref.doc/vim.host.AuthenticationManager.html",
    "function_names": [
      "active_directory_group_membership_authorized",
      "active_directory_esx_admins_group_restricted",
      "active_directory_group_membership_audited",
      "active_directory_esx_admins_group_monitored",
      "active_directory_group_membership_trusted_only"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 60/topic/com.vmware.wssdk.apiref.doc/vim.host.AuthenticationManager.html"
  },
  {
    "id": "4.5",
    "title": "(L1) Ensure the Exception Users list is properly configured",
    "assessment": "Scored",
    "description": "Users who are added to the \"Exception Users\" list do not lose their permissions when the host enters lockdown mode. Usually you may want to add some service accounts, such as a backup agent, to the Exception Users list.",
    "rationale": "Users who do not require special permissions should not be exempted from lockdown mode because this increases the risk of unauthorized actions being performed, especially if a user account is compromised.",
    "audit": "To verify the membership of the \"Exception Users\" list, perform the following: 1. From the vSphere web client, select the host. 2. Click on \"Configure\" -> \"Settings\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Lockdown Mode\". 4. Verify that the list of \"Exception Users\" is correct.",
    "remediation": "To correct the membership of the \"Exception Users\" list, perform the following: 1. From the vSphere web client, select host. 2. Click on \"Configure\" -> \"Settings\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Lockdown Mode\". 4. Click \"Edit\", then click on \"Exception Users\". 5. Add or delete users as per your organization's requirements. References: 1. https://blogs.vmware.com/vsphere/2015/03/vsphere-6-0-lockdown-mode- exception-users.html",
    "function_names": [
      "iam_user_exception_list_properly_configured",
      "iam_user_lockdown_exception_valid",
      "iam_exception_user_list_configured",
      "iam_lockdown_exception_user_valid",
      "iam_user_lockdown_bypass_configured"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://blogs.vmware.com/vsphere/2015/03/vsphere-6-0-lockdown-mode- exception-users.html"
  },
  {
    "id": "4.6",
    "title": "(L1) Ensure the maximum failed login attempts is set to 3",
    "assessment": "Scored",
    "description": "Authentication should be configured so there is a maximum number of consecutive failed login attempts for each account, at which point the account at risk will be locked out.",
    "rationale": "Multiple account login failures for the same account could possibly be an attacker trying to brute force guess the password.",
    "audit": "To verify the maximum failed login attempts is set properly, perform the following steps: 1. From the vSphere Web Client, select the host. 2. Click \"Configure\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 3. Enter \"Security.AccountLockFailures\" in the filter. 4. Verify that the value for this parameter is 3. Alternately, the following PowerCLI command may be used: Get-VMHost | Get-AdvancedSetting -Name Security.AccountLockFailures",
    "remediation": "To set the maximum failed login attempts correctly, perform the following steps: 1. From the vSphere Web Client, select the host. 2. Click \"Configure\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 3. Enter \"Security.AccountLockFailures\" in the filter. 4. Click \"Edit\". 5. Set the value for this parameter to 3. Alternately, use the following PowerCLI command: Get-VMHost | Get-AdvancedSetting -Name Security.AccountLockFailures | Set- AdvancedSetting -Value 3   48 | P a g e References: 1. https://code.vmware.com/apis/196/vsphere#https://vdc- repo.vmware.com/vmwb-repository/dcr-public/6b586ed2-655c-49d9-9029- bc416323cb22/fa0b429a-a695-4c11-b7d2- 2cbc284049dc/doc/vim.option.OptionManager.html",
    "function_names": [
      "iam_user_max_failed_login_attempts",
      "iam_user_lockout_threshold",
      "iam_account_lockout_after_failed_attempts",
      "iam_user_failed_login_limit",
      "iam_account_max_failed_attempts",
      "iam_user_lockout_policy",
      "iam_account_failed_login_threshold",
      "iam_user_authentication_lockout",
      "iam_account_failed_attempts_limit",
      "iam_user_failed_login_lockout"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://code.vmware.com/apis/196/vsphere#https://vdc- repo.vmware.com/vmwb-repository/dcr-public/6b586ed2-655c-49d9-9029- bc416323cb22/fa0b429a-a695-4c11-b7d2- 2cbc284049dc/doc/vim.option.OptionManager.html"
  },
  {
    "id": "4.7",
    "title": "(L1) Ensure account lockout is set to 15 minutes",
    "assessment": "Scored",
    "description": "An account is automatically locked after the maximum number of failed consecutive login attempts is reached. The account should be automatically unlocked after 15 minutes, otherwise administrators will need to manually unlock accounts on request by authorized users.",
    "rationale": "This setting reduces the inconvenience for benign users and the overhead on administrators, while also severely slowing down any brute force password guessing attacks.",
    "audit": "To verify the account lockout is set to 15 minutes, perform the following: 1. From the vSphere Web Client, select the host. 2. Click \"Configure\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 3. Enter \"Security.AccountUnlockTime\" in the filter. 4. Verify that the value for this parameter is set to 900. Alternately, the following PowerCLI command may be used: Get-VMHost | Get-AdvancedSetting -Name Security.AccountUnlockTime",
    "remediation": "To set the account lockout to 15 minutes, perform the following: 1. From the vSphere Web Client, select the host. 2. Click \"Configure\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 3. Enter \"Security.AccountUnlockTime\" in the filter. 4. Click \"Edit\". 5. Set the value for this parameter to 900. Alternately, use the following PowerCLI command:  50 | P a g e Get-VMHost | Get-AdvancedSetting -Name Security.AccountUnlockTime | Set- AdvancedSetting -Value 900 References: 1. https://code.vmware.com/apis/196/vsphere#https://vdc- repo.vmware.com/vmwb-repository/dcr-public/6b586ed2-655c-49d9-9029- bc416323cb22/fa0b429a-a695-4c11-b7d2- 2cbc284049dc/doc/vim.option.OptionManager.html",
    "function_names": [
      "iam_account_lockout_duration_15m",
      "iam_user_lockout_duration_15m",
      "iam_password_policy_lockout_15m",
      "iam_failed_attempts_lockout_15m",
      "iam_automatic_unlock_15m",
      "iam_consecutive_failed_attempts_lockout_15m"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://code.vmware.com/apis/196/vsphere#https://vdc- repo.vmware.com/vmwb-repository/dcr-public/6b586ed2-655c-49d9-9029- bc416323cb22/fa0b429a-a695-4c11-b7d2- 2cbc284049dc/doc/vim.option.OptionManager.html"
  },
  {
    "id": "5.1",
    "title": "(L1) Ensure the DCUI timeout is set to 600 seconds or less",
    "assessment": "Scored",
    "description": "The Direct Console User Interface (DCUI) is used for directly logging into an ESXi host and carrying out host management tasks. This setting terminates an idle DCUI session after the specified number of seconds has elapsed.",
    "rationale": "Terminating idle DCUI sessions helps avoid unauthorized usage of the DCUI originating from leftover login sessions.",
    "audit": "To verify the DCUI timeout setting, perform the following steps: 1. From the vSphere Web Client, select the host. 2. Click \"Configure\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 3. Enter \"UserVars.DcuiTimeOut\" in the filter. 4. Verify that the value for this parameter is 600 seconds or less. Alternately, the following PowerCLI command may be used: Get-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut",
    "remediation": "To correct the DCUI timeout setting, perform the following steps: 1. From the vSphere Web Client, select the host. 2. Click \"Configure\" -> \"Settings\" -> \"System\" -> \"Advanced System Settings\". 3. Enter \"UserVars.DcuiTimeOut\" in the filter. 4. Click \"Edit\". 5. Set the value for this parameter to 600 seconds or less. Alternately, use the following PowerCLI command:  52 | P a g e Get-VMHost | Get-AdvancedSetting -Name UserVars.DcuiTimeOut | Set- AdvancedSetting -Value 600 References: 1. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.wssdk.apiref.doc/vim.option.OptionManager.html",
    "function_names": [
      "esxi_dcui_timeout_600s_or_less",
      "esxi_dcui_session_timeout_compliant",
      "esxi_direct_console_idle_timeout_limited",
      "esxi_dcui_inactivity_timeout_configured",
      "esxi_host_dcui_timeout_restricted"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere- 65/topic/com.vmware.wssdk.apiref.doc/vim.option.OptionManager.html"
  },
  {
    "id": "5.2",
    "title": "(L2) Ensure DCUI is disabled",
    "assessment": "Scored",
    "description": "The Direct Console User Interface (DCUI) allows for low-level host configuration such as configuring IP address, hostname, and root password as well as diagnostic capabilities such as enabling the ESXi shell, viewing log files, restarting agents, and resetting configurations. The DCUI can be disabled to prevent any local administration from the host. Once the DCUI is disabled, any administration of the ESXi host must be done through vCenter.",
    "rationale": "Actions performed from the DCUI are not tracked by vCenter Server. Even if Lockdown Mode is enabled, users who are members of the DCUI.Access list can perform administrative tasks in the DCUI, bypassing role-based access control and auditing controls provided through vCenter. Disabling DCUI prevents all local activity, and thus forces actions to be performed in vCenter Server, where they can be centrally audited and monitored.",
    "audit": "To verify DCUI is disabled, perform the following: 1. From the vSphere web client, select the host. 2. Select \"Configure\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"Direct Console UI\". 6. Verify the Startup Policy is set to \"Start and Stop Manually\". Alternately, the following PowerCLI command may be used: # List DCUI settings for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"DCUI\" }",
    "remediation": "To disable DCUI, perform the following: 1. From the vSphere web client, select the host.  54 | P a g e 2. Select \"Configure\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"Direct Console UI\". 6. Click \"Stop\". 7. Change the Startup Policy to \"Start and Stop Manually\". 8. Click \"OK\". Alternately, use the following PowerCLI command: # Set DCUI to start manually rather than automatically for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"DCUI\" } | Set- VMHostService -Policy Off Impact: Disabling the DCUI can create a potential \"lockout\" situation, should the host become isolated from vCenter Server. Recovering from a \"lockout\" scenario requires reinstalling ESXi. Consider leaving DCUI enabled, and instead enable lockdown mode and limit the users allowed to access the DCUI using the DCUI.Access list. References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116- A8353D19FF56.html",
    "function_names": [
      "compute_host_dcui_disabled",
      "compute_host_local_admin_disabled",
      "compute_host_direct_console_disabled",
      "compute_host_esxi_dcui_disabled",
      "compute_host_console_access_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Disabling the DCUI can create a potential \"lockout\" situation, should the host become isolated from vCenter Server. Recovering from a \"lockout\" scenario requires reinstalling ESXi. Consider leaving DCUI enabled, and instead enable lockdown mode and limit the users allowed to access the DCUI using the DCUI.Access list.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116- A8353D19FF56.html"
  },
  {
    "id": "5.3",
    "title": "(L1) Ensure the ESXi shell is disabled",
    "assessment": "Scored",
    "description": "The ESXi shell is an interactive command line environment available from the Direct Console User Interface (DCUI) or remotely via SSH. The ESXi shell should only be enabled on a host when running diagnostics or troubleshooting.",
    "rationale": "Activities performed from the ESXi shell bypass vCenter RBAC and audit controls, so the ESXi shell should only be enabled when needed to troubleshoot/resolve problems that cannot be fixed through the vSphere web client or vCLI/PowerCLI.",
    "audit": "To verify the ESXi shell is disabled, perform the following: 1. From the vSphere web client, select the host. 2. Select \"Configure\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"ESXi Shell\". 6. Verify the Startup Policy is set to \"Start and Stop Manually\". Alternately, the following PowerCLI command may be used: # Check if the ESXi shell is running and set to start Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM\" } | Select VMHost, Key, Label, Policy, Running, Required Note: A host warning is displayed in the web client whenever the ESXi shell is enabled on a host.",
    "remediation": "To disable the ESXi shell, perform the following: 1. From the vSphere web client, select the host. 2. Select \"Configure\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Services\".  56 | P a g e 4. Click \"Edit...\". 5. Select \"ESXi Shell\". 6. Click \"Stop\". 7. Change the Startup Policy to \"Start and Stop Manually\". 8. Click \"OK\". Alternately, use the following PowerCLI command: # Set the ESXi shell to start manually rather than automatically for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM\" } | Set- VMHostService -Policy Off References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-B5144CE9-F8BB-494D- 8F5D-0D5621D65DAE.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-DFA67697-232E-4F7D- 860F-96C0819570A8.html",
    "function_names": [
      "esxi_host_shell_disabled",
      "esxi_host_shell_remote_access_disabled",
      "esxi_host_shell_dcui_access_disabled",
      "esxi_host_shell_diagnostics_mode_only",
      "esxi_host_shell_ssh_disabled",
      "esxi_host_shell_interactive_disabled",
      "esxi_host_shell_troubleshooting_only",
      "esxi_host_shell_non_persistent_disabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-B5144CE9-F8BB-494D- 8F5D-0D5621D65DAE.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-DFA67697-232E-4F7D- 860F-96C0819570A8.html"
  },
  {
    "id": "5.4",
    "title": "(L1) Ensure SSH is disabled",
    "assessment": "Scored",
    "description": "The ESXi shell, when enabled, can be accessed directly from the host console through the DCUI or remotely using SSH. Disable Secure Shell (SSH) for each ESXi host to prevent remote access to the ESXi shell, and only enable SSH when needed for troubleshooting or diagnostics.",
    "rationale": "Remote access to the host should be limited to the vSphere Client, remote command-line tools (vCLI/PowerCLI), and through the published APIs. Under normal circumstances, remote access to the host using SSH should be disabled.",
    "audit": "To verify SSH is disabled, perform the following: 1. From the vSphere web client, select the host. 2. Select \"Configure\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Services\". 4. Click \"Edit...\". 5. Select \"SSH\". 6. Verify the Startup Policy is set to \"Start and Stop Manually\". Alternately, the following PowerCLI command may be used: # Check if SSH is running and set to start Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM-SSH\" } | Select VMHost, Key, Label, Policy, Running, Required Note: A host warning is displayed in the web client whenever SSH is enabled on a host.",
    "remediation": "To disable SSH, perform the following: 1. From the vSphere web client, select the host. 2. Select \"Configure\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Services\".  58 | P a g e 4. Click \"Edit...\". 5. Select \"SSH\". 6. Click \"Stop\". 7. Change the Startup Policy to \"to Start and Stop Manually\". 8. Click \"OK\". Alternately, use the following PowerCLI command: # Set SSH to start manually rather than automatically for all hosts Get-VMHost | Get-VMHostService | Where { $_.key -eq \"TSM-SSH\" } | Set- VMHostService -Policy Off References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-12E27BF3-3769-4665-8769- DA76C2BC9FFE.html",
    "function_names": [
      "esxi_host_ssh_disabled",
      "esxi_host_remote_access_restricted",
      "esxi_shell_ssh_protocol_disabled",
      "esxi_host_direct_console_access_only",
      "esxi_ssh_troubleshooting_mode_only"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-12E27BF3-3769-4665-8769- DA76C2BC9FFE.html"
  },
  {
    "id": "5.5",
    "title": "(L1) Ensure CIM access is limited",
    "assessment": "Not Scored",
    "description": "The Common Information Model (CIM) system provides an interface that enables hardware-level management from remote applications using a set of standard APIs. Provide only the minimum access necessary to applications. Do not provision CIM-based hardware monitoring tools and other third-party applications to run as root or as another administrator account. Instead, create a dedicated service account specific to each CIM application with the minimal access and privileges needed for that application.",
    "rationale": "If CIM-based hardware monitoring tools or other third-party applications are granted unneeded administrator level access, they could potentially be used to compromise the security of the host.",
    "audit": "To verify CIM access is limited, check for a limited-privileged service account with the following CIM roles applied: Host.Config.SystemManagement Host.CIM.CIMInteraction Alternately, the following PowerCLI command may be used: # List all user accounts on the Host -Host Local connection required- Get-VMHostAccount",
    "remediation": "To limit CIM access, perform the following: 1. Create a limited-privileged service account for CIM and other third-party applications. 2. This account should access the system via vCenter. 3. Give the account the \"CIM Interaction\" privilege only. This will enable the account to obtain a CIM ticket, which can then be used to perform both read and write CIM operations on the target host. If an account must connect to the host directly, this account must be granted the full \"Administrator\" role on the host. This is not recommended unless required by the monitoring software being used. Alternately, run the following PowerCLI command:  60 | P a g e # Create a new host user account -Host Local connection required- New-VMHostAccount -ID ServiceUser -Password <password> -UserAccount References: 1. http://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.cimsdk.smashpg.doc%2F03_CIM_SMASH_PG_U se_Cases.5.1.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-645EBD81-CF86-44D7- BE77-224EF963D145.html",
    "function_names": [
      "compute_cim_access_limited",
      "compute_cim_no_root_access",
      "compute_cim_minimal_privileges",
      "compute_cim_dedicated_service_account",
      "compute_cim_admin_restricted",
      "compute_cim_application_specific_access",
      "compute_cim_privilege_escalation_prevented",
      "compute_cim_standard_api_restricted"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.cimsdk.smashpg.doc%2F03_CIM_SMASH_PG_U se_Cases.5.1.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-645EBD81-CF86-44D7- BE77-224EF963D145.html"
  },
  {
    "id": "5.6",
    "title": "(L1) Ensure Lockdown mode is enabled",
    "assessment": "Scored",
    "description": "Enabling lockdown mode disables direct local access to an ESXi host, requiring the host be managed remotely from vCenter Server. There are some operations, such as backup and troubleshooting, that require direct access to the host. In these cases, lockdown mode can be disabled on a temporary basis for specific hosts as needed, and then re-enabled when the task is completed. Note: Lockdown mode does not apply to users who log in using authorized keys. Also, users in the DCUI.Access list for each host are allowed to override lockdown mode and log in to the DCUI. By default, the \"root\" user is the only user listed in the DCUI.Access list.",
    "rationale": "Lockdown mode limits ESXi host access to the vCenter server to ensure the roles and access controls implemented in vCenter are always enforced and users cannot bypass them by logging into a host directly. By forcing all interaction to occur through vCenter Server, the risk of someone inadvertently attaining elevated privileges or performing tasks that are not properly audited is greatly reduced.",
    "audit": "To verify lockdown mode is enabled, perform the following from the vSphere web client: 1. Select the host. 2. Select \"Configure\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Lockdown Mode\". 4. Click \"Edit...\". 5. Ensure the \"Enable Lockdown Mode\" checkbox is checked. Alternately, the following PowerCLI command may be used: # To check if Lockdown mode is enabled Get-VMHost | Select Name,@{N=\"Lockdown\";E={$_.Extensiondata.Config.adminDisabled}}   62 | P a g e",
    "remediation": "To enable lockdown mode, perform the following from the vSphere web client: 1. Select the host. 2. Select \"Configure\" -> \"System\" -> \"Security Profile\". 3. Scroll down to \"Lockdown Mode\". 4. Click \"Edit...\". 5. Select the \"Enable Lockdown Mode\" checkbox. 6. Click \"OK\". Alternately, run the following PowerCLI command: # Enable lockdown mode for each host Get-VMHost | Foreach { $_.EnterLockdownMode() } References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2- B838-225F5FF480FF.html 2. http://kb.vmware.com/kb/1008077  63 | P a g e",
    "function_names": [
      "compute_host_lockdown_enabled",
      "compute_host_direct_access_disabled",
      "compute_host_remote_management_required",
      "compute_host_dcui_access_restricted",
      "compute_host_lockdown_temporary_override_disabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-88B24613-E8F9-40D2- B838-225F5FF480FF.html 2. http://kb.vmware.com/kb/1008077  63 | P a g e"
  },
  {
    "id": "5.7",
    "title": "(L2) Ensure the SSH authorized_keys file is empty",
    "assessment": "Scored",
    "description": "ESXi hosts come with Secure Shell (SSH), which can be configured to authenticate remote users using public key authentication. For day-to-day operations, the ESXi host should be in lockdown mode with the SSH service disabled. Lockdown mode does not prevent root users from logging in using keys. The presence of a remote user's public key in the /etc/ssh/keys-root/authorized_keys file on an ESXi host identifies the user as trusted, meaning the user is granted access to the host without providing a password. Disabling authorized_keys access may limit your ability to run unattended remote scripts.",
    "rationale": "Keeping the authorized_keys file empty prevents users from circumventing the intended restrictions of lockdown mode.",
    "audit": "To verify the authorized_keys file does not contain any keys, perform the following: 1. Logon to the ESXi shell as root or another admin user. 2. Verify the /etc/ssh/keys-root/authorized_keys file is empty.",
    "remediation": "To remove all keys from the authorized_keys file, perform the following: 1. Logon to the ESXi shell as root or another admin user. 2. Edit the /etc/ssh/keys-root/authorized_keys file. 3. Remove all keys from the file and save the file. Default Value: The file is empty by default.   64 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-392ADDE9-FD3B-49A2- BF64-4ACBB60EB149.html 2. http://pubs.vmware.com/vsphere- 60/topic/com.vmware.vsphere.security.doc/GUID-ED477079-1E7E-4EBA-AAFE- 019FB335DABC.html  65 | P a g e",
    "function_names": [
      "esxi_ssh_authorized_keys_empty",
      "esxi_ssh_authorized_keys_no_entries",
      "esxi_ssh_root_authorized_keys_disabled",
      "esxi_ssh_lockdown_mode_enabled",
      "esxi_ssh_public_key_authentication_disabled",
      "esxi_ssh_authorized_keys_file_unused",
      "esxi_ssh_root_access_restricted",
      "esxi_ssh_passwordless_auth_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-392ADDE9-FD3B-49A2- BF64-4ACBB60EB149.html 2. http://pubs.vmware.com/vsphere- 60/topic/com.vmware.vsphere.security.doc/GUID-ED477079-1E7E-4EBA-AAFE- 019FB335DABC.html  65 | P a g e"
  },
  {
    "id": "5.8",
    "title": "(L1) Ensure idle ESXi shell and SSH sessions time out after 300 seconds or less",
    "assessment": "Scored",
    "description": "The ESXiShellInteractiveTimeOut allows you to automatically terminate idle ESXi shell and SSH sessions. The permitted idle time should be 300 seconds or less.",
    "rationale": "If a user forgets to log out of an ESXi shell or SSH session, the idle session will exist indefinitely, increasing the potential for someone to gain unauthorized privileged access to the host, unless a timeout is set.",
    "audit": "To verify the timeout is set correctly, perform the following from the vSphere web client: 1. Select the host. 2. Click \"Configure\" -> \"System\" -> \"Advanced System Settings\". 3. Type ESXiShellInteractiveTimeOut in the filter. 4. Verify that the attribute is set to 300 seconds or less. Note: A value of 0 disables the ESXiShellInteractiveTimeOut. Alternately, the following PowerCLI command may be used: # List UserVars.ESXiShellInteractiveTimeOut for each host Get-VMHost | Select Name, @{N=\"UserVars.ESXiShellInteractiveTimeOut\";E={$_ | Get-AdvancedSetting UserVars.ESXiShellInteractiveTimeOut | Select - ExpandProperty Values}}",
    "remediation": "To set the timeout to the desired value, perform the following from the vSphere web client: 1. Select the host. 2. Click \"Configure\" -> \"System\" -> \"Advanced System Settings\". 3. Type ESXiShellInteractiveTimeOut in the filter. 4. Click on the attribute to highlight it. 5. Click the pencil icon to edit. 6. Set the attribute to the desired value (300 seconds or less).  66 | P a g e 7. Click \"OK\". Note: A value of 0 disables the ESXi ShellInteractiveTimeOut. Alternately, use the following PowerCLI command: # Set Remove UserVars.ESXiShellInteractiveTimeOut to 300 on all hosts Get-VMHost | Get-AdvancedSetting -Name 'UserVars.ESXiShellInteractiveTimeOut' | Set-AdvancedSetting -Value \"300\" References: 1. http://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.powercli.cmdletref.doc%2FGet- VMHostPatch.html&resultof=%22%24ESXCli.software.vib.list()%22%20 2. http://kb.vmware.com/kb/2004746 3. https://docs.vmware.com/en/VMware- vSphere/index.html#com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3- 4E16-8027-0280B9ED1009.html",
    "function_names": [
      "esxi_shell_ssh_session_timeout_300s",
      "esxi_shell_idle_timeout_enabled",
      "esxi_ssh_session_timeout_enabled",
      "esxi_shell_ssh_timeout_compliance",
      "esxi_shell_interactive_timeout_300s",
      "esxi_ssh_interactive_timeout_300s",
      "esxi_shell_ssh_session_timeout_less_than_300s",
      "esxi_shell_ssh_timeout_enforced"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.powercli.cmdletref.doc%2FGet- VMHostPatch.html&resultof=%22%24ESXCli.software.vib.list()%22%20 2. http://kb.vmware.com/kb/2004746 3. https://docs.vmware.com/en/VMware- vSphere/index.html#com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3- 4E16-8027-0280B9ED1009.html"
  },
  {
    "id": "5.9",
    "title": "(L1) Ensure the shell services timeout is set to 1 hour or less",
    "assessment": "Scored",
    "description": "When the ESXi shell or SSH services are enabled on a host, they will run indefinitely. To avoid this, set the ESXiShellTimeOut, which defines a window of time after which the ESXi shell and SSH services will automatically be terminated. It is recommended to set the ESXiShellInteractiveTimeOut together with ESXiShellTimeOut.",
    "rationale": "This reduces the risk of an inactive ESXi shell or SSH service being misused by an unauthorized party to compromise a host.",
    "audit": "To verify the timeout is set to one hour or less, perform the following from the vSphere web client: 1. Select the host and click \"Configure\" -> \"System\" -> \"Advanced System Settings\". 2. Type ESXiShellTimeOut in the filter. 3. Ensure the attribute is set to 3600 seconds (1 hour) or less. Alternately, the following PowerCLI command may be used: # List UserVars.ESXiShellTimeOut in minutes for each host Get-VMHost | Select Name, @{N=\"UserVars.ESXiShellTimeOut\";E={$_ | Get- AdvancedSettings UserVars.ESXiShellTimeOut | Select -ExpandProperty Values}}",
    "remediation": "To set the timeout to the desired value, perform the following from the vSphere web client: 1. Select the host and click \"Configure\" -> \"System\" -> \"Advanced System Settings\". 2. Type ESXiShellTimeOut in the filter. 3. Click on the attribute to highlight it. 4. Click the pencil icon to edit. 5. Set the attribute to 3600 seconds (1 hour) or less. 6. Click \"OK\".  68 | P a g e Note: A value of 0 disables the ESXiShellTimeOut. Alternately, run the following PowerCLI command: # Set UserVars.ESXiShellTimeOut to 3600 on all hosts Get-VMHost | Get-AdvancedSetting -Name 'UserVars.ESXiShellTimeOut' | Set- AdvancedSetting -Value \"3600\" References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-6E1ECA4D-B617-4D42- B40B-71E4C83DEEFB.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-B314F79B-2BDD-4D68- 8096-F009B87ACB33.html 3. http://kb.vmware.com/kb/2004746 4. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3-4E16-8027- 0280B9ED1009.html",
    "function_names": [
      "esxi_shell_timeout_set",
      "esxi_shell_interactive_timeout_set",
      "esxi_shell_timeout_max_1h",
      "esxi_shell_interactive_timeout_max_1h",
      "esxi_shell_services_timeout_configured",
      "esxi_shell_services_auto_termination_enabled",
      "esxi_shell_timeout_consistent",
      "esxi_shell_services_timeout_enforced"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-6E1ECA4D-B617-4D42- B40B-71E4C83DEEFB.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-B314F79B-2BDD-4D68- 8096-F009B87ACB33.html 3. http://kb.vmware.com/kb/2004746 4. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-94F0C54F-05E3-4E16-8027- 0280B9ED1009.html"
  },
  {
    "id": "5.10",
    "title": "(L1) Ensure DCUI has a trusted users list for lockdown mode",
    "assessment": "Not Scored",
    "description": "Lockdown mode disables direct host access, requiring admins to manage hosts from vCenter. Set DCUI.Access to a list of highly trusted users who would be able to override lockdown mode and access the DCUI in the event an ESXi host became isolated from vCenter. NOTE: If you disable lockdown mode using the DCUI, all users with the DCUI.Access privilege will be granted the Administrator role on the host.",
    "rationale": "The list prevents all admins from becoming locked out and no longer being able to manage the host.",
    "audit": "To verify a proper trusted users list is set for DCUI, perform the following from the vSphere web client: 1. Select the host. 2. Select \"Configure\" -> \"System\" -> \"Advanced System Settings\". 3. Type DCUI.Access in the filter. 4. Ensure the DCUI.Access attribute is set to a comma-separated list of the users who are allowed to override lockdown mode. Alternately, the following PowerCLI command may be used: Get-VMHost | Get-AdvancedSetting -Name DCUI.Access",
    "remediation": "To set a trusted users list for DCUI, perform the following from the vSphere web client: 1. Select the host. 2. Select \"Configure\" -> \"System\" -> \"Advanced System Settings\". 3. Type DCUI.Access in the filter.  70 | P a g e 4. Click on the attribute to highlight it. 5. Click edit. 6. Set the DCUI.Access attribute to a comma-separated list of the users who are allowed to override lockdown mode. 7. Click \"OK\". References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116- A8353D19FF56.html",
    "function_names": [
      "esxi_dcui_trusted_users_list_configured",
      "esxi_dcui_lockdown_mode_trusted_users",
      "esxi_host_dcui_access_restricted",
      "esxi_dcui_admin_override_list_defined",
      "esxi_lockdown_mode_trusted_users_set"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-6779F098-48FE-4E22-B116- A8353D19FF56.html"
  },
  {
    "id": "5.11",
    "title": "(L2) Ensure contents of exposed configuration files have not been modified",
    "assessment": "Not Scored",
    "description": "Although most configurations on ESXi are controlled via an API, there are a limited set of configuration files that are used directly to govern host behavior. These files are exposed via the vSphere HTTPS-based file transfer API. These files should be monitored for modifications. WARNING: Do not attempt to monitor files that are NOT exposed via this file transfer API, since this can result in a destabilized system.",
    "rationale": "Any changes to these files should be correlated with an approved administrative action, such as an authorized configuration change. Tampering with these files could enable unauthorized access to the host configuration and virtual machines.",
    "audit": "To verify the exposed configuration files have not been modified, perform the following: 1. Open a web browser. 2. Find the ESXi configuration files by browsing to https:///host (not available if MOB is disabled). 3. Review the contents of those files to confirm no unauthorized modifications have been made. NOTE: Not all the files listed are modifiable. Alternately, the configuration files can also be retrieved using the vCLI or PowerCLI.",
    "remediation": "Restore all modified configuration files to a known good state by restoring backups or using other means. To help prevent future occurrences, you can back up the host configuration data after configuring or reconfiguring an ESXi host. The vicfg-cfgbackup command is available only for ESXi hosts; it is not available through a vCenter Server system connection. No  72 | P a g e equivalent ESXCLI command is supported. To help identify future occurrences more quickly, implement a procedure to monitor the files and their contents over time to ensure they are not improperly modified. Be sure not to monitor log files and other files whose content is expected to change regularly due to system activity. Also, account for configuration file changes that are due to authorized administrative activity. Note: Host Profiles may also be used to track configuration changes on the host; however, Host Profiles do not track all configuration changes. References: 1. https://pubs.vmware.com/vsphere-6-5/index.jsp",
    "function_names": [
      "esxi_config_file_modification_monitored",
      "esxi_exposed_config_file_integrity_verified",
      "esxi_host_config_file_unmodified",
      "esxi_vsphere_config_file_change_detected",
      "esxi_exposed_config_file_monitoring_enabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://pubs.vmware.com/vsphere-6-5/index.jsp"
  },
  {
    "id": "6.1",
    "title": "(L1) Ensure bidirectional CHAP authentication for iSCSI traffic is enabled",
    "assessment": "Scored",
    "description": "vSphere allows for the use of bidirectional authentication of both the iSCSI target and host. Bidirectional Challenge-Handshake Authentication Protocol (CHAP), also known as Mutual CHAP, should be enabled to provide bidirectional authentication.",
    "rationale": "By not authenticating both the iSCSI target and host, there is a potential for a man-in-the- middle attack in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication can mitigate this risk. Note: Choosing not to enforce bidirectional authentication can make sense if you create a dedicated network or VLAN to service all your iSCSI devices. If the iSCSI facility is isolated from general network traffic, it is less vulnerable to exploitation.",
    "audit": "To verify that bidirectional CHAP authentication is enabled for iSCSI traffic, perform the following: 1. From the vSphere Web Client, navigate to \"Hosts and Clusters\". 2. Click on a host. 3. Click on \"Configure\" -> \"Storage\" -> \"Storage Adapters\". 4. Select the iSCSI adapter. 5. Under Adapter Details, click the Properties tab. 6. Verify that the authentication method is \"Use bidirectional CHAP\". Alternately, the following PowerCLI command may be used:  74 | P a g e # List Iscsi Initiator and CHAP Name if defined Get-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Select VMHost, Device, ChapType, @{N=\"CHAPName\";E={$_.AuthenticationProperties.ChapName}}",
    "remediation": "To enable bidirectional CHAP authentication for iSCSI traffic, perform the following: 1. From the vSphere Web Client, navigate to \"Hosts and Clusters\". 2. Click on a host. 3. Click on \"Configure\" -> \"Storage\" -> \"Storage Adapters\". 4. Select the iSCSI adapter to configure OR click the green plus symbol to create a new adapter. 5. Under Adapter Details, click the Properties tab and click \"Edit\" in the Authentication panel. 6. Specify authentication method: \"Use bidirectional CHAP\". 7. Specify the outgoing CHAP name. \u2022 Make sure that the name you specify matches the name configured on the storage side. o To set the CHAP name to the iSCSI adapter name, select \"Use initiator name\". o To set the CHAP name to anything other than the iSCSI initiator name, deselect \"Use initiator name\" and type a name in the Name text box. 8. Enter an outgoing CHAP secret to be used as part of authentication. Use the same secret as your storage side secret. 9. Specify incoming CHAP credentials. Make sure your outgoing and incoming secrets do not match. 10. Click OK. 11. Click the second to last symbol to rescan the iSCSI adapter. Alternately, run the following PowerCLI command: # Set the Chap settings for the Iscsi Adapter Get-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Set-VMHostHba # Use desired parameters here References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD- 49B433E2F266.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18-A083- 8E65FE380899.html  75 | P a g e",
    "function_names": [
      "iscsi_target_bidirectional_chap_enabled",
      "iscsi_host_bidirectional_chap_enabled",
      "iscsi_traffic_mutual_chap_enabled",
      "iscsi_connection_bidirectional_auth_enabled",
      "iscsi_storage_chap_auth_required"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD- 49B433E2F266.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18-A083- 8E65FE380899.html  75 | P a g e"
  },
  {
    "id": "6.2",
    "title": "(L1) Ensure the uniqueness of CHAP authentication secrets for iSCSI traffic",
    "assessment": "Not Scored",
    "description": "Challenge-Handshake Authentication Protocol (CHAP) requires both client and host to know the secret (password) to establish a connection. Each mutual authentication secret should be unique.",
    "rationale": "If all mutual authentication secrets are unique, compromise of one secret does not allow an attacker to authenticate to other hosts or clients using that same secret.",
    "audit": "To verify the CHAP secrets are unique, run the following to list all iSCSI adapters and their corresponding CHAP configuration: # List Iscsi Initiator and CHAP Name if defined Get-VMHost | Get-VMHostHba | Where {$_.Type -eq \"Iscsi\"} | Select VMHost, Device, ChapType, @{N=\"CHAPName\";E={$_.AuthenticationProperties.ChapName}}",
    "remediation": "To change the values of CHAP secrets so they are unique, perform the following: 1. From the vSphere Web Client, navigate to \"Hosts\". 2. Click on a host. 3. Click on \"Configure\" -> \"Storage\" -> \"Storage Adapters\". 4. Select the iSCSI adapter to configure OR click the green plus symbol to create a new adapter. 5. Under Adapter Details, click the Properties tab and click \"Edit\" in the Authentication panel. 6. Specify the authentication method. o None o Use unidirectional CHAP if required by target o Use unidirectional CHAP unless prohibited by target o Use unidirectional CHAP o Use bidirectional CHAP 7. Specify the outgoing CHAP name.  76 | P a g e \u2022 Make sure that the name you specify matches the name configured on the storage side. o To set the CHAP name to the iSCSI adapter name, select \"Use initiator name\". o To set the CHAP name to anything other than the iSCSI initiator name, deselect \"Use initiator name\" and type a name in the Name text box. 8. Enter an outgoing CHAP secret to be used as part of authentication. Use the same secret as your storage side secret. 9. If configuring with bidirectional CHAP, specify incoming CHAP credentials. \u2022 Make sure your outgoing and incoming secrets do not match. 10. Click OK. 11. Click the second to last symbol to rescan the iSCSI adapter. References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD- 49B433E2F266.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18-A083- 8E65FE380899.html  77 | P a g e",
    "function_names": [
      "iscsi_volume_chap_secret_unique",
      "iscsi_target_chap_auth_unique",
      "iscsi_connection_chap_credentials_unique",
      "iscsi_initiator_chap_secret_unique",
      "iscsi_session_chap_auth_unique",
      "iscsi_storage_chap_secret_unique",
      "iscsi_auth_chap_secret_unique",
      "iscsi_traffic_chap_secret_unique"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-AC65D747-728F-4109-96DD- 49B433E2F266.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-2F1E64DB-20BB-4D18-A083- 8E65FE380899.html  77 | P a g e"
  },
  {
    "id": "6.3",
    "title": "(L1) Ensure storage area network (SAN) resources are segregated properly",
    "assessment": "Not Scored",
    "description": "Use zoning and logical unit number (LUN) masking to segregate storage area network (SAN) activity. Zoning provides access control in the SAN topology. Zoning defines which host bus adapters (HBAs) can connect to which targets. The devices outside a zone are not visible to the devices inside the zone when SAN zoning is configured. For example, zones defined for testing should be managed independently within the SAN so they do not interfere with activity in the production zones. Similarly, you can set up different zones for different departments. Zoning must take into account any host groups that have been set up on the SAN device. LUN masking is a process that makes a LUN available to some hosts and unavailable to other hosts.",
    "rationale": "Segregating SAN activity can reduce the attack surface for the SAN, prevent non-ESXi systems from accessing SANs, and separate environments, for example, test and production environments.",
    "audit": "The audit procedures to verify SAN activity is properly segregated are SAN vendor or product-specific.",
    "remediation": "The remediation procedures to properly segregate SAN activity are SAN vendor or product- specific. In general, with ESXi hosts, use a single-initiator zoning or a single-initiator-single-target zoning. The latter is a preferred zoning practice. Using the more restrictive zoning prevents problems and misconfigurations that can occur on the SAN.   78 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-6029358F-8EE8-4143-9BB0- 16ABB3CA0FE3.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-BFE9046A-2278-4026-809A- ED8F9D8FDACE.html 3. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-39A4551F-4B03-43A6-BEDF- FAB1528C070D.html  79 | P a g e",
    "function_names": [
      "san_zoning_access_control_enabled",
      "san_lun_masking_restricted",
      "san_host_bus_adapter_zoning_configured",
      "san_production_test_zoning_segregated",
      "san_department_zoning_isolated",
      "san_host_group_zoning_aligned",
      "san_lun_host_access_restricted",
      "san_zoning_topology_defined",
      "san_target_hba_connection_restricted",
      "san_zoning_independent_management_enabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-6029358F-8EE8-4143-9BB0- 16ABB3CA0FE3.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-BFE9046A-2278-4026-809A- ED8F9D8FDACE.html 3. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-39A4551F-4B03-43A6-BEDF- FAB1528C070D.html  79 | P a g e"
  },
  {
    "id": "6.4",
    "title": "(L2) Ensure VMDK files are zeroed out prior to deletion",
    "assessment": "Not Scored",
    "description": "The CLI command 'vmkfstools --writezeroes' can be used to write zeros to the entire contents of a virtual machine disk (VMDK) file prior to its deletion.",
    "rationale": "Zeroing out a VMDK file before deleting the file can help prevent users from reconstructing the original contents of the file from the physical storage media.",
    "audit": "Not applicable",
    "remediation": "When deleting a VMDK file with sensitive data: 1. Shut down or stop the virtual machine. 2. Issue the CLI command 'vmkfstools --writezeroes' on that file prior to deleting it from the datastore. Impact: When you use this command, you lose any existing data on the virtual disk. References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-050C0FEE-2C75-4356-B9E0- CC802333FF41.html  80 | P a g e 7 vNetwork This section contains recommendations related to configuring vNetwork.",
    "function_names": [
      "compute_vmdk_zeroed_before_deletion",
      "compute_vmdk_writezeroes_enabled",
      "compute_vmdk_secure_deletion_enabled",
      "compute_vmdk_pre_deletion_sanitization",
      "compute_vmdk_zero_fill_required"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "When you use this command, you lose any existing data on the virtual disk.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.storage.doc/GUID-050C0FEE-2C75-4356-B9E0- CC802333FF41.html  80 | P a g e 7 vNetwork This section contains recommendations related to configuring vNetwork."
  },
  {
    "id": "7.1",
    "title": "(L1) Ensure the vSwitch Forged Transmits policy is set to reject",
    "assessment": "Scored",
    "description": "Set the vSwitch Forged Transmits policy to reject for each vSwitch. Reject Forged Transmit can be set at the vSwitch and/or the Portgroup level. You can override switch-level settings at the Portgroup level.",
    "rationale": "If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. Setting forged transmissions to accept means the virtual switch does not compare the source and effective MAC addresses. To protect against MAC address impersonation, all virtual switches should have forged transmissions set to reject.",
    "audit": "To verify the policy is set to reject forged transmissions, perform the following: 1. In the vSphere Web Client, navigate to the host. 2. Go to \"Hosts and Clusters\" -> \"vCenter\" -> host. 3. On the Configure tab, click Networking, and select Virtual switches. 4. Select a standard switch from the list and click the pencil icon to edit settings. 5. Select Security. 6. Verify Forged transmits is set to \"Reject\". Alternately, the following PowerCLI command may be used: # List all vSwitches and their Security Settings Get-VirtualSwitch -Standard | Select VMHost, Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Spec.Policy.Security.MacChanges) { \"Accept\" } Else { \"Reject\"} }}, `  81 | P a g e @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Spec.Policy.Security.PromiscuousMode) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Spec.Policy.Security.ForgedTransmits) { \"Accept\" } Else { \"Reject\"} }}",
    "remediation": "To set the policy to reject forged transmissions, perform the following: 1. In the vSphere Web Client, navigate to the host. 2. Go to \"Hosts and Clusters\" -> \"vCenter\" -> host. 3. On the Configure tab, click Networking, and select Virtual switches. 4. Select a standard switch from the list and click the pencil icon to edit settings. 5. Select Security. 6. Set Forged transmits to \"Reject\". 7. Click \"OK\". Alternately, the following ESXi shell command may be used: # esxcli network vswitch standard policy security set -v vSwitch2 -f false References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html",
    "function_names": [
      "compute_vswitch_forged_transmits_reject",
      "compute_vswitch_forged_transmits_reject_all",
      "compute_portgroup_forged_transmits_reject",
      "compute_portgroup_forged_transmits_reject_override"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html"
  },
  {
    "id": "7.2",
    "title": "(L1) Ensure the vSwitch MAC Address Change policy is set to reject",
    "assessment": "Scored",
    "description": "Ensure the MAC Address Change policy within the vSwitch is set to reject. Reject MAC Changes can be set at the vSwitch and/or the Portgroup level. You can override switch- level settings at the Portgroup level.",
    "rationale": "If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network.",
    "audit": "To verify the policy is set to reject, perform the following: 1. In the vSphere Web Client, navigate to the host. 2. Go to \"Hosts and Clusters\" -> \"vCenter\" -> host. 3. On the Configure tab, click Networking, and select Virtual switches. 4. Select a standard switch from the list and click the pencil icon to edit settings. 5. Select Security. 6. Verify MAC Address Changes is set to \"Reject\". 7. Click \"OK\". Alternately, the following PowerCLI command may be used: # List all vSwitches and their Security Settings Get-VirtualSwitch -Standard | Select VMHost, Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Spec.Policy.Security.MacChanges) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Spec.Policy.Security.PromiscuousMode) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Spec.Policy.Security.ForgedTransmits) { \"Accept\" } Else { \"Reject\"} }}   83 | P a g e",
    "remediation": "To set the policy to reject, perform the following: 1. In the vSphere Web Client, navigate to the host. 2. Go to \"Hosts and Clusters\" -> \"vCenter\" -> host. 3. On the Configure tab, click Networking, and select Virtual switches. 4. Select a standard switch from the list and click the pencil icon to edit settings. 5. Select Security. 6. Set MAC Address Changes to \"Reject\". 7. Click \"OK\". Alternately, perform the following using the ESXi shell: # esxcli network vswitch standard policy security set -v vSwitch2 -m false References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html",
    "function_names": [
      "compute_vswitch_mac_change_reject",
      "compute_vswitch_mac_change_reject_all_ports",
      "compute_portgroup_mac_change_reject",
      "compute_portgroup_mac_change_reject_override"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html"
  },
  {
    "id": "7.3",
    "title": "(L1) Ensure the vSwitch Promiscuous Mode policy is set to reject",
    "assessment": "Scored",
    "description": "Ensure the Promiscuous Mode Policy within the vSwitch is set to reject. Promiscuous mode can be set at the vSwitch and/or the Portgroup level. You can override switch-level settings at the Portgroup level.",
    "rationale": "When promiscuous mode is enabled for a virtual switch, all virtual machines connected to the dvPortgroup have the potential of reading all packets crossing that network. This could enable unauthorized access to the contents of those packets.",
    "audit": "To verify the policy is set to reject, perform the following: 1. In the vSphere Web Client, navigate to the host. 2. Go to \"Hosts and Clusters\" -> \"vCenter\" -> host. 3. On the Configure tab, click Networking, and select Virtual switches. 4. Select a standard switch from the list and click the pencil icon to edit settings. 5. Select Security. 6. Verify Promiscuous Mode is set to \"Reject\". 7. Click \"OK\". Alternately, the following PowerCLI command may be used: # List all vSwitches and their Security Settings Get-VirtualSwitch -Standard | Select VMHost, Name, ` @{N=\"MacChanges\";E={if ($_.ExtensionData.Spec.Policy.Security.MacChanges) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"PromiscuousMode\";E={if ($_.ExtensionData.Spec.Policy.Security.PromiscuousMode) { \"Accept\" } Else { \"Reject\"} }}, ` @{N=\"ForgedTransmits\";E={if ($_.ExtensionData.Spec.Policy.Security.ForgedTransmits) { \"Accept\" } Else { \"Reject\"} }}   85 | P a g e",
    "remediation": "To set the policy to reject, perform the following: 1. In the vSphere Web Client, navigate to the host. 2. Go to \"Hosts and Clusters\" -> \"vCenter\" -> host. 3. On the Configure tab, click Networking, and select Virtual switches. 4. Select a standard switch from the list and click the pencil icon to edit settings. 5. Select Security. 6. Set Promiscuous Mode to \"Reject\". 7. Click \"OK\". Alternately, perform the following via the ESXi shell: # esxcli network vswitch standard policy security set -v vSwitch2 -p false Default Value: reject References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html",
    "function_names": [
      "compute_vswitch_promiscuous_mode_reject",
      "compute_portgroup_promiscuous_mode_reject",
      "compute_vswitch_promiscuous_mode_reject_all_regions",
      "compute_portgroup_promiscuous_mode_reject_all_regions"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.networking.doc/GUID-891147DD-3E2E-45A1- 9B50-7717C3443DD7.html"
  },
  {
    "id": "7.4",
    "title": "(L1) Ensure port groups are not configured to the value of the native VLAN",
    "assessment": "Scored",
    "description": "ESXi does not use the concept of native VLAN, so do not configure port groups to use the native VLAN ID. If the default value of 1 for the native VLAN is being used, the ESXi Server virtual switch port groups should be configured with any value between 2 and 4094. Otherwise, ensure that the port group is not configured to use whatever value is set for the native VLAN.",
    "rationale": "Frames with VLAN specified in the port group will have a tag, but frames without a VLAN specified in the port group are not tagged and therefore will end up as belonging to the native VLAN of the physical switch. For example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a \u201c1\u201d; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a \u201c1\u201d instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged). If the ESXi virtual switch port group uses the native VLAN ID, traffic from those VMs will not be visible to the native VLAN on the switch, because the switch is expecting untagged traffic.",
    "audit": "To verify the native VLAN ID is not being used for port groups, perform the following: 1. From the vSphere web client, select the host. 2. On the Configure tab, click Networking, and select Virtual switches. 3. Select a standard switch from the list. 4. View the topology diagram of the switch, which shows the various port groups associated with that switch. 5. For each port group on the vSwitch, verify and record the VLAN IDs used. Alternately, the following PowerCLI command may be used: # List all vSwitches, their Portgroups and VLAN IDs Get-VirtualPortGroup -Standard | Select virtualSwitch, Name, VlanID  87 | P a g e",
    "remediation": "To stop using the native VLAN ID for port groups, perform the following: 1. From the vSphere web client, select the host. 2. On the Configure tab, click Networking, and select Virtual switches. 3. Select a standard switch from the list. 4. View the topology diagram of the switch, which shows the various port groups associated with that switch. 5. For each port group on the vSwitch, verify and record the VLAN IDs used. 6. If a VLAN ID change is needed, click the name of the port group in the topology diagram of the virtual switch. 7. Click the \"Edit settings\" pencil icon under the topology diagram title. 8. In the Properties section, name the port group in the Network Label text field. 9. Choose an existing VLAN ID drop-down menu or type in a new one. References: 1. http://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.vcli.migration.doc%2Fcos_upgrade_technote.1. 9.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.networking.doc/GUID-3A9D9911-3632-4B81- 9D2E-A2F9F2D01180.html",
    "function_names": [
      "compute_port_group_native_vlan_disabled",
      "compute_port_group_non_default_vlan_id",
      "compute_port_group_vlan_id_outside_native_range",
      "compute_port_group_vlan_id_valid_range",
      "compute_port_group_vlan_id_not_native",
      "compute_port_group_vlan_id_min_2",
      "compute_port_group_vlan_id_max_4094"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.vcli.migration.doc%2Fcos_upgrade_technote.1. 9.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.networking.doc/GUID-3A9D9911-3632-4B81- 9D2E-A2F9F2D01180.html"
  },
  {
    "id": "7.5",
    "title": "(L1) Ensure port groups are not configured to VLAN values reserved by upstream physical switches",
    "assessment": "Not Scored",
    "description": "Ensure that port groups are not configured to VLAN values reserved by upstream physical switches. Certain physical switches reserve certain VLAN IDs for internal purposes and often disallow traffic configured to these values. For example, Cisco Catalyst switches typically reserve VLANs 1001 through 1024 and 4094, while Nexus switches typically reserve 3968 through 4047 and 4094. Check the documentation for your specific switch.",
    "rationale": "Using a reserved VLAN might result in a denial of service on the network.",
    "audit": "To verify port groups are not using reserved VLAN values, perform the following: 1. From the vSphere web client, select the host. 2. On the Configure tab, click Networking, and select Virtual switches. 3. Select a standard switch from the list. 4. View the topology diagram of the switch, which shows the various port groups associated with that switch. 5. For each port group on the vSwitch, verify and record the VLAN IDs used. Alternately, the following PowerCLI command may be used: # List all vSwitches, their Portgroups and VLAN IDs Get-VirtualPortGroup -Standard | Select virtualSwitch, Name, VlanID",
    "remediation": "To change the VLAN values for port groups to non-reserved values, perform the following: 1. From the vSphere web client, select the host. 2. On the Configure tab, click Networking, and select Virtual switches. 3. Select a standard switch from the list. 4. View the topology diagram of the switch, which shows the various port groups associated with that switch. 5. For each port group on the vSwitch, verify and record the VLAN IDs used.  89 | P a g e 6. If a VLAN ID change is needed, click the name of the port group in the topology diagram of the virtual switch. 7. Click the \"Edit settings\" pencil icon under the topology diagram title. 8. In the Properties section, name the port group in the Network Label text field. 9. Choose an existing VLAN ID drop-down menu or type in a new one. References: 1. http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12- 2/20ew/configuration/guide/config/vlans.html#wp1038758 2. http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5500/sw/laye r2/7x/b_5500_Layer2_Config_7x/b_5500_Layer2_Config_7x_chapter_010.html#con_ 1143823",
    "function_names": [
      "compute_port_group_reserved_vlan_avoided",
      "compute_port_group_vlan_reserved_range_avoided",
      "compute_port_group_vlan_upstream_conflict_avoided",
      "compute_port_group_vlan_physical_switch_reserved_avoided",
      "compute_port_group_vlan_cisco_reserved_avoided",
      "compute_port_group_vlan_nexus_reserved_avoided",
      "compute_port_group_vlan_catalyst_reserved_avoided",
      "compute_port_group_vlan_internal_range_avoided",
      "compute_port_group_vlan_disallowed_range_avoided",
      "compute_port_group_vlan_switch_conflict_avoided"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12- 2/20ew/configuration/guide/config/vlans.html#wp1038758 2. http://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5500/sw/laye r2/7x/b_5500_Layer2_Config_7x/b_5500_Layer2_Config_7x_chapter_010.html#con_ 1143823"
  },
  {
    "id": "7.6",
    "title": "(L1) Ensure port groups are not configured to VLAN 4095 except for Virtual Guest Tagging (VGT)",
    "assessment": "Scored",
    "description": "Port groups should not be configured to VLAN 4095 except for Virtual Guest Tagging (VGT). When a port group is set to VLAN 4095, this activates VGT mode. In this mode, the vSwitch passes all network frames to the guest virtual machine without modifying the VLAN tags, leaving it up to the guest to deal with them. VLAN 4095 should be used only if the guest has been specifically configured to manage VLAN tags itself.",
    "rationale": "If VGT is enabled inappropriately, it might cause a denial of service or allow a guest virtual machine to interact with traffic on an unauthorized VLAN.",
    "audit": "To verify port groups are not set to 4095 unless VGT is required, perform the following: 1. From the vSphere web client, select the host. 2. On the Configure tab, click Networking, and select Virtual switches. 3. Select a standard switch from the list. 4. View the topology diagram of the switch, which shows the various port groups associated with that switch. 5. For each port group on the vSwitch, verify and record the VLAN IDs used. Additionally, the following PowerCLI command may be used: # List all vSwitches, their Portgroups and VLAN IDs Get-VirtualPortGroup -Standard | Select virtualSwitch, Name, VlanID",
    "remediation": "To set port groups to values other than 4095 unless VGT is required, perform the following: 1. From the vSphere web client, select the host. 2. On the Configure tab, click Networking, and select Virtual switches. 3. Select a standard switch from the list.  91 | P a g e 4. View the topology diagram of the switch, which shows the various port groups associated with that switch. 5. For each port group on the vSwitch, verify and record the VLAN IDs used. 6. If a VLAN ID change is needed, click the name of the port group in the topology diagram of the virtual switch. 7. Click the \"Edit settings\" pencil icon under the topology diagram title. 8. In the Properties section, name the port group in the Network Label text field. 9. Choose an existing VLAN ID drop-down menu or type in a new one. References: 1. http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12- 2/20ew/configuration/guide/config/vlans.html#wp1038758",
    "function_names": [
      "compute_port_group_vgt_vlan_4095_restricted",
      "compute_port_group_vlan_4095_disabled",
      "compute_port_group_vlan_4095_vgt_only",
      "compute_port_group_vlan_4095_prohibited",
      "compute_port_group_vlan_4095_configured_correctly"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/12- 2/20ew/configuration/guide/config/vlans.html#wp1038758"
  },
  {
    "id": "8.1.1",
    "title": "(L1) Ensure informational messages from the VM to the VMX file are limited",
    "assessment": "Scored",
    "description": "Limit informational messages from the virtual machine (VM) to the virtual machine extensions (VMX) file to avoid filling the datastore. The configuration file containing these name-value pairs is limited to a size of 1 MB by default. This should be sufficient for most cases, but you can change this value if necessary, such as if large amounts of custom information are being stored in the configuration file.",
    "rationale": "Filling the datastore with informational messages from the VM to the VMX file could cause a denial of service.",
    "audit": "To verify informational messages are limited to 1 MB, view the virtual machine configuration file and verify that tools.setInfo.sizeLimit is set to 1048576. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"tools.setInfo.sizeLimit\" | Select Entity, Name, Value",
    "remediation": "To limit informational messages to 1 MB, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"tools.setInfo.sizeLimit\" -value 1048576   93 | P a g e Default Value: 1048576 References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-91BF834E-CB92-4014-8CF7- 29CE40F3E8A3.html  94 | P a g e",
    "function_names": [
      "compute_vm_informational_messages_limited",
      "compute_vmx_file_size_limited",
      "compute_vm_config_file_size_restricted",
      "compute_vmx_informational_messages_restricted",
      "compute_vm_logging_to_vmx_limited"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-91BF834E-CB92-4014-8CF7- 29CE40F3E8A3.html  94 | P a g e"
  },
  {
    "id": "8.1.2",
    "title": "(L2) Ensure only one remote console connection is permitted to a VM at any time",
    "assessment": "Scored",
    "description": "By default, remote console sessions can be connected to by more than one user at a time. Permit only one remote console connection to a VM at a time. Other attempts will be rejected until the first connection disconnects.",
    "rationale": "When multiple sessions are activated, each terminal window gets a notification about the new session. If an administrator in the VM logs in using a VMware remote console during their session, a non-administrator in the VM can connect to the console and observe the administrator's actions. Also, this could result in an administrator losing console access to a VM. For example, if a jump box is being used for an open console session, and the admin loses a connection to that box, the console session remains open. Allowing two console sessions permits debugging via a shared session. For highest security, only one remote console session at a time should be allowed.",
    "audit": "To verify that only one remote console session is permitted at a time, view the virtual machine configuration file and confirm that RemoteDisplay.maxConnections is set to 1. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"RemoteDisplay.maxConnections\" | Select Entity, Name, Value",
    "remediation": "To permit only one remote console session at a time, run the following PowerCLI command for VMs that do not specify the setting: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"RemoteDisplay.maxConnections\" -value 1 Run the following PowerCLI command for VMs that specify the setting but have the wrong value for it:  95 | P a g e # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"RemoteDisplay.maxConnections\" -value 1 - Force References: 1. https://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.vcli.examples.doc%2FGUID-0885D02A-872B- 4D98-A20E-7B55373C529C.html 2. http://www.ibenit.com/post/85227299008/security-benchmark-hardening-guide- policies-and-profile",
    "function_names": [
      "compute_vm_single_remote_console_connection",
      "compute_vm_remote_console_connection_limit_one",
      "compute_vm_remote_console_exclusive_access",
      "compute_vm_remote_console_single_session",
      "compute_vm_remote_console_connection_restricted"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.vcli.examples.doc%2FGUID-0885D02A-872B- 4D98-A20E-7B55373C529C.html 2. http://www.ibenit.com/post/85227299008/security-benchmark-hardening-guide- policies-and-profile"
  },
  {
    "id": "8.2.1",
    "title": "(L1) Ensure unnecessary floppy devices are disconnected",
    "assessment": "Scored",
    "description": "Ensure that no floppy device is connected to a virtual machine unless required. For a floppy device to be disconnected, the floppyX.present parameter should either not be present or have a value of FALSE.",
    "rationale": "Removing unnecessary hardware devices can reduce the number of potential attack channels and help prevent attacks.",
    "audit": "To verify floppy drives are not connected, confirm that the following parameter is either NOT present or is set to FALSE: floppyX.present Alternately, the following PowerCLI command may be used: # Check for Floppy Devices attached to VMs Get-VM | Get-FloppyDrive | Select Parent, Name, ConnectionState",
    "remediation": "To disconnect all floppy drives from VMs, run the following PowerCLI command: # Remove all Floppy drives attached to VMs Get-VM | Get-FloppyDrive | Remove-FloppyDrive The VM will need to be powered off for this change to take effect. References: 1. https://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.vcli.examples.doc%2FGUID-F9B3FBA2-CC36- 4E21-8029-89C68DD3A50C.html   97 | P a g e",
    "function_names": [
      "compute_virtual_machine_floppy_disconnected",
      "compute_vm_floppy_device_removed",
      "compute_vm_unnecessary_floppy_disabled",
      "compute_vm_floppy_present_false",
      "compute_vm_floppy_device_unattached"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.vcli.examples.doc%2FGUID-F9B3FBA2-CC36- 4E21-8029-89C68DD3A50C.html   97 | P a g e"
  },
  {
    "id": "8.2.2",
    "title": "(L2) Ensure unnecessary CD/DVD devices are disconnected",
    "assessment": "Scored",
    "description": "Ensure that no CD/DVD device is connected to a virtual machine unless required. For a CD/DVD device to be disconnected, the ideX:Y.present parameter should either not be present or have a value of FALSE.",
    "rationale": "Removing unnecessary hardware devices can reduce the number of potential attack channels and help prevent attacks.",
    "audit": "To verify CD/DVD drives are not connected, confirm that the following parameter is either NOT present or is set to FALSE: ideX:Y.present Alternately, the following PowerCLI command may be used: # Check for CD/DVD Drives attached to VMs Get-VM | Get-CDDrive",
    "remediation": "To disconnect all CD/DVD drives from VMs, run the following PowerCLI command: # Remove all CD/DVD Drives attached to VMs Get-VM | Get-CDDrive | Remove-CDDrive The VM will need to be powered off for this change to take effect. References: 1. https://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.vcli.examples.doc%2FGUID-F9B3FBA2-CC36- 4E21-8029-89C68DD3A50C.html",
    "function_names": [
      "compute_vm_cd_dvd_disconnected",
      "compute_vm_unnecessary_devices_removed",
      "compute_vm_ide_present_false",
      "compute_vm_ide_device_disabled",
      "compute_vm_removable_media_disconnected"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.vcli.examples.doc%2FGUID-F9B3FBA2-CC36- 4E21-8029-89C68DD3A50C.html"
  },
  {
    "id": "8.2.3",
    "title": "(L1) Ensure unnecessary parallel ports are disconnected",
    "assessment": "Scored",
    "description": "Ensure that no parallel port is connected to a virtual machine unless required. For a parallel port to be disconnected, the parallelX.present parameter should either not be present or have a value of FALSE.",
    "rationale": "Removing unnecessary hardware devices can reduce the number of potential attack channels and help prevent attacks.",
    "audit": "To verify parallel ports are not connected, confirm that the following parameter is either NOT present or is set to FALSE: parallelX.present Alternately, the following PowerCLI command may be used: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in- powercli.html # Check for Parallel ports attached to VMs Get-VM | Get-ParallelPort",
    "remediation": "To disconnect all parallel ports from VMs, run the following PowerCLI command: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in- powercli.html # Remove all Parallel Ports attached to VMs Get-VM | Get-ParallelPort | Remove-ParallelPort The VM will need to be powered off for this change to take effect. References: 1. https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in- powercli.html   101 | P a g e",
    "function_names": [
      "compute_virtual_machine_parallel_ports_disconnected",
      "compute_vm_parallel_port_disabled",
      "compute_vm_parallel_port_absent",
      "compute_vm_parallel_port_present_false",
      "compute_vm_unnecessary_parallel_ports_removed"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in- powercli.html   101 | P a g e"
  },
  {
    "id": "8.2.4",
    "title": "(L1) Ensure unnecessary serial ports are disconnected",
    "assessment": "Scored",
    "description": "Ensure that no serial port is connected to a virtual machine unless required. For a serial port to be disconnected, the serialX.present parameter should either not be present or have a value of FALSE.",
    "rationale": "Removing unnecessary hardware devices can reduce the number of potential attack channels and help prevent attacks.",
    "audit": "To verify serial ports are not connected, confirm that the following parameter is either NOT present or is set to FALSE: serialX.present Alternately, the following PowerCLI command may be used: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in- powercli.html # Check for Serial ports attached to VMs Get-VM | Get-SerialPort",
    "remediation": "To disconnect all serial ports from VMs, run the following PowerCLI command: # In this Example you will need to add the functions from this post: http://blogs.vmware.com/vipowershell/2012/05/working-with-vm-devices-in- powercli.html # Remove all Serial Ports attached to VMs Get-VM | Get-SerialPort | Remove-SerialPort The VM will need to be powered off for this change to take effect. References: 1. https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in- powercli.html   103 | P a g e",
    "function_names": [
      "compute_virtual_machine_serial_ports_disconnected",
      "compute_vm_serial_port_present_false",
      "compute_instance_unnecessary_serial_ports_removed",
      "compute_vm_serial_port_disabled",
      "compute_virtual_machine_serial_port_unconfigured"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://blogs.vmware.com/PowerCLI/2012/05/working-with-vm-devices-in- powercli.html   103 | P a g e"
  },
  {
    "id": "8.2.5",
    "title": "(L1) Ensure unnecessary USB devices are disconnected",
    "assessment": "Scored",
    "description": "Ensure that no USB device is connected to a virtual machine unless required. For a USB device to be disconnected, the usb.present parameter should either not be present or have a value of FALSE.",
    "rationale": "Removing unnecessary hardware devices can reduce the number of potential attack channels and help prevent attacks.",
    "audit": "To verify USB devices are not connected, confirm that the following parameter is either NOT present or is set to FALSE: usb.present Alternately, the following PowerCLI command may be used: # Check for USB Devices attached to VMs Get-VM | Get-USBDevice",
    "remediation": "To disconnect all USB devices from VMs, run the following PowerCLI command: # Remove all USB Devices attached to VMs Get-VM | Get-USBDevice | Remove-USBDevice The VM will need to be powered off for this change to take effect. References: 1. https://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.powercli.cmdletref.doc%2FUsbDevice.html&re sultof=%22%67%65%74%2d%75%73%62%64%65%76%69%63%65%22%20",
    "function_names": [
      "compute_vm_usb_disconnected",
      "compute_vm_usb_present_false",
      "compute_vm_unnecessary_usb_removed",
      "compute_vm_usb_device_disabled",
      "compute_vm_usb_configuration_secure"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.powercli.cmdletref.doc%2FUsbDevice.html&re sultof=%22%67%65%74%2d%75%73%62%64%65%76%69%63%65%22%20"
  },
  {
    "id": "8.2.6",
    "title": "(L1) Ensure unauthorized modification and disconnection of devices is disabled",
    "assessment": "Scored",
    "description": "In a virtual machine, users and processes without root or administrator privileges can disconnect devices, such as network adapters and CD-ROM drives, and modify device settings within the guest operating system. These actions should be prevented.",
    "rationale": "Disabling unauthorized modification and disconnection of devices helps prevents unauthorized changes within the guest operating system, which could be used to gain unauthorized access, cause denial of service conditions, and otherwise negatively affect the security of the guest operating system.",
    "audit": "To verify unauthorized device modifications and disconnections are prevented, access the virtual machine configuration file and verify that isolation.device.edit.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.device.edit.disable\" | Select Entity, Name, Value",
    "remediation": "To prevent unauthorized device modifications and disconnections, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.device.edit.disable\" -value $true References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9- A168-C62D9306DBD6.html  107 | P a g e",
    "function_names": [
      "compute_vm_unauthorized_device_modification_disabled",
      "compute_vm_device_disconnection_restricted",
      "compute_vm_non_admin_device_control_disabled",
      "compute_vm_guest_device_modification_blocked",
      "compute_vm_device_settings_protected"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9- A168-C62D9306DBD6.html  107 | P a g e"
  },
  {
    "id": "8.2.7",
    "title": "(L1) Ensure unauthorized connection of devices is disabled",
    "assessment": "Scored",
    "description": "In a virtual machine, users and processes without root or administrator privileges can connect devices, such as network adapters and CD-ROM drives. This should be prevented.",
    "rationale": "Disabling unauthorized connection of devices helps prevents unauthorized changes within the guest operating system, which could be used to gain unauthorized access, cause denial of service conditions, and otherwise negatively affect the security of the guest operating system.",
    "audit": "To verify unauthorized device connections are prevented, access the virtual machine configuration file and verify that isolation.device.connectable.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.device.connectable.disable\" | Select Entity, Name, Value",
    "remediation": "To prevent unauthorized device connections, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.device.connectable.disable\" - value $true References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9- A168-C62D9306DBD6.html",
    "function_names": [
      "compute_virtual_machine_unauthorized_device_connection_disabled",
      "compute_vm_device_connection_restricted",
      "compute_instance_unauthorized_device_attachment_blocked",
      "compute_vm_device_attachment_admin_only",
      "compute_virtual_machine_device_connection_admin_restricted"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-F88A5FED-552B-44F9- A168-C62D9306DBD6.html"
  },
  {
    "id": "8.3.1",
    "title": "(L1) Ensure unnecessary or superfluous functions inside VMs are disabled",
    "assessment": "Not Scored",
    "description": "Disable all system components that are not needed to support the application or service running on the VM. VMs often don't require as many functions as ordinary physical servers, so when virtualizing, you should evaluate whether a particular function is truly needed.",
    "rationale": "By disabling unnecessary system components, you reduce the number of potential attack vectors, which reduces the likelihood of compromise.",
    "audit": "To verify unneeded functions are disabled, check that the following are disabled: 1. Unused services in the operating system. For example, if the system runs a file server, Web services should not be running. 2. Unused physical devices, such as CD/DVD drives, floppy drives, and USB adaptors. 3. Screen savers. 4. X Windows if using a Linux, BSD, or Solaris guest operating system.",
    "remediation": "To disable unneeded functions, perform whichever of the following steps are applicable: 1. Disable unused services in the operating system. 2. Disconnect unused physical devices, such as CD/DVD drives, floppy drives, and USB adaptors. 3. Turn off any screen savers. 4. If using a Linux, BSD, or Solaris guest operating system, do not run the X Windows system unless it is necessary.   111 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-6BFA8CA7-610F-4E6B- 9FC6-D656917B7E7A.html",
    "function_names": [
      "compute_vm_unnecessary_functions_disabled",
      "compute_vm_superfluous_components_disabled",
      "compute_vm_nonessential_services_disabled",
      "compute_vm_unused_features_disabled",
      "compute_vm_minimal_functionality_enabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-6BFA8CA7-610F-4E6B- 9FC6-D656917B7E7A.html"
  },
  {
    "id": "8.3.2",
    "title": "(L1) Ensure use of the VM console is limited",
    "assessment": "Not Scored",
    "description": "The VM console enables you to connect to the console of a VM, in effect seeing what a monitor on a physical server would show. The VM console also provides power management and removable device connectivity controls. Instead of the VM console, use native remote management services, such as terminal services and ssh, to interact with VMs. Grant access to the VM console only when needed, and use custom roles to provide fine-grained permissions for those people who do need access. By default, the vCenter roles \"Virtual Machine Power User\" and \"Virtual Machine Administrator\" have the \"Virtual Machine.Interaction.Console Interaction\" privilege.",
    "rationale": "The VM console could be misused to eavesdrop on VM activity, cause VM outages, and negatively affect the performance of the console, especially if many VM console sessions are open simultaneously.",
    "audit": "To verify use of the VM console is properly limited, perform the following steps: 1. From the vSphere Client, select an object in the inventory. 2. Click the Permissions tab to view the user and role pair assignments for that object. 3. Next, navigate to vCenter --> Administration --> Roles. 4. Select the role in question and choose Edit to see which effective privileges are enabled. 5. Verify that only authorized users have a role which allows them a privilege under the Virtual Machine section of the role editor.",
    "remediation": "To properly limit use of the VM console, perform the following steps: 1. From the vSphere Client, navigate to vCenter --> Administration --> Roles. 2. Create a custom role and choose Edit to enable only the minimum needed effective privileges. 3. Next, select an object in the inventory. 4. Click the Permissions tab to view the user and role pair assignments for that object.  113 | P a g e 5. Remove any default \"Admin\" or \"Power User\" roles, and assign the new custom role as needed. References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-41E5E52E-A95B-4E81-9724- 6AD6800BEF78.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-3D47149A-947D-4608- 88B3-E5811129EFA8.html",
    "function_names": [
      "compute_vm_console_access_restricted",
      "compute_vm_console_custom_role_required",
      "compute_vm_console_native_management_preferred",
      "compute_vm_console_privilege_revoked",
      "compute_vm_console_interaction_disabled",
      "compute_vm_console_access_audited",
      "compute_vm_console_privilege_minimized",
      "compute_vm_console_remote_management_enforced"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-41E5E52E-A95B-4E81-9724- 6AD6800BEF78.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-3D47149A-947D-4608- 88B3-E5811129EFA8.html"
  },
  {
    "id": "8.3.3",
    "title": "(L1) Ensure secure protocols are used for virtual serial port access",
    "assessment": "Not Scored",
    "description": "Serial ports are interfaces for connecting peripherals to the VM. They are often used on physical systems to provide a direct, low-level connection to the console of a server. Virtual serial ports allow VMs to communicate with serial ports over networks. If virtual serial ports are needed, they should be configured to use secure protocols.",
    "rationale": "If virtual serial ports do not use secure protocols, the communications with those ports could be eavesdropped on, manipulated, or otherwise compromised, giving attackers sensitive information or control to unauthorized parties.",
    "audit": "To verify that all virtual serial ports use secure protocols, check that all configured protocols are from this list: \u2022 ssl - the equivalent of TCP+SSL \u2022 tcp+ssl - SSL over TCP over IPv4 or IPv6 \u2022 tcp4+ssl - SSL over TCP over IPv4 \u2022 tcp6+ssl - SSL over TCP over IPv6 \u2022 telnets - telnet over SSL over TCP",
    "remediation": "To configure all virtual serial ports to use secure protocols, change any protocols that are not secure to one of the following: \u2022 ssl - the equivalent of TCP+SSL \u2022 tcp+ssl - SSL over TCP over IPv4 or IPv6 \u2022 tcp4+ssl - SSL over TCP over IPv4 \u2022 tcp6+ssl - SSL over TCP over IPv6 \u2022 telnets - telnet over SSL over TCP   115 | P a g e References: 1. https://code.vmware.com/apis/196/vsphere#/doc/vim.vm.device.VirtualSerialPor t.URIBackingInfo.html 2. https://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.wssdk.vsp.doc%2Fvirtual_serial_port_using_pr oxy_Chapter1.3.2.html 3. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.vm_admin.doc/GUID-462B8B04-29DF-406B- 9585-12D2588A6A48.html",
    "function_names": [
      "compute_virtual_serial_port_secure_protocol_enabled",
      "compute_serial_port_secure_protocol_required",
      "compute_vm_serial_port_encryption_enabled",
      "compute_serial_port_tls_required",
      "compute_virtual_serial_port_secure_connection_enabled",
      "compute_serial_port_secure_transport_enabled",
      "compute_vm_serial_port_protocol_restricted",
      "compute_serial_port_unencrypted_disabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://code.vmware.com/apis/196/vsphere#/doc/vim.vm.device.VirtualSerialPor t.URIBackingInfo.html 2. https://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.wssdk.vsp.doc%2Fvirtual_serial_port_using_pr oxy_Chapter1.3.2.html 3. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.vm_admin.doc/GUID-462B8B04-29DF-406B- 9585-12D2588A6A48.html"
  },
  {
    "id": "8.3.4",
    "title": "(L1) Ensure templates are used whenever possible to deploy VMs",
    "assessment": "Not Scored",
    "description": "Use a hardened base operating system template image to create application-specific templates, and use the application-specific templates to deploy virtual machines.",
    "rationale": "By capturing a hardened base operating system image (with no applications installed) in a template, you can ensure that all your virtual machines are created with a known baseline level of security. Manual installation of the OS and applications into a VM introduces the risk of misconfiguration due to human or process error.",
    "audit": "To verify that templates are used whenever possible to deploy VMs, confirm that such templates exist, the templates are properly configured, and standard procedures and processes use the templates when appropriate.",
    "remediation": "To change current practices so templates are used whenever possible to deploy VMs, perform whichever of the following steps is appropriate: \u2022 Create templates and configure them properly \u2022 Alter standard procedures and processes to use the templates Also, ensure that the applications do not depend on information specific to the VM to be deployed. References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.vm_admin.doc/GUID-8254CD05-CC06-491D- BA56-A773A32A8130.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-3399BC47-45E8-494B-9B57- E498DD294A47.html  117 | P a g e",
    "function_names": [
      "compute_vm_template_used",
      "compute_vm_hardened_template_used",
      "compute_vm_application_template_used",
      "compute_template_hardened_base_image",
      "compute_template_application_specific",
      "compute_vm_deployed_from_template",
      "compute_template_os_hardened",
      "compute_vm_template_standardized"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.vm_admin.doc/GUID-8254CD05-CC06-491D- BA56-A773A32A8130.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-3399BC47-45E8-494B-9B57- E498DD294A47.html  117 | P a g e"
  },
  {
    "id": "8.4.1",
    "title": "(L1) Ensure access to VMs through the dvfilter network APIs is configured correctly",
    "assessment": "Not Scored",
    "description": "A VM must be configured explicitly to accept access by the dvfilter network API. Only VMs that need to be accessed by that API should be configured to accept such access.",
    "rationale": "An attacker might compromise a VM by making use of the dvfilter API.",
    "audit": "To verify the configuration, perform the following if dvfilter access should be permitted: 1. Verify that the following is in the VMX file: ethernet0.filter1.name = dv-filter1 where ethernet0 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and dv-filter1 is the name of the particular data path kernel module that is protecting the VM. 2. Ensure that the name of the data path kernel is set correctly. Perform the following to verify the configuration if dvfilter access should not be permitted: 1. Verify that the following is not in the VMX file: ethernet0.filter1.name = dv- filter1.",
    "remediation": "To configure a VM to allow dvfilter access, perform the following steps: 1. Configure the following in the VMX file: ethernet0.filter1.name = dv-filter1 where ethernet0 is the network adapter interface of the virtual machine that is to be protected, filter1 is the number of the filter that is being used, and dv-filter1 is the name of the particular data path kernel module that is protecting the VM. 2. Set the name of the data path kernel correctly. To configure a VM to not allow dvfilter access, perform the following steps:  119 | P a g e 1. Remove the following from its VMX file: ethernet0.filter1.name = dv-filter1. References: 1. http://kb.vmware.com/kb/1714 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A- B821-ED17A77B0206.html",
    "function_names": [
      "compute_vm_dvfilter_access_configured",
      "compute_vm_dvfilter_access_restricted",
      "compute_vm_dvfilter_api_enabled",
      "compute_vm_dvfilter_api_authorized",
      "compute_vm_network_api_secure_config",
      "compute_vm_network_api_access_controlled",
      "compute_vm_dvfilter_secure_access",
      "compute_vm_network_api_explicit_config"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://kb.vmware.com/kb/1714 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-CD0783C9-1734-4B9A- B821-ED17A77B0206.html"
  },
  {
    "id": "8.4.2",
    "title": "(L1) Ensure VMsafe Agent Address is configured correctly",
    "assessment": "Not Scored",
    "description": "The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters to perform the following: 1. Enable the API. 2. Set the IP address used by the security virtual appliance on the introspection vSwitch. 3. Set the port number for that IP address. The second parameter must be set correctly in the vmsafe.agentAddress option in the virtual machine configuration file for any VMs that should be protected by the API.",
    "rationale": "An attacker might compromise the VMs by making unauthorized use of the introspection channel provided by the API.",
    "audit": "To verify the VMsafe Agent Address is configured correctly, perform the following steps: 1. If the VM is not being protected by a VMsafe CPU/memory product, verify that vmsafe.agentAddress is not present in the virtual machine configuration file. 2. If the VM is being protected by a VMsafe CPU/Memory product, make sure that vmsafe.agentAddress in the virtual machine configuration file is set to the correct value. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name  \"vmsafe.agentAddress\" | Select Entity, Name, Value   121 | P a g e",
    "remediation": "To configure the VMsafe Agent Address correctly, perform the following steps: 1. If the VM is not being protected by a VMsafe CPU/memory product, remove vmsafe.agentAddress from the virtual machine configuration file. 2. If the VM is being protected by a VMsafe CPU/Memory product, set vmsafe.agentAddress to the correct value. References: 1. http://kb.vmware.com/kb/1714 2. https://www.vmware.com/security/hardening-guides.html",
    "function_names": [
      "compute_vm_vmsafe_agent_address_configured",
      "compute_vm_vmsafe_api_enabled",
      "compute_vm_vmsafe_agent_address_valid",
      "compute_vm_vmsafe_agent_port_configured",
      "compute_vm_vmsafe_introspection_vswitch_configured",
      "compute_vm_vmsafe_agent_address_correct_format",
      "compute_vm_vmsafe_agent_address_reachable",
      "compute_vm_vmsafe_agent_address_not_default"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://kb.vmware.com/kb/1714 2. https://www.vmware.com/security/hardening-guides.html"
  },
  {
    "id": "8.4.3",
    "title": "(L1) Ensure VMsafe Agent Port is configured correctly",
    "assessment": "Not Scored",
    "description": "The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters to perform the following: 1. Enable the API. 2. Set the IP address used by the security virtual appliance on the introspection vSwitch. 3. Set the port number for that IP address. The third parameter must be set correctly in the vmsafe.agentPort option in the virtual machine configuration file for any VMs that should be protected by the API.",
    "rationale": "An attacker might compromise the VMs by making unauthorized use of the introspection channel provided by the API.",
    "audit": "To verify the VMsafe Agent Port is configured correctly, perform the following steps: 1. If the VM is not being protected by a VMsafe CPU/memory product, verify that vmsafe.agentPort is not present in the virtual machine configuration file. 2. If the VM is being protected by a VMsafe CPU/Memory product, make sure that vmsafe.agentPort in the virtual machine configuration file is set to the correct value. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name  \"vmsafe.agentPort\" | Select Entity, Name, Value",
    "remediation": "To configure the VMsafe Agent Port correctly, perform the following steps:  123 | P a g e 1. If the VM is not being protected by a VMsafe CPU/memory product, remove vmsafe.agentPort from the virtual machine configuration file. 2. If the VM is being protected by a VMsafe CPU/Memory product, set vmsafe.agentPort to the correct value. References: 1. http://kb.vmware.com/kb/1714 2. https://www.vmware.com/security/hardening-guides.html",
    "function_names": [
      "compute_vm_vmsafe_agent_port_configured",
      "compute_vm_vmsafe_api_enabled",
      "compute_vm_vmsafe_security_ip_set",
      "compute_vm_vmsafe_agent_port_valid",
      "compute_vm_vmsafe_introspection_vswitch_configured"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://kb.vmware.com/kb/1714 2. https://www.vmware.com/security/hardening-guides.html"
  },
  {
    "id": "8.4.4",
    "title": "(L1) Ensure VMsafe Agent is configured correctly",
    "assessment": "Not Scored",
    "description": "The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters to perform the following: 1. Enable the API. 2. Set the IP address used by the security virtual appliance on the introspection vSwitch. 3. Set the port number for that IP address. The first parameter must be set correctly in the vmsafe.enable option in the virtual machine configuration file for any VMs that should be protected by the API. For any VMs that should not be protected by the API, this option should not exist in the configuration file.",
    "rationale": "An attacker might compromise the VMs by making unauthorized use of the introspection channel provided by the API.",
    "audit": "To verify the VMsafe Agent is configured correctly, perform the following steps: 1. If the VM is not being protected by a VMsafe CPU/memory product, verify that vmsafe.enable is not present in the virtual machine configuration file or is set to FALSE. 2. If the VM is being protected by a VMsafe CPU/Memory product, make sure that vmsafe.enable in the virtual machine configuration file is set to the correct value. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name  \"vmsafe.enable\" | Select Entity, Name, Value   125 | P a g e",
    "remediation": "To configure the VMsafe Agent correctly, perform the following steps: 1. If the VM is not being protected by a VMsafe CPU/memory product, remove vmsafe.enable from the virtual machine configuration file or set it to a value of FALSE. 2. If the VM is being protected by a VMsafe CPU/Memory product, set vmsafe.enable to the correct value. Default Value: The prescribed state is the default state. References: 1. http://kb.vmware.com/kb/1714 2. https://www.vmware.com/security/hardening-guides.html",
    "function_names": [
      "compute_vm_vmsafe_enabled",
      "compute_vm_vmsafe_ip_configured",
      "compute_vm_vmsafe_port_configured",
      "compute_vm_vmsafe_config_valid",
      "compute_vm_vmsafe_api_access_restricted"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://kb.vmware.com/kb/1714 2. https://www.vmware.com/security/hardening-guides.html"
  },
  {
    "id": "8.4.5",
    "title": "(L2) Ensure Autologon is disabled",
    "assessment": "Scored",
    "description": "Autologon should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as autologon, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that autologon is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.ghi.autologon.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.ghi.autologon.disable\"| Select Entity, Name, Value",
    "remediation": "To disable autologon, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.autologon.disable\" - value $true References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html  127 | P a g e",
    "function_names": [
      "windows_autologon_disabled",
      "windows_autologon_config_disabled",
      "windows_autologon_feature_disabled",
      "windows_autologon_setting_disabled",
      "windows_autologon_policy_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html  127 | P a g e"
  },
  {
    "id": "8.4.6",
    "title": "(L2) Ensure BIOS BBS is disabled",
    "assessment": "Scored",
    "description": "BIOS BBS should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as BIOS BBS, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that BIOS BBS is disabled if not needed, check the virtual machine configuration file and verify that isolation.bios.bbs.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.bios.bbs.disable\"| Select Entity, Name, Value",
    "remediation": "To disable BIOS BBS, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.bios.bbs.disable\" -value $true References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_bios_bbs_disabled",
      "compute_bios_bbs_not_enabled",
      "compute_bios_bbs_unused_disabled",
      "compute_bios_bbs_unnecessary_disabled",
      "compute_bios_bbs_secure_state_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.7",
    "title": "(L2) Ensure Guest Host Interaction Protocol Handler is set to disabled",
    "assessment": "Scored",
    "description": "Guest Host Interaction Protocol Handle should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as Guest Host Interaction Protocol Handle, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that Guest Host Interaction Protocol Handle is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.ghi.protocolhandler.info.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.ghi.protocolhandler.info.disable\" | Select Entity, Name, Value",
    "remediation": "To disable Guest Host Interaction Protocol Handle, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.protocolhandler.info.disable\" -value $true Impact: Some automated tools and processes may cease to function.  130 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_vm_guest_host_interaction_disabled",
      "compute_vm_protocol_handler_disabled",
      "compute_vm_guest_interaction_disabled",
      "compute_vm_host_interaction_disabled",
      "compute_vm_guest_protocol_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.  130 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.8",
    "title": "(L2) Ensure Unity Taskbar is disabled",
    "assessment": "Scored",
    "description": "The Unity Taskbar feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Unity Taskbar feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Unity Taskbar feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.unity.taskbar.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unity.taskbar.disable\" | Select Entity, Name, Value",
    "remediation": "To disable the Unity Taskbar feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unity.taskbar.disable\" - value $true Impact: Some automated tools and processes may cease to function.   132 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_unity_taskbar_disabled",
      "compute_unity_taskbar_feature_disabled",
      "compute_unity_taskbar_config_disabled",
      "compute_unity_taskbar_setting_disabled",
      "compute_unity_taskbar_not_enabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.   132 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.9",
    "title": "(L2) Ensure Unity Active is disabled",
    "assessment": "Scored",
    "description": "The Unity Active feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Unity Active feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Unity Active feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.unityActive.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unityActive.disable\" | Select Entity, Name, Value",
    "remediation": "To disable the Unity Active feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unityActive.disable\" - value $True Impact: Some automated tools and processes may cease to function. References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-412EF981-D4F1-430B-  134 | P a g e 9D09- A4679C2D04E7.html?hWord=N4IghgNiBcIMIHsB2AzAlgcwK4Cc1IwAIA1AWQHcw cBTQgFQQQgGcQBfIA 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A",
    "function_names": [
      "unity_active_disabled",
      "unity_feature_disabled",
      "unity_active_not_enabled",
      "unity_active_deactivated",
      "unity_active_setting_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-412EF981-D4F1-430B-  134 | P a g e 9D09- A4679C2D04E7.html?hWord=N4IghgNiBcIMIHsB2AzAlgcwK4Cc1IwAIA1AWQHcw cBTQgFQQQgGcQBfIA 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A"
  },
  {
    "id": "8.4.10",
    "title": "(L2) Ensure Unity Window Contents is disabled",
    "assessment": "Scored",
    "description": "The Unity Window Contents feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Unity Window Contents feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Unity Window Contents feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.unity.windowContents.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unity.windowContents.disable\" | Select Entity, Name, Value",
    "remediation": "To disable the Unity Window Contents feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unity.windowContents.disable\" -value $True Impact: Some automated tools and processes may cease to function.   136 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A",
    "function_names": [
      "unity_window_contents_disabled",
      "unity_window_contents_not_enabled",
      "unity_window_contents_feature_disabled",
      "unity_window_contents_setting_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.   136 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A"
  },
  {
    "id": "8.4.11",
    "title": "(L2) Ensure Unity Push Update is disabled",
    "assessment": "Scored",
    "description": "The Unity Push Update feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Unity Push Update feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Unity Push Update feature is disabled if not needed, check virtual machine configuration file and verify that isolation.tools.unity.push.update.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unity.push.update.disable\" | Select Entity, Name, Value",
    "remediation": "To disable the Unity Push Update feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unity.push.update.disable\" -value $true Impact: Some automated tools and processes may cease to function.   138 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A",
    "function_names": [
      "unity_push_update_disabled",
      "unity_push_update_not_enabled",
      "unity_push_update_deactivated",
      "unity_push_update_feature_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.   138 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A"
  },
  {
    "id": "8.4.12",
    "title": "(L2) Ensure Drag and Drop Version Get is disabled",
    "assessment": "Scored",
    "description": "The Drag and Drop Version Get feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Drag and Drop Version Get feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Drag and Drop Version Get feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.vmxDnDVersionGet.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.vmxDnDVersionGet.disable\"| Select Entity, Name, Value",
    "remediation": "To disable the Drag and Drop Version Get feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.vmxDnDVersionGet.disable\" -value $true Impact: Some automated tools and processes may cease to function.   140 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335- CFBCE0DD2167.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A",
    "function_names": [
      "cloud_cdn_distribution_drag_and_drop_version_get_disabled",
      "cloud_cdn_distribution_drag_and_drop_get_disabled",
      "cloud_cdn_distribution_version_get_disabled",
      "cloud_cdn_distribution_drag_and_drop_disabled",
      "cloud_cdn_distribution_unnecessary_features_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.   140 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335- CFBCE0DD2167.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A"
  },
  {
    "id": "8.4.13",
    "title": "(L2) Ensure Drag and Drop Version Set is disabled",
    "assessment": "Scored",
    "description": "The Drag and Drop Version Set feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Drag and Drop Version Set feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Drag and Drop Version Set feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.guestDnDVersionSet.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.guestDnDVersionSet.disable\"| Select Entity, Name, Value",
    "remediation": "To disable the Drag and Drop Version Set feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.guestDnDVersionSet.disable\" -value $true Impact: Some automated tools and processes may cease to function.   142 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335- CFBCE0DD2167.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A",
    "function_names": [
      "cloud_cdn_distribution_drag_and_drop_disabled",
      "cloud_cdn_distribution_version_set_disabled",
      "cloud_cdn_distribution_drag_and_drop_version_set_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.   142 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335- CFBCE0DD2167.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A"
  },
  {
    "id": "8.4.14",
    "title": "(L2) Ensure Shell Action is disabled",
    "assessment": "Scored",
    "description": "The Shell Action feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Shell Action feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Shell Action feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.ghi.host.shellAction.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.ghi.host.shellAction.disable\" | Select Entity, Name, Value",
    "remediation": "To disable the Shell Action feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.ghi.host.shellAction.disable\" - value $true Impact: Some automated tools and processes may cease to function. References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-  144 | P a g e 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_instance_shell_action_disabled",
      "compute_vm_shell_action_disabled",
      "compute_instance_serial_console_disabled",
      "compute_vm_serial_console_disabled",
      "compute_instance_interactive_shell_disabled",
      "compute_vm_interactive_shell_disabled",
      "compute_instance_ssh_disabled",
      "compute_vm_ssh_disabled",
      "compute_instance_remote_access_disabled",
      "compute_vm_remote_access_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-  144 | P a g e 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.15",
    "title": "(L2) Ensure Request Disk Topology is disabled",
    "assessment": "Scored",
    "description": "The Request Disk Topology feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Request Disk Topology feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Request Disk Topology feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.dispTopoRequest.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.dispTopoRequest.disable\"| Select Entity, Name, Value",
    "remediation": "To disable the Request Disk Topology feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.dispTopoRequest.disable\" -value $true Impact: Some automated tools and processes may cease to function.   146 | P a g e References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_disk_topology_disabled",
      "compute_disk_request_topology_disabled",
      "compute_disk_topology_request_disabled",
      "compute_disk_request_topology_not_enabled",
      "compute_disk_topology_request_not_enabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.   146 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.16",
    "title": "(L2) Ensure Trash Folder State is disabled",
    "assessment": "Scored",
    "description": "The Trash Folder State feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Trash Folder State feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Trash Folder State feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.trashFolderState.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.trashFolderState.disable\"| Select Entity, Name, Value",
    "remediation": "To disable the Trash Folder State feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.trashFolderState.disable\" -value $true Impact: Some automated tools and processes may cease to function.   148 | P a g e References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "storage_bucket_trash_disabled",
      "storage_bucket_trash_folder_state_disabled",
      "storage_bucket_trash_feature_disabled",
      "storage_bucket_trash_retention_disabled",
      "storage_bucket_trash_state_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.   148 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.17",
    "title": "(L2) Ensure Guest Host Interaction Tray Icon is disabled",
    "assessment": "Scored",
    "description": "The Guest Host Interaction Tray Icon feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Guest Host Interaction Tray Icon feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Guest Host Interaction Tray Icon feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.ghi.trayicon.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.ghi.trayicon.disable\"| Select Entity, Name, Value",
    "remediation": "To disable the Guest Host Interaction Tray Icon feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.trayicon.disable\" - value $true Impact: Some automated tools and processes may cease to function.   150 | P a g e References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_vm_guest_host_interaction_disabled",
      "compute_vm_tray_icon_disabled",
      "compute_vm_guest_interaction_disabled",
      "compute_vm_host_interaction_disabled",
      "compute_vm_guest_host_tray_icon_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.   150 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.18",
    "title": "(L2) Ensure Unity is disabled",
    "assessment": "Scored",
    "description": "The Unity feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Unity feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Unity feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.unity.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unity.disable\"| Select Entity, Name, Value",
    "remediation": "To disable the Unity feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unity.disable\" -value $true Impact: Some automated tools and processes may cease to function.   152 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A",
    "function_names": [
      "cloud_cdn_unity_disabled",
      "cloud_cdn_unity_feature_disabled",
      "cloud_cdn_unity_not_enabled",
      "cloud_cdn_unity_deactivated",
      "cloud_cdn_unity_setting_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.   152 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A"
  },
  {
    "id": "8.4.19",
    "title": "(L2) Ensure Unity Interlock is disabled",
    "assessment": "Scored",
    "description": "The Unity Interlock feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Unity Interlock feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Unity Interlock feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.unityInterlockOperation.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.unityInterlockOperation.disable\"| Select Entity, Name, Value",
    "remediation": "To disable the Unity Interlock feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.unityInterlockOperation.disable\" -value $true Impact: Some automated tools and processes may cease to function.   154 | P a g e References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "unity_interlock_disabled",
      "unity_interlock_not_enabled",
      "unity_interlock_feature_disabled",
      "unity_interlock_unused_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.   154 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.20",
    "title": "(L2) Ensure GetCreds is disabled",
    "assessment": "Scored",
    "description": "The GetCreds feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the GetCreds feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the GetCreds feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.getCreds.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.getCreds.disable\"| Select Entity, Name, Value",
    "remediation": "To disable the GetCreds feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.getCreds.disable\" -value $true Impact: Some automated tools and processes may cease to function. References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-  156 | P a g e 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "iam_role_getcreds_disabled",
      "iam_role_no_getcreds",
      "iam_role_credential_retrieval_disabled",
      "iam_role_temporary_credentials_disabled",
      "iam_role_session_credentials_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C-  156 | P a g e 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.21",
    "title": "(L2) Ensure Host Guest File System Server is disabled",
    "assessment": "Scored",
    "description": "The Host Guest File System Server should be disabled if it is not needed.",
    "rationale": "Certain automated operations such as automated tool upgrades use a component in the hypervisor called Host Guest File System (HGFS), and an attacker could potentially use this to transfer files inside the guest OS. These VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features, such as the Host Guest File System Server, are not implemented in ESXi. Explicitly disabling these features reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Host Guest File System Server is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.hgfsServerSet.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.hgfsServerSet.disable\"| Select Entity, Name, Value",
    "remediation": "To disable the Host Guest File System Server, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.hgfsServerSet.disable\" - value $true Impact: This will cause the VMX process to not respond to commands from the tools process. Setting isolation.tools.hgfsServerSet.disable to TRUE disables the registration of the guest's  158 | P a g e HGFS server with the host. APIs that use HGFS to transfer files to and from the guest operating system, such as some VIX commands or the VMware Tools auto-upgrade utility, will not function. References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335- CFBCE0DD2167.html",
    "function_names": [
      "compute_vm_host_guest_file_system_disabled",
      "compute_instance_host_guest_file_system_disabled",
      "compute_virtual_machine_host_guest_file_system_disabled",
      "compute_host_guest_file_system_server_disabled",
      "compute_vm_host_guest_fs_server_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "This will cause the VMX process to not respond to commands from the tools process. Setting isolation.tools.hgfsServerSet.disable to TRUE disables the registration of the guest's  158 | P a g e HGFS server with the host. APIs that use HGFS to transfer files to and from the guest operating system, such as some VIX commands or the VMware Tools auto-upgrade utility, will not function.",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335- CFBCE0DD2167.html"
  },
  {
    "id": "8.4.22",
    "title": "(L2) Ensure Guest Host Interaction Launch Menu is disabled",
    "assessment": "Scored",
    "description": "The Guest Host Interaction Launch Menu feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the Guest Host Interaction Launch Menu feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the Guest Host Interaction Launch Menu feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.ghi.launchmenu.change is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.ghi.launchmenu.change\" | Select Entity, Name, Value",
    "remediation": "To disable the Guest Host Interaction Launch Menu feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.ghi.launchmenu.change\" - value $true Impact: Some automated tools and processes may cease to function.  160 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_vm_guest_host_interaction_disabled",
      "compute_vm_launch_menu_disabled",
      "compute_vm_guest_interaction_restricted",
      "compute_vm_host_interaction_disabled",
      "compute_vm_guest_launch_menu_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.  160 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.23",
    "title": "(L2) Ensure memSchedFakeSampleStats is disabled",
    "assessment": "Scored",
    "description": "The memSchedFakeSampleStats feature should be disabled if it is not needed.",
    "rationale": "Some VMX parameters don't apply on vSphere because VMware virtual machines work on vSphere and hosted virtualization platforms such as Workstation and Fusion. The code paths for these features are not implemented in ESXi. Explicitly disabling these features, such as the memSchedFakeSampleStats feature, reduces the potential for vulnerabilities because it reduces the number of ways in which a guest can affect the host. Note that these are referenced for organizations that insist any documented setting, regardless of whether it is implemented in code or not, must have a value.",
    "audit": "To verify that the memSchedFakeSampleStats feature is disabled if not needed, check the virtual machine configuration file and verify that isolation.tools.memSchedFakeSampleStats.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.memSchedFakeSampleStats.disable\" | Select Entity, Name, Value",
    "remediation": "To disable the memSchedFakeSampleStats feature, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.memSchedFakeSampleStats.disable\" -value $true Impact: Some automated tools and processes may cease to function.   162 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html",
    "function_names": [
      "compute_instance_memsched_fake_sample_stats_disabled",
      "compute_vm_memsched_fake_sample_stats_disabled",
      "compute_node_memsched_fake_sample_stats_disabled",
      "compute_host_memsched_fake_sample_stats_disabled",
      "compute_kernel_memsched_fake_sample_stats_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Some automated tools and processes may cease to function.   162 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-60E83710-8295-41A2-9C9D- 83DEBB6872C2.html"
  },
  {
    "id": "8.4.24",
    "title": "(L1) Ensure VM Console Copy operations are disabled",
    "assessment": "Scored",
    "description": "VM console copy operations should be disabled.",
    "rationale": "VM console copy operations are disabled by default (not explicitly specified); however, explicitly disabling this feature enables audit controls to check that this setting is correct.",
    "audit": "To verify that VM console copy operations are disabled, verify that the isolation.tools.copy.disable option is missing or set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.copy.disable\" | Select Entity, Name, Value",
    "remediation": "To explicitly disable VM console copy operations, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.copy.disable\" -value $true Default Value: Disabled References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3- AA05-85033136A667.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335- CFBCE0DD2167.html  164 | P a g e",
    "function_names": [
      "compute_vm_console_copy_disabled",
      "compute_vm_console_operations_restricted",
      "compute_vm_console_copy_protected",
      "compute_vm_console_access_disabled",
      "compute_vm_console_clipboard_disabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3- AA05-85033136A667.html 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335- CFBCE0DD2167.html  164 | P a g e"
  },
  {
    "id": "8.4.25",
    "title": "(L1) Ensure VM Console Drag and Drop operations is disabled",
    "assessment": "Scored",
    "description": "VM console drag and drop operations should be disabled.",
    "rationale": "VM console drag and drop operations are disabled by default (not explicitly specified); however, explicitly disabling this feature enables audit controls to check that this setting is correct.",
    "audit": "To verify that VM console drag and drop operations are disabled, verify that isolation.tools.dnd.disable is missing or set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.dnd.disable\" | Select Entity, Name, Value",
    "remediation": "To explicitly disable VM console drag and drop operations, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.dnd.disable\" -value $true Default Value: Disabled References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335- CFBCE0DD2167.html  166 | P a g e",
    "function_names": [
      "compute_vm_console_drag_and_drop_disabled",
      "compute_vm_console_drag_and_drop_restricted",
      "compute_vm_console_drag_and_drop_blocked",
      "compute_vm_console_drag_and_drop_prohibited",
      "compute_vm_console_drag_and_drop_locked"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-52188148-C579-4F6A-8335- CFBCE0DD2167.html  166 | P a g e"
  },
  {
    "id": "8.4.26",
    "title": "(L1) Ensure VM Console GUI Options is disabled",
    "assessment": "Scored",
    "description": "VM console and paste GUI options should be disabled.",
    "rationale": "VM console and paste GUI options are disabled by default (not explicitly specified); however, explicitly disabling this feature enables audit controls to check that this setting is correct.",
    "audit": "To verify that VM console and paste GUI options are disabled, verify that isolation.tools.setGUIOptions.enable option is missing or set to FALSE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name  \"isolation.tools.setGUIOptions.enable\"| Select Entity, Name, Value",
    "remediation": "To explicitly disable VM console and paste GUI options, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.setGUIOptions.enable\" - value $false Default Value: Disabled References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A  168 | P a g e",
    "function_names": [
      "compute_vm_console_gui_disabled",
      "compute_vm_paste_gui_disabled",
      "compute_vm_gui_options_disabled",
      "compute_vm_console_access_disabled",
      "compute_vm_gui_console_disabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A  168 | P a g e"
  },
  {
    "id": "8.4.27",
    "title": "(L1) Ensure VM Console Paste operations are disabled",
    "assessment": "Scored",
    "description": "VM console paste operations should be disabled.",
    "rationale": "VM console paste operations are disabled by default (not explicitly specified); however, explicitly disabling this feature enables audit controls to check that this setting is correct.",
    "audit": "To verify that VM console paste operations are disabled, verify that isolation.tools.paste.disable is missing or set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.paste.disable\"| Select Entity, Name, Value",
    "remediation": "To explicitly disable VM console paste operations, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.paste.disable\" -value $true Default Value: Disabled References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A  170 | P a g e 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3- AA05-85033136A667.html",
    "function_names": [
      "compute_vm_console_paste_disabled",
      "compute_vm_console_paste_restricted",
      "compute_vm_console_clipboard_disabled",
      "compute_vm_console_clipboard_restricted",
      "compute_vm_console_input_disabled",
      "compute_vm_console_input_restricted"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A  170 | P a g e 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-367D02C1-B71F-4AC3- AA05-85033136A667.html"
  },
  {
    "id": "8.4.28",
    "title": "(L1) Ensure access to VM console via VNC protocol is limited",
    "assessment": "Scored",
    "description": "Minimize access to the Virtual Machine via VNC protocol.",
    "rationale": "The VM console enables you to connect to the console of a virtual machine, in effect seeing what a monitor on a physical server would show. This console is also available via the VNC protocol. Setting up this access also involves setting up firewall rules on each ESXi server the virtual machine will run on.",
    "audit": "Check virtual machine configuration and verify that RemoteDisplay.vnc.enabled is missing or set to FALSE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"RemoteDisplay.vnc.enabled\" | Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"RemoteDisplay.vnc.enabled\" -value $false Impact: Configuring VM settings and opening up the firewall means multiple steps to be configured and monitored.   172 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.vm_admin.doc/GUID-BB1F20D3-339F-46F3- B020-D19C9322C001.html",
    "function_names": [
      "compute_instance_vnc_access_restricted",
      "compute_vm_console_protocol_limited",
      "compute_instance_vnc_protocol_disabled",
      "compute_vm_console_access_minimized",
      "compute_instance_remote_console_restricted",
      "compute_vm_vnc_connection_limited",
      "compute_instance_console_protocol_secure",
      "compute_vm_vnc_access_controlled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "Configuring VM settings and opening up the firewall means multiple steps to be configured and monitored.   172 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.vm_admin.doc/GUID-BB1F20D3-339F-46F3- B020-D19C9322C001.html"
  },
  {
    "id": "8.4.29",
    "title": "(L2) Ensure all but VGA mode on virtual machines is disabled",
    "assessment": "Not Scored",
    "description": "Enable VGA Only mode for the Virtual Machine video card. Note:this setting should only be applied to those virtual machines for which a video card is not needed such as Windows Server Core and UNIX / Linux servers.",
    "rationale": "Many Server-class virtual machines need only a standard VGA console (typically a Unix/Linux server or Windows Server Core system). Enabling this setting removes additional unnecessary graphics functionality beyond disabling 3D. This reduces the potential attack surface available for malicious attacks.",
    "audit": "Check that the virtual machine advanced setting of \"svga.vgaonly\" is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"svga.vgaOnly\" | Select Entity, Name, Value",
    "remediation": "Check that the virtual machine advanced setting of \"svga.vgaonly\" is set to TRUE. To modify the advanced settings of a virtual machine using the vSphere Client: 1. Ensure that the virtual machine has been shutdown and is powered off. 2. Right-click on the virtual machine. 3. Click Edit Settings... to open the Virtual Machine Properties window. 4. Click the VM Options tab. 5. From the list on the left, click Advanced. 6. On the Configuration Parameters frame on the right, click Edit Configuration ... 7. Click Add Parameter. 8. On the new row, click under the Key column and specify the configuration option name. 9. On the new row, click under the Value column and specify the configuration value.  174 | P a g e 10. Start the virtual machine for the settings take effect. Additionally, the following PowerCLI command may be used: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"svga.vgaOnly\" -value $true Impact: Configuring this setting to True will not allow any advanced graphics functions to work. Only character-cell console mode will be available. Use of this setting renders mks.enable3d moot. The mks.enable3d has no effect. Note: this setting should only be applied to those virtual machines for which a video card is not needed such as Windows Server Core and UNIX / Linux servers. Default Value: The prescribed state is not the default state. References: 1. http://pubs.vmware.com/vsphere- 60/topic/com.vmware.wssdk.apiref.doc/vim.option.OptionValue.html",
    "function_names": [
      "compute_virtual_machine_vga_only_enabled",
      "compute_vm_video_card_vga_mode_only",
      "compute_vm_video_card_non_vga_disabled",
      "compute_vm_video_card_vga_only_enabled",
      "compute_vm_video_card_vga_only_mode_enabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Configuring this setting to True will not allow any advanced graphics functions to work. Only character-cell console mode will be available. Use of this setting renders mks.enable3d moot. The mks.enable3d has no effect. Note: this setting should only be applied to those virtual machines for which a video card is not needed such as Windows Server Core and UNIX / Linux servers. Default Value: The prescribed state is not the default state.",
    "references": "1. http://pubs.vmware.com/vsphere- 60/topic/com.vmware.wssdk.apiref.doc/vim.option.OptionValue.html"
  },
  {
    "id": "8.5.1",
    "title": "(L2) Ensure VM limits are configured correctly",
    "assessment": "Not Scored",
    "description": "By default, all virtual machines on an ESXi host share the resources equally. By using the resource management capabilities of ESXi, such as limits with reservations, shares, and/or resource pools, you can control the server resources a virtual machine consumes.",
    "rationale": "Without resource management, one virtual machine could consume so much of the host's resources that other virtual machines on the same host could not perform their intended functions.",
    "audit": "To verify VM limits are configured correctly, confirm that limits with reservations, shares, and/or resource pools are in place to guarantee resources to critical VMs and to constrain resource consumption by VMs that have a greater risk of being exploited or attacked, or that run applications that are known to have the potential to greatly consume resources. The following PowerCLI command may be used to list resource configurations: # List all Resource shares on all VMs Get-VM | Get-VMResourceConfiguration",
    "remediation": "To configure VM limits correctly, do all of the following that are applicable: 1. Use shares or reservations to guarantee resources to critical VMs. 2. Use limits to constrain resource consumption by VMs that have a greater risk of being exploited or attacked, or that run applications that are known to have the potential to greatly consume resources. 3. Use resource pools to guarantee resources to a common group of critical VMs.   176 | P a g e References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-E6262360-9300-4E10- ADE0-D4BED08DB5CA.html  177 | P a g e",
    "function_names": [
      "compute_vm_resource_limits_configured",
      "compute_vm_cpu_limits_configured",
      "compute_vm_memory_limits_configured",
      "compute_vm_shares_configured",
      "compute_vm_reservations_configured",
      "compute_vm_resource_pools_configured",
      "compute_vm_resource_allocation_configured",
      "compute_vm_resource_sharing_configured"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-E6262360-9300-4E10- ADE0-D4BED08DB5CA.html  177 | P a g e"
  },
  {
    "id": "8.5.2",
    "title": "(L2) Ensure hardware-based 3D acceleration is disabled",
    "assessment": "Scored",
    "description": "Due to performance reasons, modern graphic rendering is done within a dedicated graphic processing unit (GPU). Virtual machines can use the host-based GPU for such operations as well. Such dedicated hardware is typically accessed by using complex APIs like OpenGL and DirectX. This hardware-based 3D acceleration should be disabled if it is not needed.",
    "rationale": "Security flaws within APIs can lead to serious security breaches like memory corruption, denial of service, and remote code execution.",
    "audit": "To verify that hardware-based 3D acceleration is disabled, check the virtual machine configuration file and verify that mks.enable3d is set to FALSE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"mks.enable3d\"| Select Entity, Name, Value",
    "remediation": "To disable hardware-based 3D acceleration, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"mks.enable3d\" -value $false References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-15D965F3-05E3-4E59-9F08- B305FDE672DD.html",
    "function_names": [
      "compute_vm_hardware_3d_acceleration_disabled",
      "compute_instance_gpu_acceleration_disabled",
      "compute_vm_graphics_acceleration_disabled",
      "compute_vm_open_gl_disabled",
      "compute_vm_direct_x_disabled",
      "compute_vm_gpu_rendering_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-15D965F3-05E3-4E59-9F08- B305FDE672DD.html"
  },
  {
    "id": "8.6.1",
    "title": "(L1) Ensure nonpersistent disks are limited",
    "assessment": "Scored",
    "description": "By default, VM disks use dependent mode, which means they are affected by snapshots. To avoid this, VM disks can use independent mode instead. Independent mode can be configured as persistent (data is written permanently to the disk) or nonpersistent (all changes made to disk are lost when the system is rebooted). Use of nonpersistent mode should be avoided unless the data is not needed (e.g., already duplicated elsewhere).",
    "rationale": "From a security standpoint, nonpersistent mode allows successful attackers to remove evidence of their actions or even their presence within a VM by performing a simple shutdown or reboot.",
    "audit": "To verify nonpersistent mode use is limited, review VM disk types to confirm that nonpersistent mode is only used when the loss of all stored data is not a concern. For all disks where nonpersistent mode is not to be used, scsiX:Y.mode should either be absent or be set to a value other than independent nonpersistent. Alternately, the following PowerCLI command may be used to review the disk types: #List the VM's and their disk types Get-VM | Get-HardDisk | Select Parent, Name, Filename, DiskType, Persistence",
    "remediation": "To limit the use of nonpersistent mode, run the following PowerCLI command: #Add the parameters for the following cmdlet to set the VM Disk Type: Get-VM  | Get-HardDisk | Set-HardDisk References: 1. https://code.vmware.com/apis/196/vsphere#/doc/vim.vm.device.VirtualDiskOpti on.DiskMode.html  180 | P a g e 2. http://pubs.vmware.com/vsphere- 60/topic/com.vmware.vsphere.hostclient.doc/GUID-81629CAB-72FA-42F0-9F86- F8FD0DE39E57.html  181 | P a g e",
    "function_names": [
      "compute_vm_nonpersistent_disks_limited",
      "compute_disk_independent_mode_persistent",
      "compute_vm_disk_snapshot_mode_dependent",
      "compute_disk_nonpersistent_avoided",
      "compute_vm_disk_mode_independent_persistent"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://code.vmware.com/apis/196/vsphere#/doc/vim.vm.device.VirtualDiskOpti on.DiskMode.html  180 | P a g e 2. http://pubs.vmware.com/vsphere- 60/topic/com.vmware.vsphere.hostclient.doc/GUID-81629CAB-72FA-42F0-9F86- F8FD0DE39E57.html  181 | P a g e"
  },
  {
    "id": "8.6.2",
    "title": "(L1) Ensure virtual disk shrinking is disabled",
    "assessment": "Scored",
    "description": "If Virtual disk shrinking is done repeatedly it will cause the virtual disk to become unavailable resulting in a denial of service. You can prevent virtual disk shrinking by disabling it.",
    "rationale": "Shrinking a virtual disk reclaims unused space in it. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. Normal users and processes\u2014that is, users and processes without root or administrator privileges\u2014within virtual machines have the capability to invoke this procedure. However, if this is done repeatedly, the virtual disk can become unavailable while this shrinking is being performed, effectively causing a denial of service. In most datacenter environments, disk shrinking is not done, so you should disable this feature. Repeated disk shrinking can make a virtual disk unavailable. This capability is available to nonadministrative users in the guest.",
    "audit": "Check virtual machine configuration file and verify that isolation.tools.diskShrink.disable is set to TRUE. Additionally, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name  \"isolation.tools.diskShrink.disable\"| Select Entity, Name, Value",
    "remediation": "To implement the recommended configuration state, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.diskShrink.disable\" - value $true   182 | P a g e Impact: Inability to shrink virtual machine disks in the event that a datastore runs out of space. Default Value: The prescribed state is not the default state. References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28- 5B34FEB264B6.html  183 | P a g e",
    "function_names": [
      "compute_virtual_disk_shrinking_disabled",
      "compute_vm_disk_shrink_protection_enabled",
      "compute_disk_shrink_operation_blocked",
      "compute_virtual_disk_shrink_prevention_enabled",
      "compute_vm_disk_shrink_disabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "Inability to shrink virtual machine disks in the event that a datastore runs out of space. Default Value: The prescribed state is not the default state.",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142- 18A9E7C592EA.html?hWord=N4IghgNiBcIMoFMDGBXATgSwC4E8AEAwgPYB2Azh gCYJphYall4BmRahpzGA5uhidzwA1ALIB3MGgR4AKkSIQyIAL5A 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28- 5B34FEB264B6.html  183 | P a g e"
  },
  {
    "id": "8.6.3",
    "title": "(L1) Ensure virtual disk wiping is disabled",
    "assessment": "Scored",
    "description": "Wiping a virtual disk reclaims all unused space in it. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. If virtual disk wiping is done repeatedly, it can cause the virtual disk to become unavailable while wiping occurs. In most datacenter environments, disk wiping is not needed, but normal users and processes--without administrative privileges--can issue disk wipes unless the feature is disabled.",
    "rationale": "Virtual disk wiping can effectively cause a denial of service.",
    "audit": "To verify that virtual disk wiping is disabled, check the virtual machine configuration file and verify that isolation.tools.diskWiper.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name  \"isolation.tools.diskWiper.disable\"| Select Entity, Name, Value",
    "remediation": "To disable virtual disk wiping, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.diskWiper.disable\" -value $true References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28- 5B34FEB264B6.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142-18A9E7C592EA.html  184 | P a g e 8.7 Tools",
    "function_names": [
      "compute_virtual_disk_wiping_disabled",
      "compute_disk_wipe_protection_enabled",
      "compute_virtual_disk_reclaim_disabled",
      "compute_disk_wipe_prevention_enabled",
      "compute_virtual_disk_unused_space_reclaim_disabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-9610FE65-3A78-4982-8C28- 5B34FEB264B6.html 2. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142-18A9E7C592EA.html  184 | P a g e 8.7 Tools"
  },
  {
    "id": "8.7.1",
    "title": "(L2) Ensure VIX messages from the VM are disabled",
    "assessment": "Scored",
    "description": "The VIX API is a library for writing scripts and programs to manipulate virtual machines. If you do not make use of custom VIX programming in your environment, then you should disable certain features, such as the ability to send messages from the VM to the host. Disabling that feature does not adversely affect the functioning of VIX operations that originate outside the guest, so certain VMware and third-party solutions that rely upon this capability should continue to work. This is a deprecated interface.",
    "rationale": "Disabling unneeded features reduces the potential for vulnerabilities.",
    "audit": "To verify VIX messages from the VM are disabled, check the VM configuration file and verify that isolation.tools.vixMessage.disable is set to TRUE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"isolation.tools.vixMessage.disable\"| Select Entity, Name, Value",
    "remediation": "To disable VIX messages from the VM, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"isolation.tools.vixMessage.disable\" - value $true References: 1. https://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.vddk.pg.doc%2FvddkTasks.8.8.html  185 | P a g e",
    "function_names": [
      "compute_vm_vix_messages_disabled",
      "compute_vm_vix_api_disabled",
      "compute_vm_host_communication_disabled",
      "compute_vm_deprecated_interface_disabled",
      "compute_vm_vix_guest_to_host_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://pubs.vmware.com/vsphere-6- 5/index.jsp?topic=%2Fcom.vmware.vddk.pg.doc%2FvddkTasks.8.8.html  185 | P a g e"
  },
  {
    "id": "8.7.2",
    "title": "(L1) Ensure the number of VM log files is configured properly",
    "assessment": "Scored",
    "description": "Normally a new log file is created only when a host is rebooted, so the file can grow to be quite large. You can ensure that new log files are created more frequently by limiting the maximum size of the log files. If you want to restrict the total size of logging data, VMware recommends saving 10 log files, each one limited to 1 MB. Each time an entry is written to the log, the size of the log is checked; if it is over the limit, the next entry is written to a new log. If the maximum number of log files already exists, when a new one is created, the oldest log file is deleted.",
    "rationale": "Log files should be rotated to preserve log data in case of corruption or destruction of the current log file, and to avoid the likelihood of logging issues caused by an overly large log file.",
    "audit": "To verify that log files will be created more frequently, check the virtual machine configuration file and verify that log.keepOld is set to 10. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name \"log.keepOld\"| Select Entity, Name, Value",
    "remediation": "To set the number of log files to be used to 10, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"log.keepOld\" -value \"10\" Impact: A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient.  186 | P a g e References: 1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142-18A9E7C592EA.html",
    "function_names": [
      "compute_vm_log_file_size_limited",
      "compute_vm_log_file_count_limited",
      "compute_vm_log_rotation_enabled",
      "compute_vm_log_file_max_size_1mb",
      "compute_vm_log_file_max_count_10"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient.  186 | P a g e",
    "references": "1. https://docs.vmware.com/en/VMware- Tools/10.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-685722FA-9009-439C- 9142-18A9E7C592EA.html"
  },
  {
    "id": "8.7.3",
    "title": "(L2) Ensure host information is not sent to guests",
    "assessment": "Scored",
    "description": "Configure VMware Tools to disable host information from being sent to guests unless a particular VM requires this information for performance monitoring purposes.",
    "rationale": "By enabling a VM to get detailed information about the physical host, an adversary could potentially use this information to inform further attacks on the host.",
    "audit": "To verify host information is not sent to guests, check the virtual machine configuration file and verify that tools.guestlib.enableHostInfo is set to FALSE. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name  \"tools.guestlib.enableHostInfo\"| Select Entity, Name, Value",
    "remediation": "To prevent host information from being sent to guests, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"tools.guestlib.enableHostInfo\" -value $false Default Value: FALSE References: 1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-2CF880DA-2435-4201- 9AFB-A16A11951A2D.html  188 | P a g e",
    "function_names": [
      "compute_vm_host_info_disabled",
      "compute_vm_tools_host_info_blocked",
      "compute_vm_guest_host_info_restricted",
      "compute_vm_tools_performance_monitoring_secure",
      "compute_vm_host_data_transfer_disabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.security.doc/GUID-2CF880DA-2435-4201- 9AFB-A16A11951A2D.html  188 | P a g e"
  },
  {
    "id": "8.7.4",
    "title": "(L1) Ensure VM log file size is limited",
    "assessment": "Scored",
    "description": "Normally a new log file is created only when a host is rebooted, so the file can grow to be quite large. You can ensure that new log files are created more frequently by limiting the maximum size of the log files. If you want to restrict the total size of logging data, VMware recommends saving 10 log files, each one limited to 1 MB. If the maximum number of log files already exists, when a new one is created, the oldest log file is deleted.",
    "rationale": "Virtual machine users and processes can abuse logging either on purpose or inadvertently so that large amounts of data flood the log file. Without restrictions on maximum log file size, over time a log file can consume enough file system space to cause a denial of service.",
    "audit": "To verify the maximum log file size is limited properly, check the virtual machine configuration file and confirm that log.rotateSize is set to 1024000. Alternately, the following PowerCLI command may be used: # List the VMs and their current settings Get-VM | Get-AdvancedSetting -Name  \"log.rotateSize\"| Select Entity, Name, Value",
    "remediation": "To properly limit the maximum log file size, run the following PowerCLI command: # Add the setting to all VMs Get-VM | New-AdvancedSetting -Name \"log.rotateSize\" -value \"1024000\" Impact: A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient.   189 | P a g e References: 1. http://kb.vmware.com/kb/8182749 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.monitoring.doc/GUID-2DD66869-52C7-42C5- 8F5B-145EBD26BBA1.html",
    "function_names": [
      "compute_vm_log_file_size_limited",
      "compute_vm_log_file_size_limited_1mb",
      "compute_vm_log_file_rotation_enabled",
      "compute_vm_log_file_count_limited",
      "compute_vm_log_file_count_limited_10_files",
      "compute_vm_log_file_retention_configured",
      "compute_vm_log_file_max_size_enforced",
      "compute_vm_log_file_rotation_on_size",
      "compute_vm_log_file_storage_optimized",
      "compute_vm_log_file_cleanup_enabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "A more extreme strategy is to disable logging altogether for the virtual machine. Disabling logging makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient.   189 | P a g e",
    "references": "1. http://kb.vmware.com/kb/8182749 2. https://docs.vmware.com/en/VMware- vSphere/6.5/com.vmware.vsphere.monitoring.doc/GUID-2DD66869-52C7-42C5- 8F5B-145EBD26BBA1.html"
  }
]