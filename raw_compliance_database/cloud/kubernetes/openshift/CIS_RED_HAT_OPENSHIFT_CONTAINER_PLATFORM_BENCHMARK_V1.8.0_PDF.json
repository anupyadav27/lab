[
  {
    "id": "1.1.1",
    "title": "Ensure that the API server pod specification file permissions are set to 600 or more restrictive",
    "assessment": "Manual",
    "remediation": "There is no remediation for updating the permissions of kube-apiserver-pod.yaml. The file is owned by an OpenShift operator and any changes to the file will result in a degraded cluster state. Please do not attempt to remediate the permissions of this file. Default Value: By default, in OpenShift 4.14, the kube-apiserver-pod.yaml has permissions of 600. In older versions of OpenShift, the kube-apiserver-pod.yaml has permissions of 644, and is not remediable. Please upgrade to OpenShift 4.14 when possible. References: 1. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#defining-masters_control-plane 2. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- apiserver/ 3. https://github.com/openshift/library- go/commit/19a42d2bae8ba68761cfad72bf764e10d275ad6e CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_api_server_pod_spec_file_permissions_restrictive",
      "kubernetes_api_server_pod_spec_file_permissions_600_or_stricter",
      "kubernetes_api_server_pod_spec_file_permissions_secure",
      "kubernetes_api_server_pod_spec_file_permissions_min_600",
      "kubernetes_api_server_pod_spec_file_permissions_protected"
    ]
  },
  {
    "id": "1.1.2",
    "title": "Ensure that the API server pod specification file ownership is set to root:root",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_api_server_pod_file_ownership_root",
      "kubernetes_api_server_pod_spec_ownership_root",
      "kubernetes_api_server_pod_file_owner_root",
      "kubernetes_api_server_pod_spec_file_owner_root",
      "kubernetes_api_server_pod_file_permissions_root",
      "kubernetes_api_server_pod_spec_file_permissions_root",
      "kubernetes_api_server_pod_file_ownership_correct",
      "kubernetes_api_server_pod_spec_ownership_correct"
    ]
  },
  {
    "id": "1.1.3",
    "title": "Ensure that the controller manager pod specification file permissions are set to 600 or more restrictive",
    "assessment": "Manual",
    "remediation": "There is no remediation for updating the permissions of kube-controller-manager- pod.yaml. The file is owned by an OpenShift operator and any changes to the file will result in a degraded cluster state. Please do not attempt to remediate the permissions of this file. Default Value: By default, in OpenShift 4.14, the kube-controller-manager-pod.yaml has permissions of 600. In older versions of OpenShift, the kube-controller-manager-pod.yaml has permissions of 644, and it not remediable. Please upgrade to OpenShift 4.14 when possible. References: 1. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#defining-masters_control-plane 2. https://github.com/openshift/library- go/commit/19a42d2bae8ba68761cfad72bf764e10d275ad6e 3. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- controller-manager/ CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_controller_manager_pod_spec_file_permissions_restrictive",
      "kubernetes_controller_manager_pod_spec_file_permissions_600_or_stricter",
      "kubernetes_controller_manager_pod_spec_file_permissions_secure",
      "kubernetes_controller_manager_pod_spec_file_permissions_min_600",
      "kubernetes_controller_manager_pod_spec_file_permissions_protected"
    ]
  },
  {
    "id": "1.1.4",
    "title": "Ensure that the controller manager pod specification file ownership is set to root:root",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_controller_manager_pod_file_ownership_root",
      "kubernetes_controller_manager_pod_spec_ownership_root",
      "kubernetes_controller_manager_file_permissions_root",
      "kubernetes_controller_manager_pod_file_owner_root",
      "kubernetes_controller_manager_spec_file_ownership_root"
    ]
  },
  {
    "id": "1.1.5",
    "title": "Ensure that the scheduler pod specification file permissions are set to 600 or more restrictive",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_scheduler_pod_file_permissions_restrictive",
      "kubernetes_scheduler_pod_spec_file_permissions_600",
      "kubernetes_scheduler_pod_file_permissions_secure",
      "kubernetes_scheduler_pod_spec_file_permissions_restricted",
      "kubernetes_scheduler_pod_file_permissions_min_600"
    ]
  },
  {
    "id": "1.1.6",
    "title": "Ensure that the scheduler pod specification file ownership is set to root:root",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#defining-masters_control-plane 2. https://docs.openshift.com/container-platform/latest/operators/operator- reference.html#cluster-kube-scheduler-operator_red-hat-operators 3. https://docs.openshift.com/container-platform/latest/nodes/scheduling/nodes- scheduler-about.html 4. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- scheduler/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account. ● ● ● v7 4.3 Ensure the Use of Dedicated Administrative Accounts Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1026",
    "function_names": [
      "kubernetes_pod_spec_file_owner_root",
      "kubernetes_scheduler_pod_spec_file_owner_root",
      "kubernetes_pod_spec_file_permission_root",
      "kubernetes_scheduler_pod_spec_file_permission_root",
      "kubernetes_pod_spec_file_ownership_root",
      "kubernetes_scheduler_pod_spec_file_ownership_root",
      "kubernetes_pod_spec_file_owner_root_root",
      "kubernetes_scheduler_pod_spec_file_owner_root_root"
    ]
  },
  {
    "id": "1.1.7",
    "title": "Ensure that the etcd pod specification file permissions are set to 600 or more restrictive",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_etcd_pod_spec_file_permissions_restrictive",
      "kubernetes_etcd_pod_spec_file_permissions_600",
      "kubernetes_etcd_pod_spec_file_permissions_secure",
      "etcd_pod_spec_file_permissions_restrictive",
      "etcd_pod_spec_file_permissions_600",
      "etcd_pod_spec_file_permissions_secure"
    ]
  },
  {
    "id": "1.1.8",
    "title": "Ensure that the etcd pod specification file ownership is set to root:root",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://coreos.com/etcd 2. https://kubernetes.io/docs/admin/etcd/ 3. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#defining-masters_control-plane CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account. ● ● ● v7 4.3 Ensure the Use of Dedicated Administrative Accounts Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1026",
    "function_names": [
      "kubernetes_etcd_pod_spec_file_owner_root",
      "kubernetes_etcd_pod_spec_file_group_root",
      "kubernetes_etcd_pod_spec_file_permissions_root_only",
      "kubernetes_etcd_pod_spec_file_ownership_root_root",
      "kubernetes_etcd_pod_spec_file_secure_ownership"
    ]
  },
  {
    "id": "1.1.9",
    "title": "Ensure that the Container Network Interface file permissions are set to 600 or more restrictive",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "container_cni_file_permissions_restrictive",
      "container_cni_file_permissions_600_or_stricter",
      "container_network_interface_file_permissions_restrictive",
      "container_network_interface_file_permissions_600_or_stricter",
      "container_cni_config_file_permissions_restrictive",
      "container_cni_config_file_permissions_600_or_stricter"
    ]
  },
  {
    "id": "1.1.10",
    "title": "Ensure that the Container Network Interface file ownership is set to root:root",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/networking/cluster-network- operator.html 2. https://kubernetes.io/docs/concepts/cluster-administration/networking/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account. ● ● ● v7 4.3 Ensure the Use of Dedicated Administrative Accounts Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1026",
    "function_names": [
      "container_network_interface_file_ownership_root",
      "container_network_interface_file_owner_root",
      "container_network_interface_file_group_root",
      "container_network_interface_file_permissions_root_only",
      "container_network_interface_file_secure_ownership"
    ]
  },
  {
    "id": "1.1.11",
    "title": "Ensure that the etcd data directory permissions are set to 700 or more restrictive",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/4.3/architecture/control- plane.html#defining-masters_control-plane 2. https://etcd.io/#data-dir 3. https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user’s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. ● ● ● v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1022",
    "function_names": [
      "etcd_data_directory_permissions_restrictive",
      "etcd_data_directory_permissions_700_or_stricter",
      "etcd_directory_permissions_secure",
      "etcd_data_directory_access_restricted",
      "etcd_directory_permissions_700_or_less"
    ]
  },
  {
    "id": "1.1.12",
    "title": "Ensure that the etcd data directory ownership is set to etcd:etcd",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "etcd_data_directory_ownership_etcd_etcd",
      "etcd_data_directory_correct_ownership",
      "etcd_directory_ownership_restricted",
      "etcd_data_directory_secure_ownership",
      "etcd_directory_ownership_etcd_user_group"
    ]
  },
  {
    "id": "1.1.13",
    "title": "Ensure that the kubeconfig file permissions are set to 600 or more restrictive",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container- platform/4.5/cli_reference/openshift_cli/administrator-cli-commands.html 2. https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create- cluster-kubeadm/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user’s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. ● ● ● v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1022",
    "function_names": [
      "kubernetes_kubeconfig_file_permissions_restrictive",
      "kubernetes_kubeconfig_file_permissions_600",
      "kubernetes_kubeconfig_file_permissions_secure",
      "kubernetes_kubeconfig_file_permissions_strict",
      "kubernetes_kubeconfig_file_permissions_min_600"
    ]
  },
  {
    "id": "1.1.14",
    "title": "Ensure that the kubeconfig file ownership is set to root:root",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_kubeconfig_file_ownership_root",
      "kubernetes_kubeconfig_file_owner_root",
      "kubernetes_config_file_ownership_root_root",
      "kubernetes_config_file_owner_root",
      "kubernetes_kubeconfig_file_permissions_root_only"
    ]
  },
  {
    "id": "1.1.15",
    "title": "Ensure that the Scheduler kubeconfig file permissions are set to 600 or more restrictive",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/operators/operator- reference.html#cluster-kube-scheduler-operator_red-hat-operators 2. https://docs.openshift.com/container-platform/latest/nodes/scheduling/nodes- scheduler-about.html 3. https://kubernetes.io/docs/concepts/scheduling-eviction/kube-scheduler/ 4. https://issues.redhat.com//browse/OCPBUGS-14323 CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user’s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. ● ● ● v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1022",
    "function_names": [
      "scheduler_kubeconfig_file_permissions_restrictive",
      "scheduler_kubeconfig_file_permissions_600",
      "scheduler_kubeconfig_file_permissions_secure",
      "scheduler_kubeconfig_file_permissions_strict",
      "scheduler_kubeconfig_file_permissions_min_600"
    ]
  },
  {
    "id": "1.1.16",
    "title": "Ensure that the Scheduler kubeconfig file ownership is set to root:root",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "scheduler_kubeconfig_file_owner_root",
      "scheduler_kubeconfig_file_group_root",
      "scheduler_kubeconfig_file_permissions_secure",
      "scheduler_kubeconfig_file_ownership_root_root",
      "scheduler_kubeconfig_file_access_restricted"
    ]
  },
  {
    "id": "1.1.17",
    "title": "Ensure that the Controller Manager kubeconfig file permissions are set to 600 or more restrictive",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_controller_manager_kubeconfig_permissions_restrictive",
      "kubernetes_controller_manager_kubeconfig_permissions_600",
      "kubernetes_controller_manager_kubeconfig_file_permissions_secure",
      "kubernetes_controller_manager_kubeconfig_file_permissions_restricted",
      "kubernetes_controller_manager_kubeconfig_file_permissions_600_or_stricter"
    ]
  },
  {
    "id": "1.1.18",
    "title": "Ensure that the Controller Manager kubeconfig file ownership is set to root:root",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_controller_manager_kubeconfig_owner_root",
      "kubernetes_controller_manager_kubeconfig_group_root",
      "kubernetes_controller_manager_kubeconfig_ownership_root_root",
      "kubernetes_controller_manager_file_owner_root",
      "kubernetes_controller_manager_file_group_root",
      "kubernetes_controller_manager_file_ownership_root_root",
      "kubernetes_controller_manager_kubeconfig_file_owner_root",
      "kubernetes_controller_manager_kubeconfig_file_group_root",
      "kubernetes_controller_manager_kubeconfig_file_ownership_root_root",
      "kubernetes_controller_manager_config_file_owner_root",
      "kubernetes_controller_manager_config_file_group_root",
      "kubernetes_controller_manager_config_file_ownership_root_root"
    ]
  },
  {
    "id": "1.1.19",
    "title": "Ensure that the OpenShift PKI directory and file ownership is set to root:root",
    "assessment": "Manual",
    "remediation": "No remediation required; file permissions are managed by the operator. Default Value: By default, the static-pod-resources/secrets and static-pod-certs directories and all of the files and directories contained within it, are set to be owned by the root user. References: 1. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- apiserver/ CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "compute_pki_directory_ownership_root",
      "compute_pki_file_ownership_root",
      "openshift_pki_directory_ownership_root",
      "openshift_pki_file_ownership_root",
      "container_pki_directory_ownership_root",
      "container_pki_file_ownership_root"
    ]
  },
  {
    "id": "1.1.20",
    "title": "Ensure that the OpenShift PKI certificate file permissions are set to 600 or more restrictive",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- apiserver/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user’s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. ● ● ● v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1022",
    "function_names": [
      "compute_openshift_pki_certificate_file_permissions_restrictive",
      "compute_openshift_pki_certificate_file_permissions_600",
      "compute_openshift_pki_certificate_file_permissions_secure",
      "compute_openshift_pki_certificate_file_permissions_strict",
      "compute_openshift_pki_certificate_file_permissions_min_600"
    ]
  },
  {
    "id": "1.1.21",
    "title": "Ensure that the OpenShift PKI key file permissions are set to 600",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- apiserver/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user’s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. ● ● ● v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1022 1.2 API Server This section contains recommendations relating to API server configuration flags. OpenShift includes two API servers, the OpenShift API server and the Kubernetes API server. All API calls are directed to the Open Shift API server and then Kubernetes objects are delegated to kube-apiserver. The cluster configuration resource (CR) APIServer holds configuration settings (like serving certificates, client CA and CORS domains) shared by all API servers in the system, among them especially kube-apiserver and openshift-apiserver. The canonical name of an instance is 'cluster'. Changes to the API server configurations should be done in the APIServer custom resource definition (CRD): apiservers.config.openshift.io The OpenShift API Server is managed by the openshift-apiserver-operator The Kubernetes API Server is managed by the openshift-kube-apiserver- operator Both are managed by the Cluster Version Operator",
    "function_names": [
      "openshift_pki_key_file_permissions_600",
      "openshift_pki_key_file_restrictive_permissions",
      "openshift_pki_key_file_secure_permissions",
      "openshift_pki_key_file_permissions_restricted",
      "openshift_pki_key_file_permissions_strict"
    ]
  },
  {
    "id": "1.2.1",
    "title": "Ensure that anonymous requests are authorized",
    "assessment": "Manual",
    "remediation": "None. The default configuration should not be modified. Default Value: By default, anonymous access is enabled and assigned to the system:unauthenticated group, which allows the system to determine which actions are allowed. If the default behavior is changed, platform components will not work properly, in particular Elasticsearch and Prometheus. The oauth-proxy deployed as part of these components makes anonymous use of /.well-known/oauth-authorization-server endpoint, granted by system:discovery role. References: 1. https://docs.openshift.com/container-platform/4.5/authentication/understanding- authentication.html 2. https://docs.openshift.com/container-platform/4.5/authentication/using-rbac.html 3. https://docs.openshift.com/container-platform/4.5/operators/operator- reference.html#cluster-authentication-operator_red-hat-operators 4. https://docs.openshift.com/container-platform/4.5/operators/operator- reference.html#kube-apiserver-operator_red-hat-operators 5. https://docs.openshift.com/container-platform/4.5/operators/operator- reference.html#openshift-apiserver-operator_red-hat-operators 6. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- apiserver/ 7. https://kubernetes.io/docs/reference/access-authn- authz/authentication/#anonymous-requests CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "s3_bucket_anonymous_access_blocked",
      "s3_bucket_public_access_restricted",
      "s3_bucket_anonymous_requests_authorized",
      "s3_bucket_all_users_denied",
      "s3_bucket_anonymous_principal_blocked",
      "s3_bucket_public_policy_restricted",
      "s3_bucket_anonymous_permissions_disabled",
      "s3_bucket_unauthenticated_access_denied"
    ]
  },
  {
    "id": "1.2.2",
    "title": "Use https for kubelet connections",
    "assessment": "Manual",
    "remediation": "No remediation is required. OpenShift platform components use X.509 certificates for authentication. OpenShift manages the CAs and certificates for platform components. This is not configurable. Default Value: By default, kubelet connections are encrypted. References: 1. https://docs.openshift.com/container-platform/latest/operators/operator- reference.html#kube-apiserver-operator_red-hat-operators 2. https://docs.openshift.com/container-platform/latest/operators/operator- reference.html#openshift-apiserver-operator_red-hat-operators 3. https://github.com/openshift/cluster-kube-apiserver-operator/blob/release- 4.13/bindata/assets/config/defaultconfig.yaml#L124-L127 4. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- apiserver/ 5. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet- authentication-authorization/ CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_kubelet_https_enabled",
      "kubernetes_kubelet_tls_configured",
      "kubernetes_kubelet_secure_connection_required",
      "kubernetes_kubelet_insecure_bind_address_disabled",
      "kubernetes_kubelet_tls_certificate_valid",
      "kubernetes_kubelet_anonymous_auth_disabled",
      "kubernetes_kubelet_read_only_port_disabled",
      "kubernetes_kubelet_tls_min_version_1_2",
      "kubernetes_kubelet_api_https_only",
      "kubernetes_kubelet_insecure_http_disabled"
    ]
  },
  {
    "id": "1.2.3",
    "title": "Ensure that the kubelet uses certificates to authenticate",
    "assessment": "Manual",
    "remediation": "No remediation is required. OpenShift platform components use X.509 certificates for authentication. OpenShift manages the CAs and certificates for platform components. This is not configurable. Default Value: By default, kubelet authentication is managed with X.509 certificates. References: 1. https://github.com/openshift/cluster-kube-apiserver-operator/blob/release- 4.13/bindata/assets/config/defaultconfig.yaml#L124-L127 2. https://kubernetes.io/docs/admin/kube-apiserver/ 3. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet- authentication-authorization/ 4. https://kubernetes.io/docs/concepts/architecture/control-plane-node- communication/ 5. https://docs.openshift.com/container-platform/4.13/operators/operator- reference.html#kube-apiserver-operator_red-hat-operators 6. https://docs.openshift.com/container-platform/4.13/operators/operator- reference.html#openshift-apiserver-operator_red-hat-operators CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_kubelet_certificate_authentication_enabled",
      "kubernetes_kubelet_tls_authentication_required",
      "kubernetes_kubelet_client_certificate_validation_enabled",
      "kubernetes_kubelet_secure_authentication_methods_enabled",
      "kubernetes_kubelet_x509_authentication_enabled"
    ]
  },
  {
    "id": "1.2.4",
    "title": "Verify that the kubelet certificate authority is set as appropriate",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_kubelet_certificate_authority_valid",
      "kubernetes_kubelet_ca_configured",
      "kubernetes_kubelet_ca_trusted",
      "kubernetes_kubelet_ca_appropriate",
      "kubernetes_kubelet_ca_correctly_set"
    ]
  },
  {
    "id": "1.2.5",
    "title": "Ensure that the --authorization-mode argument is not set to AlwaysAllow",
    "assessment": "Manual",
    "remediation": "None. RBAC is always on and the OpenShift API server does not use the values assigned to the flag authorization-mode. Default Value: OpenShift uses RBAC by default. References: 1. https://docs.openshift.com/container-platform/4.5/authentication/using-rbac.html 2. https://docs.openshift.com/container-platform/4.5/operators/operator- reference.html#kube-apiserver-operator_red-hat-operators 3. https://docs.openshift.com/container-platform/4.5/operators/operator- reference.html#openshift-apiserver-operator_red-hat-operators 4. https://kubernetes.io/docs/admin/kube-apiserver/ 5. https://kubernetes.io/docs/reference/access-authn-authz/authorization/ CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "eks_cluster_authorization_mode_restricted",
      "eks_cluster_no_always_allow_auth",
      "eks_cluster_auth_mode_secure",
      "eks_cluster_auth_mode_not_always_allow",
      "eks_cluster_authorization_mode_compliant"
    ]
  },
  {
    "id": "1.2.6",
    "title": "Verify that RBAC is enabled",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "iam_role_rbac_enabled",
      "iam_policy_rbac_enabled",
      "iam_user_rbac_enabled",
      "iam_group_rbac_enabled",
      "iam_service_account_rbac_enabled",
      "compute_instance_iam_rbac_enabled",
      "cloud_cdn_rbac_enabled",
      "storage_bucket_iam_rbac_enabled",
      "database_instance_iam_rbac_enabled",
      "kubernetes_cluster_rbac_enabled"
    ]
  },
  {
    "id": "1.2.7",
    "title": "Ensure that the APIPriorityAndFairness feature gate is enabled",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_api_priority_and_fairness_enabled",
      "kubernetes_api_feature_gate_enabled",
      "kubernetes_api_fairness_enabled",
      "kubernetes_feature_gate_priority_enabled",
      "kubernetes_api_priority_enabled"
    ]
  },
  {
    "id": "1.2.8",
    "title": "Ensure that the admission control plugin AlwaysAdmit is not set",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_admission_controller_always_admit_disabled",
      "kubernetes_admission_plugin_always_admit_not_set",
      "admission_controller_always_admit_restricted",
      "kubernetes_admission_policy_always_admit_removed",
      "admission_plugin_always_admit_prohibited"
    ]
  },
  {
    "id": "1.2.9",
    "title": "Ensure that the admission control plugin AlwaysPullImages is not set",
    "assessment": "Manual",
    "audit": "Use the following command to obtain a list of configured admission controllers: oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data.\"config.yaml\"' | jq '.apiServerArguments.\"enable-admission-plugins\"' Verify the list does not include AlwaysPullImages. Remediation: None. Default Value: When OpenShift Container Platform creates containers, it uses the container’s imagePullPolicy to determine if the image should be pulled prior to starting the container. References: 1. https://docs.openshift.com/container- platform/latest/openshift_images/managing_images/image-pull-policy.html 2. https://docs.openshift.com/container-platform/latest/architecture/admission-plug- ins.html 3. https://github.com/openshift/cluster-kube-apiserver-operator/blob/release- 4.6/bindata/v4.1.0/config/defaultconfig.yaml#L34-L78 4. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- apiserver/ 5. https://kubernetes.io/docs/reference/access-authn-authz/admission- controllers/#alwayspullimages CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user’s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. ● ● ● v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. ● ● ●  MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1610 TA0002 M1038, M1050",
    "description": "",
    "rationale": "",
    "remediation": null,
    "function_names": [
      "kubernetes_admission_controller_always_pull_images_disabled",
      "kubernetes_pod_admission_always_pull_images_not_set",
      "admission_controller_always_pull_images_unconfigured",
      "pod_security_admission_always_pull_images_disabled",
      "kubernetes_admission_plugin_always_pull_images_absent"
    ]
  },
  {
    "id": "1.2.10",
    "title": "Ensure that the admission control plugin ServiceAccount is set",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_admission_controller_service_account_enabled",
      "kubernetes_service_account_admission_plugin_enabled",
      "admission_controller_service_account_required",
      "service_account_admission_plugin_active",
      "kubernetes_admission_service_account_enforced"
    ]
  },
  {
    "id": "1.2.11",
    "title": "Ensure that the admission control plugin NamespaceLifecycle is set",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_admission_control_namespace_lifecycle_enabled",
      "kubernetes_admission_plugin_namespace_lifecycle_configured",
      "kubernetes_admission_controller_namespace_lifecycle_active",
      "kubernetes_admission_policy_namespace_lifecycle_enforced",
      "kubernetes_admission_rule_namespace_lifecycle_required"
    ]
  },
  {
    "id": "1.2.12",
    "title": "Ensure that the admission control plugin SecurityContextConstraint is set",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_admission_controller_security_context_constraint_enabled",
      "kubernetes_pod_security_context_constraint_enabled",
      "openshift_admission_controller_security_context_constraint_enabled",
      "openshift_pod_security_context_constraint_enabled",
      "kubernetes_admission_plugin_security_context_constraint_required",
      "openshift_admission_plugin_security_context_constraint_required"
    ]
  },
  {
    "id": "1.2.13",
    "title": "Ensure that the admission control plugin NodeRestriction is set",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_admission_controller_node_restriction_enabled",
      "kubernetes_admission_plugin_node_restriction_active",
      "admission_control_node_restriction_required",
      "kubernetes_node_restriction_admission_enabled",
      "admission_plugin_node_restriction_enforced"
    ]
  },
  {
    "id": "1.2.14",
    "title": "Ensure that the --insecure-bind-address argument is not set",
    "assessment": "Manual",
    "remediation": "None. Default Value: By default, the openshift-kube-apiserver is served over HTTPS with authentication and authorization; the secure API endpoint is bound to 0.0.0.0:6443. Note that the openshift-apiserver is not running in the host network namespace. The port is not exposed on the node, but only through the pod network. References: 1. https://github.com/openshift/cluster-kube-apiserver-operator/blob/release- 4.5/bindata/v4.1.0/config/defaultconfig.yaml#L104-L105 2. https://docs.openshift.com/container-platform/4.5/operators/operator- reference.html#kube-apiserver-operator_red-hat-operators 3. https://docs.openshift.com/container-platform/4.5/operators/operator- reference.html#openshift-apiserver-operator_red-hat-operators 4. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- apiserver/ CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_api_server_insecure_bind_address_disabled",
      "kubernetes_api_server_bind_address_secure",
      "kubernetes_api_server_insecure_argument_unset",
      "kubernetes_api_server_secure_bind_configuration",
      "kubernetes_api_server_insecure_flag_removed"
    ]
  },
  {
    "id": "1.2.15",
    "title": "Ensure that the --insecure-port argument is set to 0",
    "assessment": "Manual",
    "audit": "The openshift-kube-apiserver is served over HTTPS with authentication and authorization; the secure API endpoint is bound to 0.0.0.0:6443 by default. By default the insecure-port argument is set to 0. Note that the openshift-apiserver is not running in the host network namespace. The port is not exposed on the node, but only through the pod network. Run the following command: oc -n openshift-kube-apiserver get endpoints -o jsonpath='{.items[*].subsets[*].ports[*].port}' Verify the return value is 6443. Remediation: None. Default Value: By default, the openshift-kube-server is served over HTTPS with authentication and authorization; the secure API endpoint is bound to 0.0.0.0:6443 and the insecure- port has been removed in Kubernetes 1.20+. References: 1. https://github.com/openshift/cluster-kube-apiserver-operator/blob/release- 4.6/bindata/v4.1.0/config/defaultconfig.yaml#L102-L103 2. https://github.com/openshift/cluster-kube-apiserver-operator/blob/release- 4.5/bindata/v4.1.0/config/defaultconfig.yaml#L103-L105 3. https://github.com/openshift/cluster-kube-apiserver-operator/blob/release- 4.5/bindata/v4.1.0/kube-apiserver/pod.yaml#L155-L157 4. https://docs.openshift.com/container-platform/4.5/operators/operator- reference.html#kube-apiserver-operator_red-hat-operators 5. https://docs.openshift.com/container-platform/4.5/operators/operator- reference.html#openshift-apiserver-operator_red-hat-operators 6. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- apiserver/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 16.11 Leverage Vetted Modules or Services for Application Security Components Leverage vetted modules or services for application security components, such as identity management, encryption, and auditing and logging. Using platform features in critical security functions will reduce developers’ workload and minimize the likelihood of design or implementation errors. Modern operating systems provide effective mechanisms for identification, authentication, and authorization and make those mechanisms available to applications. Use only standardized, currently accepted, and extensively reviewed encryption algorithms. Operating systems also provide mechanisms to create and maintain secure audit logs. ● ● v7 9.4 Apply Host-based Firewalls or Port Filtering Apply host-based firewalls or port filtering tools on end systems, with a default- deny rule that drops all traffic except those services and ports that are explicitly allowed. ● ● ●  MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1609 TA0002 M1035",
    "description": "",
    "rationale": "",
    "remediation": null,
    "function_names": [
      "kubernetes_api_server_insecure_port_disabled",
      "kubernetes_api_server_insecure_port_zero",
      "kubernetes_api_server_secure_port_enabled",
      "kubernetes_api_server_insecure_port_unset",
      "kubernetes_api_server_port_security_enabled"
    ]
  },
  {
    "id": "1.2.16",
    "title": "Ensure that the --secure-port argument is not set to 0",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_api_server_secure_port_not_disabled",
      "kubernetes_api_server_secure_port_valid",
      "kubernetes_api_server_secure_port_configured",
      "kubernetes_api_server_secure_port_non_zero",
      "kubernetes_api_server_secure_port_enabled"
    ]
  },
  {
    "id": "1.2.17",
    "title": "Ensure that the healthz endpoint is protected by RBAC",
    "assessment": "Manual",
    "remediation": "None. Default Value: By default, profiling is enabled and protected by RBAC. References: 1. https://github.com/openshift/kubernetes- kubelet/blob/master/config/v1beta1/types.go#L259-L277 2. https://github.com/openshift/cluster-kube-apiserver-operator/blob/release- 4.5/bindata/v4.1.0/kube-apiserver/pod.yaml#L71-L84 3. https://docs.openshift.com/container-platform/latest/operators/operator- reference.html#kube-apiserver-operator_red-hat-operators 4. https://docs.openshift.com/container-platform/latest/operators/operator- reference.html#openshift-apiserver-operator_red-hat-operators 5. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- apiserver/ 6. https://github.com/kubernetes/community/blob/master/contributors/devel/profiling. md CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "compute_healthz_endpoint_rbac_protected",
      "compute_healthz_endpoint_access_restricted",
      "compute_endpoint_rbac_enabled",
      "compute_healthz_endpoint_auth_required",
      "compute_endpoint_rbac_enforced"
    ]
  },
  {
    "id": "1.2.18",
    "title": "Ensure that the --audit-log-path argument is set",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_api_server_audit_log_path_enabled",
      "kubernetes_api_server_audit_log_path_configured",
      "kubernetes_api_server_audit_log_path_set",
      "kubernetes_audit_log_path_defined",
      "kubernetes_audit_log_path_specified"
    ]
  },
  {
    "id": "1.2.19",
    "title": "Ensure that the audit logs are forwarded off the cluster for retention",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "gke_cluster_audit_logs_forwarded",
      "gke_cluster_audit_logs_retention_enabled",
      "gke_cluster_audit_logs_external_export",
      "gke_cluster_audit_logs_remote_storage",
      "gke_cluster_audit_logs_non_cluster_storage",
      "gke_cluster_audit_logs_long_term_retention",
      "gke_cluster_audit_logs_centralized",
      "gke_cluster_audit_logs_immutable_storage"
    ]
  },
  {
    "id": "1.2.20",
    "title": "Ensure that the maximumRetainedFiles argument is set to 10 or as appropriate",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "cloudtrail_trail_max_retained_files_set",
      "cloudtrail_trail_max_retained_files_limited",
      "cloudtrail_trail_retained_files_threshold",
      "cloudtrail_trail_retained_files_compliant",
      "cloudtrail_trail_retained_files_enforced"
    ]
  },
  {
    "id": "1.2.21",
    "title": "Configure Kubernetes API Server Maximum Audit Log Size",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_api_server_audit_log_size_configured",
      "kubernetes_api_server_audit_log_size_limited",
      "kubernetes_api_server_audit_log_max_size_set",
      "kubernetes_api_server_audit_log_size_within_limit",
      "kubernetes_api_server_audit_log_size_compliant"
    ]
  },
  {
    "id": "1.2.22",
    "title": "Ensure that the --request-timeout argument is set",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_api_server_request_timeout_set",
      "kubernetes_api_server_request_timeout_configured",
      "kubernetes_api_server_request_timeout_enabled",
      "kubernetes_api_server_request_timeout_valid",
      "kubernetes_api_server_request_timeout_non_default"
    ]
  },
  {
    "id": "1.2.23",
    "title": "Ensure that the --service-account-lookup argument is set to true",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null
  },
  {
    "id": "1.2.24",
    "title": "Ensure that the --service-account-key-file argument is set as appropriate",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_instance_service_account_key_file_secure",
      "compute_instance_service_account_key_file_restricted",
      "compute_instance_service_account_key_file_protected",
      "compute_instance_service_account_key_file_configured",
      "compute_instance_service_account_key_file_validated",
      "compute_instance_service_account_key_file_encrypted",
      "compute_instance_service_account_key_file_minimal_access",
      "compute_instance_service_account_key_file_appropriate_permissions"
    ]
  },
  {
    "id": "1.2.25",
    "title": "Ensure that the --etcd-certfile and --etcd-keyfile arguments are set as appropriate",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_etcd_certfile_configured",
      "kubernetes_etcd_keyfile_configured",
      "kubernetes_etcd_tls_authentication_enabled",
      "kubernetes_etcd_secure_communication_enabled",
      "kubernetes_etcd_certificate_validation_enabled"
    ]
  },
  {
    "id": "1.2.26",
    "title": "Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate",
    "assessment": "Manual",
    "remediation": "None. Default Value: By default, OpenShift uses X.509 certificates to provide secure connections between the API server and node/kubelet. OpenShift does not use values assigned to the tls- cert-file or tls-private-key-file flags. You may optionally set a custom default certificate to be used by the API server when serving content in order to enable clients to access the API server at a different host name or without the need to distribute the cluster-managed certificate authority (CA) certificates to the clients. Follow the directions in the OpenShift documentation User-provided certificates for the API server References: 1. https://docs.openshift.com/container-platform/latest/security/certificates/api- server.html 2. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- apiserver/ 3. https://rootsquash.com/2016/05/10/securing-the-kubernetes-api/ 4. https://github.com/kelseyhightower/docker-kubernetes-tls-guide CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_api_server_tls_cert_file_set",
      "kubernetes_api_server_tls_private_key_file_set",
      "kubernetes_api_server_tls_cert_and_key_files_configured",
      "kubernetes_api_server_tls_cert_file_valid",
      "kubernetes_api_server_tls_private_key_file_valid",
      "kubernetes_api_server_tls_cert_and_key_files_matching",
      "kubernetes_api_server_tls_cert_file_not_expired",
      "kubernetes_api_server_tls_private_key_file_secure_permissions",
      "kubernetes_api_server_tls_cert_file_secure_permissions",
      "kubernetes_api_server_tls_cert_and_key_files_appropriate_path"
    ]
  },
  {
    "id": "1.2.27",
    "title": "Ensure that the --client-ca-file argument is set as appropriate",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_api_server_client_ca_file_set",
      "kubernetes_api_server_client_ca_file_configured",
      "kubernetes_api_server_client_ca_file_valid",
      "kubernetes_api_server_client_ca_file_secure",
      "kubernetes_api_server_client_ca_file_properly_set"
    ]
  },
  {
    "id": "1.2.28",
    "title": "Ensure that the --etcd-cafile argument is set as appropriate",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_etcd_cafile_configured",
      "kubernetes_etcd_cafile_valid",
      "kubernetes_etcd_cafile_secure",
      "kubernetes_etcd_cafile_present",
      "kubernetes_etcd_cafile_correct_path",
      "kubernetes_etcd_cafile_trusted",
      "kubernetes_etcd_cafile_not_expired",
      "kubernetes_etcd_cafile_properly_set"
    ]
  },
  {
    "id": "1.2.29",
    "title": "Ensure that encryption providers are appropriately configured",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "cloud_cdn_domain_encryption_enabled",
      "cloud_cdn_domain_tls_min_version_1_2",
      "cloud_cdn_domain_custom_certificate_valid",
      "cloud_cdn_domain_quic_protocol_enabled",
      "cloud_cdn_domain_http2_protocol_enabled",
      "cloud_cdn_domain_ocsp_stapling_enabled",
      "cloud_cdn_domain_cipher_suite_secure",
      "cloud_cdn_domain_hsts_enabled",
      "cloud_cdn_domain_ssl_certificate_not_expired",
      "cloud_cdn_domain_ssl_certificate_trusted_ca"
    ]
  },
  {
    "id": "1.2.30",
    "title": "Ensure that the API Server only makes use of Strong Cryptographic Ciphers",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_api_server_strong_ciphers_enabled",
      "kubernetes_api_server_weak_ciphers_disabled",
      "kubernetes_api_server_tls_min_version_1_2",
      "kubernetes_api_server_cipher_suites_restricted",
      "kubernetes_api_server_insecure_ciphers_removed",
      "kubernetes_api_server_cryptographic_policy_enforced",
      "kubernetes_api_server_secure_cipher_list_configured"
    ]
  },
  {
    "id": "1.2.31",
    "title": "Ensure unsupported configuration overrides are not used",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "cloudformation_stack_no_unsupported_overrides",
      "cloudformation_stack_supported_config_only",
      "cloudformation_stack_override_validation",
      "cloudformation_stack_compliance_overrides_disabled",
      "cloudformation_stack_approved_config_only"
    ]
  },
  {
    "id": "1.3.1",
    "title": "Ensure that controller manager healthz endpoints are protected by RBAC",
    "assessment": "Manual",
    "remediation": "None. Default Value: By default, the operator exposes metrics via metrics service. The metrics are collected from the OpenShift Controller Manager and the Kubernetes Controller Manager and protected by RBAC. References: 1. https://docs.openshift.com/container-platform/latest/monitoring/monitoring- overview.html 2. https://github.com/openshift/cluster-kube-controller-manager- operator/tree/master 3. https://github.com/openshift/cluster-kube-controller-manager- operator/blob/release-4.5/bindata/bootkube/bootstrap-manifests/kube-controller- manager-pod.yaml 4. https://github.com/openshift/cluster-kube-controller-manager- operator/blob/release-4.5/bindata/bootkube/manifests/00_openshift-kube- controller-manager-ns.yaml 5. https://github.com/openshift/cluster-kube-controller-manager- operator/blob/release-4.5/bindata/v4.1.0/kube-controller-manager/kubeconfig- cm.yaml 6. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- controller-manager/ 7. https://github.com/kubernetes/community/blob/master/contributors/devel/sig- scalability/profiling.md CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_controller_manager_healthz_endpoint_rbac_protected",
      "kubernetes_controller_manager_healthz_endpoint_access_restricted",
      "kubernetes_controller_manager_healthz_endpoint_authentication_required",
      "kubernetes_controller_manager_healthz_endpoint_authorization_enabled",
      "kubernetes_controller_manager_healthz_endpoint_rbac_enforced"
    ]
  },
  {
    "id": "1.3.2",
    "title": "Ensure that the --use-service-account-credentials argument is set to true",
    "assessment": "Manual",
    "remediation": "None. Default Value: By default, in OpenShift 4 --use-service-account-credentials is set to true. The OpenShift Controller Manager operator manages and updates the OpenShift Controller Manager. The Kubernetes Controller Manager operator manages and updates the Kubernetes Controller Manager deployed on top of OpenShift. This operator is configured via KubeControllerManager custom resource. References: 1. https://docs.openshift.com/container-platform/latest/operators/operator- reference.html 2. https://github.com/openshift/cluster-kube-controller-manager- operator/tree/master 3. https://github.com/openshift/cluster-kube-controller-manager- operator/blob/release-4.5/bindata/bootkube/bootstrap-manifests/kube-controller- manager-pod.yaml 4. https://github.com/openshift/cluster-kube-controller-manager- operator/blob/release-4.5/bindata/bootkube/config/bootstrap-config- overrides.yaml 5. https://github.com/openshift/cluster-kube-controller-manager- operator/blob/release-4.5/bindata/v4.1.0/kube-controller-manager/kubeconfig- cm.yaml 6. https://github.com/openshift/cluster-openshift-controller-manager- operator/blob/release-4.5/bindata/v3.11.0/openshift-controller-manager/ds.yaml 7. https://github.com/openshift/cluster-openshift-controller-manager- operator/blob/release-4.5/bindata/v3.11.0/openshift-controller-manager/sa.yaml 8. https://github.com/openshift/cluster-openshift-controller-manager- operator/blob/release-4.5/bindata/v3.11.0/openshift-controller-manager/separate- sa-role.yaml 9. https://github.com/openshift/cluster-openshift-controller-manager- operator/blob/release-4.5/bindata/v3.11.0/openshift-controller-manager/separate- sa-rolebinding.yaml 10. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- controller-manager/ 11. https://kubernetes.io/docs/reference/access-authn-authz/service-accounts- admin/ 12. https://github.com/kubernetes/kubernetes/blob/release- 1.6/plugin/pkg/auth/authorizer/rbac/bootstrappolicy/testdata/controller-roles.yaml 13. https://github.com/kubernetes/kubernetes/blob/release- 1.6/plugin/pkg/auth/authorizer/rbac/bootstrappolicy/testdata/controller-role- bindings.yaml 14. https://kubernetes.io/docs/reference/access-authn-authz/rbac/#controller-roles CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "gke_cluster_use_service_account_credentials_enabled",
      "gke_cluster_service_account_credentials_required",
      "gke_cluster_credentials_service_account_enforced",
      "gke_cluster_service_account_credentials_mandatory",
      "gke_cluster_use_service_account_credentials_set_true"
    ]
  },
  {
    "id": "1.3.3",
    "title": "Ensure that the --service-account-private-key-file argument is set as appropriate",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "gke_cluster_service_account_private_key_file_configured",
      "gke_cluster_service_account_private_key_file_secure",
      "gke_cluster_service_account_private_key_file_protected",
      "gke_cluster_service_account_private_key_file_restricted",
      "gke_cluster_service_account_private_key_file_valid",
      "gke_cluster_service_account_private_key_file_encrypted",
      "gke_cluster_service_account_private_key_file_access_controlled",
      "gke_cluster_service_account_private_key_file_min_permissions",
      "gke_cluster_service_account_private_key_file_no_public_access",
      "gke_cluster_service_account_private_key_file_rotated_regularly"
    ]
  },
  {
    "id": "1.3.4",
    "title": "Ensure that the --root-ca-file argument is set as appropriate",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_cluster_root_ca_file_configured",
      "kubernetes_cluster_root_ca_file_valid",
      "kubernetes_cluster_root_ca_file_secure",
      "kubernetes_cluster_root_ca_file_trusted",
      "kubernetes_cluster_root_ca_file_protected"
    ]
  },
  {
    "id": "1.4.1",
    "title": "Ensure that the healthz endpoints for the scheduler are protected by RBAC",
    "assessment": "Manual",
    "remediation": "None. Default Value: By default, profiling is enabled and protected by RBAC. References: 1. https://github.com/openshift/cluster-kube-scheduler-operator 2. https://github.com/openshift/cluster-kube-scheduler-operator/blob/release- 4.5/bindata/v4.1.0/kube-scheduler/svc.yaml 3. https://github.com/openshift/cluster-kube-scheduler-operator/blob/release- 4.5/bindata/v4.1.0/kube-scheduler/pod.yaml 4. https://github.com/openshift/cluster-kube-scheduler-operator/blob/release- 4.5/bindata/v4.1.0/kube-scheduler/pod.yaml#L32-L37 5. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- scheduler/ 6. https://github.com/kubernetes/community/blob/master/contributors/devel/profiling. md CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_scheduler_healthz_rbac_protected",
      "kubernetes_scheduler_endpoint_rbac_enabled",
      "kubernetes_scheduler_healthz_access_restricted",
      "kubernetes_scheduler_endpoint_auth_required",
      "kubernetes_scheduler_healthz_rbac_enforced"
    ]
  },
  {
    "id": "1.4.2",
    "title": "Verify that the scheduler API service is protected by RBAC",
    "assessment": "Manual",
    "remediation": "None. Default Value: By default, the --bind-address parameter is not used and the metrics endpoint is protected by RBAC when using the pod IP address. References: 1. https://github.com/openshift/cluster-kube-scheduler-operator 2. https://github.com/openshift/cluster-kube-scheduler-operator/blob/release- 4.5/bindata/v4.1.0/kube-scheduler/svc.yaml 3. https://github.com/openshift/cluster-kube-scheduler-operator/blob/release- 4.5/bindata/v4.1.0/kube-scheduler/pod.yaml 4. https://github.com/openshift/cluster-kube-scheduler-operator/blob/release- 4.5/bindata/v4.1.0/kube-scheduler/pod.yaml#L32-L37 5. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- scheduler/ CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "scheduler_api_rbac_enabled",
      "scheduler_api_access_restricted",
      "scheduler_api_iam_policy_attached",
      "scheduler_api_role_based_access",
      "scheduler_api_service_account_protected",
      "scheduler_api_authentication_required",
      "scheduler_api_authorization_enabled",
      "scheduler_api_permission_restricted"
    ]
  },
  {
    "id": "2.1",
    "title": "Ensure that the --cert-file and --key-file arguments are set as appropriate",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_api_server_cert_file_set",
      "kubernetes_api_server_key_file_set",
      "kubernetes_api_server_cert_file_valid",
      "kubernetes_api_server_key_file_valid",
      "kubernetes_api_server_cert_file_secure",
      "kubernetes_api_server_key_file_secure",
      "kubernetes_api_server_cert_file_permissions_restricted",
      "kubernetes_api_server_key_file_permissions_restricted",
      "kubernetes_api_server_cert_file_not_expired",
      "kubernetes_api_server_key_file_not_expired"
    ]
  },
  {
    "id": "2.2",
    "title": "Ensure that the --client-cert-auth argument is set to true",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_api_server_client_cert_auth_enabled",
      "kubernetes_api_server_client_cert_auth_required",
      "kubernetes_api_server_client_cert_auth_configured",
      "kubernetes_api_server_client_cert_auth_enforced",
      "kubernetes_api_server_client_cert_auth_validated"
    ]
  },
  {
    "id": "2.3",
    "title": "Ensure that the --auto-tls argument is not set to true",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_ssl_certificate_auto_tls_disabled",
      "compute_load_balancer_auto_tls_disabled",
      "cloud_cdn_auto_tls_disabled",
      "compute_auto_tls_disabled",
      "network_auto_tls_disabled"
    ]
  },
  {
    "id": "2.4",
    "title": "Ensure that the --peer-cert-file and --peer-key-file arguments are set as appropriate",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_api_server_peer_cert_file_set",
      "kubernetes_api_server_peer_key_file_set",
      "kubernetes_api_server_peer_cert_key_files_configured",
      "kubernetes_api_server_peer_cert_file_valid",
      "kubernetes_api_server_peer_key_file_valid",
      "kubernetes_api_server_peer_cert_key_files_secure",
      "kubernetes_api_server_peer_cert_key_files_appropriate",
      "kubernetes_api_server_peer_cert_key_files_properly_set"
    ]
  },
  {
    "id": "2.5",
    "title": "Ensure that the --peer-client-cert-auth argument is set to true",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container- platform/latest/security/certificate_types_descriptions/etcd-certificates.html 2. https://github.com/openshift/cluster-etcd-operator 3. https://github.com/openshift/cluster-etcd-operator/blob/release- 4.5/bindata/etcd/pod.yaml#L154-L167 4. https://github.com/openshift/cluster-etcd-operator/blob/release- 4.5/bindata/etcd/pod.yaml#L154-L167 5. https://etcd.io/ 6. https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/ 7. https://etcd.io/#peer-client-cert-auth CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 6.8 Define and Maintain Role-Based Access Control Define and maintain role-based access control, through determining and documenting the access rights necessary for each role within the enterprise to successfully carry out its assigned duties. Perform access control reviews of enterprise assets to validate that all privileges are authorized, on a recurring schedule at a minimum annually, or more frequently. ● v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1552 TA0006 M1022",
    "function_names": [
      "kubernetes_api_server_peer_client_cert_auth_enabled",
      "kubernetes_api_server_client_cert_auth_required",
      "kubernetes_api_server_tls_authentication_enabled",
      "kubernetes_api_server_secure_client_auth_enabled",
      "kubernetes_api_server_mtls_authentication_enabled"
    ]
  },
  {
    "id": "2.6",
    "title": "Ensure that the --peer-auto-tls argument is not set to true",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "gke_cluster_peer_auto_tls_disabled",
      "gke_cluster_peer_auto_tls_not_true",
      "gke_cluster_peer_auto_tls_secure",
      "gke_cluster_peer_auto_tls_compliant",
      "gke_cluster_peer_auto_tls_restricted"
    ]
  },
  {
    "id": "2.7",
    "title": "Ensure that a unique Certificate Authority is used for etcd",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_etcd_unique_certificate_authority",
      "compute_etcd_ca_uniqueness",
      "compute_etcd_ca_distinct",
      "compute_etcd_ca_single_issuer",
      "compute_etcd_ca_no_shared_issuer"
    ]
  },
  {
    "id": "3.1.1",
    "title": "Client certificate authentication should not be used for users",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "iam_user_no_client_cert_auth",
      "iam_user_client_cert_auth_disabled",
      "iam_credentials_no_client_cert_auth",
      "iam_identity_no_client_cert_auth",
      "iam_auth_no_client_certificates",
      "iam_user_auth_no_client_certs",
      "iam_credentials_client_cert_auth_disabled"
    ]
  },
  {
    "id": "3.2.1",
    "title": "Ensure that a minimal audit policy is created",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "cloudtrail_trail_minimal_audit_policy_enabled",
      "cloudtrail_trail_logging_all_events_enabled",
      "cloudtrail_trail_read_write_events_enabled",
      "cloudtrail_trail_management_events_enabled",
      "cloudtrail_trail_data_events_enabled",
      "cloudtrail_trail_global_services_logging_enabled",
      "cloudtrail_trail_multi_region_enabled",
      "cloudtrail_trail_immutable_logs_enabled",
      "cloudtrail_trail_log_file_validation_enabled",
      "cloudtrail_trail_log_integrity_monitoring_enabled"
    ]
  },
  {
    "id": "3.2.2",
    "title": "Ensure that the audit policy covers key security concerns",
    "assessment": "Manual",
    "remediation": "Update the audit log policy profile to use WriteRequestBodies. Default Value: Audit logging is configured by default using the Default audit policy, but you are advised to review the log retention settings and log levels to align with your cluster's security posture. References: 1. https://docs.openshift.com/container-platform/latest/security/audit-log-policy- config.html 2. https://docs.openshift.com/container-platform/latest/security/audit-log-view.html 3. https://github.com/openshift/cluster-kube-apiserver-operator/blob/release- 4.5/bindata/v4.1.0/config/defaultconfig.yaml#L47-L77 4. https://github.com/openshift/cluster-kube-apiserver-operator/blob/release- 4.6/bindata/v4.1.0/config/defaultconfig.yaml#L34-L78 5. https://github.com/k8scop/k8s-security- dashboard/blob/master/configs/kubernetes/adv-audit.yaml 6. https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/ 7. https://github.com/falcosecurity/falco/blob/master/examples/k8s_audit_config/aud it-policy.yaml 8. https://github.com/kubernetes/kubernetes/blob/master/cluster/gce/gci/configure- helper.sh#L735 CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "cloudtrail_trail_logging_enabled",
      "cloudtrail_trail_all_events_logged",
      "cloudtrail_trail_management_events_enabled",
      "cloudtrail_trail_data_events_enabled",
      "cloudtrail_trail_read_write_events_enabled",
      "cloudtrail_trail_global_services_logged",
      "cloudtrail_trail_log_file_validation_enabled",
      "cloudtrail_trail_multi_region_enabled",
      "cloudtrail_trail_immutable_logs_enabled",
      "cloudtrail_trail_encryption_enabled",
      "cloudtrail_trail_log_retention_over_90d",
      "cloudtrail_trail_log_integrity_monitoring_enabled"
    ]
  },
  {
    "id": "4.1.1",
    "title": "Ensure that the kubelet service file permissions are set to 644 or more restrictive",
    "assessment": "Automated",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/4.5/architecture/control- plane.html#understanding-machine-config-operator_control-plane 2. https://docs.openshift.com/container- platform/4.5/scalability_and_performance/recommended-host- practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_ 3. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/ 4. https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create- cluster-kubeadm/#44-joining-your-nodes 5. https://kubernetes.io/docs/reference/setup-tools/kubeadm/#kubelet-drop-in CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user’s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. ● ● ● v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1022",
    "function_names": [
      "kubernetes_kubelet_service_file_permissions_restrictive",
      "kubernetes_kubelet_service_file_permissions_644_or_stricter",
      "kubernetes_kubelet_config_file_permissions_secure",
      "kubernetes_kubelet_service_file_permissions_compliant",
      "kubernetes_kubelet_file_permissions_restricted"
    ]
  },
  {
    "id": "4.1.2",
    "title": "Ensure that the kubelet service file ownership is set to root:root",
    "assessment": "Automated",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/4.5/architecture/control- plane.html#understanding-machine-config-operator_control-plane 2. https://docs.openshift.com/container- platform/4.5/scalability_and_performance/recommended-host- practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_ 3. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/ 4. https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create- cluster-kubeadm/#44-joining-your-nodes 5. https://kubernetes.io/docs/reference/setup-tools/kubeadm/#kubelet-drop-in CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account. ● ● ● v7 4.3 Ensure the Use of Dedicated Administrative Accounts Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1026",
    "function_names": [
      "kubernetes_kubelet_service_file_ownership_root",
      "kubernetes_kubelet_service_file_permissions_root",
      "kubernetes_kubelet_service_file_owner_root",
      "kubernetes_kubelet_service_file_group_root",
      "kubernetes_kubelet_service_file_secure_ownership",
      "kubernetes_kubelet_service_file_root_ownership",
      "kubernetes_kubelet_service_file_ownership_set_root",
      "kubernetes_kubelet_service_file_root_owner",
      "kubernetes_kubelet_service_file_root_group",
      "kubernetes_kubelet_service_file_ownership_root_root"
    ]
  },
  {
    "id": "4.1.3",
    "title": "If proxy kube proxy configuration file exists ensure permissions are set to 644 or more restrictive",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container- platform/latest/networking/openshift_sdn/configuring-kube-proxy.html 2. https://kubernetes.io/docs/reference/command-line-tools-reference/kube-proxy/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user’s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. ● ● ● v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1022",
    "function_names": [
      "kubernetes_proxy_config_file_permissions_restrictive",
      "kubernetes_proxy_config_file_permissions_644_or_stricter",
      "kubernetes_kube_proxy_config_file_permissions_secure",
      "kubernetes_proxy_config_file_permissions_compliant",
      "kubernetes_kube_proxy_config_file_permissions_644_max"
    ]
  },
  {
    "id": "4.1.4",
    "title": "If proxy kubeconfig file exists ensure ownership is set to root:root",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_proxy_kubeconfig_ownership_root",
      "kubernetes_proxy_kubeconfig_file_permissions_root",
      "kubernetes_kubeconfig_proxy_ownership_restricted",
      "kubernetes_kubeconfig_proxy_root_owned",
      "kubernetes_proxy_kubeconfig_root_only_access"
    ]
  },
  {
    "id": "4.1.5",
    "title": "Ensure that the --kubeconfig kubelet.conf file permissions are set to 644 or more restrictive",
    "assessment": "Automated",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#understanding-machine-config-operator_control-plane 2. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.3 Configure Data Access Control Lists Configure data access control lists based on a user’s need to know. Apply data access control lists, also known as access permissions, to local and remote file systems, databases, and applications. ● ● ● v7 14.6 Protect Information through Access Control Lists Protect all information stored on systems with file system, network share, claims, application, or database specific access control lists. These controls will enforce the principle that only authorized individuals should have access to the information based on their need to access the information as a part of their responsibilities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1022",
    "function_names": [
      "kubernetes_kubeconfig_file_permissions_restrictive",
      "kubernetes_kubelet_conf_file_permissions_644",
      "kubernetes_config_file_permissions_secure",
      "kubernetes_kubeconfig_file_permissions_min_644",
      "kubernetes_kubelet_conf_file_permissions_strict"
    ]
  },
  {
    "id": "4.1.6",
    "title": "Ensure that the --kubeconfig kubelet.conf file ownership is set to root:root",
    "assessment": "Automated",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#understanding-machine-config-operator_control-plane 2. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account. ● ● ● v7 4.3 Ensure the Use of Dedicated Administrative Accounts Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1026",
    "function_names": [
      "kubernetes_kubelet_conf_file_ownership_root",
      "kubernetes_kubeconfig_file_ownership_root",
      "kubernetes_kubelet_conf_file_permissions_secure",
      "kubernetes_kubeconfig_file_permissions_secure",
      "kubernetes_kubelet_conf_file_owner_root",
      "kubernetes_kubeconfig_file_owner_root",
      "kubernetes_kubelet_conf_file_group_root",
      "kubernetes_kubeconfig_file_group_root"
    ]
  },
  {
    "id": "4.1.7",
    "title": "Ensure that the certificate authorities file permissions are set to 644 or more restrictive",
    "assessment": "Automated",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_certificate_authority_file_permissions_restrictive",
      "compute_ca_file_permissions_644_or_stricter",
      "compute_ssl_certificate_authority_permissions_secure",
      "compute_ca_file_permissions_not_world_writable",
      "compute_certificate_authority_file_permissions_compliant"
    ]
  },
  {
    "id": "4.1.8",
    "title": "Ensure that the client certificate authorities file ownership is set to root:root",
    "assessment": "Automated",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#understanding-machine-config-operator_control-plane 2. https://kubernetes.io/docs/reference/access-authn-authz/authentication/#x509- client-certs CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account. ● ● ● v7 4.3 Ensure the Use of Dedicated Administrative Accounts Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1026",
    "function_names": [
      "compute_ssl_certificate_authority_file_ownership_root",
      "compute_client_certificate_authority_file_ownership_root",
      "compute_certificate_authority_file_ownership_root",
      "compute_ca_file_ownership_root",
      "compute_client_ca_file_ownership_root",
      "compute_ssl_ca_file_ownership_root",
      "compute_certificate_authority_file_owner_root",
      "compute_client_certificate_authority_file_owner_root"
    ]
  },
  {
    "id": "4.1.9",
    "title": "Ensure that the kubelet --config configuration file has permissions set to 600 or more restrictive",
    "assessment": "Automated",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#understanding-machine-config-operator_control-plane 2. https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account. ● ● ● v7 5.2 Maintain Secure Images Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates. ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1083, T1222 TA0005, TA0007 M1022",
    "function_names": [
      "kubernetes_kubelet_config_file_permissions_600_or_stricter",
      "kubernetes_kubelet_config_file_permissions_restrictive",
      "kubernetes_kubelet_config_file_permissions_secure",
      "kubernetes_kubelet_config_file_permissions_compliant",
      "kubernetes_kubelet_config_file_permissions_cis_benchmark"
    ]
  },
  {
    "id": "4.1.10",
    "title": "Ensure that the kubelet configuration file ownership is set to root:root",
    "assessment": "Automated",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_kubelet_config_file_ownership_root",
      "kubernetes_kubelet_config_file_group_ownership_root",
      "kubernetes_kubelet_config_file_permissions_secure",
      "kubernetes_kubelet_config_file_ownership_correct",
      "kubernetes_kubelet_config_file_root_owned"
    ]
  },
  {
    "id": "4.2.1",
    "title": "Activate Garbage collection in OpenShift Container Platform 4, as appropriate",
    "assessment": "Manual",
    "remediation": "To configure, follow the directions in Garbage Collection Remediation Default Value: The kubelet has the following default hard eviction thresholds: { \"imagefs.available\": \"15%\", \"memory.available\": \"100Mi\", \"nodefs.available\": \"10%\", \"nodefs.inodesFree\": \"5%\" } Noted: These default values of hard eviction thresholds will only be set if none of the parameters is changed. If you changed the value of any parameter, then the values of other parameters will not be inherited as the default values and will be set to zero. In order to provide custom values, you should provide all the thresholds respectively. References: 1. https://docs.openshift.com/container-platform/latest/operators/operator- reference.html#cluster-openshift-controller-manager-operator_cluster-operators- ref 2. https://docs.openshift.com/container-platform/latest/operators/operator- reference.html#kube-controller-manager-operator_cluster-operators-ref 3. https://docs.openshift.com/container-platform/latest/nodes/nodes/nodes-nodes- garbage-collection.html 4. https://github.com/openshift/kubernetes-kubelet/blob/origin-4.5-kubernetes- 1.18.3/config/v1beta1/types.go#L554-L604 5. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- controller-manager/ 6. https://github.com/kubernetes/kubernetes/issues/28484 CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "openshift_cluster_garbage_collection_enabled",
      "openshift_cluster_garbage_collection_configured",
      "openshift_cluster_resource_cleanup_active",
      "openshift_cluster_storage_garbage_collection_enabled",
      "openshift_cluster_automatic_cleanup_enabled",
      "openshift_cluster_unused_resource_cleanup_enabled",
      "openshift_cluster_garbage_collection_policy_configured",
      "openshift_cluster_garbage_collection_schedule_active"
    ]
  },
  {
    "id": "4.2.2",
    "title": "Ensure that the --anonymous-auth argument is set to false",
    "assessment": "Automated",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_api_server_anonymous_auth_disabled",
      "kubernetes_api_server_auth_anonymous_denied",
      "kubernetes_api_server_secure_auth_enabled",
      "kubernetes_api_server_anonymous_access_blocked",
      "kubernetes_api_server_auth_anonymous_false"
    ]
  },
  {
    "id": "4.2.3",
    "title": "Ensure that the --authorization-mode argument is not set to AlwaysAllow",
    "assessment": "Automated",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "eks_cluster_authorization_mode_not_always_allow",
      "eks_cluster_authorization_mode_restricted",
      "eks_cluster_always_allow_disabled",
      "eks_cluster_authorization_mode_secure",
      "eks_cluster_authorization_mode_compliant"
    ]
  },
  {
    "id": "4.2.4",
    "title": "Ensure that the --client-ca-file argument is set as appropriate",
    "assessment": "Automated",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#understanding-machine-config-operator_control-plane 2. https://docs.openshift.com/container- platform/latest/post_installation_configuration/machine-configuration- tasks.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_post-install- machine-configuration-tasks 3. https://github.com/openshift/cluster-kube-apiserver-operator/blob/release- 4.5/bindata/v4.1.0/config/defaultconfig.yaml#L28-L29 4. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/ 5. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet- authentication-authorization/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.11 Encrypt Sensitive Data at Rest Encrypt sensitive data at rest on servers, applications, and databases containing sensitive data. Storage-layer encryption, also known as server-side encryption, meets the minimum requirement of this Safeguard. Additional encryption methods may include application-layer encryption, also known as client-side encryption, where access to the data storage device(s) does not permit access to the plain-text data. ● ● v7 14.8 Encrypt Sensitive Information at Rest Encrypt all sensitive information at rest using a tool that requires a secondary authentication mechanism not integrated into the operating system, in order to access the information. ●",
    "function_names": [
      "kubernetes_api_server_client_ca_file_set",
      "kubernetes_api_server_client_ca_file_configured",
      "kubernetes_api_server_client_ca_file_valid",
      "kubernetes_api_server_client_ca_file_secure",
      "kubernetes_api_server_client_ca_file_properly_set"
    ]
  },
  {
    "id": "4.2.5",
    "title": "Verify that the read only port is not used or is set to 0",
    "assessment": "Automated",
    "remediation": "In earlier versions of OpenShift 4, the read-only-port argument is not used. Follow the instructions in the documentation to create a kubeletconfig CRD and set the kubelet-read-only-port is set to 0. Default Value: By default, in OpenShift 4.5 and earlier, the --read-only-port is not used. In OpenShift 4.6 and above, the kubelet-read-only-port is set to 0. References: 1. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#understanding-machine-config-operator_control-plane 2. https://docs.openshift.com/container- platform/latest/post_installation_configuration/machine-configuration- tasks.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_post-install- machine-configuration-tasks 3. https://github.com/openshift/kubernetes-kubelet/blob/origin-4.5-kubernetes- 1.18.3/config/v1beta1/types.go#L135-L141 4. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/ CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "references": "1. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#understanding-machine-config-operator_control-plane 2. https://docs.openshift.com/container- platform/latest/post_installation_configuration/machine-configuration- tasks.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_post-install- machine-configuration-tasks 3. https://github.com/openshift/kubernetes-kubelet/blob/origin-4.5-kubernetes- 1.18.3/config/v1beta1/types.go#L135-L141 4. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software Uninstall or disable unnecessary services on enterprise assets and software, such as an unused file sharing service, web application module, or service function. ● ● v7 9.2 Ensure Only Approved Ports, Protocols and Services Are Running Ensure that only network ports, protocols, and services listening on a system with validated business needs, are running on each system. ● ●",
    "function_names": [
      "redis_instance_read_only_port_disabled",
      "redis_instance_read_only_port_zero",
      "redis_instance_read_only_port_unused",
      "redis_instance_read_only_port_secure",
      "redis_instance_read_only_port_default_deny"
    ]
  },
  {
    "id": "4.2.6",
    "title": "Ensure that the --streaming-connection-idle-timeout argument is not set to 0",
    "assessment": "Automated",
    "remediation": "Follow the instructions in the documentation to create a kubeletconfig CRD and set the streamingConnectionIdleTimeout to the desired value. Do not set the value to 0. Default Value: By default, streamingConnectionIdleTimeout is set to 4 hours. References: 1. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#understanding-machine-config-operator_control-plane 2. https://docs.openshift.com/container- platform/latest/post_installation_configuration/machine-configuration- tasks.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_post-install- machine-configuration-tasks 3. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/ 4. https://github.com/kubernetes/kubernetes/pull/18552 CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "eks_cluster_streaming_connection_idle_timeout_not_zero",
      "eks_cluster_streaming_connection_idle_timeout_configured",
      "eks_cluster_streaming_connection_timeout_valid",
      "eks_cluster_streaming_connection_timeout_non_zero",
      "eks_cluster_streaming_idle_timeout_set",
      "eks_cluster_streaming_timeout_not_disabled",
      "eks_cluster_streaming_connection_timeout_secure",
      "eks_cluster_streaming_idle_timeout_enabled"
    ]
  },
  {
    "id": "4.2.7",
    "title": "Ensure that the --make-iptables-util-chains argument is set to true",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_kubelet_make_iptables_util_chains_enabled",
      "kubernetes_kubelet_iptables_util_chains_configured",
      "kubernetes_kubelet_iptables_util_chains_true",
      "kubernetes_kubelet_iptables_util_chains_set",
      "kubernetes_kubelet_iptables_util_chains_required"
    ]
  },
  {
    "id": "4.2.8",
    "title": "Ensure that the kubeAPIQPS [--event-qps] argument is set to 0 or a level which ensures appropriate event capture",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#understanding-machine-config-operator_control-plane 2. https://docs.openshift.com/container- platform/latest/post_installation_configuration/machine-configuration- tasks.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_post-install- machine-configuration-tasks 3. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/ 4. https://github.com/kubernetes/kubernetes/blob/master/pkg/kubelet/apis/kubeletco nfig/v1beta1/types.go CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 8.5 Collect Detailed Audit Logs Configure detailed audit logging for enterprise assets containing sensitive data. Include event source, date, username, timestamp, source addresses, destination addresses, and other useful elements that could assist in a forensic investigation. ● ● v7 8.8 Enable Command-line Audit Logging Enable command-line audit logging for command shells, such as Microsoft Powershell and Bash. ● ●",
    "function_names": [
      "kubernetes_api_event_qps_disabled",
      "kubernetes_api_event_qps_within_limit",
      "kubernetes_api_event_qps_appropriate_capture",
      "kubernetes_api_event_qps_zero_or_configured",
      "kubernetes_api_event_qps_rate_limited"
    ]
  },
  {
    "id": "4.2.9",
    "title": "Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate",
    "assessment": "Manual",
    "remediation": "OpenShift automatically manages TLS authentication for the API server communication with the node/kublet. This is not configurable. Default Value: By default, OpenShift uses X.509 certificates to provide secure connections between the API server and node/kubelet. OpenShift does not use values assigned to the tls- cert-file or tls-private-key-file flags. References: 1. https://docs.openshift.com/container-platform/latest/architecture/control- plane.html#understanding-machine-config-operator_control-plane 2. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/ 3. https://rootsquash.com/2016/05/10/securing-the-kubernetes-api/ 4. https://github.com/kelseyhightower/docker-kubernetes-tls-guide 5. https://jvns.ca/blog/2017/08/05/how-kubernetes-certificates-work/ CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_api_server_tls_cert_file_set",
      "kubernetes_api_server_tls_private_key_file_set",
      "kubernetes_api_server_tls_cert_and_key_valid",
      "kubernetes_api_server_tls_cert_and_key_configured",
      "kubernetes_api_server_tls_cert_and_key_matching",
      "kubernetes_api_server_tls_cert_and_key_permissions_secure",
      "kubernetes_api_server_tls_cert_and_key_not_expired",
      "kubernetes_api_server_tls_cert_and_key_properly_configured"
    ]
  },
  {
    "id": "4.2.10",
    "title": "Ensure that the --rotate-certificates argument is not set to false",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "eks_cluster_certificate_rotation_enabled",
      "eks_cluster_rotate_certificates_not_disabled",
      "eks_cluster_certificate_rotation_required",
      "eks_cluster_rotate_certificates_set_true",
      "eks_cluster_certificate_rotation_not_false"
    ]
  },
  {
    "id": "4.2.11",
    "title": "Verify that the RotateKubeletServerCertificate argument is set to true",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "eks_cluster_kubelet_certificate_rotation_enabled",
      "kubernetes_node_kubelet_server_certificate_rotated",
      "kubelet_server_certificate_auto_rotation_enabled",
      "eks_node_certificate_rotation_required",
      "kubelet_tls_certificate_rotation_enabled"
    ]
  },
  {
    "id": "4.2.12",
    "title": "Ensure that the Kubelet only makes use of Strong Cryptographic Ciphers",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_kubelet_strong_ciphers_enabled",
      "kubernetes_kubelet_weak_ciphers_disabled",
      "kubernetes_kubelet_tls_ciphers_restricted",
      "kubernetes_kubelet_cipher_suite_compliant",
      "kubernetes_kubelet_secure_cipher_config",
      "kubernetes_kubelet_cryptographic_ciphers_enforced",
      "kubernetes_kubelet_approved_ciphers_only",
      "kubernetes_kubelet_cipher_strength_validated"
    ]
  },
  {
    "id": "5.1.1",
    "title": "Ensure that the cluster-admin role is only used where required",
    "assessment": "Manual",
    "audit": "OpenShift provides a set of default cluster roles that you can bind to users and groups cluster-wide or locally (per project namespace). Be mindful of the difference between local and cluster bindings. For example, if you bind the cluster-admin role to a user by using a local role binding, it might appear that this user has the privileges of a cluster administrator. This is not the case. Binding the cluster-admin to a user in a project grants super administrator privileges for only that project to the user. You can use the oc CLI to view cluster roles and bindings by using the oc describe command. For more information, see Default Cluster Roles Some of these roles such as cluster-admin provide wide-ranging privileges which should only be applied where absolutely necessary. Roles such as cluster-admin allow super-user access to perform any action on any resource. When used in a ClusterRoleBinding, it gives full control over every resource in the cluster and in all namespaces. When used in a RoleBinding, it gives full control over every resource in the rolebinding's namespace, including the namespace itself. Review users and groups bound to cluster-admin and decide whether they require such access. Consider creating least-privilege roles for users and service accounts. Obtain a list of the principals who have access to the cluster-admin role by reviewing the clusterrolebinding output for each role binding that has access to the cluster- admin role. # needs verification # To get a list of users and service accounts with the cluster-admin role oc get clusterrolebindings -o=custom- columns=NAME:.metadata.name,ROLE:.roleRef.name,SUBJECT:.subjects[*].kind | grep cluster-admin # To verity that kubeadmin is removed, no results should be returned oc get secrets kubeadmin -n kube-system Review each principal listed and ensure that cluster-admin privilege is required for it. Verify that the kubeadmin user no longer exists. Remediation: Identify all clusterrolebindings to the cluster-admin role. Check if they are used and if they need this role or if they could use a role with fewer privileges. Where possible, first bind users to a lower privileged role and then remove the clusterrolebinding to the cluster-admin role : oc delete clusterrolebinding [name] Default Value: By default a single clusterrolebinding called cluster-admin is provided with the system:masters group as its principal. The principal for cluster-admin also includes system:cluster-admins (Group) and system:admin (User). References: 1. https://kubernetes.io/docs/reference/access-authn-authz/rbac/#user-facing-roles CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account. ● ● ● v7 4.3 Ensure the Use of Dedicated Administrative Accounts Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1078, T1078.002 TA0001, TA0004 M1026",
    "description": "",
    "rationale": "",
    "remediation": null,
    "references": "1. https://kubernetes.io/docs/reference/access-authn-authz/rbac/#user-facing-roles CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account. ● ● ● v7 4.3 Ensure the Use of Dedicated Administrative Accounts Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1078, T1078.002 TA0001, TA0004 M1026",
    "function_names": [
      "kubernetes_role_no_cluster_admin_unnecessary",
      "kubernetes_cluster_admin_restricted_usage",
      "kubernetes_role_cluster_admin_minimal_usage",
      "kubernetes_cluster_admin_role_least_privilege",
      "kubernetes_role_cluster_admin_required_only"
    ]
  },
  {
    "id": "5.1.2",
    "title": "Minimize access to secrets",
    "assessment": "Manual",
    "remediation": "Where possible, remove get, list and watch access to secret objects in the cluster. Default Value: By default in a OpenShift cluster the following list of principals have get privileges on secret objects for i in $(oc get clusterroles -o jsonpath='{.items[*].metadata.name}'); do oc describe clusterrole ${i}; done # The following default cluster roles have get privileges on secret objects admin cloud-credential-operator-role cluster-admin cluster-image-registry-operator cluster-monitoring-operator cluster-node-tuning-operator edit kube-state-metrics machine-config-controller marketplace-operator openshift-ingress-operator prometheus-operator registry-admin registry-editor system:aggregate-to-edit system:controller:expand-controller system:controller:generic-garbage-collector system:controller:namespace-controller system:controller:operator-lifecycle-manager system:controller:persistent-volume-binder system:kube-controller-manager system:master system:node system:openshift:controller:build-controller system:openshift:controller:cluster-quota-reconciliation-controller system:openshift:controller:ingress-to-route-controller system:openshift:controller:service-ca system:openshift:controller:service-serving-cert-controller system:openshift:controller:serviceaccount-pull-secrets-controller system:openshift:controller:template-service-broker CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "secrets_manager_secret_access_restricted",
      "secrets_manager_secret_no_public_access",
      "secrets_manager_secret_rotation_enabled",
      "secrets_manager_secret_encryption_enabled",
      "secrets_manager_secret_minimum_permissions",
      "secrets_manager_secret_no_wildcard_permissions",
      "secrets_manager_secret_access_logging_enabled",
      "secrets_manager_secret_cross_account_access_restricted",
      "secrets_manager_secret_vpc_endpoint_required",
      "secrets_manager_secret_no_anonymous_access"
    ]
  },
  {
    "id": "5.1.3",
    "title": "Minimize wildcard use in Roles and ClusterRoles",
    "assessment": "Manual",
    "remediation": "Where possible replace any use of wildcards in clusterroles and roles with specific objects or actions. CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "iam_role_wildcard_minimized",
      "iam_clusterrole_wildcard_minimized",
      "iam_role_permissions_restricted",
      "iam_clusterrole_permissions_restricted",
      "iam_role_wildcard_permissions_disallowed",
      "iam_clusterrole_wildcard_permissions_disallowed",
      "iam_role_least_privilege_enforced",
      "iam_clusterrole_least_privilege_enforced"
    ]
  },
  {
    "id": "5.1.4",
    "title": "Minimize access to create pods",
    "assessment": "Manual",
    "remediation": "Where possible, remove create access to pod objects in the cluster. Default Value: By default in a kubeadm cluster the following list of principals have create privileges on pod objects CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_role_pod_creation_restricted",
      "kubernetes_cluster_pod_creation_minimized",
      "kubernetes_rbac_pod_creation_limited",
      "kubernetes_user_pod_creation_disallowed",
      "kubernetes_service_account_pod_creation_denied",
      "kubernetes_namespace_pod_creation_controlled",
      "kubernetes_policy_pod_creation_constrained",
      "kubernetes_admission_pod_creation_blocked"
    ]
  },
  {
    "id": "5.1.5",
    "title": "Ensure that default service accounts are not actively used.",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://kubernetes.io/docs/tasks/configure-pod-container/configure-service- account/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.3 Disable Dormant Accounts Delete or disable any dormant accounts after a period of 45 days of inactivity, where supported. ● ● ● v7 16.9 Disable Dormant Accounts Automatically disable dormant accounts after a set period of inactivity. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1552 TA0006 M1028",
    "function_names": [
      "iam_service_account_no_active_default",
      "iam_service_account_default_unused",
      "compute_service_account_default_disabled",
      "iam_service_account_default_no_usage",
      "compute_service_account_default_inactive",
      "iam_service_account_default_no_active_usage",
      "compute_service_account_default_no_active_roles",
      "iam_service_account_default_no_active_credentials"
    ]
  },
  {
    "id": "5.1.6",
    "title": "Ensure that Service Account Tokens are only mounted where necessary",
    "assessment": "Manual",
    "remediation": "Modify the definition of pods and service accounts which do not need to mount service account tokens to disable it. Default Value: By default, all pods get a service account token mounted in them. References: 1. https://kubernetes.io/docs/tasks/configure-pod-container/configure-service- account/ CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_service_account_token_mounted_necessary",
      "kubernetes_service_account_token_unnecessary_mounts",
      "kubernetes_service_account_token_mount_restricted",
      "kubernetes_service_account_token_mount_minimized",
      "kubernetes_service_account_token_mount_required_only"
    ]
  },
  {
    "id": "5.2.1",
    "title": "Minimize the admission of privileged containers",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/authentication/managing- security-context-constraints.html 2. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod- security-policies CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account. ● ● ● v8 12.8 Establish and Maintain Dedicated Computing Resources for All Administrative Work Establish and maintain dedicated computing resources, either physically or logically separated, for all administrative tasks or tasks requiring administrative access. The computing resources should be segmented from the enterprise's primary network and not be allowed internet access. ● Controls Version Control IG 1 IG 2 IG 3 v7 4.3 Ensure the Use of Dedicated Administrative Accounts Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1611 TA0004 M1048",
    "function_names": [
      "compute_container_no_privileged_mode",
      "compute_container_privilege_escalation_disabled",
      "compute_container_read_only_root_filesystem",
      "compute_container_no_capabilities_added",
      "compute_container_no_sensitive_host_paths_mounted",
      "compute_container_non_root_user",
      "compute_container_seccomp_profile_enabled",
      "compute_container_apparmor_profile_enabled",
      "compute_container_secrets_not_mounted",
      "compute_container_resource_limits_defined"
    ]
  },
  {
    "id": "5.2.2",
    "title": "Minimize the admission of containers wishing to share the host process ID namespace",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/authentication/managing- security-context-constraints.html 2. https://kubernetes.io/docs/concepts/policy/pod-security-policy/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account. ● ● ● v7 5.2 Maintain Secure Images Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates. ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1078, T1078.002 TA0001, TA0004 M1026",
    "function_names": [
      "compute_container_host_pid_namespace_disabled",
      "compute_container_host_pid_sharing_restricted",
      "compute_container_host_pid_isolation_enabled",
      "compute_container_host_pid_namespace_minimized",
      "compute_container_host_pid_access_denied"
    ]
  },
  {
    "id": "5.2.3",
    "title": "Minimize the admission of containers wishing to share the host IPC namespace",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/authentication/managing- security-context-constraints.html 2. https://kubernetes.io/docs/concepts/policy/pod-security-policy/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 13.10 Perform Application Layer Filtering Perform application layer filtering. Example implementations include a filtering proxy, application layer firewall, or gateway. ● v7 12.9 Deploy Application Layer Filtering Proxy Server Ensure that all network traffic to or from the Internet passes through an authenticated application layer proxy that is configured to filter unauthorized connections. ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1078, T1078.002 TA0001, TA0004 M1026",
    "function_names": [
      "compute_container_host_ipc_disabled",
      "compute_container_ipc_namespace_isolated",
      "compute_container_host_ipc_restricted",
      "compute_container_ipc_sharing_minimized",
      "compute_container_host_ipc_access_denied"
    ]
  },
  {
    "id": "5.2.4",
    "title": "Minimize the admission of containers wishing to share the host network namespace",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/authentication/managing- security-context-constraints.html 2. https://kubernetes.io/docs/concepts/policy/pod-security-policy/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.12 Segment Data Processing and Storage Based on Sensitivity Segment data processing and storage based on the sensitivity of the data. Do not process sensitive data on enterprise assets intended for lower sensitivity data. ● ● v7 14.1 Segment the Network Based on Sensitivity Segment the network based on the label or classification level of the information stored on the servers, locate all sensitive information on separated Virtual Local Area Networks (VLANs). ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1098 TA0003 M1030",
    "function_names": [
      "compute_container_host_network_disabled",
      "compute_container_host_network_restricted",
      "compute_container_host_network_isolation_enabled",
      "compute_container_host_network_sharing_minimized",
      "compute_container_host_network_access_denied",
      "compute_container_host_network_namespace_protected",
      "compute_container_host_network_usage_blocked"
    ]
  },
  {
    "id": "5.2.5",
    "title": "Minimize the admission of containers with allowPrivilegeEscalation",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/authentication/managing- security-context-constraints.html 2. https://kubernetes.io/docs/concepts/policy/pod-security-policy/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account. ● ● ● v8 12.8 Establish and Maintain Dedicated Computing Resources for All Administrative Work Establish and maintain dedicated computing resources, either physically or logically separated, for all administrative tasks or tasks requiring administrative access. The computing resources should be segmented from the enterprise's primary network and not be allowed internet access. ● v7 4.3 Ensure the Use of Dedicated Administrative Accounts Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1611 TA0004 M1038, M1048",
    "function_names": [
      "kubernetes_pod_allow_privilege_escalation_disabled",
      "kubernetes_container_privilege_escalation_blocked",
      "kubernetes_workload_privilege_escalation_restricted",
      "kubernetes_deployment_privilege_escalation_denied",
      "kubernetes_namespace_privilege_escalation_minimized"
    ]
  },
  {
    "id": "5.2.6",
    "title": "Minimize the admission of root containers",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/authentication/managing- security-context-constraints.html 2. https://kubernetes.io/docs/concepts/policy/pod-security-policy/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts Restrict administrator privileges to dedicated administrator accounts on enterprise assets. Conduct general computing activities, such as internet browsing, email, and productivity suite use, from the user’s primary, non-privileged account. ● ● ● v8 12.8 Establish and Maintain Dedicated Computing Resources for All Administrative Work Establish and maintain dedicated computing resources, either physically or logically separated, for all administrative tasks or tasks requiring administrative access. The computing resources should be segmented from the enterprise's primary network and not be allowed internet access. ● v7 4.3 Ensure the Use of Dedicated Administrative Accounts Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities. ● ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1098 TA0003 M1026",
    "function_names": [
      "compute_container_root_disabled",
      "compute_container_root_minimized",
      "compute_container_root_privileges_restricted",
      "compute_container_root_access_denied",
      "compute_container_root_user_prohibited",
      "compute_container_root_escalation_blocked",
      "compute_container_root_capabilities_dropped",
      "compute_container_root_running_prohibited"
    ]
  },
  {
    "id": "5.2.7",
    "title": "Minimize the admission of containers with the NET_RAW capability",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/authentication/managing- security-context-constraints.html 2. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod- security-policies 3. https://www.nccgroup.trust/uk/our-research/abusing-privileged-and-unprivileged- linux-containers/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software Uninstall or disable unnecessary services on enterprise assets and software, such as an unused file sharing service, web application module, or service function. ● ● v7 5.2 Maintain Secure Images Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates. ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1068 TA0004 M1050"
  },
  {
    "id": "5.2.8",
    "title": "Minimize the admission of containers with added capabilities",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_container_capabilities_minimized",
      "compute_container_added_capabilities_restricted",
      "compute_container_privileged_capabilities_disabled",
      "compute_container_default_capabilities_enforced",
      "compute_container_capabilities_whitelisted",
      "compute_container_capabilities_drop_all_enabled",
      "compute_container_capabilities_minimal_required",
      "compute_container_capabilities_no_added_allowed"
    ]
  },
  {
    "id": "5.2.9",
    "title": "Minimize the admission of containers with capabilities assigned",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/latest/authentication/managing- security-context-constraints.html 2. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod- security-policies 3. https://www.nccgroup.com/uk/our-research/abusing-privileged-and-unprivileged- linux-containers/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software Uninstall or disable unnecessary services on enterprise assets and software, such as an unused file sharing service, web application module, or service function. ● ● v7 5.2 Maintain Secure Images Maintain secure images or templates for all systems in the enterprise based on the organization's approved configuration standards. Any new system deployment or existing system that becomes compromised should be imaged using one of those images or templates. ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1204 TA0002, TA0003 M1045, M1047",
    "function_names": [
      "compute_container_capabilities_restricted",
      "compute_container_capabilities_minimized",
      "compute_container_privileged_capabilities_disabled",
      "compute_container_unnecessary_capabilities_removed",
      "compute_container_default_capabilities_denied",
      "compute_container_capabilities_whitelisted",
      "compute_container_capabilities_all_removed",
      "compute_container_capabilities_drop_all_enabled"
    ]
  },
  {
    "id": "5.2.10",
    "title": "Minimize access to privileged Security Context Constraints",
    "assessment": "Manual",
    "remediation": "Remove any users and groups who do not need access to an SCC, following the principle of least privilege. You can remove users and groups from an SCC using the oc edit scc $NAME command. Additionally, you can create your own SCCs that contain the container functionality you need for a particular use case and assign that SCC to users and groups if the default SCCs are not appropriate for your use case. Default Value: OpenShift provides the following SCCs by default: \"anyuid\" \"hostaccess\" \"hostmount-anyuid\" \"hostnetwork\" \"hostnetwork-v2\" \"machine-api-termination-handler\" \"node-exporter\" \"nonroot\" \"nonroot-v2\" \"privileged\" \"restricted\" \"restricted-v2\" These default SCCs attempt to group similar privileged container functionality into a single SCC that fits particular use cases. Please refer to the OpenShift documentation for a complete list of capabilities associated with each default SCC. CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_security_context_constraints_restricted_access",
      "kubernetes_security_context_constraints_minimal_privileges",
      "kubernetes_security_context_constraints_admin_restricted",
      "kubernetes_security_context_constraints_privileged_access_minimized",
      "kubernetes_security_context_constraints_privilege_escalation_disabled",
      "kubernetes_security_context_constraints_root_access_restricted",
      "kubernetes_security_context_constraints_read_only_root_filesystem",
      "kubernetes_security_context_constraints_allow_privilege_escalation_false",
      "kubernetes_security_context_constraints_run_as_non_root",
      "kubernetes_security_context_constraints_capabilities_dropped"
    ]
  },
  {
    "id": "5.3.1",
    "title": "Ensure that the CNI in use supports Network Policies",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://docs.openshift.com/container-platform/4.5/networking/openshift- sdn/about-openshift-sdn.html 2. https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage- net/network-plugins/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.4 Implement and Manage a Firewall on Servers Implement and manage a firewall on servers, where supported. Example implementations include a virtual firewall, operating system firewall, or a third- party firewall agent. ● ● ● v7 9.5 Implement Application Firewalls Place application firewalls in front of any critical servers to verify and validate the traffic going to the server. Any unauthorized traffic should be blocked and logged. ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1046 TA0007 M1030, M1042",
    "function_names": [
      "compute_container_network_interface_network_policies_supported",
      "kubernetes_cni_network_policies_enabled",
      "container_network_interface_network_policy_compliance",
      "cni_network_policy_support_required",
      "container_network_interface_network_policy_validation",
      "kubernetes_network_policy_cni_compliance",
      "compute_cni_network_policy_enforcement",
      "container_network_interface_network_policy_capability"
    ]
  },
  {
    "id": "5.3.2",
    "title": "Ensure that all Namespaces have Network Policies defined",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_namespace_network_policy_defined",
      "kubernetes_namespace_network_policy_required",
      "kubernetes_namespace_network_policy_enabled",
      "kubernetes_namespace_network_policy_exists",
      "kubernetes_namespace_network_policy_enforced"
    ]
  },
  {
    "id": "5.4.1",
    "title": "Prefer using secrets as files over secrets as environment variables",
    "assessment": "Manual",
    "remediation": "If possible, rewrite application code to read secrets from mounted secret files, rather than from environment variables. Default Value: By default, application secrets are not defined. In a default OpenShift 4 cluster, the following platform objects are returned Pod aws-ebs-csi-driver-controller-699844b6d7-2pl8k Pod aws-ebs-csi-driver-controller-6dcc794464-gnl6l Pod aws-ebs-csi-driver-controller-6dcc794464-kkhr9 Deployment aws-ebs-csi-driver-controller Deployment aws-ebs-csi-driver-controller ReplicaSet aws-ebs-csi-driver-controller-699844b6d7 ReplicaSet aws-ebs-csi-driver-controller-777d8fbb87 ReplicaSet aws-ebs-csi-driver-controller-658754b8c8 ReplicaSet aws-ebs-csi-driver-controller-6dcc794464 References: 1. https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "references": "1. https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 3.10 Encrypt Sensitive Data in Transit Encrypt sensitive data in transit. Example implementations can include: Transport Layer Security (TLS) and Open Secure Shell (OpenSSH). ● ● v7 14.4 Encrypt All Sensitive Information in Transit Encrypt all sensitive information in transit.  ● ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1552 TA0006 M1026",
    "function_names": [
      "compute_container_secrets_as_files",
      "compute_container_no_environment_secrets",
      "compute_container_secrets_volume_mounted",
      "compute_container_secrets_secure_storage",
      "compute_container_secrets_encrypted_files",
      "compute_container_secrets_filesystem_access",
      "compute_container_secrets_minimal_exposure",
      "compute_container_secrets_immutable_files"
    ]
  },
  {
    "id": "5.4.2",
    "title": "Consider external secret storage",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "secrets_manager_secret_external_storage_enabled",
      "secrets_manager_secret_external_rotation_enabled",
      "secrets_manager_secret_external_access_restricted",
      "secrets_manager_secret_external_encryption_enabled",
      "secrets_manager_secret_external_audit_logging_enabled",
      "secrets_manager_secret_external_versioning_enabled",
      "secrets_manager_secret_external_min_tls_1_2",
      "secrets_manager_secret_external_immutable_policy_enabled"
    ]
  },
  {
    "id": "5.5.1",
    "title": "Configure Image Provenance using image controller configuration parameters",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "compute_image_provenance_enabled",
      "compute_image_controller_configured",
      "compute_image_source_verification_enabled",
      "compute_image_trusted_sources_only",
      "compute_image_signature_validation_enabled",
      "compute_image_immutable_tags_enabled",
      "compute_image_vulnerability_scanning_enabled",
      "compute_image_approved_base_images_only",
      "compute_image_build_process_audited",
      "compute_image_artifact_metadata_recorded"
    ]
  },
  {
    "id": "5.7.1",
    "title": "Create administrative boundaries between resources using namespaces",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "references": "1. https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/ 2. https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes- deployment/ CIS Controls: Controls Version Control IG 1 IG 2 IG 3 v8 4.4 Implement and Manage a Firewall on Servers Implement and manage a firewall on servers, where supported. Example implementations include a virtual firewall, operating system firewall, or a third- party firewall agent. ● ● ● v7 9.5 Implement Application Firewalls Place application firewalls in front of any critical servers to verify and validate the traffic going to the server. Any unauthorized traffic should be blocked and logged. ● MITRE ATT&CK Mappings: Techniques / Sub- techniques Tactics Mitigations T1106, T1609 TA0002, TA0008 M1038"
  },
  {
    "id": "5.7.2",
    "title": "Ensure that the seccomp profile is set to docker/default in your pod definitions",
    "assessment": "Manual",
    "description": "",
    "rationale": "",
    "audit": "",
    "remediation": null,
    "function_names": [
      "kubernetes_pod_seccomp_profile_docker_default",
      "kubernetes_pod_seccomp_profile_configured",
      "kubernetes_pod_security_profile_default",
      "kubernetes_pod_seccomp_profile_enforced",
      "kubernetes_pod_seccomp_profile_valid",
      "kubernetes_pod_security_profile_compliant",
      "kubernetes_pod_seccomp_profile_set",
      "kubernetes_pod_security_profile_docker_default"
    ]
  },
  {
    "id": "5.7.3",
    "title": "Apply Security Context to Your Pods and Containers",
    "assessment": "Manual",
    "remediation": "Follow the Kubernetes documentation and apply security contexts to your pods. For a suggested list of security contexts, you may refer to the CIS Security Benchmark for Docker Containers. Default Value: By default, no security contexts are automatically applied to pods. References: 1. https://kubernetes.io/docs/concepts/policy/security-context/ 2. https://learn.cisecurity.org/benchmarks CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_pod_security_context_configured",
      "kubernetes_container_security_context_configured",
      "kubernetes_pod_read_only_root_filesystem_enabled",
      "kubernetes_container_read_only_root_filesystem_enabled",
      "kubernetes_pod_run_as_non_root_enabled",
      "kubernetes_container_run_as_non_root_enabled",
      "kubernetes_pod_capabilities_dropped",
      "kubernetes_container_capabilities_dropped",
      "kubernetes_pod_privileged_mode_disabled",
      "kubernetes_container_privileged_mode_disabled"
    ]
  },
  {
    "id": "5.7.4",
    "title": "The default namespace should not be used",
    "assessment": "Manual",
    "remediation": "Ensure that namespaces are created to allow for appropriate segregation of Kubernetes resources and that all new resources are created in a specific namespace. Default Value: Unless a namespace is specific on object creation, the default namespace will be used CIS Controls:",
    "description": "",
    "rationale": "",
    "audit": "",
    "function_names": [
      "kubernetes_namespace_default_not_used",
      "kubernetes_namespace_default_avoided",
      "kubernetes_namespace_non_default_required",
      "kubernetes_namespace_default_prohibited",
      "kubernetes_namespace_default_restricted"
    ]
  }
]