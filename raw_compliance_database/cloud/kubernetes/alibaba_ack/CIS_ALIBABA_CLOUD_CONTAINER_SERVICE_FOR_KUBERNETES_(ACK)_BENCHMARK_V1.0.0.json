[
  {
    "id": "1.1.2",
    "title": "Ensure that the API server pod specification file ownership is set to root:root",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tAPI\tserver\tpod\tspecification\tfile\townership\tis\tset\tto\troot:root.",
    "rationale": "The\tAPI\tserver\tpod\tspecification\tfile\tcontrols\tvarious\tparameters\tthat\tset\tthe\tbehavior\tof the\tAPI\tserver.\tYou\tshould\tset\tits\tfile\townership\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile should\tbe\towned\tby\troot:root. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, stat -c %U:%G /etc/kubernetes/manifests/kube-apiserver.yaml Verify\tthat\tthe\townership\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chown root:root /etc/kubernetes/manifests/kube-apiserver.yaml Default\tValue: By\tdefault,\tthe\tkube-apiserver.yaml\tfile\townership\tis\tset\tto\troot:root. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 18\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 19\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 18\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 19\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_pod_spec_ownership_root_root",
      "kubernetes_api_server_pod_file_ownership_root_root",
      "kubernetes_pod_spec_file_ownership_root_root",
      "kubernetes_api_server_file_ownership_root_root",
      "kubernetes_control_plane_pod_spec_ownership_root_root"
    ]
  },
  {
    "id": "1.1.3",
    "title": "Ensure that the controller manager pod specification file permissions are set to 644 or more restrictive",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tcontroller\tmanager\tpod\tspecification\tfile\thas\tpermissions\tof\t644\tor\tmore restrictive.",
    "rationale": "The\tcontroller\tmanager\tpod\tspecification\tfile\tcontrols\tvarious\tparameters\tthat\tset\tthe behavior\tof\tthe\tController\tManager\ton\tthe\tmaster\tnode.\tYou\tshould\trestrict\tits\tfile permissions\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\twritable\tby\tonly\tthe administrators\ton\tthe\tsystem. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, stat -c %a /etc/kubernetes/manifests/kube-controller-manager.yaml Verify\tthat\tthe\tpermissions\tare\t644\tor\tmore\trestrictive.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chmod 644 /etc/kubernetes/manifests/kube-controller-manager.yaml Default\tValue: By\tdefault,\tthe\tkube-controller-manager.yaml\tfile\thas\tpermissions\tof\t640. References: 20\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 21\t|\tP a g e",
    "impact": "None",
    "references": "20\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 21\t|\tP a g e",
    "function_names": [
      "kubernetes_controller_manager_pod_spec_file_permissions_644_or_stricter",
      "kubernetes_controller_manager_pod_spec_file_permissions_restrictive",
      "kubernetes_controller_manager_file_permissions_secure",
      "kubernetes_controller_manager_pod_spec_file_permissions_compliant",
      "kubernetes_controller_manager_file_permissions_644_or_below"
    ]
  },
  {
    "id": "1.1.4",
    "title": "Ensure that the controller manager pod specification file ownership is set to root:root",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tcontroller\tmanager\tpod\tspecification\tfile\townership\tis\tset\tto\troot:root.",
    "rationale": "The\tcontroller\tmanager\tpod\tspecification\tfile\tcontrols\tvarious\tparameters\tthat\tset\tthe behavior\tof\tvarious\tcomponents\tof\tthe\tmaster\tnode.\tYou\tshould\tset\tits\tfile\townership\tto maintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\towned\tby\troot:root. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, stat -c %U:%G /etc/kubernetes/manifests/kube-controller-manager.yaml Verify\tthat\tthe\townership\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chown root:root /etc/kubernetes/manifests/kube-controller-manager.yaml Default\tValue: By\tdefault,\tkube-controller-manager.yaml\tfile\townership\tis\tset\tto\troot:root. References: 1. https://kubernetes.io/docs/admin/kube-controller-manager 22\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 23\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-controller-manager 22\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 23\t|\tP a g e",
    "function_names": [
      "kubernetes_controller_manager_file_ownership_root",
      "kubernetes_controller_manager_pod_spec_ownership_root",
      "kubernetes_controller_manager_file_permissions_root",
      "kubernetes_controller_manager_spec_file_ownership_root",
      "kubernetes_controller_manager_pod_file_ownership_root"
    ]
  },
  {
    "id": "1.1.5",
    "title": "Ensure that the scheduler pod specification file permissions are set to 644 or more restrictive",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tscheduler\tpod\tspecification\tfile\thas\tpermissions\tof\t644\tor\tmore\trestrictive.",
    "rationale": "The\tscheduler\tpod\tspecification\tfile\tcontrols\tvarious\tparameters\tthat\tset\tthe\tbehavior\tof the\tScheduler\tservice\tin\tthe\tmaster\tnode.\tYou\tshould\trestrict\tits\tfile\tpermissions\tto maintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\twritable\tby\tonly\tthe\tadministrators\ton the\tsystem. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, stat -c %a /etc/kubernetes/manifests/kube-scheduler.yaml Verify\tthat\tthe\tpermissions\tare\t644\tor\tmore\trestrictive.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chmod 644 /etc/kubernetes/manifests/kube-scheduler.yaml Default\tValue: By\tdefault,\tkube-scheduler.yaml\tfile\thas\tpermissions\tof\t640. References: 1. https://kubernetes.io/docs/admin/kube-scheduler/ 24\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 25\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-scheduler/ 24\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 25\t|\tP a g e",
    "function_names": [
      "kubernetes_scheduler_pod_file_permissions_644_or_restrictive",
      "kubernetes_scheduler_pod_spec_file_permissions_restrictive",
      "kubernetes_scheduler_pod_spec_file_permissions_secure",
      "kubernetes_scheduler_pod_file_permissions_secure",
      "kubernetes_scheduler_pod_spec_file_permissions_644_or_stricter"
    ]
  },
  {
    "id": "1.1.6",
    "title": "Ensure that the scheduler pod specification file ownership is set to root:root",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tscheduler\tpod\tspecification\tfile\townership\tis\tset\tto\troot:root.",
    "rationale": "The\tscheduler\tpod\tspecification\tfile\tcontrols\tvarious\tparameters\tthat\tset\tthe\tbehavior\tof the\tkube-scheduler\tservice\tin\tthe\tmaster\tnode.\tYou\tshould\tset\tits\tfile\townership\tto maintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\towned\tby\troot:root. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, stat -c %U:%G /etc/kubernetes/manifests/kube-scheduler.yaml Verify\tthat\tthe\townership\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chown root:root /etc/kubernetes/manifests/kube-scheduler.yaml Default\tValue: By\tdefault,\tkube-scheduler.yaml\tfile\townership\tis\tset\tto\troot:root. References: 1. https://kubernetes.io/docs/admin/kube-scheduler/ 26\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 27\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-scheduler/ 26\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 27\t|\tP a g e",
    "function_names": [
      "kubernetes_scheduler_pod_file_ownership_root",
      "kubernetes_scheduler_pod_spec_root_owned",
      "kubernetes_scheduler_pod_file_root_owner",
      "kubernetes_scheduler_pod_spec_ownership_root",
      "kubernetes_scheduler_pod_file_permissions_root"
    ]
  },
  {
    "id": "1.1.7",
    "title": "Ensure that the etcd service file permissions are set to 644 or more restrictive",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\t/usr/lib/systemd/system/etcd.service\tfile\thas\tpermissions\tof\t644\tor more\trestrictive.",
    "rationale": "The\tetcd\tservice\tfile\t/usr/lib/systemd/system/etcd.service\tcontrols\tvarious parameters\tthat\tset\tthe\tbehavior\tof\tthe\tetcd\tservice\tin\tthe\tmaster\tnode.\tetcd\tis\ta\thighly- available\tkey-value\tstore\twhich\tKubernetes\tuses\tfor\tpersistent\tstorage\tof\tall\tof\tits\tREST\tAPI object.\tYou\tshould\trestrict\tits\tfile\tpermissions\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile should\tbe\twritable\tby\tonly\tthe\tadministrators\ton\tthe\tsystem. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, stat -c %a /usr/lib/systemd/system/etcd.service Verify\tthat\tthe\tpermissions\tare\t644\tor\tmore\trestrictive.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chmod 644 /usr/lib/systemd/system/etcd.service Default\tValue: By\tdefault,\t/usr/lib/systemd/system/etcd.service\tfile\thas\tpermissions\tof\t644. References: 28\t|\tP a g e 1. https://coreos.com/etcd 2. https://kubernetes.io/docs/admin/etcd/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 29\t|\tP a g e",
    "impact": "None",
    "references": "28\t|\tP a g e 1. https://coreos.com/etcd 2. https://kubernetes.io/docs/admin/etcd/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 29\t|\tP a g e",
    "function_names": [
      "systemd_service_file_permissions_restrictive",
      "etcd_service_file_permissions_644_or_stricter",
      "systemd_etcd_file_permissions_secure",
      "etcd_systemd_file_permissions_compliant",
      "systemd_etcd_service_file_permissions_restricted"
    ]
  },
  {
    "id": "1.1.8",
    "title": "Ensure that the etcd service file ownership is set to root:root",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\t/usr/lib/systemd/system/etcd.service\tfile\townership\tis\tset\tto root:root.",
    "rationale": "The\tetcd\tservice\tfile\t/usr/lib/systemd/system/etcd.service\tcontrols\tvarious parameters\tthat\tset\tthe\tbehavior\tof\tthe\tetcd\tservice\tin\tthe\tmaster\tnode.\tetcd\tis\ta\thighly- available\tkey-value\tstore\twhich\tKubernetes\tuses\tfor\tpersistent\tstorage\tof\tall\tof\tits\tREST\tAPI object.\tYou\tshould\tset\tits\tfile\townership\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould be\towned\tby\troot:root. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, stat -c %U:%G /usr/lib/systemd/system/etcd.service Verify\tthat\tthe\townership\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chown root:root /usr/lib/systemd/system/etcd.service Default\tValue: By\tdefault,\t/usr/lib/systemd/system/etcd.service\tfile\townership\tis\tset\tto\troot:root. References: 30\t|\tP a g e 1. https://coreos.com/etcd 2. https://kubernetes.io/docs/admin/etcd/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 31\t|\tP a g e",
    "impact": "None",
    "references": "30\t|\tP a g e 1. https://coreos.com/etcd 2. https://kubernetes.io/docs/admin/etcd/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 31\t|\tP a g e",
    "function_names": [
      "etcd_service_file_root_ownership",
      "etcd_service_file_root_group_ownership",
      "etcd_service_file_ownership_root_root",
      "systemd_etcd_service_file_root_ownership",
      "systemd_etcd_service_file_secure_ownership"
    ]
  },
  {
    "id": "1.1.9",
    "title": "Ensure that the Container Network Interface file permissions are set to 644 or more restrictive",
    "assessment": "Manual",
    "description": "Ensure\tthat\tthe\tContainer\tNetwork\tInterface\tfiles\thave\tpermissions\tof\t644\tor\tmore restrictive.",
    "rationale": "Container\tNetwork\tInterface\tprovides\tvarious\tnetworking\toptions\tfor\toverlay\tnetworking. You\tshould\tconsult\ttheir\tdocumentation\tand\trestrict\ttheir\trespective\tfile\tpermissions\tto maintain\tthe\tintegrity\tof\tthose\tfiles.\tThose\tfiles\tshould\tbe\twritable\tby\tonly\tthe administrators\ton\tthe\tsystem. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, stat -c %a <path/to/cni/files> Verify\tthat\tthe\tpermissions\tare\t644\tor\tmore\trestrictive.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chmod 644 <path/to/cni/files> Default\tValue: NA References: 32\t|\tP a g e 1. https://kubernetes.io/docs/concepts/cluster-administration/networking/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 33\t|\tP a g e",
    "impact": "None",
    "references": "32\t|\tP a g e 1. https://kubernetes.io/docs/concepts/cluster-administration/networking/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 33\t|\tP a g e",
    "function_names": [
      "container_cni_file_permissions_restrictive",
      "container_cni_file_permissions_644_or_stricter",
      "container_network_interface_file_permissions_restrictive",
      "container_network_interface_file_permissions_644_or_stricter",
      "container_cni_config_file_permissions_restrictive",
      "container_cni_config_file_permissions_644_or_stricter"
    ]
  },
  {
    "id": "1.1.10",
    "title": "Ensure that the Container Network Interface file ownership is set to root:root",
    "assessment": "Manual",
    "description": "Ensure\tthat\tthe\tContainer\tNetwork\tInterface\tfiles\thave\townership\tset\tto\troot:root.",
    "rationale": "Container\tNetwork\tInterface\tprovides\tvarious\tnetworking\toptions\tfor\toverlay\tnetworking. You\tshould\tconsult\ttheir\tdocumentation\tand\trestrict\ttheir\trespective\tfile\tpermissions\tto maintain\tthe\tintegrity\tof\tthose\tfiles.\tThose\tfiles\tshould\tbe\towned\tby\troot:root. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, stat -c %U:%G <path/to/cni/files> Verify\tthat\tthe\townership\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chown root:root <path/to/cni/files> Default\tValue: NA References: 1. https://kubernetes.io/docs/concepts/cluster-administration/networking/ 34\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 35\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/concepts/cluster-administration/networking/ 34\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 35\t|\tP a g e",
    "function_names": [
      "container_network_interface_file_ownership_root",
      "container_network_interface_file_owner_root",
      "container_network_interface_file_group_root",
      "container_network_interface_file_permissions_root_only",
      "container_network_interface_file_secure_ownership"
    ]
  },
  {
    "id": "1.1.11",
    "title": "Ensure that the etcd data directory permissions are set to 700 or more restrictive",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tetcd\tdata\tdirectory\thas\tpermissions\tof\t700\tor\tmore\trestrictive.",
    "rationale": "etcd\tis\ta\thighly-available\tkey-value\tstore\tused\tby\tKubernetes\tdeployments\tfor\tpersistent storage\tof\tall\tof\tits\tREST\tAPI\tobjects.\tThis\tdata\tdirectory\tshould\tbe\tprotected\tfrom\tany unauthorized\treads\tor\twrites.\tIt\tshould\tnot\tbe\treadable\tor\twritable\tby\tany\tgroup\tmembers or\tthe\tworld. Impact: None",
    "audit": "On\tthe\tetcd\tserver\tnode,\tget\tthe\tetcd\tdata\tdirectory,\tpassed\tas\tan\targument\t--data-dir, from\tthe\tbelow\tcommand: ps -ef | grep etcd Run\tthe\tbelow\tcommand\t(based\ton\tthe\tetcd\tdata\tdirectory\tfound\tabove).\tFor\texample, stat -c %a /var/lib/etcd/data.etcd Verify\tthat\tthe\tpermissions\tare\t700\tor\tmore\trestrictive.",
    "remediation": "On\tthe\tetcd\tserver\tnode,\tget\tthe\tetcd\tdata\tdirectory,\tpassed\tas\tan\targument\t--data-dir, from\tthe\tbelow\tcommand: ps -ef | grep etcd Run\tthe\tbelow\tcommand\t(based\ton\tthe\tetcd\tdata\tdirectory\tfound\tabove).\tFor\texample, chmod 700 /var/lib/etcd/data.etcd 36\t|\tP a g e Default\tValue: By\tdefault,\tetcd\tdata\tdirectory\thas\tpermissions\tof\t755. References: 1. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#data-dir 2. https://kubernetes.io/docs/admin/etcd/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 37\t|\tP a g e",
    "impact": "None",
    "references": "1. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#data-dir 2. https://kubernetes.io/docs/admin/etcd/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 37\t|\tP a g e",
    "function_names": [
      "etcd_data_directory_permissions_700_or_more_restrictive",
      "etcd_data_directory_permissions_restrictive",
      "etcd_directory_permissions_secure",
      "etcd_data_directory_permissions_compliant",
      "etcd_directory_permissions_700_or_stricter"
    ]
  },
  {
    "id": "1.1.12",
    "title": "Ensure that the etcd data directory ownership is set to etcd:etcd",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tetcd\tdata\tdirectory\townership\tis\tset\tto\tetcd:etcd.",
    "rationale": "etcd\tis\ta\thighly-available\tkey-value\tstore\tused\tby\tKubernetes\tdeployments\tfor\tpersistent storage\tof\tall\tof\tits\tREST\tAPI\tobjects.\tThis\tdata\tdirectory\tshould\tbe\tprotected\tfrom\tany unauthorized\treads\tor\twrites.\tIt\tshould\tbe\towned\tby\tetcd:etcd. Impact: None",
    "audit": "On\tthe\tetcd\tserver\tnode,\tget\tthe\tetcd\tdata\tdirectory,\tpassed\tas\tan\targument\t--data-dir, from\tthe\tbelow\tcommand: ps -ef | grep etcd Run\tthe\tbelow\tcommand\t(based\ton\tthe\tetcd\tdata\tdirectory\tfound\tabove).\tFor\texample, stat -c %U:%G /var/lib/etcd/data.etcd Verify\tthat\tthe\townership\tis\tset\tto\tetcd:etcd.",
    "remediation": "On\tthe\tetcd\tserver\tnode,\tget\tthe\tetcd\tdata\tdirectory,\tpassed\tas\tan\targument\t--data-dir, from\tthe\tbelow\tcommand: ps -ef | grep etcd Run\tthe\tbelow\tcommand\t(based\ton\tthe\tetcd\tdata\tdirectory\tfound\tabove).\tFor\texample, chown etcd:etcd /var/lib/etcd/data.etcd 38\t|\tP a g e Default\tValue: By\tdefault,\tetcd\tdata\tdirectory\townership\tis\tset\tto\tetcd:etcd. References: 1. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#data-dir 2. https://kubernetes.io/docs/admin/etcd/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 39\t|\tP a g e",
    "impact": "None",
    "references": "1. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#data-dir 2. https://kubernetes.io/docs/admin/etcd/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 39\t|\tP a g e",
    "function_names": [
      "etcd_data_directory_ownership_etcd_etcd",
      "etcd_directory_permissions_etcd_etcd",
      "etcd_data_directory_correct_ownership",
      "etcd_directory_ownership_valid",
      "etcd_data_directory_secure_ownership"
    ]
  },
  {
    "id": "1.1.13",
    "title": "Ensure that the admin.conf file permissions are set to 644 or more restrictive",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tadmin.conf\tfile\thas\tpermissions\tof\t644\tor\tmore\trestrictive.",
    "rationale": "The\tadmin.conf\tis\tthe\tadministrator\tkubeconfig\tfile\tdefining\tvarious\tsettings\tfor\tthe administration\tof\tthe\tcluster.\tYou\tshould\trestrict\tits\tfile\tpermissions\tto\tmaintain\tthe integrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\twritable\tby\tonly\tthe\tadministrators\ton\tthe\tsystem. Impact: None.",
    "audit": "Run\tthe\tfollowing\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster node.\tFor\texample, stat -c %a /etc/kubernetes/admin.conf Verify\tthat\tthe\tpermissions\tare\t644\tor\tmore\trestrictive.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chmod 644 /etc/kubernetes/admin.conf Default\tValue: By\tdefault,\tadmin.conf\thas\tpermissions\tof\t640. References: 1. https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/ 40\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 41\t|\tP a g e",
    "impact": "None.",
    "references": "1. https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/ 40\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 41\t|\tP a g e",
    "function_names": [
      "kubernetes_admin_conf_file_permissions_restrictive",
      "kubernetes_admin_conf_file_permissions_644_or_stricter",
      "kubernetes_admin_conf_file_permissions_secure",
      "kubernetes_admin_conf_file_permissions_compliant",
      "kubernetes_admin_conf_file_permissions_cis_benchmark"
    ]
  },
  {
    "id": "1.1.14",
    "title": "Ensure that the admin.conf file ownership is set to root:root",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tadmin.conf\tfile\townership\tis\tset\tto\troot:root.",
    "rationale": "The\tadmin.conf\tfile\tcontains\tthe\tadmin\tcredentials\tfor\tthe\tcluster.\tYou\tshould\tset\tits\tfile ownership\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\towned\tby\troot:root. Impact: None.",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, stat -c %U:%G /etc/kubernetes/admin.conf Verify\tthat\tthe\townership\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chown root:root /etc/kubernetes/admin.conf Default\tValue: By\tdefault,\tadmin.conf\tfile\townership\tis\tset\tto\troot:root. References: 1. https://kubernetes.io/docs/admin/kubeadm/ Additional\tInformation: 42\t|\tP a g e This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 43\t|\tP a g e",
    "impact": "None.",
    "references": "1. https://kubernetes.io/docs/admin/kubeadm/ Additional\tInformation: 42\t|\tP a g e This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 43\t|\tP a g e",
    "function_names": [
      "kubernetes_admin_conf_ownership_root",
      "kubernetes_admin_conf_ownership_root_root",
      "kubernetes_file_admin_conf_ownership_root",
      "kubernetes_file_admin_conf_ownership_root_root",
      "kube_config_admin_conf_ownership_root",
      "kube_config_admin_conf_ownership_root_root"
    ]
  },
  {
    "id": "1.1.15",
    "title": "Ensure that the scheduler.conf file permissions are set to 644 or more restrictive",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tscheduler.conf\tfile\thas\tpermissions\tof\t644\tor\tmore\trestrictive.",
    "rationale": "The\tscheduler.conf\tfile\tis\tthe\tkubeconfig\tfile\tfor\tthe\tScheduler.\tYou\tshould\trestrict\tits\tfile permissions\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\twritable\tby\tonly\tthe administrators\ton\tthe\tsystem. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster node.\tFor\texample, stat -c %a /etc/kubernetes/scheduler.conf Verify\tthat\tthe\tpermissions\tare\t644\tor\tmore\trestrictive.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chmod 644 /etc/kubernetes/scheduler.conf Default\tValue: By\tdefault,\tscheduler.conf\thas\tpermissions\tof\t640. References: 1. https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/ 44\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 45\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/ 44\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 45\t|\tP a g e",
    "function_names": [
      "compute_scheduler_conf_file_permissions_644_or_restrictive",
      "compute_scheduler_conf_file_permissions_restrictive",
      "compute_scheduler_conf_file_permissions_secure",
      "compute_scheduler_conf_file_permissions_compliant",
      "compute_scheduler_conf_file_permissions_protected"
    ]
  },
  {
    "id": "1.1.16",
    "title": "Ensure that the scheduler.conf file ownership is set to root:root",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tscheduler.conf\tfile\townership\tis\tset\tto\troot:root.",
    "rationale": "The\tscheduler.conf\tfile\tis\tthe\tkubeconfig\tfile\tfor\tthe\tScheduler.\tYou\tshould\tset\tits\tfile ownership\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\towned\tby\troot:root. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, stat -c %U:%G /etc/kubernetes/scheduler.conf Verify\tthat\tthe\townership\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chown root:root /etc/kubernetes/scheduler.conf Default\tValue: By\tdefault,\tscheduler.conf\tfile\townership\tis\tset\tto\troot:root. References: 1. https://kubernetes.io/docs/admin/kubeadm/ Additional\tInformation: 46\t|\tP a g e This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 47\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kubeadm/ Additional\tInformation: 46\t|\tP a g e This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 47\t|\tP a g e",
    "function_names": [
      "compute_scheduler_conf_root_ownership",
      "compute_scheduler_conf_root_group_ownership",
      "compute_scheduler_conf_file_ownership_root",
      "scheduler_conf_file_root_ownership",
      "scheduler_conf_root_user_group_ownership"
    ]
  },
  {
    "id": "1.1.17",
    "title": "Ensure that the controller-manager.conf file permissions are set to 644 or more restrictive",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tcontroller-manager.conf\tfile\thas\tpermissions\tof\t644\tor\tmore\trestrictive.",
    "rationale": "The\tcontroller-manager.conf\tfile\tis\tthe\tkubeconfig\tfile\tfor\tthe\tController\tManager.\tYou should\trestrict\tits\tfile\tpermissions\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe writable\tby\tonly\tthe\tadministrators\ton\tthe\tsystem. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster node.\tFor\texample, stat -c %a /etc/kubernetes/controller-manager.conf Verify\tthat\tthe\tpermissions\tare\t644\tor\tmore\trestrictive.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chmod 644 /etc/kubernetes/controller-manager.conf Default\tValue: By\tdefault,\tcontroller-manager.conf\thas\tpermissions\tof\t640. References: 1. https://kubernetes.io/docs/admin/kube-controller-manager/ 48\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 49\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-controller-manager/ 48\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 49\t|\tP a g e",
    "function_names": [
      "kubernetes_controller_manager_conf_file_permissions_restrictive",
      "kubernetes_controller_manager_conf_file_permissions_644_or_stricter",
      "kubernetes_controller_manager_conf_file_permissions_secure",
      "kubernetes_controller_manager_conf_file_permissions_compliant",
      "kubernetes_controller_manager_conf_file_permissions_cis_benchmark"
    ]
  },
  {
    "id": "1.1.18",
    "title": "Ensure that the controller-manager.conf file ownership is set to root:root",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tcontroller-manager.conf\tfile\townership\tis\tset\tto\troot:root.",
    "rationale": "The\tcontroller-manager.conf\tfile\tis\tthe\tkubeconfig\tfile\tfor\tthe\tController\tManager.\tYou should\tset\tits\tfile\townership\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\towned by\troot:root. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, stat -c %U:%G /etc/kubernetes/controller-manager.conf Verify\tthat\tthe\townership\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chown root:root /etc/kubernetes/controller-manager.conf Default\tValue: By\tdefault,\tcontroller-manager.conf\tfile\townership\tis\tset\tto\troot:root. References: 1. https://kubernetes.io/docs/admin/kube-controller-manager/ 50\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 51\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-controller-manager/ 50\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 51\t|\tP a g e",
    "function_names": [
      "kubernetes_controller_manager_conf_file_ownership_root",
      "kubernetes_controller_manager_conf_file_group_ownership_root",
      "kubernetes_controller_manager_conf_file_permissions_secure",
      "kubernetes_controller_manager_conf_file_ownership_correct",
      "kubernetes_controller_manager_conf_file_root_owned"
    ]
  },
  {
    "id": "1.1.19",
    "title": "Ensure that the Kubernetes PKI directory and file ownership is set to root:root",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tKubernetes\tPKI\tdirectory\tand\tfile\townership\tis\tset\tto\troot:root.",
    "rationale": "Kubernetes\tmakes\tuse\tof\ta\tnumber\tof\tcertificates\tas\tpart\tof\tits\toperation.\tYou\tshould\tset the\townership\tof\tthe\tdirectory\tcontaining\tthe\tPKI\tinformation\tand\tall\tfiles\tin\tthat\tdirectory to\tmaintain\ttheir\tintegrity.\tThe\tdirectory\tand\tfiles\tshould\tbe\towned\tby\troot:root. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, ls -laR /etc/kubernetes/pki/ Verify\tthat\tthe\townership\tof\tall\tfiles\tand\tdirectories\tin\tthis\thierarchy\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chown -R root:root /etc/kubernetes/pki/ Default\tValue: By\tdefault,\tthe\t/etc/kubernetes/pki/\tdirectory\tand\tall\tof\tthe\tfiles\tand\tdirectories\tcontained within\tit,\tare\tset\tto\tbe\towned\tby\tthe\troot\tuser. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 52\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 53\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 52\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 53\t|\tP a g e",
    "function_names": [
      "kubernetes_pki_directory_root_owned",
      "kubernetes_pki_file_root_owned",
      "kubernetes_pki_directory_and_file_root_owned"
    ]
  },
  {
    "id": "1.1.20",
    "title": "Ensure that the Kubernetes PKI certificate file permissions are set to 644 or more restrictive",
    "assessment": "Manual",
    "description": "Ensure\tthat\tKubernetes\tPKI\tcertificate\tfiles\thave\tpermissions\tof\t644\tor\tmore\trestrictive.",
    "rationale": "Kubernetes\tmakes\tuse\tof\ta\tnumber\tof\tcertificate\tfiles\tas\tpart\tof\tthe\toperation\tof\tits components.\tThe\tpermissions\ton\tthese\tfiles\tshould\tbe\tset\tto\t644\tor\tmore\trestrictive\tto protect\ttheir\tintegrity. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, ls -laR /etc/kubernetes/pki/*.crt Verify\tthat\tthe\tpermissions\tare\t644\tor\tmore\trestrictive.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chmod -R 644 /etc/kubernetes/pki/*.crt Default\tValue: By\tdefault,\tthe\tcertificates\tused\tby\tKubernetes\tare\tset\tto\thave\tpermissions\tof\t644 References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 54\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 55\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 54\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 55\t|\tP a g e",
    "function_names": [
      "kubernetes_pki_certificate_file_permissions_644_or_restrictive",
      "kubernetes_pki_certificate_file_permissions_restrictive",
      "kubernetes_certificate_file_permissions_secure",
      "kubernetes_pki_certificate_file_permissions_compliant",
      "kubernetes_certificate_file_permissions_644_or_stricter"
    ]
  },
  {
    "id": "1.1.21",
    "title": "Ensure that the Kubernetes PKI key file permissions are set to 600",
    "assessment": "Manual",
    "description": "Ensure\tthat\tKubernetes\tPKI\tkey\tfiles\thave\tpermissions\tof\t600.",
    "rationale": "Kubernetes\tmakes\tuse\tof\ta\tnumber\tof\tkey\tfiles\tas\tpart\tof\tthe\toperation\tof\tits\tcomponents. The\tpermissions\ton\tthese\tfiles\tshould\tbe\tset\tto\t600\tto\tprotect\ttheir\tintegrity\tand confidentiality. Impact: None",
    "audit": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, ls -laR /etc/kubernetes/pki/*.key Verify\tthat\tthe\tpermissions\tare\t600.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\tmaster\tnode. For\texample, chmod -R 600 /etc/kubernetes/pki/*.key Default\tValue: By\tdefault,\tthe\tkeys\tused\tby\tKubernetes\tare\tset\tto\thave\tpermissions\tof\t600 References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 56\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 57\t|\tP a g e 1.2 API Server This\tsection\tcontains\trecommendations\trelating\tto\tAPI\tserver\tconfiguration\tflags",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 56\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 57\t|\tP a g e 1.2 API Server This\tsection\tcontains\trecommendations\trelating\tto\tAPI\tserver\tconfiguration\tflags",
    "function_names": [
      "kubernetes_pki_key_file_permissions_600",
      "kubernetes_pki_key_file_permissions_restricted",
      "kubernetes_pki_key_file_permissions_secure",
      "kubernetes_pki_key_file_permissions_strict",
      "kubernetes_pki_key_file_permissions_protected"
    ]
  },
  {
    "id": "1.2.1",
    "title": "Ensure that the --basic-auth-file argument is not set",
    "assessment": "Automated",
    "description": "Do\tnot\tuse\tbasic\tauthentication.",
    "rationale": "Basic\tauthentication\tuses\tplaintext\tcredentials\tfor\tauthentication.\tCurrently,\tthe\tbasic authentication\tcredentials\tlast\tindefinitely,\tand\tthe\tpassword\tcannot\tbe\tchanged\twithout restarting\tthe\tAPI\tserver.\tThe\tbasic\tauthentication\tis\tcurrently\tsupported\tfor\tconvenience. Hence,\tbasic\tauthentication\tshould\tnot\tbe\tused. Impact: You\twill\thave\tto\tconfigure\tand\tuse\talternate\tauthentication\tmechanisms\tsuch\tas\ttokens\tand certificates.\tUsername\tand\tpassword\tfor\tbasic\tauthentication\tcould\tno\tlonger\tbe\tused.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--basic-auth-file\targument\tdoes\tnot\texist.",
    "remediation": "Follow\tthe\tdocumentation\tand\tconfigure\talternate\tmechanisms\tfor\tauthentication.\tThen, edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tremove\tthe\t--basic-auth-file=<filename> parameter. Default\tValue: By\tdefault,\tbasic\tauthentication\tis\tnot\tset. 58\t|\tP a g e References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/authentication/#static-password-file Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 16.14\tEncrypt/Hash\tAll\tAuthentication\tFiles\tAnd\tMonitor\tTheir\tAccess Verify\tthat\tall\tauthentication\tfiles\tare\tencrypted\tor\thashed\tand\tthat\tthese\tfiles\tcannot\tbe accessed\twithout\troot\tor\tadministrator\tprivileges.\tAudit\tall\taccess\tto\tpassword\tfiles\tin\tthe system. Version\t7 16.4\tEncrypt\tor\tHash\tall\tAuthentication\tCredentials Encrypt\tor\thash\twith\ta\tsalt\tall\tauthentication\tcredentials\twhen\tstored. 59\t|\tP a g e",
    "impact": "You\twill\thave\tto\tconfigure\tand\tuse\talternate\tauthentication\tmechanisms\tsuch\tas\ttokens\tand certificates.\tUsername\tand\tpassword\tfor\tbasic\tauthentication\tcould\tno\tlonger\tbe\tused.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/authentication/#static-password-file Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 16.14\tEncrypt/Hash\tAll\tAuthentication\tFiles\tAnd\tMonitor\tTheir\tAccess Verify\tthat\tall\tauthentication\tfiles\tare\tencrypted\tor\thashed\tand\tthat\tthese\tfiles\tcannot\tbe accessed\twithout\troot\tor\tadministrator\tprivileges.\tAudit\tall\taccess\tto\tpassword\tfiles\tin\tthe system. Version\t7 16.4\tEncrypt\tor\tHash\tall\tAuthentication\tCredentials Encrypt\tor\thash\twith\ta\tsalt\tall\tauthentication\tcredentials\twhen\tstored. 59\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_no_basic_auth_file",
      "kubernetes_api_server_basic_auth_disabled",
      "kubernetes_api_server_auth_file_unset",
      "kubernetes_api_server_no_basic_auth",
      "kubernetes_api_server_auth_file_removed"
    ]
  },
  {
    "id": "1.2.2",
    "title": "Ensure that the --token-auth-file parameter is not set",
    "assessment": "Automated",
    "description": "Do\tnot\tuse\ttoken\tbased\tauthentication.",
    "rationale": "The\ttoken-based\tauthentication\tutilizes\tstatic\ttokens\tto\tauthenticate\trequests\tto\tthe apiserver.\tThe\ttokens\tare\tstored\tin\tclear-text\tin\ta\tfile\ton\tthe\tapiserver,\tand\tcannot\tbe revoked\tor\trotated\twithout\trestarting\tthe\tapiserver.\tHence,\tdo\tnot\tuse\tstatic\ttoken-based authentication. Impact: You\twill\thave\tto\tconfigure\tand\tuse\talternate\tauthentication\tmechanisms\tsuch\tas certificates.\tStatic\ttoken\tbased\tauthentication\tcould\tnot\tbe\tused.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--token-auth-file\targument\tdoes\tnot\texist.",
    "remediation": "Follow\tthe\tdocumentation\tand\tconfigure\talternate\tmechanisms\tfor\tauthentication.\tThen, edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tremove\tthe\t--token-auth-file=<filename> parameter. Default\tValue: By\tdefault,\t--token-auth-file\targument\tis\tnot\tset. References: 1. https://kubernetes.io/docs/admin/authentication/#static-token-file 2. https://kubernetes.io/docs/admin/kube-apiserver/ 60\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 16.14\tEncrypt/Hash\tAll\tAuthentication\tFiles\tAnd\tMonitor\tTheir\tAccess Verify\tthat\tall\tauthentication\tfiles\tare\tencrypted\tor\thashed\tand\tthat\tthese\tfiles\tcannot\tbe accessed\twithout\troot\tor\tadministrator\tprivileges.\tAudit\tall\taccess\tto\tpassword\tfiles\tin\tthe system. Version\t7 16.4\tEncrypt\tor\tHash\tall\tAuthentication\tCredentials Encrypt\tor\thash\twith\ta\tsalt\tall\tauthentication\tcredentials\twhen\tstored. 61\t|\tP a g e",
    "impact": "You\twill\thave\tto\tconfigure\tand\tuse\talternate\tauthentication\tmechanisms\tsuch\tas certificates.\tStatic\ttoken\tbased\tauthentication\tcould\tnot\tbe\tused.",
    "references": "1. https://kubernetes.io/docs/admin/authentication/#static-token-file 2. https://kubernetes.io/docs/admin/kube-apiserver/ 60\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 16.14\tEncrypt/Hash\tAll\tAuthentication\tFiles\tAnd\tMonitor\tTheir\tAccess Verify\tthat\tall\tauthentication\tfiles\tare\tencrypted\tor\thashed\tand\tthat\tthese\tfiles\tcannot\tbe accessed\twithout\troot\tor\tadministrator\tprivileges.\tAudit\tall\taccess\tto\tpassword\tfiles\tin\tthe system. Version\t7 16.4\tEncrypt\tor\tHash\tall\tAuthentication\tCredentials Encrypt\tor\thash\twith\ta\tsalt\tall\tauthentication\tcredentials\twhen\tstored. 61\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_token_auth_file_disabled",
      "kubernetes_api_server_token_auth_file_not_set",
      "kubernetes_api_server_token_auth_file_unused",
      "kubernetes_api_server_token_auth_file_absent",
      "kubernetes_api_server_token_auth_file_forbidden"
    ]
  },
  {
    "id": "1.2.3",
    "title": "Ensure that the --kubelet-https argument is set to true",
    "assessment": "Automated",
    "description": "Use\thttps\tfor\tkubelet\tconnections.",
    "rationale": "Connections\tfrom\tapiserver\tto\tkubelets\tcould\tpotentially\tcarry\tsensitive\tdata\tsuch\tas secrets\tand\tkeys.\tIt\tis\tthus\timportant\tto\tuse\tin-transit\tencryption\tfor\tany\tcommunication between\tthe\tapiserver\tand\tkubelets. Impact: You\trequire\tTLS\tto\tbe\tconfigured\ton\tapiserver\tas\twell\tas\tkubelets.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--kubelet-https\targument\teither\tdoes\tnot\texist\tor\tis\tset\tto\ttrue.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tremove\tthe\t--kubelet-https\tparameter. Default\tValue: By\tdefault,\tkubelet\tconnections\tare\tover\thttps. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/kubelet-authentication-authorization/ Additional\tInformation: 62\t|\tP a g e This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 63\t|\tP a g e",
    "impact": "You\trequire\tTLS\tto\tbe\tconfigured\ton\tapiserver\tas\twell\tas\tkubelets.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/kubelet-authentication-authorization/ Additional\tInformation: 62\t|\tP a g e This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 63\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_https_enabled",
      "kubernetes_kubelet_secure_connection",
      "kubernetes_kubelet_tls_required",
      "kubernetes_kubelet_encrypted_communication",
      "kubernetes_kubelet_https_enforced"
    ]
  },
  {
    "id": "1.2.4",
    "title": "Ensure that the --kubelet-client-certificate and --kubelet-client-key arguments are set as appropriate",
    "assessment": "Automated",
    "description": "Enable\tcertificate\tbased\tkubelet\tauthentication.",
    "rationale": "The\tapiserver,\tby\tdefault,\tdoes\tnot\tauthenticate\titself\tto\tthe\tkubelet's\tHTTPS\tendpoints. The\trequests\tfrom\tthe\tapiserver\tare\ttreated\tanonymously.\tYou\tshould\tset\tup\tcertificate- based\tkubelet\tauthentication\tto\tensure\tthat\tthe\tapiserver\tauthenticates\titself\tto\tkubelets when\tsubmitting\trequests. Impact: You\trequire\tTLS\tto\tbe\tconfigured\ton\tapiserver\tas\twell\tas\tkubelets.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--kubelet-client-certificate\tand\t--kubelet-client-key\targuments exist\tand\tthey\tare\tset\tas\tappropriate.",
    "remediation": "Follow\tthe\tKubernetes\tdocumentation\tand\tset\tup\tthe\tTLS\tconnection\tbetween\tthe apiserver\tand\tkubelets.\tThen,\tedit\tAPI\tserver\tpod\tspecification\tfile /etc/kubernetes/manifests/kube-apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe kubelet\tclient\tcertificate\tand\tkey\tparameters\tas\tbelow. --kubelet-client-certificate=<path/to/client-certificate-file> --kubelet-client-key=<path/to/client-key-file> Default\tValue: By\tdefault,\tcertificate-based\tkubelet\tauthentication\tis\tnot\tset. 64\t|\tP a g e References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/kubelet-authentication-authorization/ 3. https://kubernetes.io/docs/concepts/cluster-administration/master-node- communication/#apiserver---kubelet Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 3.4\tUse\tOnly\tSecure\tChannels\tFor\tRemote\tSystem\tAdministration Perform\tall\tremote\tadministration\tof\tservers,\tworkstation,\tnetwork\tdevices,\tand\tsimilar equipment\tover\tsecure\tchannels.\tProtocols\tsuch\tas\ttelnet,\tVNC,\tRDP,\tor\tothers\tthat\tdo\tnot actively\tsupport\tstrong\tencryption\tshould\tonly\tbe\tused\tif\tthey\tare\tperformed\tover\ta secondary\tencryption\tchannel,\tsuch\tas\tSSL,\tTLS\tor\tIPSEC. Version\t7 4.5\tUse\tMultifactor\tAuthentication\tFor\tAll\tAdministrative\tAccess Use\tmulti-factor\tauthentication\tand\tencrypted\tchannels\tfor\tall\tadministrative\taccount access. 65\t|\tP a g e",
    "impact": "You\trequire\tTLS\tto\tbe\tconfigured\ton\tapiserver\tas\twell\tas\tkubelets.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/kubelet-authentication-authorization/ 3. https://kubernetes.io/docs/concepts/cluster-administration/master-node- communication/#apiserver---kubelet Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 3.4\tUse\tOnly\tSecure\tChannels\tFor\tRemote\tSystem\tAdministration Perform\tall\tremote\tadministration\tof\tservers,\tworkstation,\tnetwork\tdevices,\tand\tsimilar equipment\tover\tsecure\tchannels.\tProtocols\tsuch\tas\ttelnet,\tVNC,\tRDP,\tor\tothers\tthat\tdo\tnot actively\tsupport\tstrong\tencryption\tshould\tonly\tbe\tused\tif\tthey\tare\tperformed\tover\ta secondary\tencryption\tchannel,\tsuch\tas\tSSL,\tTLS\tor\tIPSEC. Version\t7 4.5\tUse\tMultifactor\tAuthentication\tFor\tAll\tAdministrative\tAccess Use\tmulti-factor\tauthentication\tand\tencrypted\tchannels\tfor\tall\tadministrative\taccount access. 65\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_client_certificate_set",
      "kubernetes_kubelet_client_key_set",
      "kubernetes_kubelet_certificate_authentication_enabled",
      "kubernetes_kubelet_client_certificate_valid",
      "kubernetes_kubelet_client_key_valid"
    ]
  },
  {
    "id": "1.2.5",
    "title": "Ensure that the --authorization-mode argument is not set to AlwaysAllow",
    "assessment": "Automated",
    "description": "Do\tnot\talways\tauthorize\tall\trequests.",
    "rationale": "The\tAPI\tServer,\tcan\tbe\tconfigured\tto\tallow\tall\trequests.\tThis\tmode\tshould\tnot\tbe\tused\ton any\tproduction\tcluster. Impact: Only\tauthorized\trequests\twill\tbe\tserved.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--authorization-mode\targument\texists\tand\tis\tnot\tset\tto\tAlwaysAllow.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--authorization-mode\tparameter\tto values\tother\tthan\tAlwaysAllow.\tOne\tsuch\texample\tcould\tbe\tas\tbelow. --authorization-mode=RBAC Default\tValue: By\tdefault,\tAlwaysAllow\tis\tnot\tenabled. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/authorization/ 66\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 67\t|\tP a g e",
    "impact": "Only\tauthorized\trequests\twill\tbe\tserved.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/authorization/ 66\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 67\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_authorization_mode_not_always_allow",
      "kubernetes_api_server_authorization_mode_restricted",
      "kubernetes_api_server_secure_authorization_mode",
      "kubernetes_api_server_no_always_allow_auth",
      "kubernetes_api_server_auth_mode_compliant"
    ]
  },
  {
    "id": "1.2.6",
    "title": "Ensure that the --authorization-mode argument includes Node",
    "assessment": "Automated",
    "description": "Restrict\tkubelet\tnodes\tto\treading\tonly\tobjects\tassociated\twith\tthem.",
    "rationale": "The\tNode\tauthorization\tmode\tonly\tallows\tkubelets\tto\tread\tSecret,\tConfigMap, PersistentVolume,\tand\tPersistentVolumeClaim\tobjects\tassociated\twith\ttheir\tnodes. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--authorization-mode\targument\texists\tand\tis\tset\tto\ta\tvalue\tto\tinclude\tNode.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--authorization-mode\tparameter\tto\ta value\tthat\tincludes\tNode. --authorization-mode=Node,RBAC Default\tValue: By\tdefault,\tNode\tauthorization\tis\tenabled. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/authorization/node/ 3. https://github.com/kubernetes/kubernetes/pull/46076 68\t|\tP a g e 4. https://acotten.com/post/kube17-security Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 69\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/authorization/node/ 3. https://github.com/kubernetes/kubernetes/pull/46076 68\t|\tP a g e 4. https://acotten.com/post/kube17-security Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 69\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_node_authorization_enabled",
      "kubernetes_kubelet_node_authorization_required",
      "kubernetes_kubelet_authorization_mode_node_included",
      "kubernetes_kubelet_node_restricted_authorization",
      "kubernetes_kubelet_node_scope_authorization_enabled"
    ]
  },
  {
    "id": "1.2.7",
    "title": "Ensure that the --authorization-mode argument includes RBAC",
    "assessment": "Automated",
    "description": "Turn\ton\tRole\tBased\tAccess\tControl.",
    "rationale": "Role\tBased\tAccess\tControl\t(RBAC)\tallows\tfine-grained\tcontrol\tover\tthe\toperations\tthat different\tentities\tcan\tperform\ton\tdifferent\tobjects\tin\tthe\tcluster.\tIt\tis\trecommended\tto\tuse the\tRBAC\tauthorization\tmode. Impact: When\tRBAC\tis\tenabled\tyou\twill\tneed\tto\tensure\tthat\tappropriate\tRBAC\tsettings\t(including Roles,\tRoleBindings\tand\tClusterRoleBindings)\tare\tconfigured\tto\tallow\tappropriate\taccess.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--authorization-mode\targument\texists\tand\tis\tset\tto\ta\tvalue\tto\tinclude\tRBAC.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--authorization-mode\tparameter\tto\ta value\tthat\tincludes\tRBAC,\tfor\texample: --authorization-mode=Node,RBAC Default\tValue: By\tdefault,\tRBAC\tauthorization\tis\tenabled. References: 1. https://kubernetes.io/docs/reference/access-authn-authz/rbac/ 70\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 71\t|\tP a g e",
    "impact": "When\tRBAC\tis\tenabled\tyou\twill\tneed\tto\tensure\tthat\tappropriate\tRBAC\tsettings\t(including Roles,\tRoleBindings\tand\tClusterRoleBindings)\tare\tconfigured\tto\tallow\tappropriate\taccess.",
    "references": "1. https://kubernetes.io/docs/reference/access-authn-authz/rbac/ 70\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 71\t|\tP a g e",
    "function_names": [
      "kubernetes_cluster_rbac_enabled",
      "kubernetes_api_server_authorization_mode_rbac",
      "kubernetes_cluster_authorization_rbac_required",
      "kubernetes_api_server_rbac_enabled",
      "kubernetes_cluster_rbac_authorization_enabled"
    ]
  },
  {
    "id": "1.2.8",
    "title": "Ensure that the admission control plugin EventRateLimit is set",
    "assessment": "Manual",
    "description": "Limit\tthe\trate\tat\twhich\tthe\tAPI\tserver\taccepts\trequests.",
    "rationale": "Using\tEventRateLimit\tadmission\tcontrol\tenforces\ta\tlimit\ton\tthe\tnumber\tof\tevents\tthat\tthe API\tServer\twill\taccept\tin\ta\tgiven\ttime\tslice.\tA\tmisbehaving\tworkload\tcould\toverwhelm\tand DoS\tthe\tAPI\tServer,\tmaking\tit\tunavailable.\tThis\tparticularly\tapplies\tto\ta\tmulti-tenant cluster,\twhere\tthere\tmight\tbe\ta\tsmall\tpercentage\tof\tmisbehaving\ttenants\twhich\tcould\thave a\tsignificant\timpact\ton\tthe\tperformance\tof\tthe\tcluster\toverall.\tHence,\tit\tis\trecommended\tto limit\tthe\trate\tof\tevents\tthat\tthe\tAPI\tserver\twill\taccept. Note:\tThis\tis\tan\tAlpha\tfeature\tin\tthe\tKubernetes\t1.15\trelease. Impact: You\tneed\tto\tcarefully\ttune\tin\tlimits\tas\tper\tyour\tenvironment.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--enable-admission-plugins\targument\tis\tset\tto\ta\tvalue\tthat\tincludes EventRateLimit.",
    "remediation": "Follow\tthe\tKubernetes\tdocumentation\tand\tset\tthe\tdesired\tlimits\tin\ta\tconfiguration\tfile. Then,\tedit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\tand\tset\tthe\tbelow\tparameters. --enable-admission-plugins=...,EventRateLimit,... --admission-control-config-file=<path/to/configuration/file> Default\tValue: 72\t|\tP a g e By\tdefault,\tEventRateLimit\tis\tnot\tset. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#eventratelimit 3. https://github.com/staebler/community/blob/9873b632f4d99b5d99c38c9b15fe2f 8b93d0a746/contributors/design- proposals/admission_control_event_rate_limit.md Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 8.4\tEnable\tAnti-exploitation\tFeatures\t(i.e.\tDEP,\tASLR,\tEMET) Enable\tanti-exploitation\tfeatures\tsuch\tas\tData\tExecution\tPrevention\t(DEP),\tAddress Space\tLayout\tRandomization\t(ASLR),\tvirtualization/containerization,\tetc.\tFor\tincreased protection,\tdeploy\tcapabilities\tsuch\tas\tEnhanced\tMitigation\tExperience\tToolkit\t(EMET) that\tcan\tbe\tconfigured\tto\tapply\tthese\tprotections\tto\ta\tbroader\tset\tof\tapplications\tand executables. Version\t7 8.3\tEnable\tOperating\tSystem\tAnti-Exploitation\tFeatures/\tDeploy\tAnti-Exploit Technologies Enable\tanti-exploitation\tfeatures\tsuch\tas\tData\tExecution\tPrevention\t(DEP)\tor\tAddress Space\tLayout\tRandomization\t(ASLR)\tthat\tare\tavailable\tin\tan\toperating\tsystem\tor\tdeploy appropriate\ttoolkits\tthat\tcan\tbe\tconfigured\tto\tapply\tprotection\tto\ta\tbroader\tset\tof applications\tand\texecutables. 73\t|\tP a g e",
    "impact": "You\tneed\tto\tcarefully\ttune\tin\tlimits\tas\tper\tyour\tenvironment.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#eventratelimit 3. https://github.com/staebler/community/blob/9873b632f4d99b5d99c38c9b15fe2f 8b93d0a746/contributors/design- proposals/admission_control_event_rate_limit.md Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 8.4\tEnable\tAnti-exploitation\tFeatures\t(i.e.\tDEP,\tASLR,\tEMET) Enable\tanti-exploitation\tfeatures\tsuch\tas\tData\tExecution\tPrevention\t(DEP),\tAddress Space\tLayout\tRandomization\t(ASLR),\tvirtualization/containerization,\tetc.\tFor\tincreased protection,\tdeploy\tcapabilities\tsuch\tas\tEnhanced\tMitigation\tExperience\tToolkit\t(EMET) that\tcan\tbe\tconfigured\tto\tapply\tthese\tprotections\tto\ta\tbroader\tset\tof\tapplications\tand executables. Version\t7 8.3\tEnable\tOperating\tSystem\tAnti-Exploitation\tFeatures/\tDeploy\tAnti-Exploit Technologies Enable\tanti-exploitation\tfeatures\tsuch\tas\tData\tExecution\tPrevention\t(DEP)\tor\tAddress Space\tLayout\tRandomization\t(ASLR)\tthat\tare\tavailable\tin\tan\toperating\tsystem\tor\tdeploy appropriate\ttoolkits\tthat\tcan\tbe\tconfigured\tto\tapply\tprotection\tto\ta\tbroader\tset\tof applications\tand\texecutables. 73\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_event_rate_limit_enabled",
      "kubernetes_admission_control_event_rate_limit_configured",
      "kubernetes_api_server_request_rate_limited",
      "kubernetes_admission_plugin_event_rate_limit_active",
      "kubernetes_api_request_rate_limit_enforced"
    ]
  },
  {
    "id": "1.2.9",
    "title": "Ensure that the admission control plugin AlwaysAdmit is not set",
    "assessment": "Automated",
    "description": "Do\tnot\tallow\tall\trequests.",
    "rationale": "Setting\tadmission\tcontrol\tplugin\tAlwaysAdmit\tallows\tall\trequests\tand\tdo\tnot\tfilter\tany requests. The\tAlwaysAdmit\tadmission\tcontroller\twas\tdeprecated\tin\tKubernetes\tv1.13.\tIts\tbehavior was\tequivalent\tto\tturning\toff\tall\tadmission\tcontrollers. Impact: Only\trequests\texplicitly\tallowed\tby\tthe\tadmissions\tcontrol\tplugins\twould\tbe\tserved.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tif\tthe\t--enable-admission-plugins\targument\tis\tset,\tits\tvalue\tdoes\tnot\tinclude AlwaysAdmit.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\teither\tremove\tthe\t--enable-admission-plugins parameter,\tor\tset\tit\tto\ta\tvalue\tthat\tdoes\tnot\tinclude\tAlwaysAdmit. Default\tValue: AlwaysAdmit\tis\tnot\tin\tthe\tlist\tof\tdefault\tadmission\tplugins. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 74\t|\tP a g e 2. https://kubernetes.io/docs/admin/admission-controllers/#alwaysadmit Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 75\t|\tP a g e",
    "impact": "Only\trequests\texplicitly\tallowed\tby\tthe\tadmissions\tcontrol\tplugins\twould\tbe\tserved.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 74\t|\tP a g e 2. https://kubernetes.io/docs/admin/admission-controllers/#alwaysadmit Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 75\t|\tP a g e",
    "function_names": [
      "kubernetes_admission_controller_always_admit_disabled",
      "kubernetes_admission_plugin_always_admit_not_set",
      "kubernetes_admission_policy_always_admit_restricted",
      "kubernetes_admission_rule_always_admit_prohibited",
      "kubernetes_admission_control_always_admit_denied"
    ]
  },
  {
    "id": "1.2.10",
    "title": "Ensure that the admission control plugin AlwaysPullImages is set",
    "assessment": "Manual",
    "description": "Always\tpull\timages.",
    "rationale": "Setting\tadmission\tcontrol\tpolicy\tto\tAlwaysPullImages\tforces\tevery\tnew\tpod\tto\tpull\tthe required\timages\tevery\ttime.\tIn\ta\tmulti-tenant\tcluster\tusers\tcan\tbe\tassured\tthat\ttheir private\timages\tcan\tonly\tbe\tused\tby\tthose\twho\thave\tthe\tcredentials\tto\tpull\tthem.\tWithout this\tadmission\tcontrol\tpolicy,\tonce\tan\timage\thas\tbeen\tpulled\tto\ta\tnode,\tany\tpod\tfrom\tany user\tcan\tuse\tit\tsimply\tby\tknowing\tthe\timage’s\tname,\twithout\tany\tauthorization\tcheck against\tthe\timage\townership.\tWhen\tthis\tplug-in\tis\tenabled,\timages\tare\talways\tpulled\tprior to\tstarting\tcontainers,\twhich\tmeans\tvalid\tcredentials\tare\trequired. Impact: Credentials\twould\tbe\trequired\tto\tpull\tthe\tprivate\timages\tevery\ttime.\tAlso,\tin\ttrusted environments,\tthis\tmight\tincreases\tload\ton\tnetwork,\tregistry,\tand\tdecreases\tspeed. This\tsetting\tcould\timpact\toffline\tor\tisolated\tclusters,\twhich\thave\timages\tpre-loaded\tand\tdo not\thave\taccess\tto\ta\tregistry\tto\tpull\tin-use\timages.\tThis\tsetting\tis\tnot\tappropriate\tfor clusters\twhich\tuse\tthis\tconfiguration.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--enable-admission-plugins\targument\tis\tset\tto\ta\tvalue\tthat\tincludes AlwaysPullImages.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--enable-admission-plugins\tparameter to\tinclude\tAlwaysPullImages. 76\t|\tP a g e --enable-admission-plugins=...,AlwaysPullImages,... Default\tValue: By\tdefault,\tAlwaysPullImages\tis\tnot\tset. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#alwayspullimages Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.4\tProtect\tInformation\tWith\tAccess\tControl\tLists All\tinformation\tstored\ton\tsystems\tshall\tbe\tprotected\twith\tfile\tsystem,\tnetwork\tshare, claims,\tapplication,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. Version\t7 14.6\tProtect\tInformation\tthrough\tAccess\tControl\tLists Protect\tall\tinformation\tstored\ton\tsystems\twith\tfile\tsystem,\tnetwork\tshare,\tclaims, application,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. 77\t|\tP a g e",
    "impact": "Credentials\twould\tbe\trequired\tto\tpull\tthe\tprivate\timages\tevery\ttime.\tAlso,\tin\ttrusted environments,\tthis\tmight\tincreases\tload\ton\tnetwork,\tregistry,\tand\tdecreases\tspeed. This\tsetting\tcould\timpact\toffline\tor\tisolated\tclusters,\twhich\thave\timages\tpre-loaded\tand\tdo not\thave\taccess\tto\ta\tregistry\tto\tpull\tin-use\timages.\tThis\tsetting\tis\tnot\tappropriate\tfor clusters\twhich\tuse\tthis\tconfiguration.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#alwayspullimages Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.4\tProtect\tInformation\tWith\tAccess\tControl\tLists All\tinformation\tstored\ton\tsystems\tshall\tbe\tprotected\twith\tfile\tsystem,\tnetwork\tshare, claims,\tapplication,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. Version\t7 14.6\tProtect\tInformation\tthrough\tAccess\tControl\tLists Protect\tall\tinformation\tstored\ton\tsystems\twith\tfile\tsystem,\tnetwork\tshare,\tclaims, application,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. 77\t|\tP a g e",
    "function_names": [
      "kubernetes_admission_controller_always_pull_images_enabled",
      "kubernetes_pod_images_always_pulled",
      "admission_controller_always_pull_images_enabled",
      "pod_spec_always_pull_images_enabled",
      "kubernetes_image_pull_policy_always"
    ]
  },
  {
    "id": "1.2.11",
    "title": "Ensure that the admission control plugin SecurityContextDeny is set if PodSecurityPolicy is not used",
    "assessment": "Manual",
    "description": "The\tSecurityContextDeny\tadmission\tcontroller\tcan\tbe\tused\tto\tdeny\tpods\twhich\tmake\tuse\tof some\tSecurityContext\tfields\twhich\tcould\tallow\tfor\tprivilege\tescalation\tin\tthe\tcluster.\tThis should\tbe\tused\twhere\tPodSecurityPolicy\tis\tnot\tin\tplace\twithin\tthe\tcluster.",
    "rationale": "SecurityContextDeny\tcan\tbe\tused\tto\tprovide\ta\tlayer\tof\tsecurity\tfor\tclusters\twhich\tdo\tnot have\tPodSecurityPolicies\tenabled. Impact: This\tadmission\tcontroller\tshould\tonly\tbe\tused\twhere\tPod\tSecurity\tPolicies\tcannot\tbe\tused on\tthe\tcluster,\tas\tit\tcan\tinteract\tpoorly\twith\tcertain\tPod\tSecurity\tPolicies",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--enable-admission-plugins\targument\tis\tset\tto\ta\tvalue\tthat\tincludes SecurityContextDeny,\tif\tPodSecurityPolicy\tis\tnot\tincluded.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--enable-admission-plugins\tparameter to\tinclude\tSecurityContextDeny,\tunless\tPodSecurityPolicy\tis\talready\tin\tplace. --enable-admission-plugins=...,SecurityContextDeny,... Default\tValue: By\tdefault,\tSecurityContextDeny\tis\tnot\tset. References: 78\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#securitycontextdeny 3. https://kubernetes.io/docs/user-guide/pod-security-policy/#working-with-rbac Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. 79\t|\tP a g e",
    "impact": "This\tadmission\tcontroller\tshould\tonly\tbe\tused\twhere\tPod\tSecurity\tPolicies\tcannot\tbe\tused on\tthe\tcluster,\tas\tit\tcan\tinteract\tpoorly\twith\tcertain\tPod\tSecurity\tPolicies",
    "references": "78\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#securitycontextdeny 3. https://kubernetes.io/docs/user-guide/pod-security-policy/#working-with-rbac Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. 79\t|\tP a g e",
    "function_names": [
      "kubernetes_admission_controller_security_context_deny_enabled",
      "kubernetes_pod_security_context_deny_enabled",
      "kubernetes_admission_controller_security_context_deny_required",
      "kubernetes_pod_security_context_deny_required",
      "kubernetes_admission_controller_security_context_deny_active",
      "kubernetes_pod_security_context_deny_active",
      "kubernetes_admission_controller_security_context_deny_enforced",
      "kubernetes_pod_security_context_deny_enforced"
    ]
  },
  {
    "id": "1.2.12",
    "title": "Ensure that the admission control plugin ServiceAccount is set",
    "assessment": "Automated",
    "description": "Automate\tservice\taccounts\tmanagement.",
    "rationale": "When\tyou\tcreate\ta\tpod,\tif\tyou\tdo\tnot\tspecify\ta\tservice\taccount,\tit\tis\tautomatically\tassigned the\tdefault\tservice\taccount\tin\tthe\tsame\tnamespace.\tYou\tshould\tcreate\tyour\town\tservice account\tand\tlet\tthe\tAPI\tserver\tmanage\tits\tsecurity\ttokens. Impact: None.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--disable-admission-plugins\targument\tis\tset\tto\ta\tvalue\tthat\tdoes\tnot includes\tServiceAccount.",
    "remediation": "Follow\tthe\tdocumentation\tand\tcreate\tServiceAccount\tobjects\tas\tper\tyour\tenvironment. Then,\tedit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tensure\tthat\tthe\t--disable-admission-plugins parameter\tis\tset\tto\ta\tvalue\tthat\tdoes\tnot\tinclude\tServiceAccount. Default\tValue: By\tdefault,\tServiceAccount\tis\tset. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#serviceaccount 80\t|\tP a g e 3. https://kubernetes.io/docs/tasks/configure-pod-container/configure-service- account/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 16\tAccount\tMonitoring\tand\tControl Account\tMonitoring\tand\tControl 81\t|\tP a g e",
    "impact": "None.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#serviceaccount 80\t|\tP a g e 3. https://kubernetes.io/docs/tasks/configure-pod-container/configure-service- account/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 16\tAccount\tMonitoring\tand\tControl Account\tMonitoring\tand\tControl 81\t|\tP a g e",
    "function_names": [
      "kubernetes_service_account_admission_plugin_enabled",
      "kubernetes_service_account_automation_enabled",
      "kubernetes_admission_controller_service_account_required",
      "kubernetes_service_account_auto_creation_disabled",
      "kubernetes_admission_plugin_service_account_enforced"
    ]
  },
  {
    "id": "1.2.13",
    "title": "Ensure that the admission control plugin NamespaceLifecycle is set",
    "assessment": "Automated",
    "description": "Reject\tcreating\tobjects\tin\ta\tnamespace\tthat\tis\tundergoing\ttermination.",
    "rationale": "Setting\tadmission\tcontrol\tpolicy\tto\tNamespaceLifecycle\tensures\tthat\tobjects\tcannot\tbe created\tin\tnon-existent\tnamespaces,\tand\tthat\tnamespaces\tundergoing\ttermination\tare\tnot used\tfor\tcreating\tthe\tnew\tobjects.\tThis\tis\trecommended\tto\tenforce\tthe\tintegrity\tof\tthe namespace\ttermination\tprocess\tand\talso\tfor\tthe\tavailability\tof\tthe\tnewer\tobjects. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--disable-admission-plugins\targument\tis\tset\tto\ta\tvalue\tthat\tdoes\tnot include\tNamespaceLifecycle.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--disable-admission-plugins\tparameter to\tensure\tit\tdoes\tnot\tinclude\tNamespaceLifecycle. Default\tValue: By\tdefault,\tNamespaceLifecycle\tis\tset. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#namespacelifecycle 82\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 83\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#namespacelifecycle 82\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 83\t|\tP a g e",
    "function_names": [
      "kubernetes_admission_controller_namespace_lifecycle_enabled",
      "kubernetes_namespace_admission_control_termination_protected",
      "kubernetes_admission_plugin_namespace_lifecycle_configured",
      "kubernetes_namespace_termination_admission_control_enabled",
      "kubernetes_admission_controller_namespace_termination_blocked"
    ]
  },
  {
    "id": "1.2.14",
    "title": "Ensure that the admission control plugin PodSecurityPolicy is set",
    "assessment": "Automated",
    "description": "Reject\tcreating\tpods\tthat\tdo\tnot\tmatch\tPod\tSecurity\tPolicies.",
    "rationale": "A\tPod\tSecurity\tPolicy\tis\ta\tcluster-level\tresource\tthat\tcontrols\tthe\tactions\tthat\ta\tpod\tcan perform\tand\twhat\tit\thas\tthe\tability\tto\taccess.\tThe\tPodSecurityPolicy\tobjects\tdefine\ta\tset\tof conditions\tthat\ta\tpod\tmust\trun\twith\tin\torder\tto\tbe\taccepted\tinto\tthe\tsystem.\tPod\tSecurity Policies\tare\tcomprised\tof\tsettings\tand\tstrategies\tthat\tcontrol\tthe\tsecurity\tfeatures\ta\tpod\thas access\tto\tand\thence\tthis\tmust\tbe\tused\tto\tcontrol\tpod\taccess\tpermissions. Note: When\tthe\tPodSecurityPolicy\tadmission\tplugin\tis\tin\tuse,\tthere\tneeds\tto\tbe\tat\tleast\tone PodSecurityPolicy\tin\tplace\tfor\tANY\tpods\tto\tbe\tadmitted.\tSee\tsection\t5.2\tfor recommendations\ton\tPodSecurityPolicy\tsettings. Impact: The\tpolicy\tobjects\tmust\tbe\tcreated\tand\tgranted\tbefore\tpod\tcreation\twould\tbe\tallowed.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--enable-admission-plugins\targument\tis\tset\tto\ta\tvalue\tthat\tincludes PodSecurityPolicy.",
    "remediation": "Follow\tthe\tdocumentation\tand\tcreate\tPod\tSecurity\tPolicy\tobjects\tas\tper\tyour\tenvironment. Then,\tedit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--enable-admission-plugins\tparameter to\ta\tvalue\tthat\tincludes\tPodSecurityPolicy: --enable-admission-plugins=...,PodSecurityPolicy,... 84\t|\tP a g e Then\trestart\tthe\tAPI\tServer. Default\tValue: By\tdefault,\tPodSecurityPolicy\tis\tnot\tset. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#podsecuritypolicy 3. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod- security-policies Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 85\t|\tP a g e",
    "impact": "The\tpolicy\tobjects\tmust\tbe\tcreated\tand\tgranted\tbefore\tpod\tcreation\twould\tbe\tallowed.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#podsecuritypolicy 3. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod- security-policies Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 85\t|\tP a g e",
    "function_names": [
      "kubernetes_admission_controller_pod_security_policy_enabled",
      "kubernetes_pod_security_policy_admission_control_enabled",
      "kubernetes_admission_plugin_pod_security_policy_required",
      "kubernetes_pod_security_policy_admission_plugin_enabled",
      "kubernetes_admission_control_pod_security_policy_enforced"
    ]
  },
  {
    "id": "1.2.15",
    "title": "Ensure that the admission control plugin NodeRestriction is set",
    "assessment": "Automated",
    "description": "Limit\tthe\tNode\tand\tPod\tobjects\tthat\ta\tkubelet\tcould\tmodify.",
    "rationale": "Using\tthe\tNodeRestriction\tplug-in\tensures\tthat\tthe\tkubelet\tis\trestricted\tto\tthe\tNode\tand Pod\tobjects\tthat\tit\tcould\tmodify\tas\tdefined.\tSuch\tkubelets\twill\tonly\tbe\tallowed\tto\tmodify their\town\tNode\tAPI\tobject,\tand\tonly\tmodify\tPod\tAPI\tobjects\tthat\tare\tbound\tto\ttheir\tnode. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--enable-admission-plugins\targument\tis\tset\tto\ta\tvalue\tthat\tincludes NodeRestriction.",
    "remediation": "Follow\tthe\tKubernetes\tdocumentation\tand\tconfigure\tNodeRestriction\tplug-in\ton\tkubelets. Then,\tedit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--enable-admission-plugins\tparameter to\ta\tvalue\tthat\tincludes\tNodeRestriction. --enable-admission-plugins=...,NodeRestriction,... Default\tValue: By\tdefault,\tNodeRestriction\tis\tnot\tset. References: 86\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#noderestriction 3. https://kubernetes.io/docs/admin/authorization/node/ 4. https://acotten.com/post/kube17-security Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 87\t|\tP a g e",
    "impact": "None",
    "references": "86\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/admin/admission-controllers/#noderestriction 3. https://kubernetes.io/docs/admin/authorization/node/ 4. https://acotten.com/post/kube17-security Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 87\t|\tP a g e",
    "function_names": [
      "kubernetes_node_restriction_enabled",
      "kubernetes_admission_control_plugin_restricted",
      "kubernetes_kubelet_node_modification_limited",
      "kubernetes_node_restriction_admission_plugin_enabled",
      "kubernetes_kubelet_pod_modification_restricted"
    ]
  },
  {
    "id": "1.2.16",
    "title": "Ensure that the --insecure-bind-address argument is not set",
    "assessment": "Automated",
    "description": "Do\tnot\tbind\tthe\tinsecure\tAPI\tservice.",
    "rationale": "If\tyou\tbind\tthe\tapiserver\tto\tan\tinsecure\taddress,\tbasically\tanyone\twho\tcould\tconnect\tto\tit over\tthe\tinsecure\tport,\twould\thave\tunauthenticated\tand\tunencrypted\taccess\tto\tyour master\tnode.\tThe\tapiserver\tdoesn't\tdo\tany\tauthentication\tchecking\tfor\tinsecure\tbinds\tand traffic\tto\tthe\tInsecure\tAPI\tport\tis\tnot\tencrpyted,\tallowing\tattackers\tto\tpotentially\tread sensitive\tdata\tin\ttransit. Impact: Connections\tto\tthe\tAPI\tserver\twill\trequire\tvalid\tauthentication\tcredentials.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--insecure-bind-address\targument\tdoes\tnot\texist.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tremove\tthe\t--insecure-bind-address parameter. Default\tValue: By\tdefault,\tthe\tinsecure\tbind\taddress\tis\tnot\tset. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 88\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 89\t|\tP a g e",
    "impact": "Connections\tto\tthe\tAPI\tserver\twill\trequire\tvalid\tauthentication\tcredentials.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 88\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 89\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_insecure_bind_address_disabled",
      "kubernetes_api_server_insecure_bind_address_not_set",
      "kubernetes_api_server_secure_bind_address_enabled",
      "kubernetes_api_server_insecure_bind_argument_absent",
      "kubernetes_api_server_bind_address_secure"
    ]
  },
  {
    "id": "1.2.17",
    "title": "Ensure that the --insecure-port argument is set to 0",
    "assessment": "Automated",
    "description": "Do\tnot\tbind\tto\tinsecure\tport.",
    "rationale": "Setting\tup\tthe\tapiserver\tto\tserve\ton\tan\tinsecure\tport\twould\tallow\tunauthenticated\tand unencrypted\taccess\tto\tyour\tmaster\tnode.\tThis\twould\tallow\tattackers\twho\tcould\taccess\tthis port,\tto\teasily\ttake\tcontrol\tof\tthe\tcluster. Impact: All\tcomponents\tthat\tuse\tthe\tAPI\tmust\tconnect\tvia\tthe\tsecured\tport,\tauthenticate themselves,\tand\tbe\tauthorized\tto\tuse\tthe\tAPI. This\tincludes: • kube-controller-manager • kube-proxy • kube-scheduler • kubelets",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--insecure-port\targument\tis\tset\tto\t0.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\tbelow\tparameter. --insecure-port=0 Default\tValue: By\tdefault,\tthe\tinsecure\tport\tis\tset\tto\t8080. 90\t|\tP a g e References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 91\t|\tP a g e",
    "impact": "All\tcomponents\tthat\tuse\tthe\tAPI\tmust\tconnect\tvia\tthe\tsecured\tport,\tauthenticate themselves,\tand\tbe\tauthorized\tto\tuse\tthe\tAPI. This\tincludes: • kube-controller-manager • kube-proxy • kube-scheduler • kubelets",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 91\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_insecure_port_disabled",
      "kubernetes_api_server_insecure_port_set_zero",
      "kubernetes_api_server_insecure_port_unbound",
      "kubernetes_api_server_insecure_port_blocked",
      "kubernetes_api_server_insecure_port_closed"
    ]
  },
  {
    "id": "1.2.18",
    "title": "Ensure that the --secure-port argument is not set to 0",
    "assessment": "Automated",
    "description": "Do\tnot\tdisable\tthe\tsecure\tport.",
    "rationale": "The\tsecure\tport\tis\tused\tto\tserve\thttps\twith\tauthentication\tand\tauthorization.\tIf\tyou\tdisable it,\tno\thttps\ttraffic\tis\tserved\tand\tall\ttraffic\tis\tserved\tunencrypted. Impact: You\tneed\tto\tset\tthe\tAPI\tServer\tup\twith\tthe\tright\tTLS\tcertificates.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--secure-port\targument\tis\teither\tnot\tset\tor\tis\tset\tto\tan\tinteger\tvalue between\t1\tand\t65535.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\teither\tremove\tthe\t--secure-port\tparameter\tor set\tit\tto\ta\tdifferent\t(non-zero)\tdesired\tport. Default\tValue: By\tdefault,\tport\t6443\tis\tused\tas\tthe\tsecure\tport. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ Additional\tInformation: 92\t|\tP a g e This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 93\t|\tP a g e",
    "impact": "You\tneed\tto\tset\tthe\tAPI\tServer\tup\twith\tthe\tright\tTLS\tcertificates.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ Additional\tInformation: 92\t|\tP a g e This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 93\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_secure_port_not_disabled",
      "kubernetes_api_server_secure_port_enabled",
      "kubernetes_api_server_secure_port_valid",
      "kubernetes_api_server_secure_port_non_zero",
      "kubernetes_api_server_secure_port_configured"
    ]
  },
  {
    "id": "1.2.19",
    "title": "Ensure that the --profiling argument is set to false",
    "assessment": "Automated",
    "description": "Disable\tprofiling,\tif\tnot\tneeded.",
    "rationale": "Profiling\tallows\tfor\tthe\tidentification\tof\tspecific\tperformance\tbottlenecks.\tIt\tgenerates\ta significant\tamount\tof\tprogram\tdata\tthat\tcould\tpotentially\tbe\texploited\tto\tuncover\tsystem and\tprogram\tdetails.\tIf\tyou\tare\tnot\texperiencing\tany\tbottlenecks\tand\tdo\tnot\tneed\tthe profiler\tfor\ttroubleshooting\tpurposes,\tit\tis\trecommended\tto\tturn\tit\toff\tto\treduce\tthe potential\tattack\tsurface. Impact: Profiling\tinformation\twould\tnot\tbe\tavailable.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--profiling\targument\tis\tset\tto\tfalse.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\tbelow\tparameter. --profiling=false Default\tValue: By\tdefault,\tprofiling\tis\tenabled. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://github.com/kubernetes/community/blob/master/contributors/devel/profi ling.md 94\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 95\t|\tP a g e",
    "impact": "Profiling\tinformation\twould\tnot\tbe\tavailable.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://github.com/kubernetes/community/blob/master/contributors/devel/profi ling.md 94\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 95\t|\tP a g e",
    "function_names": [
      "kubernetes_cluster_profiling_disabled",
      "kubernetes_cluster_no_profiling_enabled",
      "kubernetes_cluster_profiling_argument_false",
      "kubernetes_cluster_profiling_setting_disabled",
      "kubernetes_cluster_profiling_feature_off"
    ]
  },
  {
    "id": "1.2.20",
    "title": "Ensure that the --audit-log-path argument is set",
    "assessment": "Automated",
    "description": "Enable\tauditing\ton\tthe\tKubernetes\tAPI\tServer\tand\tset\tthe\tdesired\taudit\tlog\tpath.",
    "rationale": "Auditing\tthe\tKubernetes\tAPI\tServer\tprovides\ta\tsecurity-relevant\tchronological\tset\tof records\tdocumenting\tthe\tsequence\tof\tactivities\tthat\thave\taffected\tsystem\tby\tindividual users,\tadministrators\tor\tother\tcomponents\tof\tthe\tsystem.\tEven\tthough\tcurrently, Kubernetes\tprovides\tonly\tbasic\taudit\tcapabilities,\tit\tshould\tbe\tenabled.\tYou\tcan\tenable\tit\tby setting\tan\tappropriate\taudit\tlog\tpath. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--audit-log-path\targument\tis\tset\tas\tappropriate.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--audit-log-path\tparameter\tto\ta\tsuitable path\tand\tfile\twhere\tyou\twould\tlike\taudit\tlogs\tto\tbe\twritten,\tfor\texample: --audit-log-path=/var/log/apiserver/audit.log Default\tValue: By\tdefault,\tauditing\tis\tnot\tenabled. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 96\t|\tP a g e 2. https://kubernetes.io/docs/concepts/cluster-administration/audit/ 3. https://github.com/kubernetes/features/issues/22 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 6.2\tEnsure\tAudit\tLog\tSettings\tSupport\tAppropriate\tLog\tEntry\tFormatting Validate\taudit\tlog\tsettings\tfor\teach\thardware\tdevice\tand\tthe\tsoftware\tinstalled\ton\tit, ensuring\tthat\tlogs\tinclude\ta\tdate,\ttimestamp,\tsource\taddresses,\tdestination\taddresses,\tand various\tother\tuseful\telements\tof\teach\tpacket\tand/or\ttransaction.\tSystems\tshould\trecord logs\tin\ta\tstandardized\tformat\tsuch\tas\tsyslog\tentries\tor\tthose\toutlined\tby\tthe\tCommon\tEvent Expression\tinitiative.\tIf\tsystems\tcannot\tgenerate\tlogs\tin\ta\tstandardized\tformat,\tlog normalization\ttools\tcan\tbe\tdeployed\tto\tconvert\tlogs\tinto\tsuch\ta\tformat. Version\t7 6.2\tActivate\taudit\tlogging Ensure\tthat\tlocal\tlogging\thas\tbeen\tenabled\ton\tall\tsystems\tand\tnetworking\tdevices. 6.3\tEnable\tDetailed\tLogging Enable\tsystem\tlogging\tto\tinclude\tdetailed\tinformation\tsuch\tas\tan\tevent\tsource,\tdate, user,\ttimestamp,\tsource\taddresses,\tdestination\taddresses,\tand\tother\tuseful\telements. 97\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 96\t|\tP a g e 2. https://kubernetes.io/docs/concepts/cluster-administration/audit/ 3. https://github.com/kubernetes/features/issues/22 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 6.2\tEnsure\tAudit\tLog\tSettings\tSupport\tAppropriate\tLog\tEntry\tFormatting Validate\taudit\tlog\tsettings\tfor\teach\thardware\tdevice\tand\tthe\tsoftware\tinstalled\ton\tit, ensuring\tthat\tlogs\tinclude\ta\tdate,\ttimestamp,\tsource\taddresses,\tdestination\taddresses,\tand various\tother\tuseful\telements\tof\teach\tpacket\tand/or\ttransaction.\tSystems\tshould\trecord logs\tin\ta\tstandardized\tformat\tsuch\tas\tsyslog\tentries\tor\tthose\toutlined\tby\tthe\tCommon\tEvent Expression\tinitiative.\tIf\tsystems\tcannot\tgenerate\tlogs\tin\ta\tstandardized\tformat,\tlog normalization\ttools\tcan\tbe\tdeployed\tto\tconvert\tlogs\tinto\tsuch\ta\tformat. Version\t7 6.2\tActivate\taudit\tlogging Ensure\tthat\tlocal\tlogging\thas\tbeen\tenabled\ton\tall\tsystems\tand\tnetworking\tdevices. 6.3\tEnable\tDetailed\tLogging Enable\tsystem\tlogging\tto\tinclude\tdetailed\tinformation\tsuch\tas\tan\tevent\tsource,\tdate, user,\ttimestamp,\tsource\taddresses,\tdestination\taddresses,\tand\tother\tuseful\telements. 97\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_audit_logging_enabled",
      "kubernetes_api_server_audit_log_path_set",
      "kubernetes_api_server_audit_logging_configured",
      "kubernetes_api_server_audit_log_path_valid",
      "kubernetes_api_server_audit_logging_active"
    ]
  },
  {
    "id": "1.2.21",
    "title": "Ensure that the --audit-log-maxage argument is set to 30 or as appropriate",
    "assessment": "Automated",
    "description": "Retain\tthe\tlogs\tfor\tat\tleast\t30\tdays\tor\tas\tappropriate.",
    "rationale": "Retaining\tlogs\tfor\tat\tleast\t30\tdays\tensures\tthat\tyou\tcan\tgo\tback\tin\ttime\tand\tinvestigate\tor correlate\tany\tevents.\tSet\tyour\taudit\tlog\tretention\tperiod\tto\t30\tdays\tor\tas\tper\tyour\tbusiness requirements. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--audit-log-maxage\targument\tis\tset\tto\t30\tor\tas\tappropriate.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--audit-log-maxage\tparameter\tto\t30\tor as\tan\tappropriate\tnumber\tof\tdays: --audit-log-maxage=30 Default\tValue: By\tdefault,\tauditing\tis\tnot\tenabled. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/concepts/cluster-administration/audit/ 98\t|\tP a g e 3. https://github.com/kubernetes/features/issues/22 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 6.3\tEnsure\tAudit\tLogging\tSystems\tAre\tNot\tSubject\tTo\tLoss\t(i.e.\trotation/archive) Ensure\tthat\tall\tsystems\tthat\tstore\tlogs\thave\tadequate\tstorage\tspace\tfor\tthe\tlogs generated\ton\ta\tregular\tbasis,\tso\tthat\tlog\tfiles\twill\tnot\tfill\tup\tbetween\tlog\trotation\tintervals. The\tlogs\tmust\tbe\tarchived\tand\tdigitally\tsigned\ton\ta\tperiodic\tbasis. Version\t7 6.4\tEnsure\tadequate\tstorage\tfor\tlogs Ensure\tthat\tall\tsystems\tthat\tstore\tlogs\thave\tadequate\tstorage\tspace\tfor\tthe\tlogs generated. 99\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/concepts/cluster-administration/audit/ 98\t|\tP a g e 3. https://github.com/kubernetes/features/issues/22 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 6.3\tEnsure\tAudit\tLogging\tSystems\tAre\tNot\tSubject\tTo\tLoss\t(i.e.\trotation/archive) Ensure\tthat\tall\tsystems\tthat\tstore\tlogs\thave\tadequate\tstorage\tspace\tfor\tthe\tlogs generated\ton\ta\tregular\tbasis,\tso\tthat\tlog\tfiles\twill\tnot\tfill\tup\tbetween\tlog\trotation\tintervals. The\tlogs\tmust\tbe\tarchived\tand\tdigitally\tsigned\ton\ta\tperiodic\tbasis. Version\t7 6.4\tEnsure\tadequate\tstorage\tfor\tlogs Ensure\tthat\tall\tsystems\tthat\tstore\tlogs\thave\tadequate\tstorage\tspace\tfor\tthe\tlogs generated. 99\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_audit_log_maxage_30d",
      "kubernetes_api_server_audit_log_retention_30d",
      "kubernetes_audit_log_maxage_set",
      "kubernetes_audit_log_retention_configured",
      "kubernetes_api_server_audit_log_duration_30d"
    ]
  },
  {
    "id": "1.2.22",
    "title": "Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate",
    "assessment": "Automated",
    "description": "Retain\t10\tor\tan\tappropriate\tnumber\tof\told\tlog\tfiles.",
    "rationale": "Kubernetes\tautomatically\trotates\tthe\tlog\tfiles.\tRetaining\told\tlog\tfiles\tensures\tthat\tyou would\thave\tsufficient\tlog\tdata\tavailable\tfor\tcarrying\tout\tany\tinvestigation\tor\tcorrelation. For\texample,\tif\tyou\thave\tset\tfile\tsize\tof\t100\tMB\tand\tthe\tnumber\tof\told\tlog\tfiles\tto\tkeep\tas 10,\tyou\twould\tapproximate\thave\t1\tGB\tof\tlog\tdata\tthat\tyou\tcould\tpotentially\tuse\tfor\tyour analysis. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--audit-log-maxbackup\targument\tis\tset\tto\t10\tor\tas\tappropriate.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--audit-log-maxbackup\tparameter\tto\t10 or\tto\tan\tappropriate\tvalue. --audit-log-maxbackup=10 Default\tValue: By\tdefault,\tauditing\tis\tnot\tenabled. References: 100\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/concepts/cluster-administration/audit/ 3. https://github.com/kubernetes/features/issues/22 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 6.3\tEnsure\tAudit\tLogging\tSystems\tAre\tNot\tSubject\tTo\tLoss\t(i.e.\trotation/archive) Ensure\tthat\tall\tsystems\tthat\tstore\tlogs\thave\tadequate\tstorage\tspace\tfor\tthe\tlogs generated\ton\ta\tregular\tbasis,\tso\tthat\tlog\tfiles\twill\tnot\tfill\tup\tbetween\tlog\trotation\tintervals. The\tlogs\tmust\tbe\tarchived\tand\tdigitally\tsigned\ton\ta\tperiodic\tbasis. Version\t7 6.4\tEnsure\tadequate\tstorage\tfor\tlogs Ensure\tthat\tall\tsystems\tthat\tstore\tlogs\thave\tadequate\tstorage\tspace\tfor\tthe\tlogs generated. 101\t|\tP a g e",
    "impact": "None",
    "references": "100\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://kubernetes.io/docs/concepts/cluster-administration/audit/ 3. https://github.com/kubernetes/features/issues/22 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 6.3\tEnsure\tAudit\tLogging\tSystems\tAre\tNot\tSubject\tTo\tLoss\t(i.e.\trotation/archive) Ensure\tthat\tall\tsystems\tthat\tstore\tlogs\thave\tadequate\tstorage\tspace\tfor\tthe\tlogs generated\ton\ta\tregular\tbasis,\tso\tthat\tlog\tfiles\twill\tnot\tfill\tup\tbetween\tlog\trotation\tintervals. The\tlogs\tmust\tbe\tarchived\tand\tdigitally\tsigned\ton\ta\tperiodic\tbasis. Version\t7 6.4\tEnsure\tadequate\tstorage\tfor\tlogs Ensure\tthat\tall\tsystems\tthat\tstore\tlogs\thave\tadequate\tstorage\tspace\tfor\tthe\tlogs generated. 101\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_audit_log_maxbackup_set",
      "kubernetes_api_server_audit_log_maxbackup_10_or_more",
      "kubernetes_api_server_audit_log_retention_configured",
      "kubernetes_audit_log_maxbackup_compliant",
      "kubernetes_audit_log_retention_limit_set"
    ]
  },
  {
    "id": "1.2.23",
    "title": "Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate",
    "assessment": "Automated",
    "description": "Rotate\tlog\tfiles\ton\treaching\t100\tMB\tor\tas\tappropriate.",
    "rationale": "Kubernetes\tautomatically\trotates\tthe\tlog\tfiles.\tRetaining\told\tlog\tfiles\tensures\tthat\tyou would\thave\tsufficient\tlog\tdata\tavailable\tfor\tcarrying\tout\tany\tinvestigation\tor\tcorrelation.\tIf you\thave\tset\tfile\tsize\tof\t100\tMB\tand\tthe\tnumber\tof\told\tlog\tfiles\tto\tkeep\tas\t10,\tyou\twould approximate\thave\t1\tGB\tof\tlog\tdata\tthat\tyou\tcould\tpotentially\tuse\tfor\tyour\tanalysis. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--audit-log-maxsize\targument\tis\tset\tto\t100\tor\tas\tappropriate.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--audit-log-maxsize\tparameter\tto\tan appropriate\tsize\tin\tMB.\tFor\texample,\tto\tset\tit\tas\t100\tMB: --audit-log-maxsize=100 Default\tValue: By\tdefault,\tauditing\tis\tnot\tenabled. References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 102\t|\tP a g e 2. https://kubernetes.io/docs/concepts/cluster-administration/audit/ 3. https://github.com/kubernetes/features/issues/22 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 6.3\tEnsure\tAudit\tLogging\tSystems\tAre\tNot\tSubject\tTo\tLoss\t(i.e.\trotation/archive) Ensure\tthat\tall\tsystems\tthat\tstore\tlogs\thave\tadequate\tstorage\tspace\tfor\tthe\tlogs generated\ton\ta\tregular\tbasis,\tso\tthat\tlog\tfiles\twill\tnot\tfill\tup\tbetween\tlog\trotation\tintervals. The\tlogs\tmust\tbe\tarchived\tand\tdigitally\tsigned\ton\ta\tperiodic\tbasis. Version\t7 6.4\tEnsure\tadequate\tstorage\tfor\tlogs Ensure\tthat\tall\tsystems\tthat\tstore\tlogs\thave\tadequate\tstorage\tspace\tfor\tthe\tlogs generated. 103\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 102\t|\tP a g e 2. https://kubernetes.io/docs/concepts/cluster-administration/audit/ 3. https://github.com/kubernetes/features/issues/22 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 6.3\tEnsure\tAudit\tLogging\tSystems\tAre\tNot\tSubject\tTo\tLoss\t(i.e.\trotation/archive) Ensure\tthat\tall\tsystems\tthat\tstore\tlogs\thave\tadequate\tstorage\tspace\tfor\tthe\tlogs generated\ton\ta\tregular\tbasis,\tso\tthat\tlog\tfiles\twill\tnot\tfill\tup\tbetween\tlog\trotation\tintervals. The\tlogs\tmust\tbe\tarchived\tand\tdigitally\tsigned\ton\ta\tperiodic\tbasis. Version\t7 6.4\tEnsure\tadequate\tstorage\tfor\tlogs Ensure\tthat\tall\tsystems\tthat\tstore\tlogs\thave\tadequate\tstorage\tspace\tfor\tthe\tlogs generated. 103\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_audit_log_maxsize_set",
      "kubernetes_api_server_audit_log_rotation_enabled",
      "kubernetes_api_server_audit_log_size_limited",
      "kubernetes_api_server_audit_log_maxsize_100mb",
      "kubernetes_api_server_audit_log_rotation_threshold_configured"
    ]
  },
  {
    "id": "1.2.24",
    "title": "Ensure that the --request-timeout argument is set as appropriate",
    "assessment": "Automated",
    "description": "Set\tglobal\trequest\ttimeout\tfor\tAPI\tserver\trequests\tas\tappropriate.",
    "rationale": "Setting\tglobal\trequest\ttimeout\tallows\textending\tthe\tAPI\tserver\trequest\ttimeout\tlimit\tto\ta duration\tappropriate\tto\tthe\tuser's\tconnection\tspeed.\tBy\tdefault,\tit\tis\tset\tto\t60\tseconds which\tmight\tbe\tproblematic\ton\tslower\tconnections\tmaking\tcluster\tresources\tinaccessible once\tthe\tdata\tvolume\tfor\trequests\texceeds\twhat\tcan\tbe\ttransmitted\tin\t60\tseconds.\tBut, setting\tthis\ttimeout\tlimit\tto\tbe\ttoo\tlarge\tcan\texhaust\tthe\tAPI\tserver\tresources\tmaking\tit prone\tto\tDenial-of-Service\tattack.\tHence,\tit\tis\trecommended\tto\tset\tthis\tlimit\tas\tappropriate and\tchange\tthe\tdefault\tlimit\tof\t60\tseconds\tonly\tif\tneeded. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--request-timeout\targument\tis\teither\tnot\tset\tor\tset\tto\tan\tappropriate value.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\tand\tset\tthe\tbelow\tparameter\tas\tappropriate\tand\tif\tneeded.\tFor\texample, --request-timeout=300s Default\tValue: By\tdefault,\t--request-timeout\tis\tset\tto\t60\tseconds. 104\t|\tP a g e References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://github.com/kubernetes/kubernetes/pull/51415 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.6\tEnforce\tDetailed\tAudit\tLogging\tFor\tSensitive\tInformation Enforce\tdetailed\taudit\tlogging\tfor\taccess\tto\tnonpublic\tdata\tand\tspecial\tauthentication\tfor sensitive\tdata. Version\t7 14.9\tEnforce\tDetail\tLogging\tfor\tAccess\tor\tChanges\tto\tSensitive\tData Enforce\tdetailed\taudit\tlogging\tfor\taccess\tto\tsensitive\tdata\tor\tchanges\tto\tsensitive\tdata (utilizing\ttools\tsuch\tas\tFile\tIntegrity\tMonitoring\tor\tSecurity\tInformation\tand\tEvent Monitoring). 105\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://github.com/kubernetes/kubernetes/pull/51415 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.6\tEnforce\tDetailed\tAudit\tLogging\tFor\tSensitive\tInformation Enforce\tdetailed\taudit\tlogging\tfor\taccess\tto\tnonpublic\tdata\tand\tspecial\tauthentication\tfor sensitive\tdata. Version\t7 14.9\tEnforce\tDetail\tLogging\tfor\tAccess\tor\tChanges\tto\tSensitive\tData Enforce\tdetailed\taudit\tlogging\tfor\taccess\tto\tsensitive\tdata\tor\tchanges\tto\tsensitive\tdata (utilizing\ttools\tsuch\tas\tFile\tIntegrity\tMonitoring\tor\tSecurity\tInformation\tand\tEvent Monitoring). 105\t|\tP a g e",
    "function_names": [
      "api_server_request_timeout_set",
      "api_server_request_timeout_configured",
      "api_server_request_timeout_appropriate",
      "api_server_request_timeout_valid",
      "api_server_request_timeout_within_limits"
    ]
  },
  {
    "id": "1.2.25",
    "title": "Ensure that the --service-account-lookup argument is set to true",
    "assessment": "Automated",
    "description": "Validate\tservice\taccount\tbefore\tvalidating\ttoken.",
    "rationale": "If\t--service-account-lookup\tis\tnot\tenabled,\tthe\tapiserver\tonly\tverifies\tthat\tthe authentication\ttoken\tis\tvalid,\tand\tdoes\tnot\tvalidate\tthat\tthe\tservice\taccount\ttoken mentioned\tin\tthe\trequest\tis\tactually\tpresent\tin\tetcd.\tThis\tallows\tusing\ta\tservice\taccount token\teven\tafter\tthe\tcorresponding\tservice\taccount\tis\tdeleted.\tThis\tis\tan\texample\tof\ttime\tof check\tto\ttime\tof\tuse\tsecurity\tissue. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tif\tthe\t--service-account-lookup\targument\texists\tit\tis\tset\tto\ttrue.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\tbelow\tparameter. --service-account-lookup=true Alternatively,\tyou\tcan\tdelete\tthe\t--service-account-lookup\tparameter\tfrom\tthis\tfile\tso that\tthe\tdefault\ttakes\teffect. Default\tValue: By\tdefault,\t--service-account-lookup\targument\tis\tset\tto\ttrue. 106\t|\tP a g e References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://github.com/kubernetes/kubernetes/issues/24167 3. https://en.wikipedia.org/wiki/Time_of_check_to_time_of_use Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 16\tAccount\tMonitoring\tand\tControl Account\tMonitoring\tand\tControl 107\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://github.com/kubernetes/kubernetes/issues/24167 3. https://en.wikipedia.org/wiki/Time_of_check_to_time_of_use Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 16\tAccount\tMonitoring\tand\tControl Account\tMonitoring\tand\tControl 107\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_service_account_lookup_enabled",
      "kubernetes_api_server_service_account_validation_enabled",
      "kubernetes_api_server_service_account_pre_validation_enabled",
      "kubernetes_api_server_service_account_auth_enabled",
      "kubernetes_api_server_service_account_secure_lookup_enabled"
    ]
  },
  {
    "id": "1.2.26",
    "title": "Ensure that the --service-account-key-file argument is set as appropriate",
    "assessment": "Automated",
    "description": "Explicitly\tset\ta\tservice\taccount\tpublic\tkey\tfile\tfor\tservice\taccounts\ton\tthe\tapiserver.",
    "rationale": "By\tdefault,\tif\tno\t--service-account-key-file\tis\tspecified\tto\tthe\tapiserver,\tit\tuses\tthe private\tkey\tfrom\tthe\tTLS\tserving\tcertificate\tto\tverify\tservice\taccount\ttokens.\tTo\tensure\tthat the\tkeys\tfor\tservice\taccount\ttokens\tcould\tbe\trotated\tas\tneeded,\ta\tseparate\tpublic/private key\tpair\tshould\tbe\tused\tfor\tsigning\tservice\taccount\ttokens.\tHence,\tthe\tpublic\tkey\tshould\tbe specified\tto\tthe\tapiserver\twith\t--service-account-key-file. Impact: The\tcorresponding\tprivate\tkey\tmust\tbe\tprovided\tto\tthe\tcontroller\tmanager.\tYou\twould need\tto\tsecurely\tmaintain\tthe\tkey\tfile\tand\trotate\tthe\tkeys\tbased\ton\tyour\torganization's\tkey rotation\tpolicy.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--service-account-key-file\targument\texists\tand\tis\tset\tas\tappropriate.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--service-account-key-file\tparameter to\tthe\tpublic\tkey\tfile\tfor\tservice\taccounts: --service-account-key-file=<filename> Default\tValue: By\tdefault,\t--service-account-key-file\targument\tis\tnot\tset. 108\t|\tP a g e References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://github.com/kubernetes/kubernetes/issues/24167 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 3\tSecure\tConfigurations\tfor\tHardware\tand\tSoftware\ton\tMobile\tDevices,\tLaptops, Workstations,\tand\tServers Secure\tConfigurations\tfor\tHardware\tand\tSoftware\ton\tMobile\tDevices,\tLaptops, Workstations,\tand\tServers 109\t|\tP a g e",
    "impact": "The\tcorresponding\tprivate\tkey\tmust\tbe\tprovided\tto\tthe\tcontroller\tmanager.\tYou\twould need\tto\tsecurely\tmaintain\tthe\tkey\tfile\tand\trotate\tthe\tkeys\tbased\ton\tyour\torganization's\tkey rotation\tpolicy.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://github.com/kubernetes/kubernetes/issues/24167 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 3\tSecure\tConfigurations\tfor\tHardware\tand\tSoftware\ton\tMobile\tDevices,\tLaptops, Workstations,\tand\tServers Secure\tConfigurations\tfor\tHardware\tand\tSoftware\ton\tMobile\tDevices,\tLaptops, Workstations,\tand\tServers 109\t|\tP a g e",
    "function_names": [
      "apiserver_service_account_key_file_set",
      "apiserver_service_account_public_key_configured",
      "apiserver_service_account_key_file_appropriate",
      "apiserver_service_account_key_file_explicitly_set"
    ]
  },
  {
    "id": "1.2.27",
    "title": "Ensure that the --etcd-certfile and --etcd-keyfile arguments are set as appropriate",
    "assessment": "Automated",
    "description": "etcd\tshould\tbe\tconfigured\tto\tmake\tuse\tof\tTLS\tencryption\tfor\tclient\tconnections.",
    "rationale": "etcd\tis\ta\thighly-available\tkey\tvalue\tstore\tused\tby\tKubernetes\tdeployments\tfor\tpersistent storage\tof\tall\tof\tits\tREST\tAPI\tobjects.\tThese\tobjects\tare\tsensitive\tin\tnature\tand\tshould\tbe protected\tby\tclient\tauthentication.\tThis\trequires\tthe\tAPI\tserver\tto\tidentify\titself\tto\tthe\tetcd server\tusing\ta\tclient\tcertificate\tand\tkey. Impact: TLS\tand\tclient\tcertificate\tauthentication\tmust\tbe\tconfigured\tfor\tetcd.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--etcd-certfile\tand\t--etcd-keyfile\targuments\texist\tand\tthey\tare\tset\tas appropriate.",
    "remediation": "Follow\tthe\tKubernetes\tdocumentation\tand\tset\tup\tthe\tTLS\tconnection\tbetween\tthe apiserver\tand\tetcd.\tThen,\tedit\tthe\tAPI\tserver\tpod\tspecification\tfile /etc/kubernetes/manifests/kube-apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\tetcd certificate\tand\tkey\tfile\tparameters. --etcd-certfile=<path/to/client-certificate-file> --etcd-keyfile=<path/to/client-key-file> Default\tValue: By\tdefault,\t--etcd-certfile\tand\t--etcd-keyfile\targuments\tare\tnot\tset 110\t|\tP a g e References: 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://coreos.com/etcd/docs/latest/op-guide/security.html Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices 111\t|\tP a g e",
    "impact": "TLS\tand\tclient\tcertificate\tauthentication\tmust\tbe\tconfigured\tfor\tetcd.",
    "references": "1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://coreos.com/etcd/docs/latest/op-guide/security.html Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices 111\t|\tP a g e",
    "function_names": [
      "etcd_certificate_file_configured",
      "etcd_key_file_configured",
      "etcd_client_tls_encryption_enabled",
      "etcd_certificate_key_pair_valid",
      "etcd_client_connection_encrypted"
    ]
  },
  {
    "id": "1.2.28",
    "title": "Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate",
    "assessment": "Automated",
    "description": "Setup\tTLS\tconnection\ton\tthe\tAPI\tserver.",
    "rationale": "API\tserver\tcommunication\tcontains\tsensitive\tparameters\tthat\tshould\tremain\tencrypted\tin transit.\tConfigure\tthe\tAPI\tserver\tto\tserve\tonly\tHTTPS\ttraffic. Impact: TLS\tand\tclient\tcertificate\tauthentication\tmust\tbe\tconfigured\tfor\tyour\tKubernetes\tcluster deployment.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--tls-cert-file\tand\t--tls-private-key-file\targuments\texist\tand\tthey are\tset\tas\tappropriate.",
    "remediation": "Follow\tthe\tKubernetes\tdocumentation\tand\tset\tup\tthe\tTLS\tconnection\ton\tthe\tapiserver. Then,\tedit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\tTLS\tcertificate\tand\tprivate\tkey\tfile parameters. --tls-cert-file=<path/to/tls-certificate-file> --tls-private-key-file=<path/to/tls-key-file> Default\tValue: By\tdefault,\t--tls-cert-file\tand\t--tls-private-key-file\targuments\tare\tnot\tset. References: 112\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. http://rootsquash.com/2016/05/10/securing-the-kubernetes-api/ 3. https://github.com/kelseyhightower/docker-kubernetes-tls-guide Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 113\t|\tP a g e",
    "impact": "TLS\tand\tclient\tcertificate\tauthentication\tmust\tbe\tconfigured\tfor\tyour\tKubernetes\tcluster deployment.",
    "references": "112\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. http://rootsquash.com/2016/05/10/securing-the-kubernetes-api/ 3. https://github.com/kelseyhightower/docker-kubernetes-tls-guide Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 113\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_tls_cert_file_set",
      "kubernetes_api_server_tls_private_key_file_set",
      "kubernetes_api_server_tls_connection_configured",
      "kubernetes_api_server_tls_cert_and_key_valid",
      "kubernetes_api_server_tls_encryption_enabled"
    ]
  },
  {
    "id": "1.2.29",
    "title": "Ensure that the --client-ca-file argument is set as appropriate",
    "assessment": "Automated",
    "description": "Setup\tTLS\tconnection\ton\tthe\tAPI\tserver.",
    "rationale": "API\tserver\tcommunication\tcontains\tsensitive\tparameters\tthat\tshould\tremain\tencrypted\tin transit.\tConfigure\tthe\tAPI\tserver\tto\tserve\tonly\tHTTPS\ttraffic.\tIf\t--client-ca-file argument\tis\tset,\tany\trequest\tpresenting\ta\tclient\tcertificate\tsigned\tby\tone\tof\tthe\tauthorities in\tthe\tclient-ca-file\tis\tauthenticated\twith\tan\tidentity\tcorresponding\tto\tthe CommonName\tof\tthe\tclient\tcertificate. Impact: TLS\tand\tclient\tcertificate\tauthentication\tmust\tbe\tconfigured\tfor\tyour\tKubernetes\tcluster deployment.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--client-ca-file\targument\texists\tand\tit\tis\tset\tas\tappropriate.",
    "remediation": "Follow\tthe\tKubernetes\tdocumentation\tand\tset\tup\tthe\tTLS\tconnection\ton\tthe\tapiserver. Then,\tedit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\tclient\tcertificate\tauthority\tfile. --client-ca-file=<path/to/client-ca-file> Default\tValue: By\tdefault,\t--client-ca-file\targument\tis\tnot\tset. References: 114\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. http://rootsquash.com/2016/05/10/securing-the-kubernetes-api/ 3. https://github.com/kelseyhightower/docker-kubernetes-tls-guide Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 115\t|\tP a g e",
    "impact": "TLS\tand\tclient\tcertificate\tauthentication\tmust\tbe\tconfigured\tfor\tyour\tKubernetes\tcluster deployment.",
    "references": "114\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. http://rootsquash.com/2016/05/10/securing-the-kubernetes-api/ 3. https://github.com/kelseyhightower/docker-kubernetes-tls-guide Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 115\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_client_ca_file_set",
      "kubernetes_api_server_tls_connection_configured",
      "kubernetes_api_server_client_ca_file_valid",
      "kubernetes_api_server_tls_authentication_enabled",
      "kubernetes_api_server_client_ca_file_properly_configured"
    ]
  },
  {
    "id": "1.2.30",
    "title": "Ensure that the --etcd-cafile argument is set as appropriate",
    "assessment": "Automated",
    "description": "etcd\tshould\tbe\tconfigured\tto\tmake\tuse\tof\tTLS\tencryption\tfor\tclient\tconnections.",
    "rationale": "etcd\tis\ta\thighly-available\tkey\tvalue\tstore\tused\tby\tKubernetes\tdeployments\tfor\tpersistent storage\tof\tall\tof\tits\tREST\tAPI\tobjects.\tThese\tobjects\tare\tsensitive\tin\tnature\tand\tshould\tbe protected\tby\tclient\tauthentication.\tThis\trequires\tthe\tAPI\tserver\tto\tidentify\titself\tto\tthe\tetcd server\tusing\ta\tSSL\tCertificate\tAuthority\tfile. Impact: TLS\tand\tclient\tcertificate\tauthentication\tmust\tbe\tconfigured\tfor\tetcd.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--etcd-cafile\targument\texists\tand\tit\tis\tset\tas\tappropriate.",
    "remediation": "Follow\tthe\tKubernetes\tdocumentation\tand\tset\tup\tthe\tTLS\tconnection\tbetween\tthe apiserver\tand\tetcd.\tThen,\tedit\tthe\tAPI\tserver\tpod\tspecification\tfile /etc/kubernetes/manifests/kube-apiserver.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\tetcd certificate\tauthority\tfile\tparameter. --etcd-cafile=<path/to/ca-file> Default\tValue: By\tdefault,\t--etcd-cafile\tis\tnot\tset. References: 116\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://coreos.com/etcd/docs/latest/op-guide/security.html Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 117\t|\tP a g e",
    "impact": "TLS\tand\tclient\tcertificate\tauthentication\tmust\tbe\tconfigured\tfor\tetcd.",
    "references": "116\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-apiserver/ 2. https://coreos.com/etcd/docs/latest/op-guide/security.html Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 117\t|\tP a g e",
    "function_names": [
      "etcd_connection_tls_encryption_enabled",
      "etcd_client_cafile_configured",
      "etcd_secure_client_communication_enabled",
      "etcd_tls_client_authentication_required",
      "etcd_cafile_argument_set_correctly"
    ]
  },
  {
    "id": "1.2.31",
    "title": "Ensure that the --encryption-provider-config argument is set as appropriate",
    "assessment": "Manual",
    "description": "Encrypt\tetcd\tkey-value\tstore.",
    "rationale": "etcd\tis\ta\thighly\tavailable\tkey-value\tstore\tused\tby\tKubernetes\tdeployments\tfor\tpersistent storage\tof\tall\tof\tits\tREST\tAPI\tobjects.\tThese\tobjects\tare\tsensitive\tin\tnature\tand\tshould\tbe encrypted\tat\trest\tto\tavoid\tany\tdisclosures. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--encryption-provider-config\targument\tis\tset\tto\ta\tEncryptionConfig\tfile. Additionally,\tensure\tthat\tthe\tEncryptionConfig\tfile\thas\tall\tthe\tdesired\tresources\tcovered especially\tany\tsecrets.",
    "remediation": "Follow\tthe\tKubernetes\tdocumentation\tand\tconfigure\ta\tEncryptionConfig\tfile.\tThen,\tedit the\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube-apiserver.yaml on\tthe\tmaster\tnode\tand\tset\tthe\t--encryption-provider-config\tparameter\tto\tthe\tpath\tof that\tfile: --encryption-provider-config=</path/to/EncryptionConfig/File> Default\tValue: By\tdefault,\t--encryption-provider-config\tis\tnot\tset. References: 118\t|\tP a g e 1. https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/ 2. https://acotten.com/post/kube17-security 3. https://kubernetes.io/docs/admin/kube-apiserver/ 4. https://github.com/kubernetes/features/issues/92 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.5\tEncrypt\tAt\tRest\tSensitive\tInformation Sensitive\tinformation\tstored\ton\tsystems\tshall\tbe\tencrypted\tat\trest\tand\trequire\ta secondary\tauthentication\tmechanism,\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto access\tthe\tinformation. Version\t7 14.8\tEncrypt\tSensitive\tInformation\tat\tRest Encrypt\tall\tsensitive\tinformation\tat\trest\tusing\ta\ttool\tthat\trequires\ta\tsecondary authentication\tmechanism\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto\taccess\tthe information. 119\t|\tP a g e",
    "impact": "None",
    "references": "118\t|\tP a g e 1. https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/ 2. https://acotten.com/post/kube17-security 3. https://kubernetes.io/docs/admin/kube-apiserver/ 4. https://github.com/kubernetes/features/issues/92 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.5\tEncrypt\tAt\tRest\tSensitive\tInformation Sensitive\tinformation\tstored\ton\tsystems\tshall\tbe\tencrypted\tat\trest\tand\trequire\ta secondary\tauthentication\tmechanism,\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto access\tthe\tinformation. Version\t7 14.8\tEncrypt\tSensitive\tInformation\tat\tRest Encrypt\tall\tsensitive\tinformation\tat\trest\tusing\ta\ttool\tthat\trequires\ta\tsecondary authentication\tmechanism\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto\taccess\tthe information. 119\t|\tP a g e",
    "function_names": [
      "kubernetes_etcd_encryption_enabled",
      "kubernetes_etcd_encryption_provider_configured",
      "kubernetes_etcd_encryption_key_rotation_enabled",
      "kubernetes_etcd_encryption_tls_enabled",
      "kubernetes_etcd_encryption_config_valid"
    ]
  },
  {
    "id": "1.2.32",
    "title": "Ensure that encryption providers are appropriately configured",
    "assessment": "Manual",
    "description": "Where\tetcd\tencryption\tis\tused,\tappropriate\tproviders\tshould\tbe\tconfigured.",
    "rationale": "Where\tetcd\tencryption\tis\tused,\tit\tis\timportant\tto\tensure\tthat\tthe\tappropriate\tset\tof encryption\tproviders\tis\tused.\tCurrently,\tthe\taescbc,\tkms\tand\tsecretbox\tare\tlikely\tto\tbe appropriate\toptions. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Get\tthe\tEncryptionConfig\tfile\tset\tfor\t--encryption-provider-config\targument.\tVerify that\taescbc,\tkms\tor\tsecretbox\tis\tset\tas\tthe\tencryption\tprovider\tfor\tall\tthe\tdesired resources.",
    "remediation": "Follow\tthe\tKubernetes\tdocumentation\tand\tconfigure\ta\tEncryptionConfig\tfile.\tIn\tthis\tfile, choose\taescbc,\tkms\tor\tsecretbox\tas\tthe\tencryption\tprovider. Default\tValue: By\tdefault,\tno\tencryption\tprovider\tis\tset. References: 1. https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/ 2. https://acotten.com/post/kube17-security 3. https://kubernetes.io/docs/admin/kube-apiserver/ 120\t|\tP a g e 4. https://github.com/kubernetes/features/issues/92 5. https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/#providers Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.5\tEncrypt\tAt\tRest\tSensitive\tInformation Sensitive\tinformation\tstored\ton\tsystems\tshall\tbe\tencrypted\tat\trest\tand\trequire\ta secondary\tauthentication\tmechanism,\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto access\tthe\tinformation. Version\t7 14.8\tEncrypt\tSensitive\tInformation\tat\tRest Encrypt\tall\tsensitive\tinformation\tat\trest\tusing\ta\ttool\tthat\trequires\ta\tsecondary authentication\tmechanism\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto\taccess\tthe information. 121\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/ 2. https://acotten.com/post/kube17-security 3. https://kubernetes.io/docs/admin/kube-apiserver/ 120\t|\tP a g e 4. https://github.com/kubernetes/features/issues/92 5. https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/#providers Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.5\tEncrypt\tAt\tRest\tSensitive\tInformation Sensitive\tinformation\tstored\ton\tsystems\tshall\tbe\tencrypted\tat\trest\tand\trequire\ta secondary\tauthentication\tmechanism,\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto access\tthe\tinformation. Version\t7 14.8\tEncrypt\tSensitive\tInformation\tat\tRest Encrypt\tall\tsensitive\tinformation\tat\trest\tusing\ta\ttool\tthat\trequires\ta\tsecondary authentication\tmechanism\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto\taccess\tthe information. 121\t|\tP a g e",
    "function_names": [
      "etcd_encryption_provider_configured",
      "etcd_encryption_provider_secure",
      "etcd_encryption_provider_valid",
      "etcd_encryption_provider_approved",
      "etcd_encryption_provider_compliant",
      "etcd_encryption_provider_standard",
      "etcd_encryption_provider_correct",
      "etcd_encryption_provider_properly_configured"
    ]
  },
  {
    "id": "1.2.33",
    "title": "Ensure that the API Server only makes use of Strong Cryptographic Ciphers",
    "assessment": "Manual",
    "description": "Ensure\tthat\tthe\tAPI\tserver\tis\tconfigured\tto\tonly\tuse\tstrong\tcryptographic\tciphers.",
    "rationale": "TLS\tciphers\thave\thad\ta\tnumber\tof\tknown\tvulnerabilities\tand\tweaknesses,\twhich\tcan reduce\tthe\tprotection\tprovided\tby\tthem.\tBy\tdefault\tKubernetes\tsupports\ta\tnumber\tof\tTLS ciphersuites\tincluding\tsome\tthat\thave\tsecurity\tconcerns,\tweakening\tthe\tprotection provided. Impact: API\tserver\tclients\tthat\tcannot\tsupport\tmodern\tcryptographic\tciphers\twill\tnot\tbe\table\tto make\tconnections\tto\tthe\tAPI\tserver.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--tls-cipher-suites\targument\tis\tset\tas\toutlined\tin\tthe\tremediation procedure\tbelow.",
    "remediation": "Edit\tthe\tAPI\tserver\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube-apiserver.yaml on\tthe\tmaster\tnode\tand\tset\tthe\tbelow\tparameter. --tls-cipher- suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM _SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM _SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM _SHA384 Default\tValue: By\tdefault\tthe\tKubernetes\tAPI\tserver\tsupports\ta\twide\trange\tof\tTLS\tciphers 122\t|\tP a g e References: 1. https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best- Practices#23-use-secure-cipher-suites Additional\tInformation: The\tlist\tchosen\tabove\tshould\tbe\tfine\tfor\tmodern\tclients.\tIt's\tessentially\tthe\tlist\tfrom\tthe Mozilla\t\"Modern\tcipher\"\toption\twith\tthe\tciphersuites\tsupporting\tCBC\tmode\tremoved,\tas CBC\thas\ttraditionally\thad\ta\tlot\tof\tissues This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 3.4\tUse\tOnly\tSecure\tChannels\tFor\tRemote\tSystem\tAdministration Perform\tall\tremote\tadministration\tof\tservers,\tworkstation,\tnetwork\tdevices,\tand\tsimilar equipment\tover\tsecure\tchannels.\tProtocols\tsuch\tas\ttelnet,\tVNC,\tRDP,\tor\tothers\tthat\tdo\tnot actively\tsupport\tstrong\tencryption\tshould\tonly\tbe\tused\tif\tthey\tare\tperformed\tover\ta secondary\tencryption\tchannel,\tsuch\tas\tSSL,\tTLS\tor\tIPSEC. Version\t7 4.5\tUse\tMultifactor\tAuthentication\tFor\tAll\tAdministrative\tAccess Use\tmulti-factor\tauthentication\tand\tencrypted\tchannels\tfor\tall\tadministrative\taccount access. 123\t|\tP a g e 1.3 Controller Manager This\tsection\tcontains\trecommendations\trelating\tto\tController\tManager\tconfiguration\tflags",
    "impact": "API\tserver\tclients\tthat\tcannot\tsupport\tmodern\tcryptographic\tciphers\twill\tnot\tbe\table\tto make\tconnections\tto\tthe\tAPI\tserver.",
    "references": "1. https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best- Practices#23-use-secure-cipher-suites Additional\tInformation: The\tlist\tchosen\tabove\tshould\tbe\tfine\tfor\tmodern\tclients.\tIt's\tessentially\tthe\tlist\tfrom\tthe Mozilla\t\"Modern\tcipher\"\toption\twith\tthe\tciphersuites\tsupporting\tCBC\tmode\tremoved,\tas CBC\thas\ttraditionally\thad\ta\tlot\tof\tissues This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 3.4\tUse\tOnly\tSecure\tChannels\tFor\tRemote\tSystem\tAdministration Perform\tall\tremote\tadministration\tof\tservers,\tworkstation,\tnetwork\tdevices,\tand\tsimilar equipment\tover\tsecure\tchannels.\tProtocols\tsuch\tas\ttelnet,\tVNC,\tRDP,\tor\tothers\tthat\tdo\tnot actively\tsupport\tstrong\tencryption\tshould\tonly\tbe\tused\tif\tthey\tare\tperformed\tover\ta secondary\tencryption\tchannel,\tsuch\tas\tSSL,\tTLS\tor\tIPSEC. Version\t7 4.5\tUse\tMultifactor\tAuthentication\tFor\tAll\tAdministrative\tAccess Use\tmulti-factor\tauthentication\tand\tencrypted\tchannels\tfor\tall\tadministrative\taccount access. 123\t|\tP a g e 1.3 Controller Manager This\tsection\tcontains\trecommendations\trelating\tto\tController\tManager\tconfiguration\tflags",
    "function_names": [
      "kubernetes_api_server_strong_ciphers_enabled",
      "kubernetes_api_server_weak_ciphers_disabled",
      "kubernetes_api_server_tls_min_version_1_2",
      "kubernetes_api_server_cipher_suite_restricted",
      "kubernetes_api_server_insecure_ciphers_rejected"
    ]
  },
  {
    "id": "1.3.1",
    "title": "Ensure that the --terminated-pod-gc-threshold argument is set as appropriate",
    "assessment": "Manual",
    "description": "Activate\tgarbage\tcollector\ton\tpod\ttermination,\tas\tappropriate.",
    "rationale": "Garbage\tcollection\tis\timportant\tto\tensure\tsufficient\tresource\tavailability\tand\tavoiding degraded\tperformance\tand\tavailability.\tIn\tthe\tworst\tcase,\tthe\tsystem\tmight\tcrash\tor\tjust\tbe unusable\tfor\ta\tlong\tperiod\tof\ttime.\tThe\tcurrent\tsetting\tfor\tgarbage\tcollection\tis\t12,500 terminated\tpods\twhich\tmight\tbe\ttoo\thigh\tfor\tyour\tsystem\tto\tsustain.\tBased\ton\tyour\tsystem resources\tand\ttests,\tchoose\tan\tappropriate\tthreshold\tvalue\tto\tactivate\tgarbage\tcollection. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-controller-manager Verify\tthat\tthe\t--terminated-pod-gc-threshold\targument\tis\tset\tas\tappropriate.",
    "remediation": "Edit\tthe\tController\tManager\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- controller-manager.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--terminated-pod-gc- threshold\tto\tan\tappropriate\tthreshold,\tfor\texample: --terminated-pod-gc-threshold=10 Default\tValue: 124\t|\tP a g e By\tdefault,\t--terminated-pod-gc-threshold\tis\tset\tto\t12500. References: 1. https://kubernetes.io/docs/admin/kube-controller-manager/ 2. https://github.com/kubernetes/kubernetes/issues/28484 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 125\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-controller-manager/ 2. https://github.com/kubernetes/kubernetes/issues/28484 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 125\t|\tP a g e",
    "function_names": [
      "kubernetes_pod_garbage_collection_enabled",
      "kubernetes_pod_termination_threshold_set",
      "kubernetes_controller_manager_terminated_pod_gc_configured",
      "kubernetes_controller_manager_pod_cleanup_threshold_set",
      "kubernetes_pod_gc_threshold_configured",
      "kubernetes_controller_manager_terminated_pod_cleanup_enabled",
      "kubernetes_pod_termination_cleanup_threshold_set",
      "kubernetes_controller_manager_pod_gc_threshold_configured"
    ]
  },
  {
    "id": "1.3.2",
    "title": "Ensure that the --profiling argument is set to false",
    "assessment": "Automated",
    "description": "Disable\tprofiling,\tif\tnot\tneeded.",
    "rationale": "Profiling\tallows\tfor\tthe\tidentification\tof\tspecific\tperformance\tbottlenecks.\tIt\tgenerates\ta significant\tamount\tof\tprogram\tdata\tthat\tcould\tpotentially\tbe\texploited\tto\tuncover\tsystem and\tprogram\tdetails.\tIf\tyou\tare\tnot\texperiencing\tany\tbottlenecks\tand\tdo\tnot\tneed\tthe profiler\tfor\ttroubleshooting\tpurposes,\tit\tis\trecommended\tto\tturn\tit\toff\tto\treduce\tthe potential\tattack\tsurface. Impact: Profiling\tinformation\twould\tnot\tbe\tavailable.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-controller-manager Verify\tthat\tthe\t--profiling\targument\tis\tset\tto\tfalse.",
    "remediation": "Edit\tthe\tController\tManager\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- controller-manager.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\tbelow\tparameter. --profiling=false Default\tValue: By\tdefault,\tprofiling\tis\tenabled. References: 1. https://kubernetes.io/docs/admin/kube-controller-manager/ 2. https://github.com/kubernetes/community/blob/master/contributors/devel/profi ling.md 126\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 127\t|\tP a g e",
    "impact": "Profiling\tinformation\twould\tnot\tbe\tavailable.",
    "references": "1. https://kubernetes.io/docs/admin/kube-controller-manager/ 2. https://github.com/kubernetes/community/blob/master/contributors/devel/profi ling.md 126\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 127\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_profiling_disabled",
      "kubernetes_api_server_profiling_set_false",
      "kubernetes_api_server_profiling_not_enabled",
      "kubernetes_api_server_profiling_config_disabled",
      "kubernetes_api_server_profiling_argument_false"
    ]
  },
  {
    "id": "1.3.3",
    "title": "Ensure that the --use-service-account-credentials argument is set to true",
    "assessment": "Automated",
    "description": "Use\tindividual\tservice\taccount\tcredentials\tfor\teach\tcontroller.",
    "rationale": "The\tcontroller\tmanager\tcreates\ta\tservice\taccount\tper\tcontroller\tin\tthe\tkube-system namespace,\tgenerates\ta\tcredential\tfor\tit,\tand\tbuilds\ta\tdedicated\tAPI\tclient\twith\tthat\tservice account\tcredential\tfor\teach\tcontroller\tloop\tto\tuse.\tSetting\tthe\t--use-service-account- credentials\tto\ttrue\truns\teach\tcontrol\tloop\twithin\tthe\tcontroller\tmanager\tusing\ta\tseparate service\taccount\tcredential.\tWhen\tused\tin\tcombination\twith\tRBAC,\tthis\tensures\tthat\tthe control\tloops\trun\twith\tthe\tminimum\tpermissions\trequired\tto\tperform\ttheir\tintended\ttasks. Impact: Whatever\tauthorizer\tis\tconfigured\tfor\tthe\tcluster,\tit\tmust\tgrant\tsufficient\tpermissions\tto the\tservice\taccounts\tto\tperform\ttheir\tintended\ttasks.\tWhen\tusing\tthe\tRBAC\tauthorizer, those\troles\tare\tcreated\tand\tbound\tto\tthe\tappropriate\tservice\taccounts\tin\tthe\tkube-system namespace\tautomatically\twith\tdefault\troles\tand\trolebindings\tthat\tare\tauto-reconciled\ton startup. If\tusing\tother\tauthorization\tmethods\t(ABAC,\tWebhook,\tetc),\tthe\tcluster\tdeployer\tis responsible\tfor\tgranting\tappropriate\tpermissions\tto\tthe\tservice\taccounts\t(the\trequired permissions\tcan\tbe\tseen\tby\tinspecting\tthe\tcontroller-roles.yaml\tand\tcontroller-role- bindings.yaml\tfiles\tfor\tthe\tRBAC\troles.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-controller-manager Verify\tthat\tthe\t--use-service-account-credentials\targument\tis\tset\tto\ttrue.",
    "remediation": "128\t|\tP a g e Edit\tthe\tController\tManager\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- controller-manager.yaml\ton\tthe\tmaster\tnode\tto\tset\tthe\tbelow\tparameter. --use-service-account-credentials=true Default\tValue: By\tdefault,\t--use-service-account-credentials\tis\tset\tto\tfalse. References: 1. https://kubernetes.io/docs/admin/kube-controller-manager/ 2. https://kubernetes.io/docs/admin/service-accounts-admin/ 3. https://github.com/kubernetes/kubernetes/blob/release- 1.6/plugin/pkg/auth/authorizer/rbac/bootstrappolicy/testdata/controller- roles.yaml 4. https://github.com/kubernetes/kubernetes/blob/release- 1.6/plugin/pkg/auth/authorizer/rbac/bootstrappolicy/testdata/controller-role- bindings.yaml 5. https://kubernetes.io/docs/admin/authorization/rbac/#controller-roles Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 129\t|\tP a g e",
    "impact": "Whatever\tauthorizer\tis\tconfigured\tfor\tthe\tcluster,\tit\tmust\tgrant\tsufficient\tpermissions\tto the\tservice\taccounts\tto\tperform\ttheir\tintended\ttasks.\tWhen\tusing\tthe\tRBAC\tauthorizer, those\troles\tare\tcreated\tand\tbound\tto\tthe\tappropriate\tservice\taccounts\tin\tthe\tkube-system namespace\tautomatically\twith\tdefault\troles\tand\trolebindings\tthat\tare\tauto-reconciled\ton startup. If\tusing\tother\tauthorization\tmethods\t(ABAC,\tWebhook,\tetc),\tthe\tcluster\tdeployer\tis responsible\tfor\tgranting\tappropriate\tpermissions\tto\tthe\tservice\taccounts\t(the\trequired permissions\tcan\tbe\tseen\tby\tinspecting\tthe\tcontroller-roles.yaml\tand\tcontroller-role- bindings.yaml\tfiles\tfor\tthe\tRBAC\troles.",
    "references": "1. https://kubernetes.io/docs/admin/kube-controller-manager/ 2. https://kubernetes.io/docs/admin/service-accounts-admin/ 3. https://github.com/kubernetes/kubernetes/blob/release- 1.6/plugin/pkg/auth/authorizer/rbac/bootstrappolicy/testdata/controller- roles.yaml 4. https://github.com/kubernetes/kubernetes/blob/release- 1.6/plugin/pkg/auth/authorizer/rbac/bootstrappolicy/testdata/controller-role- bindings.yaml 5. https://kubernetes.io/docs/admin/authorization/rbac/#controller-roles Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 129\t|\tP a g e",
    "function_names": [
      "gke_cluster_use_service_account_credentials_enabled",
      "gke_controller_service_account_credentials_required",
      "gke_cluster_service_account_credentials_enforced",
      "gke_controller_individual_service_account_credentials",
      "gke_cluster_controller_credentials_isolated"
    ]
  },
  {
    "id": "1.3.4",
    "title": "Ensure that the --service-account-private-key-file argument is set as appropriate",
    "assessment": "Automated",
    "description": "Explicitly\tset\ta\tservice\taccount\tprivate\tkey\tfile\tfor\tservice\taccounts\ton\tthe\tcontroller manager.",
    "rationale": "To\tensure\tthat\tkeys\tfor\tservice\taccount\ttokens\tcan\tbe\trotated\tas\tneeded,\ta\tseparate public/private\tkey\tpair\tshould\tbe\tused\tfor\tsigning\tservice\taccount\ttokens.\tThe\tprivate\tkey should\tbe\tspecified\tto\tthe\tcontroller\tmanager\twith\t--service-account-private-key-file as\tappropriate. Impact: You\twould\tneed\tto\tsecurely\tmaintain\tthe\tkey\tfile\tand\trotate\tthe\tkeys\tbased\ton\tyour organization's\tkey\trotation\tpolicy.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-controller-manager Verify\tthat\tthe\t--service-account-private-key-file\targument\tis\tset\tas\tappropriate.",
    "remediation": "Edit\tthe\tController\tManager\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- controller-manager.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--service-account-private- key-file\tparameter\tto\tthe\tprivate\tkey\tfile\tfor\tservice\taccounts. --service-account-private-key-file=<filename> Default\tValue: By\tdefault,\t--service-account-private-key-file\tit\tnot\tset. References: 130\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-controller-manager/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 131\t|\tP a g e",
    "impact": "You\twould\tneed\tto\tsecurely\tmaintain\tthe\tkey\tfile\tand\trotate\tthe\tkeys\tbased\ton\tyour organization's\tkey\trotation\tpolicy.",
    "references": "130\t|\tP a g e 1. https://kubernetes.io/docs/admin/kube-controller-manager/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 131\t|\tP a g e",
    "function_names": [
      "kubernetes_controller_manager_service_account_private_key_file_set",
      "kubernetes_controller_manager_service_account_key_file_configured",
      "kubernetes_controller_manager_private_key_file_specified",
      "kubernetes_controller_manager_service_account_key_file_valid",
      "kubernetes_controller_manager_private_key_file_secure"
    ]
  },
  {
    "id": "1.3.5",
    "title": "Ensure that the --root-ca-file argument is set as appropriate",
    "assessment": "Automated",
    "description": "Allow\tpods\tto\tverify\tthe\tAPI\tserver's\tserving\tcertificate\tbefore\testablishing\tconnections.",
    "rationale": "Processes\trunning\twithin\tpods\tthat\tneed\tto\tcontact\tthe\tAPI\tserver\tmust\tverify\tthe\tAPI server's\tserving\tcertificate.\tFailing\tto\tdo\tso\tcould\tbe\ta\tsubject\tto\tman-in-the-middle\tattacks. Providing\tthe\troot\tcertificate\tfor\tthe\tAPI\tserver's\tserving\tcertificate\tto\tthe\tcontroller manager\twith\tthe\t--root-ca-file\targument\tallows\tthe\tcontroller\tmanager\tto\tinject\tthe trusted\tbundle\tinto\tpods\tso\tthat\tthey\tcan\tverify\tTLS\tconnections\tto\tthe\tAPI\tserver. Impact: You\tneed\tto\tsetup\tand\tmaintain\troot\tcertificate\tauthority\tfile.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-controller-manager Verify\tthat\tthe\t--root-ca-file\targument\texists\tand\tis\tset\tto\ta\tcertificate\tbundle\tfile containing\tthe\troot\tcertificate\tfor\tthe\tAPI\tserver's\tserving\tcertificate.",
    "remediation": "Edit\tthe\tController\tManager\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- controller-manager.yaml\ton\tthe\tmaster\tnode\tand\tset\tthe\t--root-ca-file\tparameter\tto the\tcertificate\tbundle\tfile`. --root-ca-file=<path/to/file> Default\tValue: By\tdefault,\t--root-ca-file\tis\tnot\tset. 132\t|\tP a g e References: 1. https://kubernetes.io/docs/admin/kube-controller-manager/ 2. https://github.com/kubernetes/kubernetes/issues/11000 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 133\t|\tP a g e",
    "impact": "You\tneed\tto\tsetup\tand\tmaintain\troot\tcertificate\tauthority\tfile.",
    "references": "1. https://kubernetes.io/docs/admin/kube-controller-manager/ 2. https://github.com/kubernetes/kubernetes/issues/11000 Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 133\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_root_ca_file_configured",
      "kubernetes_api_server_root_ca_file_valid",
      "kubernetes_api_server_root_ca_file_secure",
      "kubernetes_api_server_root_ca_file_trusted",
      "kubernetes_api_server_root_ca_file_present"
    ]
  },
  {
    "id": "1.3.6",
    "title": "Ensure that the --bind-address argument is set to 127.0.0.1",
    "assessment": "Automated",
    "description": "Do\tnot\tbind\tthe\tController\tManager\tservice\tto\tnon-loopback\tinsecure\taddresses.",
    "rationale": "The\tController\tManager\tAPI\tservice\twhich\truns\ton\tport\t10252/TCP\tby\tdefault\tis\tused\tfor health\tand\tmetrics\tinformation\tand\tis\tavailable\twithout\tauthentication\tor\tencryption.\tAs such\tit\tshould\tonly\tbe\tbound\tto\ta\tlocalhost\tinterface,\tto\tminimize\tthe\tcluster's\tattack surface Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-controller-manager Verify\tthat\tthe\t--bind-address\targument\tis\tset\tto\t127.0.0.1",
    "remediation": "Edit\tthe\tController\tManager\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- controller-manager.yaml\ton\tthe\tmaster\tnode\tand\tensure\tthe\tcorrect\tvalue\tfor\tthe\t-- bind-address\tparameter Default\tValue: By\tdefault,\tthe\t--bind-address\tparameter\tis\tset\tto\t0.0.0.0 References: 1. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- controller-manager/ 134\t|\tP a g e Additional\tInformation: Although\tthe\tcurrent\tKubernetes\tdocumentation\tsite\tsays\tthat\t--address\tis\tdeprecated\tin favour\tof\t--bind-address\tKubeadm\t1.11\tstill\tmakes\tuse\tof\t--address This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 135\t|\tP a g e 1.4 Scheduler This\tsection\tcontains\trecommendations\trelating\tto\tScheduler\tconfiguration\tflags",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- controller-manager/ 134\t|\tP a g e Additional\tInformation: Although\tthe\tcurrent\tKubernetes\tdocumentation\tsite\tsays\tthat\t--address\tis\tdeprecated\tin favour\tof\t--bind-address\tKubeadm\t1.11\tstill\tmakes\tuse\tof\t--address This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 135\t|\tP a g e 1.4 Scheduler This\tsection\tcontains\trecommendations\trelating\tto\tScheduler\tconfiguration\tflags",
    "function_names": [
      "kubernetes_controller_manager_bind_address_localhost",
      "kubernetes_controller_manager_network_restricted_loopback",
      "kubernetes_controller_manager_insecure_bind_disabled",
      "kubernetes_controller_manager_loopback_only_enabled",
      "kubernetes_controller_manager_bind_address_secure"
    ]
  },
  {
    "id": "1.4.1",
    "title": "Ensure that the --profiling argument is set to false",
    "assessment": "Automated",
    "description": "Disable\tprofiling,\tif\tnot\tneeded.",
    "rationale": "Profiling\tallows\tfor\tthe\tidentification\tof\tspecific\tperformance\tbottlenecks.\tIt\tgenerates\ta significant\tamount\tof\tprogram\tdata\tthat\tcould\tpotentially\tbe\texploited\tto\tuncover\tsystem and\tprogram\tdetails.\tIf\tyou\tare\tnot\texperiencing\tany\tbottlenecks\tand\tdo\tnot\tneed\tthe profiler\tfor\ttroubleshooting\tpurposes,\tit\tis\trecommended\tto\tturn\tit\toff\tto\treduce\tthe potential\tattack\tsurface. Impact: Profiling\tinformation\twould\tnot\tbe\tavailable.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-scheduler Verify\tthat\tthe\t--profiling\targument\tis\tset\tto\tfalse.",
    "remediation": "Edit\tthe\tScheduler\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- scheduler.yaml\tfile\ton\tthe\tmaster\tnode\tand\tset\tthe\tbelow\tparameter. --profiling=false Default\tValue: By\tdefault,\tprofiling\tis\tenabled. 136\t|\tP a g e References: 1. https://kubernetes.io/docs/admin/kube-scheduler/ 2. https://github.com/kubernetes/community/blob/master/contributors/devel/profi ling.md Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 137\t|\tP a g e",
    "impact": "Profiling\tinformation\twould\tnot\tbe\tavailable.",
    "references": "1. https://kubernetes.io/docs/admin/kube-scheduler/ 2. https://github.com/kubernetes/community/blob/master/contributors/devel/profi ling.md Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 137\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_profiling_disabled",
      "kubernetes_api_server_profiling_not_enabled",
      "kubernetes_api_server_profiling_set_false",
      "kubernetes_api_server_no_profiling",
      "kubernetes_api_server_profiling_flag_disabled"
    ]
  },
  {
    "id": "1.4.2",
    "title": "Ensure that the --bind-address argument is set to 127.0.0.1",
    "assessment": "Automated",
    "description": "Do\tnot\tbind\tthe\tscheduler\tservice\tto\tnon-loopback\tinsecure\taddresses.",
    "rationale": "The\tScheduler\tAPI\tservice\twhich\truns\ton\tport\t10251/TCP\tby\tdefault\tis\tused\tfor\thealth\tand metrics\tinformation\tand\tis\tavailable\twithout\tauthentication\tor\tencryption.\tAs\tsuch\tit should\tonly\tbe\tbound\tto\ta\tlocalhost\tinterface,\tto\tminimize\tthe\tcluster's\tattack\tsurface Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tmaster\tnode: ps -ef | grep kube-scheduler Verify\tthat\tthe\t--bind-address\targument\tis\tset\tto\t127.0.0.1",
    "remediation": "Edit\tthe\tScheduler\tpod\tspecification\tfile\t/etc/kubernetes/manifests/kube- scheduler.yaml\ton\tthe\tmaster\tnode\tand\tensure\tthe\tcorrect\tvalue\tfor\tthe\t--bind-address parameter Default\tValue: By\tdefault,\tthe\t--bind-address\tparameter\tis\tset\tto\t0.0.0.0 References: 1. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- scheduler/ Additional\tInformation: 138\t|\tP a g e This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 139\t|\tP a g e 2 etcd This\tsection\tcovers\trecommendations\tfor\tetcd\tconfiguration.",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/reference/command-line-tools-reference/kube- scheduler/ Additional\tInformation: 138\t|\tP a g e This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 139\t|\tP a g e 2 etcd This\tsection\tcovers\trecommendations\tfor\tetcd\tconfiguration.",
    "function_names": [
      "kubernetes_scheduler_bind_address_localhost",
      "kubernetes_scheduler_loopback_only",
      "kubernetes_scheduler_insecure_bind_disabled",
      "kubernetes_scheduler_bind_address_secure",
      "kubernetes_scheduler_localhost_restricted"
    ]
  },
  {
    "id": "2.1",
    "title": "Ensure that the --cert-file and --key-file arguments are set as appropriate",
    "assessment": "Automated",
    "description": "Configure\tTLS\tencryption\tfor\tthe\tetcd\tservice.",
    "rationale": "etcd\tis\ta\thighly-available\tkey\tvalue\tstore\tused\tby\tKubernetes\tdeployments\tfor\tpersistent storage\tof\tall\tof\tits\tREST\tAPI\tobjects.\tThese\tobjects\tare\tsensitive\tin\tnature\tand\tshould\tbe encrypted\tin\ttransit. Impact: Client\tconnections\tonly\tover\tTLS\twould\tbe\tserved.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tetcd\tserver\tnode ps -ef | grep etcd Verify\tthat\tthe\t--cert-file\tand\tthe\t--key-file\targuments\tare\tset\tas\tappropriate.",
    "remediation": "Follow\tthe\tetcd\tservice\tdocumentation\tand\tconfigure\tTLS\tencryption. Then,\tedit\tthe\tetcd\tpod\tspecification\tfile\t/etc/kubernetes/manifests/etcd.yaml\ton\tthe master\tnode\tand\tset\tthe\tbelow\tparameters. --cert-file=</path/to/ca-file> --key-file=</path/to/key-file> Default\tValue: By\tdefault,\tTLS\tencryption\tis\tnot\tset. 140\t|\tP a g e References: 1. https://coreos.com/etcd/docs/latest/op-guide/security.html 2. https://kubernetes.io/docs/admin/etcd/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 141\t|\tP a g e",
    "impact": "Client\tconnections\tonly\tover\tTLS\twould\tbe\tserved.",
    "references": "1. https://coreos.com/etcd/docs/latest/op-guide/security.html 2. https://kubernetes.io/docs/admin/etcd/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 141\t|\tP a g e",
    "function_names": [
      "etcd_service_cert_file_configured",
      "etcd_service_key_file_configured",
      "etcd_service_tls_encryption_enabled",
      "etcd_service_cert_file_valid",
      "etcd_service_key_file_valid",
      "etcd_service_tls_configured_correctly"
    ]
  },
  {
    "id": "2.2",
    "title": "Ensure that the --client-cert-auth argument is set to true",
    "assessment": "Automated",
    "description": "Enable\tclient\tauthentication\ton\tetcd\tservice.",
    "rationale": "etcd\tis\ta\thighly-available\tkey\tvalue\tstore\tused\tby\tKubernetes\tdeployments\tfor\tpersistent storage\tof\tall\tof\tits\tREST\tAPI\tobjects.\tThese\tobjects\tare\tsensitive\tin\tnature\tand\tshould\tnot be\tavailable\tto\tunauthenticated\tclients.\tYou\tshould\tenable\tthe\tclient\tauthentication\tvia valid\tcertificates\tto\tsecure\tthe\taccess\tto\tthe\tetcd\tservice. Impact: All\tclients\tattempting\tto\taccess\tthe\tetcd\tserver\twill\trequire\ta\tvalid\tclient\tcertificate.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tetcd\tserver\tnode: ps -ef | grep etcd Verify\tthat\tthe\t--client-cert-auth\targument\tis\tset\tto\ttrue.",
    "remediation": "Edit\tthe\tetcd\tpod\tspecification\tfile\t/etc/kubernetes/manifests/etcd.yaml\ton\tthe\tmaster node\tand\tset\tthe\tbelow\tparameter. --client-cert-auth=\"true\" Default\tValue: By\tdefault,\tthe\tetcd\tservice\tcan\tbe\tqueried\tby\tunauthenticated\tclients. References: 1. https://coreos.com/etcd/docs/latest/op-guide/security.html 2. https://kubernetes.io/docs/admin/etcd/ 142\t|\tP a g e 3. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#client-cert-auth Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 143\t|\tP a g e",
    "impact": "All\tclients\tattempting\tto\taccess\tthe\tetcd\tserver\twill\trequire\ta\tvalid\tclient\tcertificate.",
    "references": "1. https://coreos.com/etcd/docs/latest/op-guide/security.html 2. https://kubernetes.io/docs/admin/etcd/ 142\t|\tP a g e 3. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#client-cert-auth Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 143\t|\tP a g e",
    "function_names": [
      "etcd_service_client_auth_enabled",
      "etcd_service_client_cert_auth_required",
      "etcd_service_tls_client_auth_enabled",
      "etcd_service_client_authentication_enabled",
      "etcd_service_client_cert_auth_set_true"
    ]
  },
  {
    "id": "2.3",
    "title": "Ensure that the --auto-tls argument is not set to true",
    "assessment": "Automated",
    "description": "Do\tnot\tuse\tself-signed\tcertificates\tfor\tTLS.",
    "rationale": "etcd\tis\ta\thighly-available\tkey\tvalue\tstore\tused\tby\tKubernetes\tdeployments\tfor\tpersistent storage\tof\tall\tof\tits\tREST\tAPI\tobjects.\tThese\tobjects\tare\tsensitive\tin\tnature\tand\tshould\tnot be\tavailable\tto\tunauthenticated\tclients.\tYou\tshould\tenable\tthe\tclient\tauthentication\tvia valid\tcertificates\tto\tsecure\tthe\taccess\tto\tthe\tetcd\tservice. Impact: Clients\twill\tnot\tbe\table\tto\tuse\tself-signed\tcertificates\tfor\tTLS.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tetcd\tserver\tnode: ps -ef | grep etcd Verify\tthat\tif\tthe\t--auto-tls\targument\texists,\tit\tis\tnot\tset\tto\ttrue.",
    "remediation": "Edit\tthe\tetcd\tpod\tspecification\tfile\t/etc/kubernetes/manifests/etcd.yaml\ton\tthe\tmaster node\tand\teither\tremove\tthe\t--auto-tls\tparameter\tor\tset\tit\tto\tfalse. --auto-tls=false Default\tValue: By\tdefault,\t--auto-tls\tis\tset\tto\tfalse. References: 1. https://coreos.com/etcd/docs/latest/op-guide/security.html 2. https://kubernetes.io/docs/admin/etcd/ 3. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#auto-tls 144\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 145\t|\tP a g e",
    "impact": "Clients\twill\tnot\tbe\table\tto\tuse\tself-signed\tcertificates\tfor\tTLS.",
    "references": "1. https://coreos.com/etcd/docs/latest/op-guide/security.html 2. https://kubernetes.io/docs/admin/etcd/ 3. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#auto-tls 144\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 145\t|\tP a g e",
    "function_names": [
      "cloud_cdn_domain_auto_tls_disabled",
      "cloud_cdn_certificate_self_signed_disabled",
      "cloud_cdn_tls_auto_renewal_disabled",
      "cloud_cdn_tls_custom_certificate_required",
      "cloud_cdn_tls_managed_certificate_disabled"
    ]
  },
  {
    "id": "2.4",
    "title": "Ensure that the --peer-cert-file and --peer-key-file arguments are set as appropriate",
    "assessment": "Automated",
    "description": "etcd\tshould\tbe\tconfigured\tto\tmake\tuse\tof\tTLS\tencryption\tfor\tpeer\tconnections.",
    "rationale": "etcd\tis\ta\thighly-available\tkey\tvalue\tstore\tused\tby\tKubernetes\tdeployments\tfor\tpersistent storage\tof\tall\tof\tits\tREST\tAPI\tobjects.\tThese\tobjects\tare\tsensitive\tin\tnature\tand\tshould\tbe encrypted\tin\ttransit\tand\talso\tamongst\tpeers\tin\tthe\tetcd\tclusters. Impact: etcd\tcluster\tpeers\twould\tneed\tto\tset\tup\tTLS\tfor\ttheir\tcommunication.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tetcd\tserver\tnode: ps -ef | grep etcd Verify\tthat\tthe\t--peer-cert-file\tand\t--peer-key-file\targuments\tare\tset\tas\tappropriate. Note: This\trecommendation\tis\tapplicable\tonly\tfor\tetcd\tclusters.\tIf\tyou\tare\tusing\tonly\tone etcd\tserver\tin\tyour\tenvironment\tthen\tthis\trecommendation\tis\tnot\tapplicable.",
    "remediation": "Follow\tthe\tetcd\tservice\tdocumentation\tand\tconfigure\tpeer\tTLS\tencryption\tas\tappropriate for\tyour\tetcd\tcluster. Then,\tedit\tthe\tetcd\tpod\tspecification\tfile\t/etc/kubernetes/manifests/etcd.yaml\ton\tthe master\tnode\tand\tset\tthe\tbelow\tparameters. --peer-client-file=</path/to/peer-cert-file> --peer-key-file=</path/to/peer-key-file> Default\tValue: Note: This\trecommendation\tis\tapplicable\tonly\tfor\tetcd\tclusters.\tIf\tyou\tare\tusing\tonly\tone etcd\tserver\tin\tyour\tenvironment\tthen\tthis\trecommendation\tis\tnot\tapplicable. 146\t|\tP a g e By\tdefault,\tpeer\tcommunication\tover\tTLS\tis\tnot\tconfigured. References: 1. https://coreos.com/etcd/docs/latest/op-guide/security.html 2. https://kubernetes.io/docs/admin/etcd/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 147\t|\tP a g e",
    "impact": "etcd\tcluster\tpeers\twould\tneed\tto\tset\tup\tTLS\tfor\ttheir\tcommunication.",
    "references": "1. https://coreos.com/etcd/docs/latest/op-guide/security.html 2. https://kubernetes.io/docs/admin/etcd/ Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 147\t|\tP a g e",
    "function_names": [
      "etcd_peer_certificate_file_set",
      "etcd_peer_key_file_set",
      "etcd_peer_tls_encryption_enabled",
      "etcd_peer_connection_secure",
      "etcd_peer_cert_key_files_configured"
    ]
  },
  {
    "id": "2.5",
    "title": "Ensure that the --peer-client-cert-auth argument is set to true",
    "assessment": "Automated",
    "description": "etcd\tshould\tbe\tconfigured\tfor\tpeer\tauthentication.",
    "rationale": "etcd\tis\ta\thighly-available\tkey\tvalue\tstore\tused\tby\tKubernetes\tdeployments\tfor\tpersistent storage\tof\tall\tof\tits\tREST\tAPI\tobjects.\tThese\tobjects\tare\tsensitive\tin\tnature\tand\tshould\tbe accessible\tonly\tby\tauthenticated\tetcd\tpeers\tin\tthe\tetcd\tcluster. Impact: All\tpeers\tattempting\tto\tcommunicate\twith\tthe\tetcd\tserver\twill\trequire\ta\tvalid\tclient certificate\tfor\tauthentication.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tetcd\tserver\tnode: ps -ef | grep etcd Verify\tthat\tthe\t--peer-client-cert-auth\targument\tis\tset\tto\ttrue. Note: This\trecommendation\tis\tapplicable\tonly\tfor\tetcd\tclusters.\tIf\tyou\tare\tusing\tonly\tone etcd\tserver\tin\tyour\tenvironment\tthen\tthis\trecommendation\tis\tnot\tapplicable.",
    "remediation": "Edit\tthe\tetcd\tpod\tspecification\tfile\t/etc/kubernetes/manifests/etcd.yaml\ton\tthe\tmaster node\tand\tset\tthe\tbelow\tparameter. --peer-client-cert-auth=true Default\tValue: Note: This\trecommendation\tis\tapplicable\tonly\tfor\tetcd\tclusters.\tIf\tyou\tare\tusing\tonly\tone etcd\tserver\tin\tyour\tenvironment\tthen\tthis\trecommendation\tis\tnot\tapplicable. By\tdefault,\t--peer-client-cert-auth\targument\tis\tset\tto\tfalse. 148\t|\tP a g e References: 1. https://coreos.com/etcd/docs/latest/op-guide/security.html 2. https://kubernetes.io/docs/admin/etcd/ 3. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#peer-client- cert-auth Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.4\tProtect\tInformation\tWith\tAccess\tControl\tLists All\tinformation\tstored\ton\tsystems\tshall\tbe\tprotected\twith\tfile\tsystem,\tnetwork\tshare, claims,\tapplication,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. Version\t7 14.6\tProtect\tInformation\tthrough\tAccess\tControl\tLists Protect\tall\tinformation\tstored\ton\tsystems\twith\tfile\tsystem,\tnetwork\tshare,\tclaims, application,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. 149\t|\tP a g e",
    "impact": "All\tpeers\tattempting\tto\tcommunicate\twith\tthe\tetcd\tserver\twill\trequire\ta\tvalid\tclient certificate\tfor\tauthentication.",
    "references": "1. https://coreos.com/etcd/docs/latest/op-guide/security.html 2. https://kubernetes.io/docs/admin/etcd/ 3. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#peer-client- cert-auth Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.4\tProtect\tInformation\tWith\tAccess\tControl\tLists All\tinformation\tstored\ton\tsystems\tshall\tbe\tprotected\twith\tfile\tsystem,\tnetwork\tshare, claims,\tapplication,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. Version\t7 14.6\tProtect\tInformation\tthrough\tAccess\tControl\tLists Protect\tall\tinformation\tstored\ton\tsystems\twith\tfile\tsystem,\tnetwork\tshare,\tclaims, application,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. 149\t|\tP a g e",
    "function_names": [
      "etcd_peer_client_cert_auth_enabled",
      "etcd_peer_authentication_required",
      "etcd_peer_cert_authentication_enabled",
      "etcd_peer_tls_authentication_enabled",
      "etcd_peer_client_cert_auth_required"
    ]
  },
  {
    "id": "2.6",
    "title": "Ensure that the --peer-auto-tls argument is not set to true",
    "assessment": "Automated",
    "description": "Do\tnot\tuse\tautomatically\tgenerated\tself-signed\tcertificates\tfor\tTLS\tconnections\tbetween peers.",
    "rationale": "etcd\tis\ta\thighly-available\tkey\tvalue\tstore\tused\tby\tKubernetes\tdeployments\tfor\tpersistent storage\tof\tall\tof\tits\tREST\tAPI\tobjects.\tThese\tobjects\tare\tsensitive\tin\tnature\tand\tshould\tbe accessible\tonly\tby\tauthenticated\tetcd\tpeers\tin\tthe\tetcd\tcluster.\tHence,\tdo\tnot\tuse\tself- signed\tcertificates\tfor\tauthentication. Impact: All\tpeers\tattempting\tto\tcommunicate\twith\tthe\tetcd\tserver\twill\trequire\ta\tvalid\tclient certificate\tfor\tauthentication.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tthe\tetcd\tserver\tnode: ps -ef | grep etcd Verify\tthat\tif\tthe\t--peer-auto-tls\targument\texists,\tit\tis\tnot\tset\tto\ttrue. Note: This\trecommendation\tis\tapplicable\tonly\tfor\tetcd\tclusters.\tIf\tyou\tare\tusing\tonly\tone etcd\tserver\tin\tyour\tenvironment\tthen\tthis\trecommendation\tis\tnot\tapplicable.",
    "remediation": "Edit\tthe\tetcd\tpod\tspecification\tfile\t/etc/kubernetes/manifests/etcd.yaml\ton\tthe\tmaster node\tand\teither\tremove\tthe\t--peer-auto-tls\tparameter\tor\tset\tit\tto\tfalse. --peer-auto-tls=false Default\tValue: 150\t|\tP a g e Note: This\trecommendation\tis\tapplicable\tonly\tfor\tetcd\tclusters.\tIf\tyou\tare\tusing\tonly\tone etcd\tserver\tin\tyour\tenvironment\tthen\tthis\trecommendation\tis\tnot\tapplicable. By\tdefault,\t--peer-auto-tls\targument\tis\tset\tto\tfalse. References: 1. https://coreos.com/etcd/docs/latest/op-guide/security.html 2. https://kubernetes.io/docs/admin/etcd/ 3. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#peer-auto-tls Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 151\t|\tP a g e",
    "impact": "All\tpeers\tattempting\tto\tcommunicate\twith\tthe\tetcd\tserver\twill\trequire\ta\tvalid\tclient certificate\tfor\tauthentication.",
    "references": "1. https://coreos.com/etcd/docs/latest/op-guide/security.html 2. https://kubernetes.io/docs/admin/etcd/ 3. https://coreos.com/etcd/docs/latest/op-guide/configuration.html#peer-auto-tls Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 151\t|\tP a g e",
    "function_names": [
      "compute_peer_auto_tls_disabled",
      "compute_peer_tls_self_signed_disabled",
      "compute_peer_tls_manual_cert_required",
      "compute_peer_connection_tls_configured",
      "compute_peer_auto_tls_not_true"
    ]
  },
  {
    "id": "2.7",
    "title": "Ensure that a unique Certificate Authority is used for etcd",
    "assessment": "Manual",
    "description": "Kubernetes\tcan\taudit\tthe\tdetails\tof\trequests\tmade\tto\tthe\tAPI\tserver.\tThe\t--audit-policy- file\tflag\tmust\tbe\tset\tfor\tthis\tlogging\tto\tbe\tenabled.",
    "rationale": "Logging\tis\tan\timportant\tdetective\tcontrol\tfor\tall\tsystems,\tto\tdetect\tpotential\tunauthorised access. Impact: Audit\tlogs\twill\tbe\tcreated\ton\tthe\tmaster\tnodes,\twhich\twill\tconsume\tdisk\tspace.\tCare\tshould be\ttaken\tto\tavoid\tgenerating\ttoo\tlarge\tvolumes\tof\tlog\tinformation\tas\tthis\tcould\timpact\tthe available\tof\tthe\tcluster\tnodes.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\tone\tof\tthe\tcluster\tmaster\tnodes: ps -ef | grep kube-apiserver Verify\tthat\tthe\t--audit-policy-file\tis\tset.\tReview\tthe\tcontents\tof\tthe\tfile\tspecified\tand ensure\tthat\tit\tcontains\ta\tvalid\taudit\tpolicy.",
    "remediation": "Create\tan\taudit\tpolicy\tfile\tfor\tyour\tcluster. Default\tValue: Unless\tthe\t--audit-policy-file\tflag\tis\tspecified,\tno\tauditing\twill\tbe\tcarried\tout. References: 1. https://kubernetes.io/docs/tasks/debug-application-cluster/audit/ 2. https://www.alibabacloud.com/help/doc-detail/91406.htm 156\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t7 6.2\tActivate\taudit\tlogging Ensure\tthat\tlocal\tlogging\thas\tbeen\tenabled\ton\tall\tsystems\tand\tnetworking\tdevices. 157\t|\tP a g e",
    "impact": "Audit\tlogs\twill\tbe\tcreated\ton\tthe\tmaster\tnodes,\twhich\twill\tconsume\tdisk\tspace.\tCare\tshould be\ttaken\tto\tavoid\tgenerating\ttoo\tlarge\tvolumes\tof\tlog\tinformation\tas\tthis\tcould\timpact\tthe available\tof\tthe\tcluster\tnodes.",
    "references": "1. https://kubernetes.io/docs/tasks/debug-application-cluster/audit/ 2. https://www.alibabacloud.com/help/doc-detail/91406.htm 156\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t7 6.2\tActivate\taudit\tlogging Ensure\tthat\tlocal\tlogging\thas\tbeen\tenabled\ton\tall\tsystems\tand\tnetworking\tdevices. 157\t|\tP a g e",
    "function_names": [
      "kubernetes_etcd_unique_certificate_authority",
      "kubernetes_etcd_unique_ca",
      "kubernetes_etcd_ca_uniqueness",
      "kubernetes_etcd_ca_distinct",
      "kubernetes_etcd_ca_single_source"
    ]
  },
  {
    "id": "3.2.2",
    "title": "Ensure that the audit policy covers key security concerns",
    "assessment": "Manual",
    "description": "Ensure\tthat\tthe\taudit\tpolicy\tcreated\tfor\tthe\tcluster\tcovers\tkey\tsecurity\tconcerns.",
    "rationale": "Security\taudit\tlogs\tshould\tcover\taccess\tand\tmodification\tof\tkey\tresources\tin\tthe\tcluster,\tto enable\tthem\tto\tform\tan\teffective\tpart\tof\ta\tsecurity\tenvironment. Impact: Increasing\taudit\tlogging\twill\tconsume\tresources\ton\tthe\tnodes\tor\tother\tlog\tdestination.",
    "audit": "Review\tthe\taudit\tpolicy\tprovided\tfor\tthe\tcluster\tand\tensure\tthat\tit\tcovers\tat\tleast\tthe following\tareas\t:- • Access\tto\tSecrets\tmanaged\tby\tthe\tcluster.\tCare\tshould\tbe\ttaken\tto\tonly\tlog\tMetadata for\trequests\tto\tSecrets,\tConfigMaps,\tand\tTokenReviews,\tin\torder\tto\tavoid\tthe\trisk\tof logging\tsensitive\tdata. • Modification\tof\tpod\tand\tdeployment\tobjects. • Use\tof\tpods/exec,\tpods/portforward,\tpods/proxy\tand\tservices/proxy. For\tmost\trequests,\tminimally\tlogging\tat\tthe\tMetadata\tlevel\tis\trecommended\t(the\tmost\tbasic level\tof\tlogging).",
    "remediation": "Consider\tmodification\tof\tthe\taudit\tpolicy\tin\tuse\ton\tthe\tcluster\tto\tinclude\tthese\titems,\tat\ta minimum. Default\tValue: By\tdefault\tKubernetes\tclusters\tdo\tnot\tlog\taudit\tinformation. References: 158\t|\tP a g e 1. https://github.com/k8scop/k8s-security- dashboard/blob/master/configs/kubernetes/adv-audit.yaml 2. https://kubernetes.io/docs/tasks/debug-application-cluster/audit/#audit-policy 3. https://github.com/falcosecurity/falco/blob/master/examples/k8s_audit_config/a udit-policy.yaml 4. https://github.com/kubernetes/kubernetes/blob/master/cluster/gce/gci/configur e-helper.sh#L735 5. https://www.alibabacloud.com/help/doc-detail/91406.htm Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.6\tEnforce\tDetailed\tAudit\tLogging\tFor\tSensitive\tInformation Enforce\tdetailed\taudit\tlogging\tfor\taccess\tto\tnonpublic\tdata\tand\tspecial\tauthentication\tfor sensitive\tdata. Version\t7 14.9\tEnforce\tDetail\tLogging\tfor\tAccess\tor\tChanges\tto\tSensitive\tData Enforce\tdetailed\taudit\tlogging\tfor\taccess\tto\tsensitive\tdata\tor\tchanges\tto\tsensitive\tdata (utilizing\ttools\tsuch\tas\tFile\tIntegrity\tMonitoring\tor\tSecurity\tInformation\tand\tEvent Monitoring). 4 Worker Nodes This\tsection\tconsists\tof\tsecurity\trecommendations\tfor\tthe\tcomponents\tthat\trun\ton Kubernetes\tworker\tnodes. Note\tthat\tthese\tcomponents\tmay\talso\trun\ton\tKubernetes\tmaster\tnodes,\tso\tthe recommendations\tin\tthis\tsection\tshould\tbe\tapplied\tto\tmaster\tnodes\tas\twell\tas\tworker nodes\twhere\tthe\tmaster\tnodes\tmake\tuse\tof\tthese\tcomponents. 159\t|\tP a g e 4.1 Worker Node Configuration Files This\tsection\tcovers\trecommendations\tfor\tconfiguration\tfiles\ton\tthe\tworker\tnodes. To\tPerform\tan\tAutomated\tAudit\tutilizing\tCIS-CAT\tthe\tfollowing\tparameters\tmust\tbe\tset\ton each\tnode\tbeing\tevaluated. $kubelet_service_config $kubelet_config $kubelet_config_yaml If\tyou\tare\tauditing\ta\tkubeadm\tenvironment\tthe\tdefault\tsettings\tfor\tthese\tvalues\tare\tbelow: export kubelet_service_config=/etc/systemd/system/kubelet.service.d/10- kubeadm.conf export kubelet_config=/etc/kubernetes/kubelet.conf export kubelet_config_yaml=/var/lib/kubelet/config.yaml",
    "impact": "Increasing\taudit\tlogging\twill\tconsume\tresources\ton\tthe\tnodes\tor\tother\tlog\tdestination.",
    "references": "158\t|\tP a g e 1. https://github.com/k8scop/k8s-security- dashboard/blob/master/configs/kubernetes/adv-audit.yaml 2. https://kubernetes.io/docs/tasks/debug-application-cluster/audit/#audit-policy 3. https://github.com/falcosecurity/falco/blob/master/examples/k8s_audit_config/a udit-policy.yaml 4. https://github.com/kubernetes/kubernetes/blob/master/cluster/gce/gci/configur e-helper.sh#L735 5. https://www.alibabacloud.com/help/doc-detail/91406.htm Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 14.6\tEnforce\tDetailed\tAudit\tLogging\tFor\tSensitive\tInformation Enforce\tdetailed\taudit\tlogging\tfor\taccess\tto\tnonpublic\tdata\tand\tspecial\tauthentication\tfor sensitive\tdata. Version\t7 14.9\tEnforce\tDetail\tLogging\tfor\tAccess\tor\tChanges\tto\tSensitive\tData Enforce\tdetailed\taudit\tlogging\tfor\taccess\tto\tsensitive\tdata\tor\tchanges\tto\tsensitive\tdata (utilizing\ttools\tsuch\tas\tFile\tIntegrity\tMonitoring\tor\tSecurity\tInformation\tand\tEvent Monitoring). 4 Worker Nodes This\tsection\tconsists\tof\tsecurity\trecommendations\tfor\tthe\tcomponents\tthat\trun\ton Kubernetes\tworker\tnodes. Note\tthat\tthese\tcomponents\tmay\talso\trun\ton\tKubernetes\tmaster\tnodes,\tso\tthe recommendations\tin\tthis\tsection\tshould\tbe\tapplied\tto\tmaster\tnodes\tas\twell\tas\tworker nodes\twhere\tthe\tmaster\tnodes\tmake\tuse\tof\tthese\tcomponents. 159\t|\tP a g e 4.1 Worker Node Configuration Files This\tsection\tcovers\trecommendations\tfor\tconfiguration\tfiles\ton\tthe\tworker\tnodes. To\tPerform\tan\tAutomated\tAudit\tutilizing\tCIS-CAT\tthe\tfollowing\tparameters\tmust\tbe\tset\ton each\tnode\tbeing\tevaluated. $kubelet_service_config $kubelet_config $kubelet_config_yaml If\tyou\tare\tauditing\ta\tkubeadm\tenvironment\tthe\tdefault\tsettings\tfor\tthese\tvalues\tare\tbelow: export kubelet_service_config=/etc/systemd/system/kubelet.service.d/10- kubeadm.conf export kubelet_config=/etc/kubernetes/kubelet.conf export kubelet_config_yaml=/var/lib/kubelet/config.yaml",
    "function_names": [
      "kubernetes_audit_policy_security_concerns_covered",
      "kubernetes_audit_policy_key_events_logged",
      "kubernetes_audit_policy_minimum_requirements_met",
      "kubernetes_audit_policy_sensitive_actions_included",
      "kubernetes_audit_policy_comprehensive_coverage_enabled"
    ]
  },
  {
    "id": "4.1.1",
    "title": "Ensure that the kubelet service file permissions are set to 644 or more restrictive",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tkubelet\tservice\tfile\thas\tpermissions\tof\t644\tor\tmore\trestrictive.",
    "rationale": "The\tkubelet\tservice\tfile\tcontrols\tvarious\tparameters\tthat\tset\tthe\tbehavior\tof\tthe\tkubelet service\tin\tthe\tworker\tnode.\tYou\tshould\trestrict\tits\tfile\tpermissions\tto\tmaintain\tthe\tintegrity of\tthe\tfile.\tThe\tfile\tshould\tbe\twritable\tby\tonly\tthe\tadministrators\ton\tthe\tsystem. Impact: None",
    "audit": "160\t|\tP a g e Automated\tAAC\tauditing\thas\tbeen\tmodified\tto\tallow\tCIS-CAT\tto\tinput\ta\tvariable\tfor\tthe\t/\tof the\tkubelet\tservice\tconfig\tfile. Please\tset\t$kubelet_service_config=\tbased\ton\tthe\tfile\tlocation\ton\tyour\tsystem for\texample: export kubelet_service_config=/etc/systemd/system/kubelet.service.d/10- kubeadm.conf To\tperform\tthe\taudit\tmanually: Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, stat -c %a /etc/systemd/system/kubelet.service.d/10-kubeadm.conf Verify\tthat\tthe\tpermissions\tare\t644\tor\tmore\trestrictive.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, chmod 755 /etc/systemd/system/kubelet.service.d/10-kubeadm.conf Default\tValue: By\tdefault,\tthe\tkubelet\tservice\tfile\thas\tpermissions\tof\t640. References: 1. https://kubernetes.io/docs/admin/kubelet/ 2. https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/#44- joining-your-nodes 3. https://kubernetes.io/docs/admin/kubeadm/#kubelet-drop-in CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 161\t|\tP a g e 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 162\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kubelet/ 2. https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/#44- joining-your-nodes 3. https://kubernetes.io/docs/admin/kubeadm/#kubelet-drop-in CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 161\t|\tP a g e 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 162\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_service_file_permissions_644_or_restrictive",
      "kubernetes_kubelet_service_file_permissions_restrictive",
      "kubernetes_kubelet_service_file_permissions_secure",
      "kubernetes_kubelet_service_file_permissions_compliant",
      "kubernetes_kubelet_service_file_permissions_protected"
    ]
  },
  {
    "id": "4.1.2",
    "title": "Ensure that the kubelet service file ownership is set to root:root",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tkubelet\tservice\tfile\townership\tis\tset\tto\troot:root.",
    "rationale": "The\tkubelet\tservice\tfile\tcontrols\tvarious\tparameters\tthat\tset\tthe\tbehavior\tof\tthe\tkubelet service\tin\tthe\tworker\tnode.\tYou\tshould\tset\tits\tfile\townership\tto\tmaintain\tthe\tintegrity\tof\tthe file.\tThe\tfile\tshould\tbe\towned\tby\troot:root. Impact: None",
    "audit": "Automated\tAAC\tauditing\thas\tbeen\tmodified\tto\tallow\tCIS-CAT\tto\tinput\ta\tvariable\tfor\tthe\t/\tof the\tkubelet\tservice\tconfig\tfile. Please\tset\t$kubelet_service_config=\tbased\ton\tthe\tfile\tlocation\ton\tyour\tsystem for\texample: export kubelet_service_config=/etc/systemd/system/kubelet.service.d/10- kubeadm.conf To\tperform\tthe\taudit\tmanually: Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, stat -c %a /etc/systemd/system/kubelet.service.d/10-kubeadm.conf Verify\tthat\tthe\townership\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, 163\t|\tP a g e chown root:root /etc/systemd/system/kubelet.service.d/10-kubeadm.conf Default\tValue: By\tdefault,\tkubelet\tservice\tfile\townership\tis\tset\tto\troot:root. References: 1. https://kubernetes.io/docs/admin/kubelet/ 2. https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/#44- joining-your-nodes 3. https://kubernetes.io/docs/admin/kubeadm/#kubelet-drop-in CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 164\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kubelet/ 2. https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/#44- joining-your-nodes 3. https://kubernetes.io/docs/admin/kubeadm/#kubelet-drop-in CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 164\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_service_file_ownership_root",
      "kubernetes_kubelet_service_file_owner_root",
      "kubernetes_kubelet_file_ownership_root_root",
      "kubernetes_service_file_ownership_root",
      "kubernetes_kubelet_config_file_ownership_root_root"
    ]
  },
  {
    "id": "4.1.3",
    "title": "If proxy kubeconfig file exists ensure permissions are set to 644 or more restrictive",
    "assessment": "Manual",
    "description": "If\tkube-proxy\tis\trunning,\tand\tif\tit\tis\tusing\ta\tfile-based\tkubeconfig\tfile,\tensure\tthat\tthe\tproxy kubeconfig\tfile\thas\tpermissions\tof\t644\tor\tmore\trestrictive.",
    "rationale": "The\tkube-proxy\tkubeconfig\tfile\tcontrols\tvarious\tparameters\tof\tthe\tkube-proxy\tservice\tin the\tworker\tnode.\tYou\tshould\trestrict\tits\tfile\tpermissions\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile. The\tfile\tshould\tbe\twritable\tby\tonly\tthe\tadministrators\ton\tthe\tsystem. It\tis\tpossible\tto\trun\tkube-proxy\twith\tthe\tkubeconfig\tparameters\tconfigured\tas\ta Kubernetes\tConfigMap\tinstead\tof\ta\tfile.\tIn\tthis\tcase,\tthere\tis\tno\tproxy\tkubeconfig\tfile. Impact: None",
    "audit": "Find\tthe\tkubeconfig\tfile\tbeing\tused\tby\tkube-proxy\tby\trunning\tthe\tfollowing\tcommand: ps -ef | grep kube-proxy If\tkube-proxy\tis\trunning,\tget\tthe\tkubeconfig\tfile\tlocation\tfrom\tthe\t--kubeconfig\tparameter. To\tperform\tthe\taudit: Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, stat -c %a <path><filename> Verify\tthat\ta\tfile\tis\tspecified\tand\tit\texists\twith\tpermissions\tare\t644\tor\tmore\trestrictive.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, 165\t|\tP a g e chmod 644 <proxy kubeconfig file> Default\tValue: By\tdefault,\tproxy\tfile\thas\tpermissions\tof\t640. References: 1. https://kubernetes.io/docs/admin/kube-proxy/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 166\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-proxy/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 166\t|\tP a g e"
  },
  {
    "id": "4.1.4",
    "title": "If proxy kubeconfig file exists ensure ownership is set to root:root",
    "assessment": "Manual",
    "description": "If\tkube-proxy\tis\trunning,\tensure\tthat\tthe\tfile\townership\tof\tits\tkubeconfig\tfile\tis\tset\tto root:root.",
    "rationale": "The\tkubeconfig\tfile\tfor\tkube-proxy\tcontrols\tvarious\tparameters\tfor\tthe\tkube-proxy\tservice in\tthe\tworker\tnode.\tYou\tshould\tset\tits\tfile\townership\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile. The\tfile\tshould\tbe\towned\tby\troot:root. Impact: None",
    "audit": "Find\tthe\tkubeconfig\tfile\tbeing\tused\tby\tkube-proxy\tby\trunning\tthe\tfollowing\tcommand: ps -ef | grep kube-proxy If\tkube-proxy\tis\trunning,\tget\tthe\tkubeconfig\tfile\tlocation\tfrom\tthe\t--kubeconfig\tparameter. To\tperform\tthe\taudit: Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, stat -c %U:%G <path><filename> Verify\tthat\tthe\townership\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, chown root:root <proxy kubeconfig file> 167\t|\tP a g e Default\tValue: By\tdefault,\tproxy\tfile\townership\tis\tset\tto\troot:root. References: 1. https://kubernetes.io/docs/admin/kube-proxy/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 168\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kube-proxy/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 168\t|\tP a g e",
    "function_names": [
      "kubernetes_proxy_kubeconfig_root_ownership",
      "kubernetes_proxy_kubeconfig_file_secure_ownership",
      "kubernetes_kubeconfig_root_owner",
      "kubernetes_proxy_config_file_root_owned",
      "kubernetes_kubeconfig_ownership_restricted"
    ]
  },
  {
    "id": "4.1.5",
    "title": "Ensure that the --kubeconfig kubelet.conf file permissions are set to 644 or more restrictive",
    "assessment": "Automated",
    "description": "Ensure\tthat\tthe\tkubelet.conf\tfile\thas\tpermissions\tof\t644\tor\tmore\trestrictive.",
    "rationale": "The\tkubelet.conf\tfile\tis\tthe\tkubeconfig\tfile\tfor\tthe\tnode,\tand\tcontrols\tvarious\tparameters that\tset\tthe\tbehavior\tand\tidentity\tof\tthe\tworker\tnode.\tYou\tshould\trestrict\tits\tfile permissions\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\twritable\tby\tonly\tthe administrators\ton\tthe\tsystem. Impact: None",
    "audit": "Automated\tAAC\tauditing\thas\tbeen\tmodified\tto\tallow\tCIS-CAT\tto\tinput\ta\tvariable\tfor\tthe\t/\tof the\tkubelet\tconfig\tfile. Please\tset\t$kubelet_config=\tbased\ton\tthe\tfile\tlocation\ton\tyour\tsystem for\texample: export kubelet_config=/etc/kubernetes/kubelet.conf To\tperform\tthe\taudit\tmanually: Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, stat -c %a /etc/kubernetes/kubelet.conf Verify\tthat\tthe\tpermissions\tare\t644\tor\tmore\trestrictive.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, 169\t|\tP a g e chmod 644 /etc/kubernetes/kubelet.conf Default\tValue: By\tdefault,\tkubelet.conf\tfile\thas\tpermissions\tof\t640. References: 1. https://kubernetes.io/docs/admin/kubelet/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 170\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kubelet/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 170\t|\tP a g e",
    "function_names": [
      "kubernetes_kubeconfig_file_permissions_restrictive",
      "kubernetes_kubelet_conf_file_permissions_644",
      "kubernetes_config_file_permissions_secure",
      "kubernetes_kubelet_conf_file_permissions_restricted",
      "kubernetes_kubeconfig_file_permissions_644_or_stricter"
    ]
  },
  {
    "id": "4.1.6",
    "title": "Ensure that the --kubeconfig kubelet.conf file ownership is set to root:root",
    "assessment": "Manual",
    "description": "Ensure\tthat\tthe\tkubelet.conf\tfile\townership\tis\tset\tto\troot:root.",
    "rationale": "The\tkubelet.conf\tfile\tis\tthe\tkubeconfig\tfile\tfor\tthe\tnode,\tand\tcontrols\tvarious\tparameters that\tset\tthe\tbehavior\tand\tidentity\tof\tthe\tworker\tnode.\tYou\tshould\tset\tits\tfile\townership\tto maintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\towned\tby\troot:root. Impact: None",
    "audit": "Automated\tAAC\tauditing\thas\tbeen\tmodified\tto\tallow\tCIS-CAT\tto\tinput\ta\tvariable\tfor\tthe\t/\tof the\tkubelet\tconfig\tfile. Please\tset\t$kubelet_config=\tbased\ton\tthe\tfile\tlocation\ton\tyour\tsystem for\texample: export kubelet_config=/etc/kubernetes/kubelet.conf To\tperform\tthe\taudit\tmanually: Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, stat -c %U:%G /etc/kubernetes/kubelet.conf Verify\tthat\tthe\townership\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, chown root:root /etc/kubernetes/kubelet.conf 171\t|\tP a g e Default\tValue: By\tdefault,\tkubelet.conf\tfile\townership\tis\tset\tto\troot:root. References: 1. https://kubernetes.io/docs/admin/kubelet/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 172\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/admin/kubelet/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 172\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_conf_file_ownership_root",
      "kubernetes_kubeconfig_file_ownership_root",
      "kubernetes_kubelet_conf_root_ownership",
      "kubernetes_kubeconfig_root_ownership",
      "kubernetes_kubelet_conf_file_root_owner",
      "kubernetes_kubeconfig_file_root_owner"
    ]
  },
  {
    "id": "4.1.7",
    "title": "Ensure that the certificate authorities file permissions are set to 644 or more restrictive",
    "assessment": "Manual",
    "description": "Ensure\tthat\tthe\tcertificate\tauthorities\tfile\thas\tpermissions\tof\t644\tor\tmore\trestrictive.",
    "rationale": "The\tcertificate\tauthorities\tfile\tcontrols\tthe\tauthorities\tused\tto\tvalidate\tAPI\trequests.\tYou should\trestrict\tits\tfile\tpermissions\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe writable\tby\tonly\tthe\tadministrators\ton\tthe\tsystem. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand: ps -ef | grep kubelet Find\tthe\tfile\tspecified\tby\tthe\t--client-ca-file\targument. Run\tthe\tfollowing\tcommand: stat -c %a <filename> Verify\tthat\tthe\tpermissions\tare\t644\tor\tmore\trestrictive.",
    "remediation": "Run\tthe\tfollowing\tcommand\tto\tmodify\tthe\tfile\tpermissions\tof\tthe\t--client-ca-file chmod 644 <filename> Default\tValue: By\tdefault\tno\t--client-ca-file\tis\tspecified. References: 173\t|\tP a g e 1. https://kubernetes.io/docs/admin/authentication/#x509-client-certs CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. 14.4\tProtect\tInformation\tWith\tAccess\tControl\tLists All\tinformation\tstored\ton\tsystems\tshall\tbe\tprotected\twith\tfile\tsystem,\tnetwork\tshare, claims,\tapplication,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. Version\t7 14.6\tProtect\tInformation\tthrough\tAccess\tControl\tLists Protect\tall\tinformation\tstored\ton\tsystems\twith\tfile\tsystem,\tnetwork\tshare,\tclaims, application,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. 174\t|\tP a g e",
    "impact": "None",
    "references": "173\t|\tP a g e 1. https://kubernetes.io/docs/admin/authentication/#x509-client-certs CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. 14.4\tProtect\tInformation\tWith\tAccess\tControl\tLists All\tinformation\tstored\ton\tsystems\tshall\tbe\tprotected\twith\tfile\tsystem,\tnetwork\tshare, claims,\tapplication,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. Version\t7 14.6\tProtect\tInformation\tthrough\tAccess\tControl\tLists Protect\tall\tinformation\tstored\ton\tsystems\twith\tfile\tsystem,\tnetwork\tshare,\tclaims, application,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. 174\t|\tP a g e",
    "function_names": [
      "compute_certificate_authorities_file_permissions_644_or_restrictive",
      "compute_ca_file_permissions_644_or_restrictive",
      "compute_certificate_authorities_file_permissions_restrictive",
      "compute_ca_file_permissions_restrictive",
      "compute_certificate_authorities_file_permissions_secure",
      "compute_ca_file_permissions_secure"
    ]
  },
  {
    "id": "4.1.8",
    "title": "Ensure that the client certificate authorities file ownership is set to root:root",
    "assessment": "Manual",
    "description": "Ensure\tthat\tthe\tcertificate\tauthorities\tfile\townership\tis\tset\tto\troot:root.",
    "rationale": "The\tcertificate\tauthorities\tfile\tcontrols\tthe\tauthorities\tused\tto\tvalidate\tAPI\trequests.\tYou should\tset\tits\tfile\townership\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\towned by\troot:root. Impact: None",
    "audit": "Run\tthe\tfollowing\tcommand: ps -ef | grep kubelet Find\tthe\tfile\tspecified\tby\tthe\t--client-ca-file\targument. Run\tthe\tfollowing\tcommand: stat -c %U:%G <filename> Verify\tthat\tthe\townership\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tfollowing\tcommand\tto\tmodify\tthe\townership\tof\tthe\t--client-ca-file. chown root:root <filename> Default\tValue: By\tdefault\tno\t--client-ca-file\tis\tspecified. References: 175\t|\tP a g e 1. https://kubernetes.io/docs/admin/authentication/#x509-client-certs CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 176\t|\tP a g e",
    "impact": "None",
    "references": "175\t|\tP a g e 1. https://kubernetes.io/docs/admin/authentication/#x509-client-certs CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 176\t|\tP a g e",
    "function_names": [
      "compute_client_certificate_authorities_file_ownership_root",
      "compute_client_certificate_authorities_file_ownership_root_root",
      "compute_certificate_authorities_file_ownership_root",
      "compute_certificate_authorities_file_ownership_root_root",
      "client_certificate_authorities_file_ownership_root",
      "client_certificate_authorities_file_ownership_root_root",
      "certificate_authorities_file_ownership_root",
      "certificate_authorities_file_ownership_root_root"
    ]
  },
  {
    "id": "4.1.9",
    "title": "Ensure that the kubelet --config configuration file has permissions set to 644 or more restrictive",
    "assessment": "Automated",
    "description": "Ensure\tthat\tif\tthe\tkubelet\trefers\tto\ta\tconfiguration\tfile\twith\tthe\t--config\targument,\tthat\tfile has\tpermissions\tof\t644\tor\tmore\trestrictive.",
    "rationale": "The\tkubelet\treads\tvarious\tparameters,\tincluding\tsecurity\tsettings,\tfrom\ta\tconfig\tfile specified\tby\tthe\t--config\targument.\tIf\tthis\tfile\tis\tspecified\tyou\tshould\trestrict\tits\tfile permissions\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\twritable\tby\tonly\tthe administrators\ton\tthe\tsystem. Impact: None",
    "audit": "Automated\tAAC\tauditing\thas\tbeen\tmodified\tto\tallow\tCIS-CAT\tto\tinput\ta\tvariable\tfor\tthe\t/\tof the\tkubelet\tconfig\tyaml\tfile. Please\tset\t$kubelet_config_yaml=\tbased\ton\tthe\tfile\tlocation\ton\tyour\tsystem for\texample: export kubelet_config_yaml=/var/lib/kubelet/config.yaml To\tperform\tthe\taudit\tmanually: Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, stat -c %a /var/lib/kubelet/config.yaml Verify\tthat\tthe\tpermissions\tare\t644\tor\tmore\trestrictive.",
    "remediation": "Run\tthe\tfollowing\tcommand\t(using\tthe\tconfig\tfile\tlocation\tidentied\tin\tthe\tAudit\tstep) 177\t|\tP a g e chmod 644 /var/lib/kubelet/config.yaml Default\tValue: By\tdefault,\tthe\t/var/lib/kubelet/config.yaml\tfile\tas\tset\tup\tby\tkubeadm\thas\tpermissions\tof 644. References: 1. https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 178\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 178\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_config_file_permissions_644_or_restrictive",
      "kubernetes_kubelet_config_file_permissions_secure",
      "kubernetes_kubelet_config_file_permissions_compliant",
      "kubernetes_kubelet_config_file_permissions_protected",
      "kubernetes_kubelet_config_file_permissions_enforced"
    ]
  },
  {
    "id": "4.1.10",
    "title": "Ensure that the kubelet --config configuration file ownership is set to root:root",
    "assessment": "Automated",
    "description": "Ensure\tthat\tif\tthe\tkubelet\trefers\tto\ta\tconfiguration\tfile\twith\tthe\t--config\targument,\tthat\tfile is\towned\tby\troot:root.",
    "rationale": "The\tkubelet\treads\tvarious\tparameters,\tincluding\tsecurity\tsettings,\tfrom\ta\tconfig\tfile specified\tby\tthe\t--config\targument.\tIf\tthis\tfile\tis\tspecified\tyou\tshould\trestrict\tits\tfile permissions\tto\tmaintain\tthe\tintegrity\tof\tthe\tfile.\tThe\tfile\tshould\tbe\towned\tby\troot:root. Impact: None",
    "audit": "Automated\tAAC\tauditing\thas\tbeen\tmodified\tto\tallow\tCIS-CAT\tto\tinput\ta\tvariable\tfor\tthe\t/\tof the\tkubelet\tconfig\tyaml\tfile. Please\tset\t$kubelet_config_yaml=\tbased\ton\tthe\tfile\tlocation\ton\tyour\tsystem for\texample: export kubelet_config_yaml=/var/lib/kubelet/config.yaml To\tperform\tthe\taudit\tmanually: Run\tthe\tbelow\tcommand\t(based\ton\tthe\tfile\tlocation\ton\tyour\tsystem)\ton\tthe\teach\tworker node.\tFor\texample, stat -c %U:%G /var/lib/kubelet/config.yaml Verify\tthat\tthe\townership\tis\tset\tto\troot:root.",
    "remediation": "Run\tthe\tfollowing\tcommand\t(using\tthe\tconfig\tfile\tlocation\tidentied\tin\tthe\tAudit\tstep) chown root:root /etc/kubernetes/kubelet.conf 179\t|\tP a g e Default\tValue: By\tdefault,\t/var/lib/kubelet/config.yaml\tfile\tas\tset\tup\tby\tkubeadm\tis\towned\tby root:root. References: 1. https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 180\t|\tP a g e 4.2 Kubelet This\tsection\tcontains\trecommendations\tfor\tkubelet\tconfiguration. Kubelet\tsettings\tmay\tbe\tconfigured\tusing\targuments\ton\tthe\trunning\tkubelet\texecutable,\tor they\tmay\tbe\ttaken\tfrom\ta\tKubelet\tconfig\tfile.\tIf\tboth\tare\tspecified,\tthe\texecutable\targument takes\tprecedence. To\tfind\tthe\tKubelet\tconfig\tfile,\trun\tthe\tfollowing\tcommand: ps -ef | grep kubelet | grep config If\tthe\t--config\targument\tis\tpresent,\tthis\tgives\tthe\tlocation\tof\tthe\tKubelet\tconfig\tfile.\tThis config\tfile\tcould\tbe\tin\tJSON\tor\tYAML\tformat\tdepending\ton\tyour\tdistribution.",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 180\t|\tP a g e 4.2 Kubelet This\tsection\tcontains\trecommendations\tfor\tkubelet\tconfiguration. Kubelet\tsettings\tmay\tbe\tconfigured\tusing\targuments\ton\tthe\trunning\tkubelet\texecutable,\tor they\tmay\tbe\ttaken\tfrom\ta\tKubelet\tconfig\tfile.\tIf\tboth\tare\tspecified,\tthe\texecutable\targument takes\tprecedence. To\tfind\tthe\tKubelet\tconfig\tfile,\trun\tthe\tfollowing\tcommand: ps -ef | grep kubelet | grep config If\tthe\t--config\targument\tis\tpresent,\tthis\tgives\tthe\tlocation\tof\tthe\tKubelet\tconfig\tfile.\tThis config\tfile\tcould\tbe\tin\tJSON\tor\tYAML\tformat\tdepending\ton\tyour\tdistribution.",
    "function_names": [
      "kubernetes_kubelet_config_file_owned_by_root",
      "kubernetes_kubelet_config_file_root_ownership",
      "kubernetes_kubelet_config_root_ownership",
      "kubernetes_kubelet_config_file_root_owner",
      "kubernetes_kubelet_config_secure_ownership"
    ]
  },
  {
    "id": "4.2.1",
    "title": "Ensure that the --anonymous-auth argument is set to false",
    "assessment": "Automated",
    "description": "Disable\tanonymous\trequests\tto\tthe\tKubelet\tserver.",
    "rationale": "When\tenabled,\trequests\tthat\tare\tnot\trejected\tby\tother\tconfigured\tauthentication\tmethods are\ttreated\tas\tanonymous\trequests.\tThese\trequests\tare\tthen\tserved\tby\tthe\tKubelet\tserver. You\tshould\trely\ton\tauthentication\tto\tauthorize\taccess\tand\tdisallow\tanonymous\trequests. Impact: Anonymous\trequests\twill\tbe\trejected.",
    "audit": "If\tusing\ta\tKubelet\tconfiguration\tfile,\tcheck\tthat\tthere\tis\tan\tentry\tfor\tauthentication: anonymous: enabled\tset\tto\tfalse. Run\tthe\tfollowing\tcommand\ton\teach\tnode: ps -ef | grep kubelet 181\t|\tP a g e Verify\tthat\tthe\t--anonymous-auth\targument\tis\tset\tto\tfalse. This\texecutable\targument\tmay\tbe\tomitted,\tprovided\tthere\tis\ta\tcorresponding\tentry\tset\tto false\tin\tthe\tKubelet\tconfig\tfile.",
    "remediation": "If\tusing\ta\tKubelet\tconfig\tfile,\tedit\tthe\tfile\tto\tset\tauthentication: anonymous: enabled\tto false. If\tusing\texecutable\targuments,\tedit\tthe\tkubelet\tservice\tfile /etc/systemd/system/kubelet.service.d/10-kubeadm.conf\ton\teach\tworker\tnode\tand set\tthe\tbelow\tparameter\tin\tKUBELET_SYSTEM_PODS_ARGS\tvariable. --anonymous-auth=false Based\ton\tyour\tsystem,\trestart\tthe\tkubelet\tservice.\tFor\texample: systemctl daemon-reload systemctl restart kubelet.service Default\tValue: By\tdefault,\tanonymous\taccess\tis\tenabled. References: 1. https://kubernetes.io/docs/admin/kubelet/ 2. https://kubernetes.io/docs/admin/kubelet-authentication-authorization/#kubelet- authentication CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 182\t|\tP a g e",
    "impact": "Anonymous\trequests\twill\tbe\trejected.",
    "references": "1. https://kubernetes.io/docs/admin/kubelet/ 2. https://kubernetes.io/docs/admin/kubelet-authentication-authorization/#kubelet- authentication CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 182\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_anonymous_auth_disabled",
      "kubernetes_kubelet_auth_enabled",
      "kubernetes_kubelet_anonymous_access_blocked",
      "kubernetes_kubelet_secure_auth_required",
      "kubernetes_kubelet_no_anonymous_auth"
    ]
  },
  {
    "id": "4.2.2",
    "title": "Ensure that the --authorization-mode argument is not set to AlwaysAllow",
    "assessment": "Automated",
    "description": "Do\tnot\tallow\tall\trequests.\tEnable\texplicit\tauthorization.",
    "rationale": "Kubelets,\tby\tdefault,\tallow\tall\tauthenticated\trequests\t(even\tanonymous\tones)\twithout needing\texplicit\tauthorization\tchecks\tfrom\tthe\tapiserver.\tYou\tshould\trestrict\tthis\tbehavior and\tonly\tallow\texplicitly\tauthorized\trequests. Impact: Unauthorized\trequests\twill\tbe\tdenied.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\teach\tnode: ps -ef | grep kubelet If\tthe\t--authorization-mode\targument\tis\tpresent\tcheck\tthat\tit\tis\tnot\tset\tto\tAlwaysAllow.\tIf it\tis\tnot\tpresent\tcheck\tthat\tthere\tis\ta\tKubelet\tconfig\tfile\tspecified\tby\t--config,\tand\tthat\tfile sets\tauthorization: mode\tto\tsomething\tother\tthan\tAlwaysAllow. It\tis\talso\tpossible\tto\treview\tthe\trunning\tconfiguration\tof\ta\tKubelet\tvia\tthe\t/configz endpoint\ton\tthe\tKubelet\tAPI\tport\t(typically\t10250/TCP).\tAccessing\tthese\twith\tappropriate credentials\twill\tprovide\tdetails\tof\tthe\tKubelet's\tconfiguration.",
    "remediation": "If\tusing\ta\tKubelet\tconfig\tfile,\tedit\tthe\tfile\tto\tset\tauthorization: mode\tto\tWebhook. If\tusing\texecutable\targuments,\tedit\tthe\tkubelet\tservice\tfile /etc/systemd/system/kubelet.service.d/10-kubeadm.conf\ton\teach\tworker\tnode\tand set\tthe\tbelow\tparameter\tin\tKUBELET_AUTHZ_ARGS\tvariable. --authorization-mode=Webhook Based\ton\tyour\tsystem,\trestart\tthe\tkubelet\tservice.\tFor\texample: 183\t|\tP a g e systemctl daemon-reload systemctl restart kubelet.service Default\tValue: By\tdefault,\t--authorization-mode\targument\tis\tset\tto\tAlwaysAllow. References: 1. https://kubernetes.io/docs/admin/kubelet/ 2. https://kubernetes.io/docs/admin/kubelet-authentication-authorization/#kubelet- authentication CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 184\t|\tP a g e",
    "impact": "Unauthorized\trequests\twill\tbe\tdenied.",
    "references": "1. https://kubernetes.io/docs/admin/kubelet/ 2. https://kubernetes.io/docs/admin/kubelet-authentication-authorization/#kubelet- authentication CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 184\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_authorization_mode_not_always_allow",
      "kubernetes_api_server_explicit_authorization_enabled",
      "kubernetes_api_server_authorization_mode_restricted",
      "kubernetes_api_server_always_allow_disabled",
      "kubernetes_api_server_authorization_mode_secure"
    ]
  },
  {
    "id": "4.2.3",
    "title": "Ensure that the --client-ca-file argument is set as appropriate",
    "assessment": "Automated",
    "description": "Enable\tKubelet\tauthentication\tusing\tcertificates.",
    "rationale": "The\tconnections\tfrom\tthe\tapiserver\tto\tthe\tkubelet\tare\tused\tfor\tfetching\tlogs\tfor\tpods, attaching\t(through\tkubectl)\tto\trunning\tpods,\tand\tusing\tthe\tkubelet’s\tport-forwarding functionality.\tThese\tconnections\tterminate\tat\tthe\tkubelet’s\tHTTPS\tendpoint.\tBy\tdefault,\tthe apiserver\tdoes\tnot\tverify\tthe\tkubelet’s\tserving\tcertificate,\twhich\tmakes\tthe\tconnection subject\tto\tman-in-the-middle\tattacks,\tand\tunsafe\tto\trun\tover\tuntrusted\tand/or\tpublic networks.\tEnabling\tKubelet\tcertificate\tauthentication\tensures\tthat\tthe\tapiserver\tcould authenticate\tthe\tKubelet\tbefore\tsubmitting\tany\trequests. Impact: You\trequire\tTLS\tto\tbe\tconfigured\ton\tapiserver\tas\twell\tas\tkubelets.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\teach\tnode: ps -ef | grep kubelet Verify\tthat\tthe\t--client-ca-file\targument\texists\tand\tis\tset\tto\tthe\tlocation\tof\tthe\tclient certificate\tauthority\tfile. If\tthe\t--client-ca-file\targument\tis\tnot\tpresent,\tcheck\tthat\tthere\tis\ta\tKubelet\tconfig\tfile specified\tby\t--config,\tand\tthat\tthe\tfile\tsets\tauthentication: x509: clientCAFile\tto\tthe location\tof\tthe\tclient\tcertificate\tauthority\tfile.",
    "remediation": "If\tusing\ta\tKubelet\tconfig\tfile,\tedit\tthe\tfile\tto\tset\tauthentication: x509: clientCAFile\tto the\tlocation\tof\tthe\tclient\tCA\tfile. If\tusing\tcommand\tline\targuments,\tedit\tthe\tkubelet\tservice\tfile 185\t|\tP a g e /etc/systemd/system/kubelet.service.d/10-kubeadm.conf\ton\teach\tworker\tnode\tand set\tthe\tbelow\tparameter\tin\tKUBELET_AUTHZ_ARGS\tvariable. --client-ca-file=<path/to/client-ca-file> Based\ton\tyour\tsystem,\trestart\tthe\tkubelet\tservice.\tFor\texample: systemctl daemon-reload systemctl restart kubelet.service Default\tValue: By\tdefault,\t--client-ca-file\targument\tis\tnot\tset. References: 1. https://kubernetes.io/docs/admin/kubelet/ 2. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet- authentication-authorization/ CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 186\t|\tP a g e",
    "impact": "You\trequire\tTLS\tto\tbe\tconfigured\ton\tapiserver\tas\twell\tas\tkubelets.",
    "references": "1. https://kubernetes.io/docs/admin/kubelet/ 2. https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet- authentication-authorization/ CIS\tControls: Version\t6 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 186\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_client_ca_file_set",
      "kubernetes_kubelet_certificate_authentication_enabled",
      "kubernetes_kubelet_client_ca_file_configured",
      "kubernetes_kubelet_authentication_certificates_valid",
      "kubernetes_kubelet_client_ca_file_appropriate"
    ]
  },
  {
    "id": "4.2.4",
    "title": "Verify that the --read-only-port argument is set to 0",
    "assessment": "Manual",
    "description": "Disable\tthe\tread-only\tport.",
    "rationale": "The\tKubelet\tprocess\tprovides\ta\tread-only\tAPI\tin\taddition\tto\tthe\tmain\tKubelet\tAPI. Unauthenticated\taccess\tis\tprovided\tto\tthis\tread-only\tAPI\twhich\tcould\tpossibly\tretrieve potentially\tsensitive\tinformation\tabout\tthe\tcluster. Impact: Removal\tof\tthe\tread-only\tport\twill\trequire\tthat\tany\tservice\twhich\tmade\tuse\tof\tit\twill\tneed to\tbe\tre-configured\tto\tuse\tthe\tmain\tKubelet\tAPI.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\teach\tnode: ps -ef | grep kubelet Verify\tthat\tthe\t--read-only-port\targument\texists\tand\tis\tset\tto\t0. If\tthe\t--read-only-port\targument\tis\tnot\tpresent,\tcheck\tthat\tthere\tis\ta\tKubelet\tconfig\tfile specified\tby\t--config.\tCheck\tthat\tif\tthere\tis\ta\treadOnlyPort\tentry\tin\tthe\tfile,\tit\tis\tset\tto\t0.",
    "remediation": "If\tusing\ta\tKubelet\tconfig\tfile,\tedit\tthe\tfile\tto\tset\treadOnlyPort\tto\t0. If\tusing\tcommand\tline\targuments,\tedit\tthe\tkubelet\tservice\tfile /etc/systemd/system/kubelet.service.d/10-kubeadm.conf\ton\teach\tworker\tnode\tand set\tthe\tbelow\tparameter\tin\tKUBELET_SYSTEM_PODS_ARGS\tvariable. --read-only-port=0 Based\ton\tyour\tsystem,\trestart\tthe\tkubelet\tservice.\tFor\texample: systemctl daemon-reload systemctl restart kubelet.service 187\t|\tP a g e Default\tValue: By\tdefault,\t--read-only-port\tis\tset\tto\t10255/TCP.\tHowever,\tif\ta\tconfig\tfile\tis\tspecified\tby\t-- config\tthe\tdefault\tvalue\tfor\treadOnlyPort\tis\t0. References: 1. https://kubernetes.io/docs/admin/kubelet/ CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 188\t|\tP a g e",
    "impact": "Removal\tof\tthe\tread-only\tport\twill\trequire\tthat\tany\tservice\twhich\tmade\tuse\tof\tit\twill\tneed to\tbe\tre-configured\tto\tuse\tthe\tmain\tKubelet\tAPI.",
    "references": "1. https://kubernetes.io/docs/admin/kubelet/ CIS\tControls: Version\t6 9.1\tLimit\tOpen\tPorts,\tProtocols,\tand\tServices Ensure\tthat\tonly\tports,\tprotocols,\tand\tservices\twith\tvalidated\tbusiness\tneeds\tare\trunning on\teach\tsystem. Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 188\t|\tP a g e",
    "function_names": [
      "kubernetes_api_server_read_only_port_disabled",
      "kubernetes_api_server_read_only_port_set_to_zero",
      "kubernetes_api_server_read_only_port_secure_config",
      "kubernetes_api_server_read_only_port_zero",
      "kubernetes_api_server_read_only_port_unset"
    ]
  },
  {
    "id": "4.2.5",
    "title": "Ensure that the --streaming-connection-idle-timeout argument is not set to 0",
    "assessment": "Manual",
    "description": "Do\tnot\tdisable\ttimeouts\ton\tstreaming\tconnections.",
    "rationale": "Setting\tidle\ttimeouts\tensures\tthat\tyou\tare\tprotected\tagainst\tDenial-of-Service\tattacks, inactive\tconnections\tand\trunning\tout\tof\tephemeral\tports. Note: By\tdefault,\t--streaming-connection-idle-timeout\tis\tset\tto\t4\thours\twhich\tmight\tbe too\thigh\tfor\tyour\tenvironment.\tSetting\tthis\tas\tappropriate\twould\tadditionally\tensure\tthat such\tstreaming\tconnections\tare\ttimed\tout\tafter\tserving\tlegitimate\tuse\tcases. Impact: Long-lived\tconnections\tcould\tbe\tinterrupted.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\teach\tnode: ps -ef | grep kubelet Verify\tthat\tthe\t--streaming-connection-idle-timeout\targument\tis\tnot\tset\tto\t0. If\tthe\targument\tis\tnot\tpresent,\tand\tthere\tis\ta\tKubelet\tconfig\tfile\tspecified\tby\t--config, check\tthat\tit\tdoes\tnot\tset\tstreamingConnectionIdleTimeout\tto\t0.",
    "remediation": "If\tusing\ta\tKubelet\tconfig\tfile,\tedit\tthe\tfile\tto\tset\tstreamingConnectionIdleTimeout\tto\ta value\tother\tthan\t0. If\tusing\tcommand\tline\targuments,\tedit\tthe\tkubelet\tservice\tfile /etc/systemd/system/kubelet.service.d/10-kubeadm.conf\ton\teach\tworker\tnode\tand set\tthe\tbelow\tparameter\tin\tKUBELET_SYSTEM_PODS_ARGS\tvariable. --streaming-connection-idle-timeout=5m 189\t|\tP a g e Based\ton\tyour\tsystem,\trestart\tthe\tkubelet\tservice.\tFor\texample: systemctl daemon-reload systemctl restart kubelet.service Default\tValue: By\tdefault,\t--streaming-connection-idle-timeout\tis\tset\tto\t4\thours. References: 1. https://kubernetes.io/docs/admin/kubelet/ 2. https://github.com/kubernetes/kubernetes/pull/18552 CIS\tControls: Version\t6 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 190\t|\tP a g e",
    "impact": "Long-lived\tconnections\tcould\tbe\tinterrupted.",
    "references": "1. https://kubernetes.io/docs/admin/kubelet/ 2. https://github.com/kubernetes/kubernetes/pull/18552 CIS\tControls: Version\t6 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 190\t|\tP a g e",
    "function_names": [
      "eks_cluster_streaming_connection_idle_timeout_not_zero",
      "eks_cluster_streaming_connection_timeout_configured",
      "eks_streaming_connection_idle_timeout_enabled",
      "eks_streaming_connection_timeout_not_disabled",
      "eks_cluster_streaming_timeout_not_zero"
    ]
  },
  {
    "id": "4.2.6",
    "title": "Ensure that the --protect-kernel-defaults argument is set to true",
    "assessment": "Manual",
    "description": "Protect\ttuned\tkernel\tparameters\tfrom\toverriding\tkubelet\tdefault\tkernel\tparameter\tvalues.",
    "rationale": "Kernel\tparameters\tare\tusually\ttuned\tand\thardened\tby\tthe\tsystem\tadministrators\tbefore putting\tthe\tsystems\tinto\tproduction.\tThese\tparameters\tprotect\tthe\tkernel\tand\tthe\tsystem. Your\tkubelet\tkernel\tdefaults\tthat\trely\ton\tsuch\tparameters\tshould\tbe\tappropriately\tset\tto match\tthe\tdesired\tsecured\tsystem\tstate.\tIgnoring\tthis\tcould\tpotentially\tlead\tto\trunning pods\twith\tundesired\tkernel\tbehavior. Impact: You\twould\thave\tto\tre-tune\tkernel\tparameters\tto\tmatch\tkubelet\tparameters.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\teach\tnode: ps -ef | grep kubelet Verify\tthat\tthe\t--protect-kernel-defaults\targument\tis\tset\tto\ttrue. If\tthe\t--protect-kernel-defaults\targument\tis\tnot\tpresent,\tcheck\tthat\tthere\tis\ta\tKubelet config\tfile\tspecified\tby\t--config,\tand\tthat\tthe\tfile\tsets\tprotectKernelDefaults\tto\ttrue.",
    "remediation": "If\tusing\ta\tKubelet\tconfig\tfile,\tedit\tthe\tfile\tto\tset\tprotectKernelDefaults: true. If\tusing\tcommand\tline\targuments,\tedit\tthe\tkubelet\tservice\tfile /etc/systemd/system/kubelet.service.d/10-kubeadm.conf\ton\teach\tworker\tnode\tand set\tthe\tbelow\tparameter\tin\tKUBELET_SYSTEM_PODS_ARGS\tvariable. --protect-kernel-defaults=true Based\ton\tyour\tsystem,\trestart\tthe\tkubelet\tservice.\tFor\texample: 191\t|\tP a g e systemctl daemon-reload systemctl restart kubelet.service Default\tValue: By\tdefault,\t--protect-kernel-defaults\tis\tnot\tset. References: 1. https://kubernetes.io/docs/admin/kubelet/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 192\t|\tP a g e",
    "impact": "You\twould\thave\tto\tre-tune\tkernel\tparameters\tto\tmatch\tkubelet\tparameters.",
    "references": "1. https://kubernetes.io/docs/admin/kubelet/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 192\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_protect_kernel_defaults_enabled",
      "kubernetes_kubelet_kernel_defaults_protected",
      "kubernetes_kubelet_kernel_parameters_protected",
      "kubernetes_kubelet_kernel_defaults_preserved",
      "kubernetes_kubelet_kernel_tuned_protection_enabled"
    ]
  },
  {
    "id": "4.2.7",
    "title": "Ensure that the --make-iptables-util-chains argument is set to true",
    "assessment": "Automated",
    "description": "Allow\tKubelet\tto\tmanage\tiptables.",
    "rationale": "Kubelets\tcan\tautomatically\tmanage\tthe\trequired\tchanges\tto\tiptables\tbased\ton\thow\tyou choose\tyour\tnetworking\toptions\tfor\tthe\tpods.\tIt\tis\trecommended\tto\tlet\tkubelets\tmanage the\tchanges\tto\tiptables.\tThis\tensures\tthat\tthe\tiptables\tconfiguration\tremains\tin\tsync\twith pods\tnetworking\tconfiguration.\tManually\tconfiguring\tiptables\twith\tdynamic\tpod\tnetwork configuration\tchanges\tmight\thamper\tthe\tcommunication\tbetween\tpods/containers\tand\tto the\toutside\tworld.\tYou\tmight\thave\tiptables\trules\ttoo\trestrictive\tor\ttoo\topen. Impact: Kubelet\twould\tmanage\tthe\tiptables\ton\tthe\tsystem\tand\tkeep\tit\tin\tsync.\tIf\tyou\tare\tusing\tany other\tiptables\tmanagement\tsolution,\tthen\tthere\tmight\tbe\tsome\tconflicts.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\teach\tnode: ps -ef | grep kubelet Verify\tthat\tif\tthe\t--make-iptables-util-chains\targument\texists\tthen\tit\tis\tset\tto\ttrue. If\tthe\t--make-iptables-util-chains\targument\tdoes\tnot\texist,\tand\tthere\tis\ta\tKubelet\tconfig file\tspecified\tby\t--config,\tverify\tthat\tthe\tfile\tdoes\tnot\tset\tmakeIPTablesUtilChains\tto false.",
    "remediation": "If\tusing\ta\tKubelet\tconfig\tfile,\tedit\tthe\tfile\tto\tset\tmakeIPTablesUtilChains: true. If\tusing\tcommand\tline\targuments,\tedit\tthe\tkubelet\tservice\tfile /etc/systemd/system/kubelet.service.d/10-kubeadm.conf\ton\teach\tworker\tnode\tand remove\tthe\t--make-iptables-util-chains\targument\tfrom\tthe 193\t|\tP a g e KUBELET_SYSTEM_PODS_ARGS\tvariable. Based\ton\tyour\tsystem,\trestart\tthe\tkubelet\tservice.\tFor\texample: systemctl daemon-reload systemctl restart kubelet.service Default\tValue: By\tdefault,\t--make-iptables-util-chains\targument\tis\tset\tto\ttrue. References: 1. https://kubernetes.io/docs/admin/kubelet/ CIS\tControls: Version\t6 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Version\t7 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices 194\t|\tP a g e",
    "impact": "Kubelet\twould\tmanage\tthe\tiptables\ton\tthe\tsystem\tand\tkeep\tit\tin\tsync.\tIf\tyou\tare\tusing\tany other\tiptables\tmanagement\tsolution,\tthen\tthere\tmight\tbe\tsome\tconflicts.",
    "references": "1. https://kubernetes.io/docs/admin/kubelet/ CIS\tControls: Version\t6 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Version\t7 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices 194\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_iptables_util_chains_enabled",
      "kubernetes_kubelet_iptables_managed",
      "kubernetes_kubelet_iptables_util_chains_true",
      "kubernetes_kubelet_iptables_chains_configured",
      "kubernetes_kubelet_iptables_util_enabled"
    ]
  },
  {
    "id": "4.2.8",
    "title": "Ensure that the --event-qps argument is set to 0 or a level which ensures appropriate event capture",
    "assessment": "Manual",
    "description": "Security\trelevant\tinformation\tshould\tbe\tcaptured.\tThe\t--event-qps\tflag\ton\tthe\tKubelet\tcan be\tused\tto\tlimit\tthe\trate\tat\twhich\tevents\tare\tgathered.\tSetting\tthis\ttoo\tlow\tcould\tresult\tin relevant\tevents\tnot\tbeing\tlogged,\thowever\tthe\tunlimited\tsetting\tof\t0\tcould\tresult\tin\ta\tdenial of\tservice\ton\tthe\tkubelet.",
    "rationale": "It\tis\timportant\tto\tcapture\tall\tevents\tand\tnot\trestrict\tevent\tcreation.\tEvents\tare\tan\timportant source\tof\tsecurity\tinformation\tand\tanalytics\tthat\tensure\tthat\tyour\tenvironment\tis consistently\tmonitored\tusing\tthe\tevent\tdata. Impact: Setting\tthis\tparameter\tto\t0\tcould\tresult\tin\ta\tdenial\tof\tservice\tcondition\tdue\tto\texcessive events\tbeing\tcreated.\tThe\tcluster's\tevent\tprocessing\tand\tstorage\tsystems\tshould\tbe\tscaled to\thandle\texpected\tevent\tloads.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\teach\tnode: ps -ef | grep kubelet Review\tthe\tvalue\tset\tfor\tthe\t--event-qps\targument\tand\tdetermine\twhether\tthis\thas\tbeen set\tto\tan\tappropriate\tlevel\tfor\tthe\tcluster.\tThe\tvalue\tof\t0\tcan\tbe\tused\tto\tensure\tthat\tall events\tare\tcaptured. If\tthe\t--event-qps\targument\tdoes\tnot\texist,\tcheck\tthat\tthere\tis\ta\tKubelet\tconfig\tfile specified\tby\t--config\tand\treview\tthe\tvalue\tin\tthis\tlocation.",
    "remediation": "If\tusing\ta\tKubelet\tconfig\tfile,\tedit\tthe\tfile\tto\tset\teventRecordQPS:\tto\tan\tappropriate\tlevel. If\tusing\tcommand\tline\targuments,\tedit\tthe\tkubelet\tservice\tfile /etc/systemd/system/kubelet.service.d/10-kubeadm.conf\ton\teach\tworker\tnode\tand 195\t|\tP a g e set\tthe\tbelow\tparameter\tin\tKUBELET_SYSTEM_PODS_ARGS\tvariable. Based\ton\tyour\tsystem,\trestart\tthe\tkubelet\tservice.\tFor\texample: systemctl daemon-reload systemctl restart kubelet.service Default\tValue: By\tdefault,\t--event-qps\targument\tis\tset\tto\t5. References: 1. https://kubernetes.io/docs/admin/kubelet/ 2. https://github.com/kubernetes/kubernetes/blob/master/pkg/kubelet/apis/kubel etconfig/v1beta1/types.go CIS\tControls: Version\t6 6\tMaintenance,\tMonitoring,\tand\tAnalysis\tof\tAudit\tLogs Maintenance,\tMonitoring,\tand\tAnalysis\tof\tAudit\tLogs Version\t7 6\tMaintenance,\tMonitoring\tand\tAnalysis\tof\tAudit\tLogs Maintenance,\tMonitoring\tand\tAnalysis\tof\tAudit\tLogs 196\t|\tP a g e",
    "impact": "Setting\tthis\tparameter\tto\t0\tcould\tresult\tin\ta\tdenial\tof\tservice\tcondition\tdue\tto\texcessive events\tbeing\tcreated.\tThe\tcluster's\tevent\tprocessing\tand\tstorage\tsystems\tshould\tbe\tscaled to\thandle\texpected\tevent\tloads.",
    "references": "1. https://kubernetes.io/docs/admin/kubelet/ 2. https://github.com/kubernetes/kubernetes/blob/master/pkg/kubelet/apis/kubel etconfig/v1beta1/types.go CIS\tControls: Version\t6 6\tMaintenance,\tMonitoring,\tand\tAnalysis\tof\tAudit\tLogs Maintenance,\tMonitoring,\tand\tAnalysis\tof\tAudit\tLogs Version\t7 6\tMaintenance,\tMonitoring\tand\tAnalysis\tof\tAudit\tLogs Maintenance,\tMonitoring\tand\tAnalysis\tof\tAudit\tLogs 196\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_event_qps_disabled",
      "kubernetes_kubelet_event_qps_rate_limited",
      "kubernetes_kubelet_event_qps_appropriate_level",
      "kubernetes_kubelet_event_capture_configured",
      "kubernetes_kubelet_event_qps_secure_setting"
    ]
  },
  {
    "id": "4.2.9",
    "title": "Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate",
    "assessment": "Manual",
    "description": "Setup\tTLS\tconnection\ton\tthe\tKubelets.",
    "rationale": "The\tconnections\tfrom\tthe\tapiserver\tto\tthe\tkubelet\tare\tused\tfor\tfetching\tlogs\tfor\tpods, attaching\t(through\tkubectl)\tto\trunning\tpods,\tand\tusing\tthe\tkubelet’s\tport-forwarding functionality.\tThese\tconnections\tterminate\tat\tthe\tkubelet’s\tHTTPS\tendpoint.\tBy\tdefault,\tthe apiserver\tdoes\tnot\tverify\tthe\tkubelet’s\tserving\tcertificate,\twhich\tmakes\tthe\tconnection subject\tto\tman-in-the-middle\tattacks,\tand\tunsafe\tto\trun\tover\tuntrusted\tand/or\tpublic networks.",
    "audit": "Run\tthe\tfollowing\tcommand\ton\teach\tnode: ps -ef | grep kubelet Verify\tthat\tthe\t--tls-cert-file\tand\t--tls-private-key-file\targuments\texist\tand\tthey\tare\tset\tas appropriate. If\tthese\targuments\tare\tnot\tpresent,\tcheck\tthat\tthere\tis\ta\tKubelet\tconfig\tspecified\tby\t--config and\tthat\tit\tcontains\tappropriate\tsettings\tfor\ttlsCertFile\tand\ttlsPrivateKeyFile.",
    "remediation": "If\tusing\ta\tKubelet\tconfig\tfile,\tedit\tthe\tfile\tto\tset\ttlsCertFile\tto\tthe\tlocation\tof\tthe\tcertificate file\tto\tuse\tto\tidentify\tthis\tKubelet,\tand\ttlsPrivateKeyFile\tto\tthe\tlocation\tof\tthe corresponding\tprivate\tkey\tfile. If\tusing\tcommand\tline\targuments,\tedit\tthe\tkubelet\tservice\tfile /etc/systemd/system/kubelet.service.d/10-kubeadm.conf\ton\teach\tworker\tnode\tand\tset the\tbelow\tparameters\tin\tKUBELET_CERTIFICATE_ARGS\tvariable. --tls-cert-file=<path/to/tls-certificate-file>\t--tls-private-key-file=<path/to/tls-key-file> Based\ton\tyour\tsystem,\trestart\tthe\tkubelet\tservice.\tFor\texample: 197\t|\tP a g e systemctl daemon-reload systemctl restart kubelet.service CIS\tControls: Version\t6 1.6\tUse\tOf\tClient\tCertificates\tFor\tSystem\tAuthentication Use\tclient\tcertificates\tto\tvalidate\tand\tauthenticate\tsystems\tprior\tto\tconnecting\tto\tthe private\tnetwork. 14.2\tEncrypt\tAll\tSensitive\tInformation\tOver\tLess-trusted\tNetworks All\tcommunication\tof\tsensitive\tinformation\tover\tless-trusted\tnetworks\tshould\tbe encrypted.\tWhenever\tinformation\tflows\tover\ta\tnetwork\twith\ta\tlower\ttrust\tlevel,\tthe information\tshould\tbe\tencrypted. Version\t7 1.8\tUtilize\tClient\tCertificates\tto\tAuthenticate\tHardware\tAssets Use\tclient\tcertificates\tto\tauthenticate\thardware\tassets\tconnecting\tto\tthe\torganization's trusted\tnetwork. 198\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_tls_cert_file_set",
      "kubernetes_kubelet_tls_private_key_file_set",
      "kubernetes_kubelet_tls_connection_configured",
      "kubernetes_kubelet_tls_cert_and_key_valid",
      "kubernetes_kubelet_tls_encryption_enabled"
    ]
  },
  {
    "id": "4.2.10",
    "title": "Ensure that the Kubelet only makes use of Strong Cryptographic Ciphers",
    "assessment": "Manual",
    "description": "The\tRBAC\trole\tcluster-admin\tprovides\twide-ranging\tpowers\tover\tthe\tenvironment\tand should\tbe\tused\tonly\twhere\tand\twhen\tneeded.",
    "rationale": "Kubernetes\tprovides\ta\tset\tof\tdefault\troles\twhere\tRBAC\tis\tused.\tSome\tof\tthese\troles\tsuch\tas cluster-admin\tprovide\twide-ranging\tprivileges\twhich\tshould\tonly\tbe\tapplied\twhere absolutely\tnecessary.\tRoles\tsuch\tas\tcluster-admin\tallow\tsuper-user\taccess\tto\tperform\tany action\ton\tany\tresource.\tWhen\tused\tin\ta\tClusterRoleBinding,\tit\tgives\tfull\tcontrol\tover every\tresource\tin\tthe\tcluster\tand\tin\tall\tnamespaces.\tWhen\tused\tin\ta\tRoleBinding,\tit\tgives full\tcontrol\tover\tevery\tresource\tin\tthe\trolebinding's\tnamespace,\tincluding\tthe\tnamespace itself. Impact: Care\tshould\tbe\ttaken\tbefore\tremoving\tany\tclusterrolebindings\tfrom\tthe\tenvironment\tto ensure\tthey\twere\tnot\trequired\tfor\toperation\tof\tthe\tcluster.\tSpecifically,\tmodifications should\tnot\tbe\tmade\tto\tclusterrolebindings\twith\tthe\tsystem:\tprefix\tas\tthey\tare\trequired for\tthe\toperation\tof\tsystem\tcomponents.",
    "audit": "Obtain\ta\tlist\tof\tthe\tprincipals\twho\thave\taccess\tto\tthe\tcluster-admin\trole\tby\treviewing\tthe clusterrolebinding\toutput\tfor\teach\trole\tbinding\tthat\thas\taccess\tto\tthe\tcluster-admin role. kubectl get clusterrolebindings -o=custom- columns=NAME:.metadata.name,ROLE:.roleRef.name,SUBJECT:.subjects[*].name Review\teach\tprincipal\tlisted\tand\tensure\tthat\tcluster-admin\tprivilege\tis\trequired\tfor\tit.",
    "remediation": "202\t|\tP a g e Identify\tall\tclusterrolebindings\tto\tthe\tcluster-admin\trole.\tCheck\tif\tthey\tare\tused\tand\tif\tthey need\tthis\trole\tor\tif\tthey\tcould\tuse\ta\trole\twith\tfewer\tprivileges. Where\tpossible,\tfirst\tbind\tusers\tto\ta\tlower\tprivileged\trole\tand\tthen\tremove\tthe clusterrolebinding\tto\tthe\tcluster-admin\trole\t: kubectl delete clusterrolebinding [name] Default\tValue: By\tdefault\ta\tsingle\tclusterrolebinding\tcalled\tcluster-admin\tis\tprovided\twith\tthe system:masters\tgroup\tas\tits\tprincipal. References: 1. https://kubernetes.io/docs/admin/authorization/rbac/#user-facing-roles CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 203\t|\tP a g e",
    "impact": "Care\tshould\tbe\ttaken\tbefore\tremoving\tany\tclusterrolebindings\tfrom\tthe\tenvironment\tto ensure\tthey\twere\tnot\trequired\tfor\toperation\tof\tthe\tcluster.\tSpecifically,\tmodifications should\tnot\tbe\tmade\tto\tclusterrolebindings\twith\tthe\tsystem:\tprefix\tas\tthey\tare\trequired for\tthe\toperation\tof\tsystem\tcomponents.",
    "references": "1. https://kubernetes.io/docs/admin/authorization/rbac/#user-facing-roles CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 203\t|\tP a g e",
    "function_names": [
      "kubernetes_kubelet_strong_ciphers_enabled",
      "kubernetes_kubelet_weak_ciphers_disabled",
      "kubernetes_kubelet_tls_ciphers_restricted",
      "kubernetes_kubelet_cryptographic_ciphers_secure",
      "kubernetes_kubelet_cipher_suites_compliant"
    ]
  },
  {
    "id": "5.1.2",
    "title": "Minimize access to secrets",
    "assessment": "Manual",
    "description": "The\tKubernetes\tAPI\tstores\tsecrets,\twhich\tmay\tbe\tservice\taccount\ttokens\tfor\tthe Kubernetes\tAPI\tor\tcredentials\tused\tby\tworkloads\tin\tthe\tcluster.\tAccess\tto\tthese\tsecrets should\tbe\trestricted\tto\tthe\tsmallest\tpossible\tgroup\tof\tusers\tto\treduce\tthe\trisk\tof\tprivilege escalation.",
    "rationale": "Inappropriate\taccess\tto\tsecrets\tstored\twithin\tthe\tKubernetes\tcluster\tcan\tallow\tfor\tan attacker\tto\tgain\tadditional\taccess\tto\tthe\tKubernetes\tcluster\tor\texternal\tresources\twhose credentials\tare\tstored\tas\tsecrets. Impact: Care\tshould\tbe\ttaken\tnot\tto\tremove\taccess\tto\tsecrets\tto\tsystem\tcomponents\twhich\trequire this\tfor\ttheir\toperation",
    "audit": "Review\tthe\tusers\twho\thave\tget,\tlist\tor\twatch\taccess\tto\tsecrets\tobjects\tin\tthe\tKubernetes API.",
    "remediation": "Where\tpossible,\tremove\tget,\tlist\tand\twatch\taccess\tto\tsecret\tobjects\tin\tthe\tcluster. Default\tValue: By\tdefault\tin\ta\tkubeadm\tcluster\tthe\tfollowing\tlist\tof\tprincipals\thave\tget\tprivileges\ton secret\tobjects CLUSTERROLEBINDING                                    SUBJECT TYPE            SA-NAMESPACE cluster-admin                                         system:masters Group system:controller:clusterrole-aggregation-controller  clusterrole- aggregation-controller  ServiceAccount  kube-system 204\t|\tP a g e system:controller:expand-controller                   expand-controller ServiceAccount  kube-system system:controller:generic-garbage-collector           generic-garbage- collector           ServiceAccount  kube-system system:controller:namespace-controller                namespace-controller ServiceAccount  kube-system system:controller:persistent-volume-binder            persistent-volume- binder            ServiceAccount  kube-system system:kube-controller-manager                        system:kube-controller- manager      User CIS\tControls: Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 205\t|\tP a g e",
    "impact": "Care\tshould\tbe\ttaken\tnot\tto\tremove\taccess\tto\tsecrets\tto\tsystem\tcomponents\twhich\trequire this\tfor\ttheir\toperation",
    "function_names": [
      "kubernetes_secret_access_restricted",
      "kubernetes_secret_minimal_user_access",
      "kubernetes_secret_no_public_access",
      "kubernetes_secret_iam_policy_restricted",
      "kubernetes_secret_rbac_restricted",
      "kubernetes_secret_service_account_restricted",
      "kubernetes_secret_no_wildcard_access",
      "kubernetes_secret_no_anonymous_access",
      "kubernetes_secret_no_default_service_account",
      "kubernetes_secret_no_broad_role_bindings"
    ]
  },
  {
    "id": "5.1.3",
    "title": "Minimize wildcard use in Roles and ClusterRoles",
    "assessment": "Manual",
    "description": "Kubernetes\tRoles\tand\tClusterRoles\tprovide\taccess\tto\tresources\tbased\ton\tsets\tof\tobjects\tand actions\tthat\tcan\tbe\ttaken\ton\tthose\tobjects.\tIt\tis\tpossible\tto\tset\teither\tof\tthese\tto\tbe\tthe wildcard\t\"*\"\twhich\tmatches\tall\titems. Use\tof\twildcards\tis\tnot\toptimal\tfrom\ta\tsecurity\tperspective\tas\tit\tmay\tallow\tfor\tinadvertent access\tto\tbe\tgranted\twhen\tnew\tresources\tare\tadded\tto\tthe\tKubernetes\tAPI\teither\tas\tCRDs or\tin\tlater\tversions\tof\tthe\tproduct.",
    "rationale": "The\tprinciple\tof\tleast\tprivilege\trecommends\tthat\tusers\tare\tprovided\tonly\tthe\taccess required\tfor\ttheir\trole\tand\tnothing\tmore.\tThe\tuse\tof\twildcard\trights\tgrants\tis\tlikely\tto provide\texcessive\trights\tto\tthe\tKubernetes\tAPI.",
    "audit": "Retrieve\tthe\troles\tdefined\tacross\teach\tnamespaces\tin\tthe\tcluster\tand\treview\tfor\twildcards kubectl get roles --all-namespaces -o yaml Retrieve\tthe\tcluster\troles\tdefined\tin\tthe\tcluster\tand\treview\tfor\twildcards kubectl get clusterroles -o yaml",
    "remediation": "Where\tpossible\treplace\tany\tuse\tof\twildcards\tin\tclusterroles\tand\troles\twith\tspecific\tobjects or\tactions. CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. 206\t|\tP a g e Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 207\t|\tP a g e",
    "function_names": [
      "kubernetes_role_no_wildcard_resources",
      "kubernetes_clusterrole_no_wildcard_resources",
      "kubernetes_role_no_wildcard_actions",
      "kubernetes_clusterrole_no_wildcard_actions",
      "kubernetes_role_no_wildcard_resources_or_actions",
      "kubernetes_clusterrole_no_wildcard_resources_or_actions"
    ]
  },
  {
    "id": "5.1.4",
    "title": "Minimize access to create pods",
    "assessment": "Manual",
    "description": "The\tability\tto\tcreate\tpods\tin\ta\tnamespace\tcan\tprovide\ta\tnumber\tof\topportunities\tfor privilege\tescalation,\tsuch\tas\tassigning\tprivileged\tservice\taccounts\tto\tthese\tpods\tor mounting\thostPaths\twith\taccess\tto\tsensitive\tdata\t(unless\tPod\tSecurity\tPolicies\tare implemented\tto\trestrict\tthis\taccess) As\tsuch,\taccess\tto\tcreate\tnew\tpods\tshould\tbe\trestricted\tto\tthe\tsmallest\tpossible\tgroup\tof users.",
    "rationale": "The\tability\tto\tcreate\tpods\tin\ta\tcluster\topens\tup\tpossibilities\tfor\tprivilege\tescalation\tand should\tbe\trestricted,\twhere\tpossible. Impact: Care\tshould\tbe\ttaken\tnot\tto\tremove\taccess\tto\tpods\tto\tsystem\tcomponents\twhich\trequire this\tfor\ttheir\toperation",
    "audit": "Review\tthe\tusers\twho\thave\tcreate\taccess\tto\tpod\tobjects\tin\tthe\tKubernetes\tAPI.",
    "remediation": "Where\tpossible,\tremove\tcreate\taccess\tto\tpod\tobjects\tin\tthe\tcluster. Default\tValue: By\tdefault\tin\ta\tkubeadm\tcluster\tthe\tfollowing\tlist\tof\tprincipals\thave\tcreate\tprivileges\ton pod\tobjects CLUSTERROLEBINDING                                    SUBJECT TYPE            SA-NAMESPACE cluster-admin                                         system:masters Group 208\t|\tP a g e system:controller:clusterrole-aggregation-controller  clusterrole- aggregation-controller  ServiceAccount  kube-system system:controller:daemon-set-controller               daemon-set-controller ServiceAccount  kube-system system:controller:job-controller                      job-controller ServiceAccount  kube-system system:controller:persistent-volume-binder            persistent-volume- binder            ServiceAccount  kube-system system:controller:replicaset-controller               replicaset-controller ServiceAccount  kube-system system:controller:replication-controller              replication-controller ServiceAccount  kube-system system:controller:statefulset-controller              statefulset-controller ServiceAccount  kube-system CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 209\t|\tP a g e",
    "impact": "Care\tshould\tbe\ttaken\tnot\tto\tremove\taccess\tto\tpods\tto\tsystem\tcomponents\twhich\trequire this\tfor\ttheir\toperation",
    "function_names": [
      "kubernetes_namespace_pod_creation_restricted",
      "kubernetes_role_pod_creation_minimized",
      "kubernetes_cluster_pod_creation_limited",
      "kubernetes_service_account_pod_creation_restricted",
      "kubernetes_rbac_pod_creation_minimized",
      "kubernetes_user_pod_creation_restricted",
      "kubernetes_group_pod_creation_limited",
      "kubernetes_policy_pod_creation_restricted"
    ]
  },
  {
    "id": "5.1.5",
    "title": "Ensure that default service accounts are not actively used.",
    "assessment": "Manual",
    "description": "The\tdefault\tservice\taccount\tshould\tnot\tbe\tused\tto\tensure\tthat\trights\tgranted\tto applications\tcan\tbe\tmore\teasily\taudited\tand\treviewed.",
    "rationale": "Kubernetes\tprovides\ta\tdefault\tservice\taccount\twhich\tis\tused\tby\tcluster\tworkloads\twhere no\tspecific\tservice\taccount\tis\tassigned\tto\tthe\tpod. Where\taccess\tto\tthe\tKubernetes\tAPI\tfrom\ta\tpod\tis\trequired,\ta\tspecific\tservice\taccount should\tbe\tcreated\tfor\tthat\tpod,\tand\trights\tgranted\tto\tthat\tservice\taccount. The\tdefault\tservice\taccount\tshould\tbe\tconfigured\tsuch\tthat\tit\tdoes\tnot\tprovide\ta\tservice account\ttoken\tand\tdoes\tnot\thave\tany\texplicit\trights\tassignments. Impact: All\tworkloads\twhich\trequire\taccess\tto\tthe\tKubernetes\tAPI\twill\trequire\tan\texplicit\tservice account\tto\tbe\tcreated.",
    "audit": "For\teach\tnamespace\tin\tthe\tcluster,\treview\tthe\trights\tassigned\tto\tthe\tdefault\tservice\taccount and\tensure\tthat\tit\thas\tno\troles\tor\tcluster\troles\tbound\tto\tit\tapart\tfrom\tthe\tdefaults. Additionally\tensure\tthat\tthe\tautomountServiceAccountToken: false\tsetting\tis\tin\tplace\tfor each\tdefault\tservice\taccount.",
    "remediation": "Create\texplicit\tservice\taccounts\twherever\ta\tKubernetes\tworkload\trequires\tspecific\taccess to\tthe\tKubernetes\tAPI\tserver. Modify\tthe\tconfiguration\tof\teach\tdefault\tservice\taccount\tto\tinclude\tthis\tvalue automountServiceAccountToken: false Default\tValue: 210\t|\tP a g e By\tdefault\tthe\tdefault\tservice\taccount\tallows\tfor\tits\tservice\taccount\ttoken\tto\tbe\tmounted in\tpods\tin\tits\tnamespace. References: 1. https://kubernetes.io/docs/tasks/configure-pod-container/configure-service- account/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 211\t|\tP a g e",
    "impact": "All\tworkloads\twhich\trequire\taccess\tto\tthe\tKubernetes\tAPI\twill\trequire\tan\texplicit\tservice account\tto\tbe\tcreated.",
    "references": "1. https://kubernetes.io/docs/tasks/configure-pod-container/configure-service- account/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 211\t|\tP a g e",
    "function_names": [
      "iam_service_account_no_active_default",
      "iam_service_account_default_unused",
      "iam_default_service_account_disabled",
      "compute_default_service_account_no_usage",
      "compute_service_account_default_inactive"
    ]
  },
  {
    "id": "5.1.6",
    "title": "Ensure that Service Account Tokens are only mounted where necessary",
    "assessment": "Manual",
    "description": "Service\taccounts\ttokens\tshould\tnot\tbe\tmounted\tin\tpods\texcept\twhere\tthe\tworkload running\tin\tthe\tpod\texplicitly\tneeds\tto\tcommunicate\twith\tthe\tAPI\tserver",
    "rationale": "Mounting\tservice\taccount\ttokens\tinside\tpods\tcan\tprovide\tan\tavenue\tfor\tprivilege\tescalation attacks\twhere\tan\tattacker\tis\table\tto\tcompromise\ta\tsingle\tpod\tin\tthe\tcluster. Avoiding\tmounting\tthese\ttokens\tremoves\tthis\tattack\tavenue. Impact: Pods\tmounted\twithout\tservice\taccount\ttokens\twill\tnot\tbe\table\tto\tcommunicate\twith\tthe\tAPI server,\texcept\twhere\tthe\tresource\tis\tavailable\tto\tunauthenticated\tprincipals.",
    "audit": "Review\tpod\tand\tservice\taccount\tobjects\tin\tthe\tcluster\tand\tensure\tthat\tthe\toption\tbelow\tis set,\tunless\tthe\tresource\texplicitly\trequires\tthis\taccess. automountServiceAccountToken: false",
    "remediation": "Modify\tthe\tdefinition\tof\tpods\tand\tservice\taccounts\twhich\tdo\tnot\tneed\tto\tmount\tservice account\ttokens\tto\tdisable\tit. Default\tValue: By\tdefault,\tall\tpods\tget\ta\tservice\taccount\ttoken\tmounted\tin\tthem. References: 1. https://kubernetes.io/docs/tasks/configure-pod-container/configure-service- account/ 212\t|\tP a g e CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 213\t|\tP a g e 5.2 Pod Security Policies A\tPod\tSecurity\tPolicy\t(PSP)\tis\ta\tcluster-level\tresource\tthat\tcontrols\tsecurity\tsettings\tfor pods.\tYour\tcluster\tmay\thave\tmultiple\tPSPs.\tYou\tcan\tquery\tPSPs\twith\tthe\tfollowing command: kubectl get psp PodSecurityPolicies\tare\tused\tin\tconjunction\twith\tthe\tPodSecurityPolicy\tadmission controller\tplugin.",
    "impact": "Pods\tmounted\twithout\tservice\taccount\ttokens\twill\tnot\tbe\table\tto\tcommunicate\twith\tthe\tAPI server,\texcept\twhere\tthe\tresource\tis\tavailable\tto\tunauthenticated\tprincipals.",
    "references": "1. https://kubernetes.io/docs/tasks/configure-pod-container/configure-service- account/ 212\t|\tP a g e CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 213\t|\tP a g e 5.2 Pod Security Policies A\tPod\tSecurity\tPolicy\t(PSP)\tis\ta\tcluster-level\tresource\tthat\tcontrols\tsecurity\tsettings\tfor pods.\tYour\tcluster\tmay\thave\tmultiple\tPSPs.\tYou\tcan\tquery\tPSPs\twith\tthe\tfollowing command: kubectl get psp PodSecurityPolicies\tare\tused\tin\tconjunction\twith\tthe\tPodSecurityPolicy\tadmission controller\tplugin.",
    "function_names": [
      "kubernetes_pod_service_account_token_unmounted",
      "kubernetes_pod_service_account_token_mounted_necessary_only",
      "kubernetes_pod_service_account_token_disabled_by_default",
      "kubernetes_pod_service_account_token_explicit_requirement",
      "kubernetes_pod_service_account_token_restricted_mounting"
    ]
  },
  {
    "id": "5.2.1",
    "title": "Minimize the admission of privileged containers",
    "assessment": "Manual",
    "description": "Do\tnot\tgenerally\tpermit\tcontainers\tto\tbe\trun\twith\tthe\tsecurityContext.privileged\tflag set\tto\ttrue.",
    "rationale": "Privileged\tcontainers\thave\taccess\tto\tall\tLinux\tKernel\tcapabilities\tand\tdevices.\tA\tcontainer running\twith\tfull\tprivileges\tcan\tdo\talmost\teverything\tthat\tthe\thost\tcan\tdo.\tThis\tflag\texists to\tallow\tspecial\tuse-cases,\tlike\tmanipulating\tthe\tnetwork\tstack\tand\taccessing\tdevices. There\tshould\tbe\tat\tleast\tone\tPodSecurityPolicy\t(PSP)\tdefined\twhich\tdoes\tnot\tpermit privileged\tcontainers. If\tyou\tneed\tto\trun\tprivileged\tcontainers,\tthis\tshould\tbe\tdefined\tin\ta\tseparate\tPSP\tand\tyou should\tcarefully\tcheck\tRBAC\tcontrols\tto\tensure\tthat\tonly\tlimited\tservice\taccounts\tand users\tare\tgiven\tpermission\tto\taccess\tthat\tPSP. Impact: Pods\tdefined\twith\tspec.containers[].securityContext.privileged: true\twill\tnot\tbe permitted.",
    "audit": "Get\tthe\tset\tof\tPSPs\twith\tthe\tfollowing\tcommand: 214\t|\tP a g e kubectl get psp For\teach\tPSP,\tcheck\twhether\tprivileged\tis\tenabled: kubectl get psp <name> -o=jsonpath='{.spec.privileged}' Verify\tthat\tthere\tis\tat\tleast\tone\tPSP\twhich\tdoes\tnot\treturn\ttrue.",
    "remediation": "Create\ta\tPSP\tas\tdescribed\tin\tthe\tKubernetes\tdocumentation,\tensuring\tthat\tthe .spec.privileged\tfield\tis\tomitted\tor\tset\tto\tfalse. Default\tValue: By\tdefault,\tPodSecurityPolicies\tare\tnot\tdefined. References: 1. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod- security-policies CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 215\t|\tP a g e",
    "impact": "Pods\tdefined\twith\tspec.containers[].securityContext.privileged: true\twill\tnot\tbe permitted.",
    "references": "1. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod- security-policies CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 215\t|\tP a g e",
    "function_names": [
      "compute_container_privileged_disabled",
      "compute_container_privileged_flag_false",
      "compute_container_security_context_unprivileged",
      "compute_container_privilege_escalation_disabled",
      "compute_container_root_privileges_disabled"
    ]
  },
  {
    "id": "5.2.2",
    "title": "Minimize the admission of containers wishing to share the host process ID namespace",
    "assessment": "Manual",
    "description": "Do\tnot\tgenerally\tpermit\tcontainers\tto\tbe\trun\twith\tthe\thostPID\tflag\tset\tto\ttrue.",
    "rationale": "A\tcontainer\trunning\tin\tthe\thost's\tPID\tnamespace\tcan\tinspect\tprocesses\trunning\toutside\tthe container.\tIf\tthe\tcontainer\talso\thas\taccess\tto\tptrace\tcapabilities\tthis\tcan\tbe\tused\tto\tescalate privileges\toutside\tof\tthe\tcontainer. There\tshould\tbe\tat\tleast\tone\tPodSecurityPolicy\t(PSP)\tdefined\twhich\tdoes\tnot\tpermit containers\tto\tshare\tthe\thost\tPID\tnamespace. If\tyou\tneed\tto\trun\tcontainers\twhich\trequire\thostPID,\tthis\tshould\tbe\tdefined\tin\ta\tseparate PSP\tand\tyou\tshould\tcarefully\tcheck\tRBAC\tcontrols\tto\tensure\tthat\tonly\tlimited\tservice accounts\tand\tusers\tare\tgiven\tpermission\tto\taccess\tthat\tPSP. Impact: Pods\tdefined\twith\tspec.hostPID: true\twill\tnot\tbe\tpermitted\tunless\tthey\tare\trun\tunder\ta specific\tPSP.",
    "audit": "Get\tthe\tset\tof\tPSPs\twith\tthe\tfollowing\tcommand: kubectl get psp For\teach\tPSP,\tcheck\twhether\tprivileged\tis\tenabled: kubectl get psp <name> -o=jsonpath='{.spec.hostPID}' Verify\tthat\tthere\tis\tat\tleast\tone\tPSP\twhich\tdoes\tnot\treturn\ttrue.",
    "remediation": "Create\ta\tPSP\tas\tdescribed\tin\tthe\tKubernetes\tdocumentation,\tensuring\tthat\tthe .spec.hostPID\tfield\tis\tomitted\tor\tset\tto\tfalse. 216\t|\tP a g e Default\tValue: By\tdefault,\tPodSecurityPolicies\tare\tnot\tdefined. References: 1. https://kubernetes.io/docs/concepts/policy/pod-security-policy CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 217\t|\tP a g e",
    "impact": "Pods\tdefined\twith\tspec.hostPID: true\twill\tnot\tbe\tpermitted\tunless\tthey\tare\trun\tunder\ta specific\tPSP.",
    "references": "1. https://kubernetes.io/docs/concepts/policy/pod-security-policy CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 217\t|\tP a g e",
    "function_names": [
      "compute_container_host_pid_disabled",
      "compute_container_host_pid_sharing_restricted",
      "compute_container_host_pid_namespace_isolated",
      "compute_container_host_pid_access_denied",
      "compute_container_host_pid_flag_false"
    ]
  },
  {
    "id": "5.2.3",
    "title": "Minimize the admission of containers wishing to share the host IPC namespace",
    "assessment": "Manual",
    "description": "Do\tnot\tgenerally\tpermit\tcontainers\tto\tbe\trun\twith\tthe\thostIPC\tflag\tset\tto\ttrue.",
    "rationale": "A\tcontainer\trunning\tin\tthe\thost's\tIPC\tnamespace\tcan\tuse\tIPC\tto\tinteract\twith\tprocesses outside\tthe\tcontainer. There\tshould\tbe\tat\tleast\tone\tPodSecurityPolicy\t(PSP)\tdefined\twhich\tdoes\tnot\tpermit containers\tto\tshare\tthe\thost\tIPC\tnamespace. If\tyou\thave\ta\trequirement\tto\tcontainers\twhich\trequire\thostIPC,\tthis\tshould\tbe\tdefined\tin\ta separate\tPSP\tand\tyou\tshould\tcarefully\tcheck\tRBAC\tcontrols\tto\tensure\tthat\tonly\tlimited service\taccounts\tand\tusers\tare\tgiven\tpermission\tto\taccess\tthat\tPSP. Impact: Pods\tdefined\twith\tspec.hostIPC: true\twill\tnot\tbe\tpermitted\tunless\tthey\tare\trun\tunder\ta specific\tPSP.",
    "audit": "Get\tthe\tset\tof\tPSPs\twith\tthe\tfollowing\tcommand: kubectl get psp For\teach\tPSP,\tcheck\twhether\tprivileged\tis\tenabled: kubectl get psp <name> -o=jsonpath='{.spec.hostIPC}' Verify\tthat\tthere\tis\tat\tleast\tone\tPSP\twhich\tdoes\tnot\treturn\ttrue.",
    "remediation": "Create\ta\tPSP\tas\tdescribed\tin\tthe\tKubernetes\tdocumentation,\tensuring\tthat\tthe .spec.hostIPC\tfield\tis\tomitted\tor\tset\tto\tfalse. 218\t|\tP a g e Default\tValue: By\tdefault,\tPodSecurityPolicies\tare\tnot\tdefined. References: 1. https://kubernetes.io/docs/concepts/policy/pod-security-policy CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 219\t|\tP a g e",
    "impact": "Pods\tdefined\twith\tspec.hostIPC: true\twill\tnot\tbe\tpermitted\tunless\tthey\tare\trun\tunder\ta specific\tPSP.",
    "references": "1. https://kubernetes.io/docs/concepts/policy/pod-security-policy CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 219\t|\tP a g e",
    "function_names": [
      "compute_container_host_ipc_disabled",
      "compute_container_host_ipc_restricted",
      "compute_container_host_ipc_not_shared",
      "compute_container_host_ipc_denied",
      "compute_container_host_ipc_protected"
    ]
  },
  {
    "id": "5.2.4",
    "title": "Minimize the admission of containers wishing to share the host network namespace",
    "assessment": "Manual",
    "description": "Do\tnot\tgenerally\tpermit\tcontainers\tto\tbe\trun\twith\tthe\thostNetwork\tflag\tset\tto\ttrue.",
    "rationale": "A\tcontainer\trunning\tin\tthe\thost's\tnetwork\tnamespace\tcould\taccess\tthe\tlocal\tloopback device,\tand\tcould\taccess\tnetwork\ttraffic\tto\tand\tfrom\tother\tpods. There\tshould\tbe\tat\tleast\tone\tPodSecurityPolicy\t(PSP)\tdefined\twhich\tdoes\tnot\tpermit containers\tto\tshare\tthe\thost\tnetwork\tnamespace. If\tyou\thave\tneed\tto\trun\tcontainers\twhich\trequire\thostNetwork,\tthis\tshould\tbe\tdefined\tin\ta separate\tPSP\tand\tyou\tshould\tcarefully\tcheck\tRBAC\tcontrols\tto\tensure\tthat\tonly\tlimited service\taccounts\tand\tusers\tare\tgiven\tpermission\tto\taccess\tthat\tPSP. Impact: Pods\tdefined\twith\tspec.hostNetwork: true\twill\tnot\tbe\tpermitted\tunless\tthey\tare\trun under\ta\tspecific\tPSP.",
    "audit": "Get\tthe\tset\tof\tPSPs\twith\tthe\tfollowing\tcommand: kubectl get psp For\teach\tPSP,\tcheck\twhether\tprivileged\tis\tenabled: kubectl get psp <name> -o=jsonpath='{.spec.hostNetwork}' Verify\tthat\tthere\tis\tat\tleast\tone\tPSP\twhich\tdoes\tnot\treturn\ttrue.",
    "remediation": "Create\ta\tPSP\tas\tdescribed\tin\tthe\tKubernetes\tdocumentation,\tensuring\tthat\tthe .spec.hostNetwork\tfield\tis\tomitted\tor\tset\tto\tfalse. 220\t|\tP a g e Default\tValue: By\tdefault,\tPodSecurityPolicies\tare\tnot\tdefined. References: 1. https://kubernetes.io/docs/concepts/policy/pod-security-policy CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 221\t|\tP a g e",
    "impact": "Pods\tdefined\twith\tspec.hostNetwork: true\twill\tnot\tbe\tpermitted\tunless\tthey\tare\trun under\ta\tspecific\tPSP.",
    "references": "1. https://kubernetes.io/docs/concepts/policy/pod-security-policy CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 221\t|\tP a g e",
    "function_names": [
      "compute_container_host_network_disabled",
      "compute_pod_host_network_disabled",
      "kubernetes_container_host_network_restricted",
      "kubernetes_pod_host_network_restricted",
      "container_host_network_sharing_disabled",
      "container_host_network_isolation_enabled",
      "pod_host_network_access_restricted",
      "container_host_network_admission_controlled"
    ]
  },
  {
    "id": "5.2.5",
    "title": "Minimize the admission of containers with allowPrivilegeEscalation",
    "assessment": "Manual",
    "description": "Do\tnot\tgenerally\tpermit\tcontainers\tto\tbe\trun\twith\tthe\tallowPrivilegeEscalation\tflag\tset to\ttrue.",
    "rationale": "A\tcontainer\trunning\twith\tthe\tallowPrivilegeEscalation\tflag\tset\tto\ttrue\tmay\thave processes\tthat\tcan\tgain\tmore\tprivileges\tthan\ttheir\tparent. There\tshould\tbe\tat\tleast\tone\tPodSecurityPolicy\t(PSP)\tdefined\twhich\tdoes\tnot\tpermit containers\tto\tallow\tprivilege\tescalation.\tThe\toption\texists\t(and\tis\tdefaulted\tto\ttrue)\tto permit\tsetuid\tbinaries\tto\trun. If\tyou\thave\tneed\tto\trun\tcontainers\twhich\tuse\tsetuid\tbinaries\tor\trequire\tprivilege\tescalation, this\tshould\tbe\tdefined\tin\ta\tseparate\tPSP\tand\tyou\tshould\tcarefully\tcheck\tRBAC\tcontrols\tto ensure\tthat\tonly\tlimited\tservice\taccounts\tand\tusers\tare\tgiven\tpermission\tto\taccess\tthat PSP. Impact: Pods\tdefined\twith\tspec.allowPrivilegeEscalation: true\twill\tnot\tbe\tpermitted\tunless they\tare\trun\tunder\ta\tspecific\tPSP.",
    "audit": "Get\tthe\tset\tof\tPSPs\twith\tthe\tfollowing\tcommand: kubectl get psp For\teach\tPSP,\tcheck\twhether\tprivileged\tis\tenabled: kubectl get psp <name> -o=jsonpath='{.spec.allowPrivilegeEscalation}' Verify\tthat\tthere\tis\tat\tleast\tone\tPSP\twhich\tdoes\tnot\treturn\ttrue.",
    "remediation": "222\t|\tP a g e Create\ta\tPSP\tas\tdescribed\tin\tthe\tKubernetes\tdocumentation,\tensuring\tthat\tthe .spec.allowPrivilegeEscalation\tfield\tis\tomitted\tor\tset\tto\tfalse. Default\tValue: By\tdefault,\tPodSecurityPolicies\tare\tnot\tdefined. References: 1. https://kubernetes.io/docs/concepts/policy/pod-security-policy CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 223\t|\tP a g e",
    "impact": "Pods\tdefined\twith\tspec.allowPrivilegeEscalation: true\twill\tnot\tbe\tpermitted\tunless they\tare\trun\tunder\ta\tspecific\tPSP.",
    "references": "1. https://kubernetes.io/docs/concepts/policy/pod-security-policy CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 223\t|\tP a g e",
    "function_names": [
      "kubernetes_pod_allow_privilege_escalation_disabled",
      "kubernetes_container_privilege_escalation_blocked",
      "kubernetes_workload_privilege_escalation_restricted",
      "kubernetes_deployment_privilege_escalation_denied",
      "kubernetes_namespace_privilege_escalation_prohibited"
    ]
  },
  {
    "id": "5.2.6",
    "title": "Minimize the admission of root containers",
    "assessment": "Manual",
    "description": "Do\tnot\tgenerally\tpermit\tcontainers\tto\tbe\trun\tas\tthe\troot\tuser.",
    "rationale": "Containers\tmay\trun\tas\tany\tLinux\tuser.\tContainers\twhich\trun\tas\tthe\troot\tuser,\twhilst constrained\tby\tContainer\tRuntime\tsecurity\tfeatures\tstill\thave\ta\tescalated\tlikelihood\tof container\tbreakout. Ideally,\tall\tcontainers\tshould\trun\tas\ta\tdefined\tnon-UID\t0\tuser. There\tshould\tbe\tat\tleast\tone\tPodSecurityPolicy\t(PSP)\tdefined\twhich\tdoes\tnot\tpermit\troot users\tin\ta\tcontainer. If\tyou\tneed\tto\trun\troot\tcontainers,\tthis\tshould\tbe\tdefined\tin\ta\tseparate\tPSP\tand\tyou\tshould carefully\tcheck\tRBAC\tcontrols\tto\tensure\tthat\tonly\tlimited\tservice\taccounts\tand\tusers\tare given\tpermission\tto\taccess\tthat\tPSP. Impact: Pods\twith\tcontainers\twhich\trun\tas\tthe\troot\tuser\twill\tnot\tbe\tpermitted.",
    "audit": "Get\tthe\tset\tof\tPSPs\twith\tthe\tfollowing\tcommand: kubectl get psp For\teach\tPSP,\tcheck\twhether\trunning\tcontainers\tas\troot\tis\tenabled: kubectl get psp <name> -o=jsonpath='{.spec.runAsUser.rule}' Verify\tthat\tthere\tis\tat\tleast\tone\tPSP\twhich\treturns\tMustRunAsNonRoot\tor\tMustRunAs\twith\tthe range\tof\tUIDs\tnot\tincluding\t0.",
    "remediation": "224\t|\tP a g e Create\ta\tPSP\tas\tdescribed\tin\tthe\tKubernetes\tdocumentation,\tensuring\tthat\tthe .spec.runAsUser.rule\tis\tset\tto\teither\tMustRunAsNonRoot\tor\tMustRunAs\twith\tthe\trange\tof UIDs\tnot\tincluding\t0. Default\tValue: By\tdefault,\tPodSecurityPolicies\tare\tnot\tdefined. References: 1. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod- security-policies CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 225\t|\tP a g e",
    "impact": "Pods\twith\tcontainers\twhich\trun\tas\tthe\troot\tuser\twill\tnot\tbe\tpermitted.",
    "references": "1. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod- security-policies CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 225\t|\tP a g e",
    "function_names": [
      "compute_container_root_user_disabled",
      "compute_container_root_privileges_restricted",
      "compute_container_non_root_user_required",
      "compute_container_root_admission_minimized",
      "compute_container_root_execution_prohibited"
    ]
  },
  {
    "id": "5.2.7",
    "title": "Minimize the admission of containers with the NET_RAW capability",
    "assessment": "Manual",
    "description": "Do\tnot\tgenerally\tpermit\tcontainers\twith\tthe\tpotentially\tdangerous\tNET_RAW\tcapability.",
    "rationale": "Containers\trun\twith\ta\tdefault\tset\tof\tcapabilities\tas\tassigned\tby\tthe\tContainer\tRuntime.\tBy default\tthis\tcan\tinclude\tpotentially\tdangerous\tcapabilities.\tWith\tDocker\tas\tthe\tcontainer runtime\tthe\tNET_RAW\tcapability\tis\tenabled\twhich\tmay\tbe\tmisused\tby\tmalicious containers. Ideally,\tall\tcontainers\tshould\tdrop\tthis\tcapability. There\tshould\tbe\tat\tleast\tone\tPodSecurityPolicy\t(PSP)\tdefined\twhich\tprevents\tcontainers with\tthe\tNET_RAW\tcapability\tfrom\tlaunching. If\tyou\tneed\tto\trun\tcontainers\twith\tthis\tcapability,\tthis\tshould\tbe\tdefined\tin\ta\tseparate\tPSP and\tyou\tshould\tcarefully\tcheck\tRBAC\tcontrols\tto\tensure\tthat\tonly\tlimited\tservice\taccounts and\tusers\tare\tgiven\tpermission\tto\taccess\tthat\tPSP. Impact: Pods\twith\tcontainers\twhich\trun\twith\tthe\tNET_RAW\tcapability\twill\tnot\tbe\tpermitted.",
    "audit": "Get\tthe\tset\tof\tPSPs\twith\tthe\tfollowing\tcommand: kubectl get psp For\teach\tPSP,\tcheck\twhether\tNET_RAW\tis\tdisabled: kubectl get psp <name> -o=jsonpath='{.spec.requiredDropCapabilities}' Verify\tthat\tthere\tis\tat\tleast\tone\tPSP\twhich\treturns\tNET_RAW\tor\tALL.",
    "remediation": "226\t|\tP a g e Create\ta\tPSP\tas\tdescribed\tin\tthe\tKubernetes\tdocumentation,\tensuring\tthat\tthe .spec.requiredDropCapabilities\tis\tset\tto\tinclude\teither\tNET_RAW\tor\tALL. Default\tValue: By\tdefault,\tPodSecurityPolicies\tare\tnot\tdefined. References: 1. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod- security-policies 2. https://www.nccgroup.trust/uk/our-research/abusing-privileged-and- unprivileged-linux-containers/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 227\t|\tP a g e",
    "impact": "Pods\twith\tcontainers\twhich\trun\twith\tthe\tNET_RAW\tcapability\twill\tnot\tbe\tpermitted.",
    "references": "1. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod- security-policies 2. https://www.nccgroup.trust/uk/our-research/abusing-privileged-and- unprivileged-linux-containers/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 227\t|\tP a g e",
    "function_names": [
      "compute_container_net_raw_capability_disabled",
      "compute_container_net_raw_capability_restricted",
      "compute_container_net_raw_capability_minimized",
      "compute_container_net_raw_capability_denied",
      "compute_container_net_raw_capability_prohibited"
    ]
  },
  {
    "id": "5.2.8",
    "title": "Minimize the admission of containers with added capabilities",
    "assessment": "Manual",
    "description": "Do\tnot\tgenerally\tpermit\tcontainers\twith\tcapabilities\tassigned\tbeyond\tthe\tdefault\tset.",
    "rationale": "Containers\trun\twith\ta\tdefault\tset\tof\tcapabilities\tas\tassigned\tby\tthe\tContainer\tRuntime. Capabilities\toutside\tthis\tset\tcan\tbe\tadded\tto\tcontainers\twhich\tcould\texpose\tthem\tto\trisks\tof container\tbreakout\tattacks. There\tshould\tbe\tat\tleast\tone\tPodSecurityPolicy\t(PSP)\tdefined\twhich\tprevents\tcontainers with\tcapabilities\tbeyond\tthe\tdefault\tset\tfrom\tlaunching. If\tyou\tneed\tto\trun\tcontainers\twith\tadditional\tcapabilities,\tthis\tshould\tbe\tdefined\tin\ta separate\tPSP\tand\tyou\tshould\tcarefully\tcheck\tRBAC\tcontrols\tto\tensure\tthat\tonly\tlimited service\taccounts\tand\tusers\tare\tgiven\tpermission\tto\taccess\tthat\tPSP. Impact: Pods\twith\tcontainers\twhich\trequire\tcapabilities\toutwith\tthe\tdefault\tset\twill\tnot\tbe permitted.",
    "audit": "Get\tthe\tset\tof\tPSPs\twith\tthe\tfollowing\tcommand: kubectl get psp Verify\tthat\tthere\tare\tno\tPSPs\tpresent\twhich\thave\tallowedCapabilities\tset\tto\tanything other\tthan\tan\tempty\tarray.",
    "remediation": "Ensure\tthat\tallowedCapabilities\tis\tnot\tpresent\tin\tPSPs\tfor\tthe\tcluster\tunless\tit\tis\tset\tto\tan empty\tarray. Default\tValue: 228\t|\tP a g e By\tdefault,\tPodSecurityPolicies\tare\tnot\tdefined. References: 1. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod- security-policies 2. https://www.nccgroup.trust/uk/our-research/abusing-privileged-and- unprivileged-linux-containers/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 229\t|\tP a g e",
    "impact": "Pods\twith\tcontainers\twhich\trequire\tcapabilities\toutwith\tthe\tdefault\tset\twill\tnot\tbe permitted.",
    "references": "1. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod- security-policies 2. https://www.nccgroup.trust/uk/our-research/abusing-privileged-and- unprivileged-linux-containers/ CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 229\t|\tP a g e",
    "function_names": [
      "compute_container_default_capabilities_only",
      "compute_container_added_capabilities_minimized",
      "compute_container_capabilities_restricted_to_default",
      "compute_container_no_added_capabilities",
      "compute_container_capabilities_default_only"
    ]
  },
  {
    "id": "5.2.9",
    "title": "Minimize the admission of containers with capabilities assigned",
    "assessment": "Manual",
    "description": "There\tare\ta\tvariety\tof\tCNI\tplugins\tavailable\tfor\tKubernetes.\tIf\tthe\tCNI\tin\tuse\tdoes\tnot support\tNetwork\tPolicies\tit\tmay\tnot\tbe\tpossible\tto\teffectively\trestrict\ttraffic\tin\tthe\tcluster.",
    "rationale": "Kubernetes\tnetwork\tpolicies\tare\tenforced\tby\tthe\tCNI\tplugin\tin\tuse.\tAs\tsuch\tit\tis\timportant to\tensure\tthat\tthe\tCNI\tplugin\tsupports\tboth\tIngress\tand\tEgress\tnetwork\tpolicies. Impact: None",
    "audit": "Review\tthe\tdocumentation\tof\tCNI\tplugin\tin\tuse\tby\tthe\tcluster,\tand\tconfirm\tthat\tit\tsupports Ingress\tand\tEgress\tnetwork\tpolicies.",
    "remediation": "If\tthe\tCNI\tplugin\tin\tuse\tdoes\tnot\tsupport\tnetwork\tpolicies,\tconsideration\tshould\tbe\tgiven\tto making\tuse\tof\ta\tdifferent\tplugin,\tor\tfinding\tan\talternate\tmechanism\tfor\trestricting\ttraffic\tin the\tKubernetes\tcluster. Default\tValue: This\twill\tdepend\ton\tthe\tCNI\tplugin\tin\tuse. References: 1. https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage- net/network-plugins/ Additional\tInformation: 232\t|\tP a g e One\texample\there\tis\tFlannel\t(https://github.com/coreos/flannel)\twhich\tdoes\tnot\tsupport Network\tpolicy\tunless\tCalico\tis\talso\tin\tuse. CIS\tControls: Version\t6 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Version\t7 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices 233\t|\tP a g e",
    "impact": "None",
    "references": "1. https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage- net/network-plugins/ Additional\tInformation: 232\t|\tP a g e One\texample\there\tis\tFlannel\t(https://github.com/coreos/flannel)\twhich\tdoes\tnot\tsupport Network\tpolicy\tunless\tCalico\tis\talso\tin\tuse. CIS\tControls: Version\t6 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Version\t7 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices 233\t|\tP a g e",
    "function_names": [
      "kubernetes_pod_capabilities_minimized",
      "kubernetes_container_capabilities_restricted",
      "kubernetes_admission_capabilities_limited",
      "kubernetes_workload_capabilities_reduced",
      "kubernetes_namespace_capabilities_controlled"
    ]
  },
  {
    "id": "5.3.2",
    "title": "Ensure that all Namespaces have Network Policies defined",
    "assessment": "Manual",
    "description": "Kubernetes\tsupports\tmounting\tsecrets\tas\tdata\tvolumes\tor\tas\tenvironment\tvariables. Minimize\tthe\tuse\tof\tenvironment\tvariable\tsecrets.",
    "rationale": "It\tis\treasonably\tcommon\tfor\tapplication\tcode\tto\tlog\tout\tits\tenvironment\t(particularly\tin\tthe event\tof\tan\terror).\tThis\twill\tinclude\tany\tsecret\tvalues\tpassed\tin\tas\tenvironment\tvariables, so\tsecrets\tcan\teasily\tbe\texposed\tto\tany\tuser\tor\tentity\twho\thas\taccess\tto\tthe\tlogs. Impact: Application\tcode\twhich\texpects\tto\tread\tsecrets\tin\tthe\tform\tof\tenvironment\tvariables\twould need\tmodification",
    "audit": "Run\tthe\tfollowing\tcommand\tto\tfind\treferences\tto\tobjects\twhich\tuse\tenvironment\tvariables defined\tfrom\tsecrets. kubectl get all -o jsonpath='{range .items[?(@..secretKeyRef)]} {.kind} {.metadata.name} {\"\\n\"}{end}' -A",
    "remediation": "If\tpossible,\trewrite\tapplication\tcode\tto\tread\tsecrets\tfrom\tmounted\tsecret\tfiles,\trather\tthan from\tenvironment\tvariables. Default\tValue: By\tdefault,\tsecrets\tare\tnot\tdefined References: 236\t|\tP a g e 1. https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets Additional\tInformation: Mounting\tsecrets\tas\tvolumes\thas\tthe\tadditional\tbenefit\tthat\tsecret\tvalues\tcan\tbe\tupdated without\trestarting\tthe\tpod CIS\tControls: Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 14.8\tEncrypt\tSensitive\tInformation\tat\tRest Encrypt\tall\tsensitive\tinformation\tat\trest\tusing\ta\ttool\tthat\trequires\ta\tsecondary authentication\tmechanism\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto\taccess\tthe information. 237\t|\tP a g e",
    "impact": "Application\tcode\twhich\texpects\tto\tread\tsecrets\tin\tthe\tform\tof\tenvironment\tvariables\twould need\tmodification",
    "references": "236\t|\tP a g e 1. https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets Additional\tInformation: Mounting\tsecrets\tas\tvolumes\thas\tthe\tadditional\tbenefit\tthat\tsecret\tvalues\tcan\tbe\tupdated without\trestarting\tthe\tpod CIS\tControls: Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 14.8\tEncrypt\tSensitive\tInformation\tat\tRest Encrypt\tall\tsensitive\tinformation\tat\trest\tusing\ta\ttool\tthat\trequires\ta\tsecondary authentication\tmechanism\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto\taccess\tthe information. 237\t|\tP a g e"
  },
  {
    "id": "5.4.2",
    "title": "Consider external secret storage",
    "assessment": "Manual",
    "description": "Configure\tImage\tProvenance\tfor\tyour\tdeployment.",
    "rationale": "Kubernetes\tsupports\tplugging\tin\tprovenance\trules\tto\taccept\tor\treject\tthe\timages\tin\tyour deployments.\tYou\tcould\tconfigure\tsuch\trules\tto\tensure\tthat\tonly\tapproved\timages\tare deployed\tin\tthe\tcluster. Impact: You\tneed\tto\tregularly\tmaintain\tyour\tprovenance\tconfiguration\tbased\ton\tcontainer\timage updates.",
    "audit": "Review\tthe\tpod\tdefinitions\tin\tyour\tcluster\tand\tverify\tthat\timage\tprovenance\tis\tconfigured as\tappropriate.",
    "remediation": "Follow\tthe\tKubernetes\tdocumentation\tand\tsetup\timage\tprovenance. Default\tValue: By\tdefault,\timage\tprovenance\tis\tnot\tset. References: 1. https://kubernetes.io/docs/admin/admission-controllers/#imagepolicywebhook 2. https://github.com/kubernetes/community/blob/master/contributors/design- proposals/image-provenance.md 3. https://hub.docker.com/r/dnurmi/anchore-toolbox/ 4. https://github.com/kubernetes/kubernetes/issues/22888 239\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 18\tApplication\tSoftware\tSecurity Application\tSoftware\tSecurity Version\t7 18\tApplication\tSoftware\tSecurity Application\tSoftware\tSecurity 240\t|\tP a g e 5.6 General Policies These\tpolicies\trelate\tto\tgeneral\tcluster\tmanagement\ttopics,\tlike\tnamespace\tbest\tpractices and\tpolicies\tapplied\tto\tpod\tobjects\tin\tthe\tcluster.",
    "impact": "You\tneed\tto\tregularly\tmaintain\tyour\tprovenance\tconfiguration\tbased\ton\tcontainer\timage updates.",
    "references": "1. https://kubernetes.io/docs/admin/admission-controllers/#imagepolicywebhook 2. https://github.com/kubernetes/community/blob/master/contributors/design- proposals/image-provenance.md 3. https://hub.docker.com/r/dnurmi/anchore-toolbox/ 4. https://github.com/kubernetes/kubernetes/issues/22888 239\t|\tP a g e Additional\tInformation: This\tcontrol\tcannot\tbe\taudited\tand\tmodified\tin\tACK\tmanaged\tclusters. CIS\tControls: Version\t6 18\tApplication\tSoftware\tSecurity Application\tSoftware\tSecurity Version\t7 18\tApplication\tSoftware\tSecurity Application\tSoftware\tSecurity 240\t|\tP a g e 5.6 General Policies These\tpolicies\trelate\tto\tgeneral\tcluster\tmanagement\ttopics,\tlike\tnamespace\tbest\tpractices and\tpolicies\tapplied\tto\tpod\tobjects\tin\tthe\tcluster.",
    "function_names": [
      "compute_image_provenance_configured",
      "compute_image_external_secret_storage_enabled",
      "compute_deployment_secret_storage_external",
      "compute_image_secret_storage_configured",
      "compute_deployment_provenance_verified"
    ]
  },
  {
    "id": "5.6.1",
    "title": "Create administrative boundaries between resources using namespaces",
    "assessment": "Manual",
    "description": "Use\tnamespaces\tto\tisolate\tyour\tKubernetes\tobjects.",
    "rationale": "Limiting\tthe\tscope\tof\tuser\tpermissions\tcan\treduce\tthe\timpact\tof\tmistakes\tor\tmalicious activities.\tA\tKubernetes\tnamespace\tallows\tyou\tto\tpartition\tcreated\tresources\tinto\tlogically named\tgroups.\tResources\tcreated\tin\tone\tnamespace\tcan\tbe\thidden\tfrom\tother\tnamespaces. By\tdefault,\teach\tresource\tcreated\tby\ta\tuser\tin\tKubernetes\tcluster\truns\tin\ta\tdefault namespace,\tcalled\tdefault.\tYou\tcan\tcreate\tadditional\tnamespaces\tand\tattach\tresources\tand users\tto\tthem.\tYou\tcan\tuse\tKubernetes\tAuthorization\tplugins\tto\tcreate\tpolicies\tthat segregate\taccess\tto\tnamespace\tresources\tbetween\tdifferent\tusers. Impact: You\tneed\tto\tswitch\tbetween\tnamespaces\tfor\tadministration.",
    "audit": "Run\tthe\tbelow\tcommand\tand\treview\tthe\tnamespaces\tcreated\tin\tthe\tcluster. kubectl get namespaces Ensure\tthat\tthese\tnamespaces\tare\tthe\tones\tyou\tneed\tand\tare\tadequately\tadministered\tas per\tyour\trequirements.",
    "remediation": "Follow\tthe\tdocumentation\tand\tcreate\tnamespaces\tfor\tobjects\tin\tyour\tdeployment\tas\tyou need\tthem. 241\t|\tP a g e Default\tValue: By\tdefault,\tKubernetes\tstarts\twith\ttwo\tinitial\tnamespaces: 1. default\t-\tThe\tdefault\tnamespace\tfor\tobjects\twith\tno\tother\tnamespace 2. kube-system\t-\tThe\tnamespace\tfor\tobjects\tcreated\tby\tthe\tKubernetes\tsystem References: 1. https://kubernetes.io/docs/concepts/overview/working-with- objects/namespaces/ 2. http://blog.kubernetes.io/2016/08/security-best-practices-kubernetes- deployment.html CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 242\t|\tP a g e",
    "impact": "You\tneed\tto\tswitch\tbetween\tnamespaces\tfor\tadministration.",
    "references": "1. https://kubernetes.io/docs/concepts/overview/working-with- objects/namespaces/ 2. http://blog.kubernetes.io/2016/08/security-best-practices-kubernetes- deployment.html CIS\tControls: Version\t6 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Version\t7 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 242\t|\tP a g e",
    "function_names": [
      "kubernetes_namespace_isolation_enabled",
      "kubernetes_namespace_boundaries_enforced",
      "kubernetes_namespace_administrative_separation_required",
      "kubernetes_namespace_resource_isolation_configured",
      "kubernetes_namespace_security_boundaries_defined"
    ]
  },
  {
    "id": "5.6.2",
    "title": "Ensure that the seccomp profile is set to runtime/default in your pod definitions",
    "assessment": "Manual",
    "description": "Enable\truntime/default\tseccomp\tprofile\tin\tyour\tpod\tdefinitions.",
    "rationale": "Seccomp\t(secure\tcomputing\tmode)\tis\tused\tto\trestrict\tthe\tset\tof\tsystem\tcalls\tapplications can\tmake,\tallowing\tcluster\tadministrators\tgreater\tcontrol\tover\tthe\tsecurity\tof\tworkloads running\tin\tthe\tcluster.\tKubernetes\tdisables\tseccomp\tprofiles\tby\tdefault\tfor\thistorical reasons.\tYou\tshould\tenable\tit\tto\tensure\tthat\tthe\tworkloads\thave\trestricted\tactions\tavailable within\tthe\tcontainer. Impact: If\tthe\truntime/default\tseccomp\tprofile\tis\ttoo\trestrictive\tfor\tyou,\tyou\twould\thave\tto create/manage\tyour\town\tseccomp\tprofiles.\tAlso,\tyou\tneed\tto\tenable\tall\talpha\tfeatures\tfor this\tto\twork.\tThere\tis\tno\tindividual\tswitch\tto\tturn\ton\tthis\tfeature.",
    "audit": "Review\tthe\tpod\tdefinitions\tin\tyour\tcluster.\tIt\tshould\tcreate\ta\tline\tas\tbelow: annotations: seccomp.security.alpha.kubernetes.io/pod: runtime/default",
    "remediation": "Seccomp\tis\tan\talpha\tfeature\tcurrently.\tBy\tdefault,\tall\talpha\tfeatures\tare\tdisabled.\tSo,\tyou would\tneed\tto\tenable\talpha\tfeatures\tin\tthe\tapiserver\tby\tpassing\t\"--feature- gates=AllAlpha=true\"\targument. Edit\tthe\t/etc/kubernetes/apiserver\tfile\ton\tthe\tmaster\tnode\tand\tset\tthe\tKUBE_API_ARGS parameter\tto\t\"--feature-gates=AllAlpha=true\" KUBE_API_ARGS=\"--feature-gates=AllAlpha=true\" Based\ton\tyour\tsystem,\trestart\tthe\tkube-apiserver\tservice.\tFor\texample: 243\t|\tP a g e systemctl restart kube-apiserver.service Use\tannotations\tto\tenable\tthe\tdocker/default\tseccomp\tprofile\tin\tyour\tpod\tdefinitions.\tAn example\tis\tas\tbelow: apiVersion: v1 kind: Pod metadata: name: trustworthy-pod annotations: seccomp.security.alpha.kubernetes.io/pod: runtime/default spec: containers: - name: trustworthy-container image: sotrustworthy:latest Default\tValue: By\tdefault,\tseccomp\tprofile\tis\tset\tto\tunconfined\twhich\tmeans\tthat\tno\tseccomp\tprofiles\tare enabled. References: 1. https://github.com/kubernetes/kubernetes/issues/39845 2. https://github.com/kubernetes/kubernetes/pull/21790 3. https://github.com/kubernetes/community/blob/master/contributors/design- proposals/seccomp.md#examples 4. https://docs.docker.com/engine/security/seccomp/ 5. https://kubernetes.io/docs/tutorials/clusters/seccomp/ CIS\tControls: Version\t6 5\tControlled\tUse\tof\tAdministration\tPrivileges Controlled\tUse\tof\tAdministration\tPrivileges Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 244\t|\tP a g e",
    "impact": "If\tthe\truntime/default\tseccomp\tprofile\tis\ttoo\trestrictive\tfor\tyou,\tyou\twould\thave\tto create/manage\tyour\town\tseccomp\tprofiles.\tAlso,\tyou\tneed\tto\tenable\tall\talpha\tfeatures\tfor this\tto\twork.\tThere\tis\tno\tindividual\tswitch\tto\tturn\ton\tthis\tfeature.",
    "references": "1. https://github.com/kubernetes/kubernetes/issues/39845 2. https://github.com/kubernetes/kubernetes/pull/21790 3. https://github.com/kubernetes/community/blob/master/contributors/design- proposals/seccomp.md#examples 4. https://docs.docker.com/engine/security/seccomp/ 5. https://kubernetes.io/docs/tutorials/clusters/seccomp/ CIS\tControls: Version\t6 5\tControlled\tUse\tof\tAdministration\tPrivileges Controlled\tUse\tof\tAdministration\tPrivileges Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 244\t|\tP a g e",
    "function_names": [
      "kubernetes_pod_seccomp_profile_runtime_default",
      "kubernetes_pod_seccomp_profile_default_enabled",
      "kubernetes_pod_security_seccomp_runtime_default",
      "kubernetes_pod_security_seccomp_profile_default",
      "kubernetes_pod_seccomp_runtime_default_enabled"
    ]
  },
  {
    "id": "5.6.3",
    "title": "Apply Security Context to Your Pods and Containers",
    "assessment": "Manual",
    "description": "Apply\tSecurity\tContext\tto\tYour\tPods\tand\tContainers",
    "rationale": "A\tsecurity\tcontext\tdefines\tthe\toperating\tsystem\tsecurity\tsettings\t(uid,\tgid,\tcapabilities, SELinux\trole,\tetc..)\tapplied\tto\ta\tcontainer.\tWhen\tdesigning\tyour\tcontainers\tand\tpods,\tmake sure\tthat\tyou\tconfigure\tthe\tsecurity\tcontext\tfor\tyour\tpods,\tcontainers,\tand\tvolumes.\tA security\tcontext\tis\ta\tproperty\tdefined\tin\tthe\tdeployment\tyaml.\tIt\tcontrols\tthe\tsecurity parameters\tthat\twill\tbe\tassigned\tto\tthe\tpod/container/volume.\tThere\tare\ttwo\tlevels\tof security\tcontext:\tpod\tlevel\tsecurity\tcontext,\tand\tcontainer\tlevel\tsecurity\tcontext. Impact: If\tyou\tincorrectly\tapply\tsecurity\tcontexts,\tyou\tmay\thave\ttrouble\trunning\tthe\tpods.",
    "audit": "Review\tthe\tpod\tdefinitions\tin\tyour\tcluster\tand\tverify\tthat\tyou\thave\tsecurity\tcontexts defined\tas\tappropriate.",
    "remediation": "Follow\tthe\tKubernetes\tdocumentation\tand\tapply\tsecurity\tcontexts\tto\tyour\tpods.\tFor\ta suggested\tlist\tof\tsecurity\tcontexts,\tyou\tmay\trefer\tto\tthe\tCIS\tSecurity\tBenchmark\tfor\tDocker Containers. Default\tValue: By\tdefault,\tno\tsecurity\tcontexts\tare\tautomatically\tapplied\tto\tpods. References: 1. https://kubernetes.io/docs/concepts/policy/security-context/ 2. https://learn.cisecurity.org/benchmarks CIS\tControls: 245\t|\tP a g e Version\t6 3\tSecure\tConfigurations\tfor\tHardware\tand\tSoftware\ton\tMobile\tDevices,\tLaptops, Workstations,\tand\tServers Secure\tConfigurations\tfor\tHardware\tand\tSoftware\ton\tMobile\tDevices,\tLaptops, Workstations,\tand\tServers Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 246\t|\tP a g e",
    "impact": "If\tyou\tincorrectly\tapply\tsecurity\tcontexts,\tyou\tmay\thave\ttrouble\trunning\tthe\tpods.",
    "references": "1. https://kubernetes.io/docs/concepts/policy/security-context/ 2. https://learn.cisecurity.org/benchmarks CIS\tControls: 245\t|\tP a g e Version\t6 3\tSecure\tConfigurations\tfor\tHardware\tand\tSoftware\ton\tMobile\tDevices,\tLaptops, Workstations,\tand\tServers Secure\tConfigurations\tfor\tHardware\tand\tSoftware\ton\tMobile\tDevices,\tLaptops, Workstations,\tand\tServers Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 246\t|\tP a g e",
    "function_names": [
      "kubernetes_pod_security_context_configured",
      "kubernetes_container_security_context_configured",
      "kubernetes_pod_read_only_root_filesystem_enabled",
      "kubernetes_container_read_only_root_filesystem_enabled",
      "kubernetes_pod_run_as_non_root_enabled",
      "kubernetes_container_run_as_non_root_enabled",
      "kubernetes_pod_privilege_escalation_disabled",
      "kubernetes_container_privilege_escalation_disabled",
      "kubernetes_pod_capabilities_dropped",
      "kubernetes_container_capabilities_dropped"
    ]
  },
  {
    "id": "5.6.4",
    "title": "The default namespace should not be used",
    "assessment": "Manual",
    "description": "Kubernetes\tprovides\ta\tdefault\tnamespace,\twhere\tobjects\tare\tplaced\tif\tno\tnamespace\tis specified\tfor\tthem.\tPlacing\tobjects\tin\tthis\tnamespace\tmakes\tapplication\tof\tRBAC\tand\tother controls\tmore\tdifficult.",
    "rationale": "Resources\tin\ta\tKubernetes\tcluster\tshould\tbe\tsegregated\tby\tnamespace,\tto\tallow\tfor\tsecurity controls\tto\tbe\tapplied\tat\tthat\tlevel\tand\tto\tmake\tit\teasier\tto\tmanage\tresources. Impact: None",
    "audit": "Run\tthis\tcommand\tto\tlist\tobjects\tin\tdefault\tnamespace kubectl get all The\tonly\tentries\tthere\tshould\tbe\tsystem\tmanaged\tresources\tsuch\tas\tthe\tkubernetes\tservice",
    "remediation": "Ensure\tthat\tnamespaces\tare\tcreated\tto\tallow\tfor\tappropriate\tsegregation\tof\tKubernetes resources\tand\tthat\tall\tnew\tresources\tare\tcreated\tin\ta\tspecific\tnamespace. Default\tValue: Unless\ta\tnamespace\tis\tspecific\ton\tobject\tcreation,\tthe\tdefault\tnamespace\twill\tbe\tused CIS\tControls: Version\t6 5.1\tMinimize\tAnd\tSparingly\tUse\tAdministrative\tPrivileges Minimize\tadministrative\tprivileges\tand\tonly\tuse\tadministrative\taccounts\twhen\tthey\tare 247\t|\tP a g e required.\tImplement\tfocused\tauditing\ton\tthe\tuse\tof\tadministrative\tprivileged\tfunctions\tand monitor\tfor\tanomalous\tbehavior. Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 6 Managed services This\tsection\tconsists\tof\tsecurity\trecommendations\tfor\tthe\tdirect\tconfiguration\tof Kubernetes\tmanaged\tservice\tcomponents,\tnamely,\tAlibaba\tCloud\tContainer\tService\tfor Kubernetes\t(ACK).\tThese\trecommendations\tare\tdirectly\tapplicable\tfor\tfeatures\twhich\texist only\tas\tpart\tof\ta\tmanaged\tservice. 248\t|\tP a g e 6.1 Image Registry and Image Scanning This\tsection\tcontains\trecommendations\trelating\tto\tcontainer\timage\tregistries\tand\tsecuring images\tin\tthose\tregistries,\tsuch\tas\tAlibaba\tCloud\tContainer\tRegistry\t(ACR).",
    "impact": "None",
    "function_names": [
      "kubernetes_namespace_not_default",
      "kubernetes_namespace_default_denied",
      "kubernetes_namespace_non_default_required",
      "kubernetes_namespace_default_restricted",
      "kubernetes_namespace_no_default_usage"
    ]
  },
  {
    "id": "6.1.1",
    "title": "Ensure Image Vulnerability Scanning using ACR image scanning or a third party provider",
    "assessment": "Manual",
    "description": "Scan\timages\tstored\tin\tAlibaba\tCloud\tContainer\tRegistry\t(ACR)\tfor\tvulnerabilities.",
    "rationale": "Vulnerabilities\tin\tsoftware\tpackages\tcan\tbe\texploited\tby\thackers\tor\tmalicious\tusers\tto obtain\tunauthorized\taccess\tto\tlocal\tcloud\tresources.\tACR\tContainer\tAnalysis\tand\tother third\tparty\tproducts\tallow\timages\tstored\tin\tACR\tto\tbe\tscanned\tfor\tknown\tvulnerabilities. Impact: None.",
    "audit": "Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACR\tby\tvisiting\thttps://cr.console.aliyun.com/ 2. Configure\tthe\tbasic\tinformation\tof\tchain 3. Configure\timage\tsecurity\tscanning\trule",
    "remediation": "Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACR\tby\tvisiting\thttps://cr.console.aliyun.com/ 2. Configure\tthe\tbasic\tinformation\tof\tchain 3. Configure\timage\tsecurity\tscanning\trule Default\tValue: 249\t|\tP a g e By\tdefault,\tACR\tContainer\tAnalysis\tis\tdisabled. References: 1. https://www.alibabacloud.com/help/doc-detail/160146.htm CIS\tControls: Version\t7 3\tContinuous\tVulnerability\tManagement Continuous\tVulnerability\tManagement 3.1\tRun\tAutomated\tVulnerability\tScanning\tTools Utilize\tan\tup-to-date\tSCAP-compliant\tvulnerability\tscanning\ttool\tto\tautomatically\tscan\tall systems\ton\tthe\tnetwork\ton\ta\tweekly\tor\tmore\tfrequent\tbasis\tto\tidentify\tall\tpotential vulnerabilities\ton\tthe\torganization's\tsystems. 3.2\tPerform\tAuthenticated\tVulnerability\tScanning Perform\tauthenticated\tvulnerability\tscanning\twith\tagents\trunning\tlocally\ton\teach\tsystem or\twith\tremote\tscanners\tthat\tare\tconfigured\twith\televated\trights\ton\tthe\tsystem\tbeing tested. 250\t|\tP a g e",
    "impact": "None.",
    "references": "1. https://www.alibabacloud.com/help/doc-detail/160146.htm CIS\tControls: Version\t7 3\tContinuous\tVulnerability\tManagement Continuous\tVulnerability\tManagement 3.1\tRun\tAutomated\tVulnerability\tScanning\tTools Utilize\tan\tup-to-date\tSCAP-compliant\tvulnerability\tscanning\ttool\tto\tautomatically\tscan\tall systems\ton\tthe\tnetwork\ton\ta\tweekly\tor\tmore\tfrequent\tbasis\tto\tidentify\tall\tpotential vulnerabilities\ton\tthe\torganization's\tsystems. 3.2\tPerform\tAuthenticated\tVulnerability\tScanning Perform\tauthenticated\tvulnerability\tscanning\twith\tagents\trunning\tlocally\ton\teach\tsystem or\twith\tremote\tscanners\tthat\tare\tconfigured\twith\televated\trights\ton\tthe\tsystem\tbeing tested. 250\t|\tP a g e",
    "function_names": [
      "acr_image_vulnerability_scanning_enabled",
      "acr_image_scanning_third_party_integrated",
      "acr_image_scan_results_monitored",
      "acr_image_scan_frequency_regular",
      "acr_image_scan_high_severity_alerts_enabled"
    ]
  },
  {
    "id": "6.1.2",
    "title": "Minimize user access to ACR",
    "assessment": "Manual",
    "description": "Restrict\tuser\taccess\tto\tACR,\tlimiting\tinteraction\twith\tbuild\timages\tto\tonly\tauthorized personnel\tand\tservice\taccounts.",
    "rationale": "Weak\taccess\tcontrol\tto\tACR\tmay\tallow\tmalicious\tusers\tto\treplace\tbuilt\timages\twith vulnerable\tcontainers. Impact: Care\tshould\tbe\ttaken\tnot\tto\tremove\taccess\tto\tACR\tfor\taccounts\tthat\trequire\tthis\tfor\ttheir operation.",
    "audit": "Follow\tthe\tACR\tdocument\tto\tcheck\tnetwork\taccess\tcontrol: https://www.alibabacloud.com/help/doc-detail/142179.htm Follow\tthe\tACR\tdocument\tto\tcheck\tResource\tAccess\tManagement\t(RAM)\tpolicies\twhich\tare related\twith\tACR: https://www.alibabacloud.com/help/doc-detail/144229.htm",
    "remediation": "Follow\tthe\tACR\tdocument\tto\tsetup\tnetwork\taccess\tcontrol: https://www.alibabacloud.com/help/doc-detail/142179.htm Follow\tthe\tACR\tdocument\tto\tsetup\tResource\tAccess\tManagement\t(RAM)\tpolicies\tfor\tACR: https://www.alibabacloud.com/help/doc-detail/144229.htm Default\tValue: By\tdefault,\tACR\tis\tdisabled\tand\taccess\tcontrols\tare\tset\tduring\tinitialisation. References: 1. https://www.alibabacloud.com/help/doc-detail/67992.htm 2. https://www.alibabacloud.com/help/doc-detail/142179.htm 3. https://www.alibabacloud.com/help/doc-detail/142247.htm 251\t|\tP a g e 4. https://www.alibabacloud.com/help/doc-detail/144229.htm CIS\tControls: Version\t7 14.6\tProtect\tInformation\tthrough\tAccess\tControl\tLists Protect\tall\tinformation\tstored\ton\tsystems\twith\tfile\tsystem,\tnetwork\tshare,\tclaims, application,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. 252\t|\tP a g e",
    "impact": "Care\tshould\tbe\ttaken\tnot\tto\tremove\taccess\tto\tACR\tfor\taccounts\tthat\trequire\tthis\tfor\ttheir operation.",
    "references": "1. https://www.alibabacloud.com/help/doc-detail/67992.htm 2. https://www.alibabacloud.com/help/doc-detail/142179.htm 3. https://www.alibabacloud.com/help/doc-detail/142247.htm 251\t|\tP a g e 4. https://www.alibabacloud.com/help/doc-detail/144229.htm CIS\tControls: Version\t7 14.6\tProtect\tInformation\tthrough\tAccess\tControl\tLists Protect\tall\tinformation\tstored\ton\tsystems\twith\tfile\tsystem,\tnetwork\tshare,\tclaims, application,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. 252\t|\tP a g e",
    "function_names": [
      "acr_registry_access_restricted",
      "acr_registry_user_access_minimized",
      "acr_registry_authorized_personnel_only",
      "acr_registry_service_accounts_only",
      "acr_registry_build_images_restricted",
      "acr_registry_unauthorized_access_blocked",
      "acr_registry_iam_policy_restricted",
      "acr_registry_access_least_privilege",
      "acr_registry_human_access_disabled",
      "acr_registry_automated_access_only"
    ]
  },
  {
    "id": "6.1.3",
    "title": "Minimize cluster access to read-only for ACR",
    "assessment": "Manual",
    "description": "Configure\tthe\tCluster\tService\tAccount\twith\tStorage\tObject\tViewer\tRole\tto\tonly\tallow\tread- only\taccess\tto\tACR.",
    "rationale": "The\tCluster\tService\tAccount\tdoes\tnot\trequire\tadministrative\taccess\tto\tACR,\tonly\trequiring pull\taccess\tto\tcontainers\tto\tdeploy\tonto\tACK.\tRestricting\tpermissions\tfollows\tthe\tprinciples of\tleast\tprivilege\tand\tprevents\tcredentials\tfrom\tbeing\tabused\tbeyond\tthe\trequired\trole. Impact: A\tseparate\tdedicated\tservice\taccount\tmay\tbe\trequired\tfor\tuse\tby\tbuild\tservers\tand\tother robot\tusers\tpushing\tor\tmanaging\tcontainer\timages",
    "audit": "Review\tAlibaba\tCloud\tECS\tmaster\tnode\tand\tworker\tnode\tRAM\troles'\tRAM\tPolicy Permissions\tto\tverify\tthat\tthey\tare\tset\tand\tthe\tminimum\trequired\tlevel. Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 2. In\tthe\tleft-side\tnavigation\tpane,\tclick Clusters . 3. On\tthe Clusters page,\tclick\tthe\tname\tof\ta\tcluster\tor\tclick Details in\tthe\tActions column.\tThe\tdetails\tpage\tof\tthe\tcluster\tappears. 4. In\tthe\tleft-side\tnavigation\tpane\tof\tthe details page,\tclick Cluster\tInformation . 5. On\tthe Cluster\tInformation page,\tclick\tthe Cluster\tResources tab\tand\tclick\tthe name\tof\tthe**\tworker\tRAM\trole**\tor master\tRAM\trole on\tthe\ttab. 6. You\tare\tthen\tredirected\tto\tthe\tRAM\tconsole.\tOn\tthe Permissions tab,\tclick\tthe\tname in\tthe Policy column. 7. On\tthe details page\tof\tthe\tpolicy,\tclick Policy\tDocument table\tto\treview\tthe\tRAM policy\tpermissions. If\tutilizing\ta\t3rd\tparty\ttool\tto\tscan\timages\tutilize\tthe\tminimum\trequired\tpermission\tlevel required\tto\tinteract\twith\tthe\tcluster\t-\tgenerally\tthis\tshould\tbe\tread-only.",
    "remediation": "253\t|\tP a g e You\tcan\tuse\tyour\tACR\timages\twith\tACK,\tbut\tyou\tneed\tto\tsatisfy\tthe\tfollowing\tprerequisites. The\tACK\tmaster\tand\tworker\tnode\tRAM\troles\tthat\tyou\tuse\twith\tyour\tmaster/worker\tnodes must\tpossess\tthe\tAliyunContainerRegistryReadOnlyAccess\tRAM\tpolicy\tpermissions\tfor ACR. Default\tValue: These\tRAM\tpermissions\tare\tapplied\tto\tyour\tACK\tmaster\tand\tworker\tnode\tRAM\troles\tby default. References: 1. https://www.alibabacloud.com/help/doc-detail/128468.htm 2. https://www.alibabacloud.com/help/doc-detail/67992.htm CIS\tControls: Version\t7 3.2\tPerform\tAuthenticated\tVulnerability\tScanning Perform\tauthenticated\tvulnerability\tscanning\twith\tagents\trunning\tlocally\ton\teach\tsystem or\twith\tremote\tscanners\tthat\tare\tconfigured\twith\televated\trights\ton\tthe\tsystem\tbeing tested. 254\t|\tP a g e",
    "impact": "A\tseparate\tdedicated\tservice\taccount\tmay\tbe\trequired\tfor\tuse\tby\tbuild\tservers\tand\tother robot\tusers\tpushing\tor\tmanaging\tcontainer\timages",
    "references": "1. https://www.alibabacloud.com/help/doc-detail/128468.htm 2. https://www.alibabacloud.com/help/doc-detail/67992.htm CIS\tControls: Version\t7 3.2\tPerform\tAuthenticated\tVulnerability\tScanning Perform\tauthenticated\tvulnerability\tscanning\twith\tagents\trunning\tlocally\ton\teach\tsystem or\twith\tremote\tscanners\tthat\tare\tconfigured\twith\televated\trights\ton\tthe\tsystem\tbeing tested. 254\t|\tP a g e",
    "function_names": [
      "container_cluster_service_account_read_only_acr",
      "container_cluster_storage_object_viewer_role",
      "container_cluster_acr_read_only_access",
      "container_cluster_service_account_minimal_acr_permissions",
      "container_cluster_acr_storage_object_viewer",
      "container_cluster_service_account_acr_read_only",
      "container_cluster_acr_access_read_only",
      "container_cluster_service_account_storage_object_viewer"
    ]
  },
  {
    "id": "6.1.4",
    "title": "Minimize Container Registries to only those approved",
    "assessment": "Manual",
    "description": "Use\tapproved\tcontainer\tregistries.",
    "rationale": "Allowing\tunrestricted\taccess\tto\texternal\tcontainer\tregistries\tprovides\tthe\topportunity\tfor malicious\tor\tunapproved\tcontainers\tto\tbe\tdeployed\tinto\tthe\tcluster.\tAllowlisting\tonly approved\tcontainer\tregistries\treduces\tthis\trisk. Impact: All\tcontainer\timages\tto\tbe\tdeployed\tto\tthe\tcluster\tmust\tbe\thosted\twithin\tan\tapproved container\timage\tregistry",
    "audit": "Remediation: References: 1. https://www.alibabacloud.com/help/doc-detail/162599.htm 2. https://www.alibabacloud.com/help/doc-detail/180803.htm CIS\tControls: Version\t7 5.2\tMaintain\tSecure\tImages Maintain\tsecure\timages\tor\ttemplates\tfor\tall\tsystems\tin\tthe\tenterprise\tbased\ton\tthe organization's\tapproved\tconfiguration\tstandards.\tAny\tnew\tsystem\tdeployment\tor\texisting system\tthat\tbecomes\tcompromised\tshould\tbe\timaged\tusing\tone\tof\tthose\timages\tor templates. 5.3\tSecurely\tStore\tMaster\tImages Store\tthe\tmaster\timages\tand\ttemplates\ton\tsecurely\tconfigured\tservers,\tvalidated\twith integrity\tmonitoring\ttools,\tto\tensure\tthat\tonly\tauthorized\tchanges\tto\tthe\timages\tare possible. 255\t|\tP a g e 6.2 Key Management Service (KMS) This\tsection\tcontains\trecommendations\trelating\tto\tusing\tCloud\tKMS\twith\tACK.",
    "remediation": null,
    "impact": "All\tcontainer\timages\tto\tbe\tdeployed\tto\tthe\tcluster\tmust\tbe\thosted\twithin\tan\tapproved container\timage\tregistry",
    "function_names": [
      "container_registry_approved_list",
      "container_registry_unapproved_denied",
      "container_registry_whitelist_enabled",
      "container_registry_approved_only",
      "container_registry_restricted_to_approved"
    ]
  },
  {
    "id": "6.2.1",
    "title": "Ensure Kubernetes Secrets are encrypted using keys managed in KMS",
    "assessment": "Manual",
    "description": "Encrypt\tKubernetes\tsecrets,\tstored\tin\tetcd,\tat\tthe\tapplication-layer\tusing\ta\tcustomer- managed\tkey\tin\tCloud\tKMS.",
    "rationale": "Kubernetes\tcan\tstore\tsecrets\tthat\tpods\tcan\taccess\tvia\ta\tmounted\tvolume.\tToday, Kubernetes\tsecrets\tare\tstored\twith\tBase64\tencoding,\tbut\tencrypting\tis\tthe\trecommended approach.\tACK\tPro\tclusters\tsupport\tthe\tcapability\tof\tencrypting\tyour\tKubernetes\tsecrets using\tKey\tManagement\tService\t(KMS)\tCustomer\tManaged\tKeys\t(CMK).\tThe\tonly requirement\tis\tto\tenable\tthe\tencryption\tprovider\tsupport\tduring\tACK\tcluster\tcreation. Use\tKey\tManagement\tService\t(KMS)\tkeys\tto\tprovide\tenvelope\tencryption\tof\tKubernetes secrets\tstored\tin\tACK.\tImplementing\tenvelope\tencryption\tis\tconsidered\ta\tsecurity\tbest practice\tfor\tapplications\tthat\tstore\tsensitive\tdata\tand\tis\tpart\tof\ta\tdefense\tin\tdepth\tsecurity strategy. Application-layer\tSecrets\tEncryption\tprovides\tan\tadditional\tlayer\tof\tsecurity\tfor\tsensitive data,\tsuch\tas\tuser\tdefined\tSecrets\tand\tSecrets\trequired\tfor\tthe\toperation\tof\tthe\tcluster, such\tas\tservice\taccount\tkeys,\twhich\tare\tall\tstored\tin\tetcd. Using\tthis\tfunctionality,\tyou\tcan\tuse\ta\tkey,\tthat\tyou\tmanage\tin\tKMS,\tto\tencrypt\tdata\tat\tthe application\tlayer.\tThis\tprotects\tagainst\tattackers\tin\tthe\tevent\tthat\tthey\tmanage\tto\tgain access\tto\tetcd.",
    "audit": "Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 256\t|\tP a g e 2. Select\tthe\tdesired\tcluster,\tand\twithin\tthe\t'Basic\tInformation'\tpane,\tmake\tsure\tthe 'Secret\tEncryption'\tis\tenabled.",
    "remediation": "Enable\t'Secret\tEncryption'\tduring\tACK\tPro\tcluster\tcreation\tas\tdescribed\tin\tthe\tlinks\twithin the\t'References'\tsection. Default\tValue: By\tdefault,\tApplication-layer\tSecrets\tEncryption\tis\tnot\tenabled. References: 1. https://www.alibabacloud.com/help/doc-detail/177372.htm Additional\tInformation: This\tcontrol\tonly\tavailable\tfor\tACK\tPro\tclusters CIS\tControls: Version\t7 14.8\tEncrypt\tSensitive\tInformation\tat\tRest Encrypt\tall\tsensitive\tinformation\tat\trest\tusing\ta\ttool\tthat\trequires\ta\tsecondary authentication\tmechanism\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto\taccess\tthe information. 257\t|\tP a g e 6.3 Cluster Networking This\tsection\tcontains\trecommendations\trelating\tto\tnetwork\tsecurity\tconfigurations\tin\tACK.",
    "references": "1. https://www.alibabacloud.com/help/doc-detail/177372.htm Additional\tInformation: This\tcontrol\tonly\tavailable\tfor\tACK\tPro\tclusters CIS\tControls: Version\t7 14.8\tEncrypt\tSensitive\tInformation\tat\tRest Encrypt\tall\tsensitive\tinformation\tat\trest\tusing\ta\ttool\tthat\trequires\ta\tsecondary authentication\tmechanism\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto\taccess\tthe information. 257\t|\tP a g e 6.3 Cluster Networking This\tsection\tcontains\trecommendations\trelating\tto\tnetwork\tsecurity\tconfigurations\tin\tACK.",
    "function_names": [
      "kubernetes_secret_encryption_enabled",
      "kubernetes_secret_kms_key_managed",
      "kubernetes_secret_etcd_encryption_enabled",
      "kubernetes_secret_application_layer_encryption_enabled",
      "kubernetes_secret_customer_managed_key_used"
    ]
  },
  {
    "id": "6.3.1",
    "title": "Restrict Access to the Control Plane Endpoint",
    "assessment": "Manual",
    "description": "Enable\tEndpoint\tPrivate\tAccess\tto\trestrict\taccess\tto\tthe\tcluster's\tcontrol\tplane\tto\tonly\tan allowlist\tof\tauthorized\tIPs.",
    "rationale": "Authorized\tnetworks\tare\ta\tway\tof\tspecifying\ta\trestricted\trange\tof\tIP\taddresses\tthat\tare permitted\tto\taccess\tyour\tcluster's\tcontrol\tplane.\tKubernetes\tEngine\tuses\tboth\tTransport Layer\tSecurity\t(TLS)\tand\tauthentication\tto\tprovide\tsecure\taccess\tto\tyour\tcluster's\tcontrol plane\tfrom\tthe\tpublic\tinternet.\tThis\tprovides\tyou\tthe\tflexibility\tto\tadminister\tyour\tcluster from\tanywhere;\thowever,\tyou\tmight\twant\tto\tfurther\trestrict\taccess\tto\ta\tset\tof\tIP\taddresses that\tyou\tcontrol.\tYou\tcan\tset\tthis\trestriction\tby\tspecifying\tan\tauthorized\tnetwork. Restricting\taccess\tto\tan\tauthorized\tnetwork\tcan\tprovide\tadditional\tsecurity\tbenefits\tfor your\tcontainer\tcluster,\tincluding: • Better\tprotection\tfrom\toutsider\tattacks:\tAuthorized\tnetworks\tprovide\tan\tadditional layer\tof\tsecurity\tby\tlimiting\texternal\taccess\tto\ta\tspecific\tset\tof\taddresses\tyou designate,\tsuch\tas\tthose\tthat\toriginate\tfrom\tyour\tpremises.\tThis\thelps\tprotect\taccess to\tyour\tcluster\tin\tthe\tcase\tof\ta\tvulnerability\tin\tthe\tcluster's\tauthentication\tor authorization\tmechanism. • Better\tprotection\tfrom\tinsider\tattacks:\tAuthorized\tnetworks\thelp\tprotect\tyour cluster\tfrom\taccidental\tleaks\tof\tmaster\tcertificates\tfrom\tyour\tcompany's\tpremises. Leaked\tcertificates\tused\tfrom\toutside\tECS\tand\toutside\tthe\tauthorized\tIP\tranges\t(for example,\tfrom\taddresses\toutside\tyour\tcompany)\tare\tstill\tdenied\taccess Impact: When\timplementing\tEndpoint\tPrivate\tAccess,\tbe\tcareful\tto\tensure\tall\tdesired\tnetworks\tare on\tthe\tallowlist\t(whitelist)\tto\tprevent\tinadvertently\tblocking\texternal\taccess\tto\tyour cluster's\tcontrol\tplane.",
    "audit": "258\t|\tP a g e Using\tAlibaba\tCloud\tConsole: 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 2. From\tthe\tlist\tof\tclusters,\tclick\ton\tthe\tdesired\tcluster\tto\topen\tthe\tDetails\tpage.\tUnder the\t'Basic\tInformation'\tsection,\tclick\t'Set\taccess\tcontrol'\tlink\tto\tview\taccess\tcontrol of\tcontrol\tplane\tendpoint.",
    "remediation": "For\texist\tcluster: Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 2. From\tthe\tlist\tof\tclusters,\tclick\ton\tthe\tdesired\tcluster\tto\topen\tthe\tDetails\tpage.\tUnder the\t'Basic\tInformation'\tsection,\tclick\t'Set\taccess\tcontrol'\tlink\tto\tmodify\taccess control\tof\tcontrol\tplane\tendpoint. For\tcreate\tcluster: Using\tAlibaba\tCloud\tConsole 1. When\tcreate\tcluster,\tmake\tsure\tnot\tchecked\tthe\t'Public\tAccess'\tcheckbox. Default\tValue: By\tdefault,\tEndpoint\tPrivate\tAccess\tis\tdisabled. References: 1. https://www.alibabacloud.com/help/doc-detail/95108.htm 2. https://www.alibabacloud.com/help/doc-detail/129425.htm CIS\tControls: Version\t7 14.6\tProtect\tInformation\tthrough\tAccess\tControl\tLists Protect\tall\tinformation\tstored\ton\tsystems\twith\tfile\tsystem,\tnetwork\tshare,\tclaims, application,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. 259\t|\tP a g e",
    "impact": "When\timplementing\tEndpoint\tPrivate\tAccess,\tbe\tcareful\tto\tensure\tall\tdesired\tnetworks\tare on\tthe\tallowlist\t(whitelist)\tto\tprevent\tinadvertently\tblocking\texternal\taccess\tto\tyour cluster's\tcontrol\tplane.",
    "references": "1. https://www.alibabacloud.com/help/doc-detail/95108.htm 2. https://www.alibabacloud.com/help/doc-detail/129425.htm CIS\tControls: Version\t7 14.6\tProtect\tInformation\tthrough\tAccess\tControl\tLists Protect\tall\tinformation\tstored\ton\tsystems\twith\tfile\tsystem,\tnetwork\tshare,\tclaims, application,\tor\tdatabase\tspecific\taccess\tcontrol\tlists.\tThese\tcontrols\twill\tenforce\tthe principle\tthat\tonly\tauthorized\tindividuals\tshould\thave\taccess\tto\tthe\tinformation\tbased\ton their\tneed\tto\taccess\tthe\tinformation\tas\ta\tpart\tof\ttheir\tresponsibilities. 259\t|\tP a g e",
    "function_names": [
      "eks_cluster_control_plane_endpoint_private_access_enabled",
      "eks_cluster_control_plane_endpoint_public_access_disabled",
      "eks_cluster_control_plane_endpoint_allowlist_restricted",
      "eks_cluster_control_plane_endpoint_authorized_ips_only",
      "eks_cluster_control_plane_endpoint_private_access_only"
    ]
  },
  {
    "id": "6.3.2",
    "title": "Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled",
    "assessment": "Manual",
    "description": "Disable\taccess\tto\tthe\tKubernetes\tAPI\tfrom\toutside\tthe\tnode\tnetwork\tif\tit\tis\tnot\trequired.",
    "rationale": "In\ta\tprivate\tcluster,\tthe\tmaster\tnode\thas\ttwo\tendpoints,\ta\tprivate\tand\tpublic\tendpoint.\tThe private\tendpoint\tis\tthe\tinternal\tIP\taddress\tof\tthe\tmaster,\tbehind\tan\tinternal\tload\tbalancer in\tthe\tmaster's\tVPC\tnetwork.\tNodes\tcommunicate\twith\tthe\tmaster\tusing\tthe\tprivate endpoint.\tThe\tpublic\tendpoint\tenables\tthe\tKubernetes\tAPI\tto\tbe\taccessed\tfrom\toutside\tthe master's\tVPC\tnetwork. Although\tKubernetes\tAPI\trequires\tan\tauthorized\ttoken\tto\tperform\tsensitive\tactions,\ta vulnerability\tcould\tpotentially\texpose\tthe\tKubernetes\tpublically\twith\tunrestricted\taccess. Additionally,\tan\tattacker\tmay\tbe\table\tto\tidentify\tthe\tcurrent\tcluster\tand\tKubernetes\tAPI version\tand\tdetermine\twhether\tit\tis\tvulnerable\tto\tan\tattack.\tUnless\trequired,\tdisabling public\tendpoint\twill\thelp\tprevent\tsuch\tthreats,\tand\trequire\tthe\tattacker\tto\tbe\ton\tthe master's\tVPC\tnetwork\tto\tperform\tany\tattack\ton\tthe\tKubernetes\tAPI. Impact: Configure\tthe\tACK\tcluster\tendpoint\tto\tbe\tprivate. 1. Leave\tthe\tcluster\tendpoint\tpublic\tand\tspecify\twhich\tCIDR\tblocks\tcan\tcommunicate with\tthe\tcluster\tendpoint.\tThe\tblocks\tare\teffectively\ta\twhitelisted\tset\tof\tpublic\tIP addresses\tthat\tare\tallowed\tto\taccess\tthe\tcluster\tendpoint. 2. Disable\taccess\tto\tthe\tcluster\tendpoint\tfrom\toutside\tthe\tcluster\tVPC. Audit: Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 2. Select\tthe\tdesired\tcluster,\tand\twithin\tthe\t'Cluster\tResources'\tpane,\tclick\ton\t'SLB'\tlink 3. Within\tthe\tSLB\tpage,\tmake\tsure\tthe\tSLB\tnot\tbind\tan\tEIP",
    "remediation": "260\t|\tP a g e For\texist\tcluster: Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 2. Select\tthe\tdesired\tcluster,\tand\twithin\tthe\t'Cluster\tResources'\tpane,\tclick\ton\t'SLB'\tlink 3. On\tthe\tSLB\tpage,\tclick\ton\t'Unbind\tEIP'\tbutton\tto\tunbind\tEIP For\tcreate\tcluster: Using\tAlibaba\tCloud\tConsole 1. When\tcreate\tcluster,\tmake\tsure\tnot\tchecked\tthe\t'Public\tAccess'\tcheckbox. Default\tValue: By\tdefault,\tthe\tPrivate\tEndpoint\tis\tdisabled. References: 1. https://www.alibabacloud.com/help/doc-detail/95108.htm CIS\tControls: Version\t7 12\tBoundary\tDefense Boundary\tDefense 261\t|\tP a g e",
    "audit": "",
    "impact": "Configure\tthe\tACK\tcluster\tendpoint\tto\tbe\tprivate. 1. Leave\tthe\tcluster\tendpoint\tpublic\tand\tspecify\twhich\tCIDR\tblocks\tcan\tcommunicate with\tthe\tcluster\tendpoint.\tThe\tblocks\tare\teffectively\ta\twhitelisted\tset\tof\tpublic\tIP addresses\tthat\tare\tallowed\tto\taccess\tthe\tcluster\tendpoint. 2. Disable\taccess\tto\tthe\tcluster\tendpoint\tfrom\toutside\tthe\tcluster\tVPC. Audit: Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 2. Select\tthe\tdesired\tcluster,\tand\twithin\tthe\t'Cluster\tResources'\tpane,\tclick\ton\t'SLB'\tlink 3. Within\tthe\tSLB\tpage,\tmake\tsure\tthe\tSLB\tnot\tbind\tan\tEIP",
    "references": "1. https://www.alibabacloud.com/help/doc-detail/95108.htm CIS\tControls: Version\t7 12\tBoundary\tDefense Boundary\tDefense 261\t|\tP a g e",
    "function_names": [
      "kubernetes_cluster_private_endpoint_enabled",
      "kubernetes_cluster_public_access_disabled",
      "kubernetes_cluster_api_access_restricted",
      "kubernetes_cluster_network_access_controlled",
      "kubernetes_cluster_endpoint_private_only",
      "kubernetes_cluster_external_access_disabled",
      "kubernetes_cluster_internal_network_restricted",
      "kubernetes_cluster_api_no_public_access"
    ]
  },
  {
    "id": "6.3.3",
    "title": "Ensure clusters are created with Private Nodes",
    "assessment": "Manual",
    "description": "Disable\tpublic\tIP\taddresses\tfor\tcluster\tnodes,\tso\tthat\tthey\tonly\thave\tprivate\tIP\taddresses. Private\tNodes\tare\tnodes\twith\tno\tpublic\tIP\taddresses.",
    "rationale": "Disabling\tpublic\tIP\taddresses\ton\tcluster\tnodes\trestricts\taccess\tto\tonly\tinternal\tnetworks, forcing\tattackers\tto\tobtain\tlocal\tnetwork\taccess\tbefore\tattempting\tto\tcompromise\tthe underlying\tKubernetes\thosts. Impact: To\tenable\tPrivate\tNodes,\tthe\tcluster\thas\tto\talso\tbe\tconfigured\twith\ta\tprivate\tmaster\tIP range\tand\tIP\tAliasing\tenabled. Private\tNodes\tdo\tnot\thave\toutbound\taccess\tto\tthe\tpublic\tinternet.\tIf\tyou\twant\tto\tprovide outbound\tInternet\taccess\tfor\tyour\tprivate\tnodes,\tyou\tcan\tuse\tCloud\tNAT\tor\tyou\tcan manage\tyour\town\tNAT\tgateway.",
    "audit": "Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 2. Select\tthe\tdesired\tcluster,\tand\twithin\tthe\t'Cluster\tResources'\tpane,\tclick\ton\t'NAT Gateway'\tlink. 3. On\tNAT\tgateway\tpage,\tmake\tsure\tno\tNAT\tgateway\tavailable\tor\tnot\texist\tany\tSNAT entriy.",
    "remediation": "For\texist\tcluster: Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 2. Select\tthe\tdesired\tcluster,\tand\twithin\tthe\t'Cluster\tResources'\tpane,\tclick\ton\t'NAT Gateway'\tlink. 3. On\tNAT\tgateway\tpage,\tdelete\tany\texist\tSNAT\tentries. 262\t|\tP a g e For\tcreate\tcluster: Using\tAlibaba\tCloud\tConsole 1. When\tcreate\tcluster,\tmake\tsure\tnot\tchecked\tthe\t'Configure\tSNAT'\tcheckbox. Default\tValue: By\tdefault,\tPrivate\tNodes\tare\tdisabled. References: 1. https://www.alibabacloud.com/help/doc-detail/95108.htm 2. https://www.alibabacloud.com/help/doc-detail/121157.html CIS\tControls: Version\t7 12\tBoundary\tDefense Boundary\tDefense 263\t|\tP a g e",
    "impact": "To\tenable\tPrivate\tNodes,\tthe\tcluster\thas\tto\talso\tbe\tconfigured\twith\ta\tprivate\tmaster\tIP range\tand\tIP\tAliasing\tenabled. Private\tNodes\tdo\tnot\thave\toutbound\taccess\tto\tthe\tpublic\tinternet.\tIf\tyou\twant\tto\tprovide outbound\tInternet\taccess\tfor\tyour\tprivate\tnodes,\tyou\tcan\tuse\tCloud\tNAT\tor\tyou\tcan manage\tyour\town\tNAT\tgateway.",
    "references": "1. https://www.alibabacloud.com/help/doc-detail/95108.htm 2. https://www.alibabacloud.com/help/doc-detail/121157.html CIS\tControls: Version\t7 12\tBoundary\tDefense Boundary\tDefense 263\t|\tP a g e",
    "function_names": [
      "compute_cluster_private_nodes_enabled",
      "compute_cluster_public_ip_disabled",
      "compute_node_private_ip_only",
      "compute_cluster_node_no_public_ip",
      "compute_cluster_private_networking_enabled"
    ]
  },
  {
    "id": "6.3.4",
    "title": "Ensure Network Policy is Enabled and set as appropriate",
    "assessment": "Manual",
    "description": "Use\tNetwork\tPolicy\tto\trestrict\tpod\tto\tpod\ttraffic\twithin\ta\tcluster\tand\tsegregate\tworkloads.",
    "rationale": "By\tdefault,\tall\tpod\tto\tpod\ttraffic\twithin\ta\tcluster\tis\tallowed.\tNetwork\tPolicy\tcreates\ta podlevel\tfirewall\tthat\tcan\tbe\tused\tto\trestrict\ttraffic\tbetween\tsources.\tPod\ttraffic\tis restricted\tby\thaving\ta\tNetwork\tPolicy\tthat\tselects\tit\t(through\tthe\tuse\tof\tlabels).\tOnce\tthere is\tany\tNetwork\tPolicy\tin\ta\tnamespace\tselecting\ta\tparticular\tpod,\tthat\tpod\twill\treject\tany connections\tthat\tare\tnot\tallowed\tby\tany\tNetwork\tPolicy.\tOther\tpods\tin\tthe\tnamespace\tthat are\tnot\tselected\tby\tany\tNetwork\tPolicy\twill\tcontinue\tto\taccept\tall\ttraffic. Network\tPolicies\tare\tmanaged\tvia\tthe\tKubernetes\tNetwork\tPolicy\tAPI\tand\tenforced\tby\ta network\tplugin,\tsimply\tcreating\tthe\tresource\twithout\ta\tcompatible\tnetwork\tplugin\tto implement\tit\twill\thave\tno\teffect.\tACK\tsupports\tNetwork\tPolicy\tenforcement\tthrough\tthe use\tof\tTerway. Impact: Network\tPolicy\trequires\tthe\tNetwork\tPolicy\tadd-on.\tThis\tadd-on\tis\tincluded\tautomatically when\ta\tcluster\twith\tNetwork\tPolicy\tis\tcreated,\tbut\tfor\tan\texisting\tcluster,\tneeds\tto\tbe added\tprior\tto\tenabling\tNetwork\tPolicy",
    "audit": "Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 2. Select\tthe\tdesired\tcluster,\tand\twithin\tthe\tDetails\tpane\tmake\tsure\tthat\tvalue\tof 'Network\tPlug-in'\tis\t'Terway",
    "remediation": "Using\tAlibaba\tCloud\tConsole 1. When\tcreate\tcluster,\tmake\tsure\tselected\tuse\t'Terway'\tas\t'Network\tPlug-in'\tand checked\tthe\t'Support\tfor\tNetworkPolicy'\tcheckbox 264\t|\tP a g e Default\tValue: By\tdefault,\tNetwork\tPolicy\tis\tdisabled. References: 1. https://www.alibabacloud.com/help/doc-detail/97621.htm 2. https://www.alibabacloud.com/help/doc-detail/95108.htm CIS\tControls: Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 9.4\tApply\tHost-based\tFirewalls\tor\tPort\tFiltering Apply\thost-based\tfirewalls\tor\tport\tfiltering\ttools\ton\tend\tsystems,\twith\ta\tdefault-deny rule\tthat\tdrops\tall\ttraffic\texcept\tthose\tservices\tand\tports\tthat\tare\texplicitly\tallowed. 265\t|\tP a g e",
    "impact": "Network\tPolicy\trequires\tthe\tNetwork\tPolicy\tadd-on.\tThis\tadd-on\tis\tincluded\tautomatically when\ta\tcluster\twith\tNetwork\tPolicy\tis\tcreated,\tbut\tfor\tan\texisting\tcluster,\tneeds\tto\tbe added\tprior\tto\tenabling\tNetwork\tPolicy",
    "references": "1. https://www.alibabacloud.com/help/doc-detail/97621.htm 2. https://www.alibabacloud.com/help/doc-detail/95108.htm CIS\tControls: Version\t7 9.2\tEnsure\tOnly\tApproved\tPorts,\tProtocols\tand\tServices\tAre\tRunning Ensure\tthat\tonly\tnetwork\tports,\tprotocols,\tand\tservices\tlistening\ton\ta\tsystem\twith validated\tbusiness\tneeds,\tare\trunning\ton\teach\tsystem. 9.4\tApply\tHost-based\tFirewalls\tor\tPort\tFiltering Apply\thost-based\tfirewalls\tor\tport\tfiltering\ttools\ton\tend\tsystems,\twith\ta\tdefault-deny rule\tthat\tdrops\tall\ttraffic\texcept\tthose\tservices\tand\tports\tthat\tare\texplicitly\tallowed. 265\t|\tP a g e",
    "function_names": [
      "kubernetes_network_policy_enabled",
      "kubernetes_network_policy_restrict_pod_traffic",
      "kubernetes_network_policy_workload_segregation",
      "kubernetes_network_policy_appropriate_settings",
      "kubernetes_network_policy_traffic_restrictions",
      "kubernetes_network_policy_cluster_isolation",
      "kubernetes_network_policy_secure_communication",
      "kubernetes_network_policy_default_deny",
      "kubernetes_network_policy_minimal_access",
      "kubernetes_network_policy_ingress_egress_controls"
    ]
  },
  {
    "id": "6.3.5",
    "title": "Encrypt traffic to HTTPS load balancers with TLS certificates",
    "assessment": "Manual",
    "description": "Encrypt\ttraffic\tto\tHTTPS\tload\tbalancers\tusing\tTLS\tcertificates.",
    "rationale": "Encrypting\ttraffic\tbetween\tusers\tand\tyour\tKubernetes\tworkload\tis\tfundamental\tto protecting\tdata\tsent\tover\tthe\tweb.",
    "audit": "Remediation: References: 1. https://www.alibabacloud.com/help/doc-detail/90792.html 2. https://www.alibabacloud.com/help/doc-detail/86535.html CIS\tControls: Version\t7 14.4\tEncrypt\tAll\tSensitive\tInformation\tin\tTransit Encrypt\tall\tsensitive\tinformation\tin\ttransit. 266\t|\tP a g e 6.4 Storage This\tsection\tcontains\trecommendations\trelating\tto\tsecurity-related\tconfigurations\tfor storage\tin\tACK.",
    "remediation": null,
    "function_names": [
      "cloud_cdn_load_balancer_tls_encryption_enabled",
      "cloud_cdn_load_balancer_https_redirect_enabled",
      "cloud_cdn_load_balancer_ssl_certificate_attached",
      "cloud_cdn_load_balancer_min_tls_1_2",
      "cloud_cdn_load_balancer_tls_termination_enabled",
      "cloud_cdn_load_balancer_secure_cipher_suites",
      "cloud_cdn_load_balancer_tls_certificate_valid",
      "cloud_cdn_load_balancer_tls_certificate_not_expired"
    ]
  },
  {
    "id": "6.4.1",
    "title": "Enable data disk encryption for Alibaba Cloud Disks",
    "assessment": "Manual",
    "description": "Use\tCustomer-Managed\tEncryption\tKeys\t(CMEK)\tto\tencrypt\tthe\tAliaba\tCloud\tDisk\tand attached\tit\tas\tdata\tdisk\tin\tACK\tcluster.",
    "rationale": "The\tAlibaba\tCloud\tdisk\twhich\tusing\tas\tthe\tdata\tdisk\tin\tcluster\tis\tencrypted\tat\trest\tby default\tusing\tenvelope\tencryption\twith\tkeys\tmanaged\tby\tAlibaba\tCloud.\tFor\tadditional protection,\tusers\tcan\tmanage\tthe\tKey\tEncryption\tKeys\tusing\tCloud\tKMS.",
    "audit": "Using\tAlibaba\tCloud\tConsole: 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 2. From\tthe\tlist\tof\tclusters,\tclick\ton\tthe\tdesired\tcluster\tto\topen\tthe\tDetails\tpage.\tgo\tto the\t\"Persistent\tVolumes\"\tpage,\tselect\t\"Storage\tClasses\"\ttab\tand\tfind\tthe\ttarget StorageClass\tinstance\tto\tcheck\tencrypted:\t\"true\"\tand\tkmsKeyId:\t\"your\tkey\tid\"\twere set\tin\tthe\tinstance\tyaml. 3. Go\tto\tECS\tby\tvisiting\thttps://ecs.console.aliyun.com/ 4. Go\tto\t\"Storage\t&\tSnapshots\"\t->\t\"Disks\"\tpage,\tfind\tthe\ttarget\tdisk\tand\tmake\tsure\tthe \"Encrypted/Unencrypted\"\tstatus\tis\t\"encrypted\".",
    "remediation": "For\tcreate\tcluster: 1. Go\tto\tKey\tManagement\tService\tby\tvisiting\thttps://kms.console.aliyun.com/ 2. Click\tthe\t\"Create\tKey\"\tbutton\tto\tcreate\tthe\tmanagement\tKMS\tkey 3. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 4. From\tthe\tlist\tof\tclusters,\tclick\ton\tthe\tdesired\tcluster\tto\topen\tthe\tDetails\tpage.\tgo\tto the\t\"Persistent\tVolumes\"\tpage,\tselect\t\"Storage\tClasses\"\ttab\tand\tcreate\tthe StorageClass\tinstance\twith\tthe\tyaml\ttemplate\tas\tbelow: 267\t|\tP a g e apiVersion: storage.k8s.io/v1 kind: StorageClass metadata: name: alicloud-disk-ssd-byok parameters: type: cloud_ssd encrypted: \"true\" kmsKeyId: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx provisioner: alicloud/disk reclaimPolicy: Delete  5. Create\tthe\tPVC\tinstance\twith\tthe\tyaml\ttemplate\tas\tbelow: kind: PersistentVolumeClaim apiVersion: v1 metadata: name: disk-ssd-byok spec: accessModes: - ReadWriteOnce storageClassName: alicloud-disk-ssd-byok resources: requests: storage: 20Gi  6. In\tthe\tdeployment\ttemplate,\tmount\tPVC\twith\tthe\ttarget\tencrypted\tdisk. Default\tValue: By\tdefault,\tthe\tcluster\tdata\tdisk\tis\tnot\tencrypted. References: 1. https://www.alibabacloud.com/help/doc-detail/107972.htm CIS\tControls: Version\t7 14.8\tEncrypt\tSensitive\tInformation\tat\tRest Encrypt\tall\tsensitive\tinformation\tat\trest\tusing\ta\ttool\tthat\trequires\ta\tsecondary authentication\tmechanism\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto\taccess\tthe information. 268\t|\tP a g e 6.5 Logging This\tsection\tcontains\trecommendations\trelating\tto\tsecurity-related\tlogging\tin\tACK.",
    "references": "1. https://www.alibabacloud.com/help/doc-detail/107972.htm CIS\tControls: Version\t7 14.8\tEncrypt\tSensitive\tInformation\tat\tRest Encrypt\tall\tsensitive\tinformation\tat\trest\tusing\ta\ttool\tthat\trequires\ta\tsecondary authentication\tmechanism\tnot\tintegrated\tinto\tthe\toperating\tsystem,\tin\torder\tto\taccess\tthe information. 268\t|\tP a g e 6.5 Logging This\tsection\tcontains\trecommendations\trelating\tto\tsecurity-related\tlogging\tin\tACK.",
    "function_names": [
      "compute_disk_encryption_enabled",
      "compute_disk_cmek_encryption_enabled",
      "compute_data_disk_encryption_enabled",
      "compute_data_disk_cmek_encryption_enabled",
      "ack_disk_encryption_enabled",
      "ack_data_disk_cmek_encryption_enabled"
    ]
  },
  {
    "id": "6.5.1",
    "title": "Ensure Cluster Auditing is Enabled",
    "assessment": "Manual",
    "description": "Send\tcluster\taudit\tlogs\tto\ta\tremote\taggregator\tto\tmitigate\tthe\trisk\tof\tlocal\ttampering\tin\tthe event\tof\ta\tbreach.",
    "rationale": "Exporting\tcluster\taudit\tlogs\tto\ta\tdedicated,\tpersistent\tdatastore\tsuch\tas\tLog\tService\t(SLS) ensures\tavailability\tof\taudit\tdata\tfollowing\ta\tcluster\tsecurity\tevent,\tand\tprovides\ta\tcentral location\tfor\tanalysis\tof\tlog\tand\tmetric\tdata\tcollated\tfrom\tmultiple\tsources.",
    "audit": "Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 2. Select\tthe\tdesired\tcluster,\tand\twithin\tthe\t'Security\t>\tCluster\tAuditing'\tpane,\tmake sure\tthe\tauditing\tdashboard\tis\tenabled",
    "remediation": "Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 2. Select\tthe\tdesired\tcluster,\tand\twithin\tthe\t'Security\t>\tCluster\tAuditing'\tpane,\tclick\ton 'Enable\tCluster\tAuditing\tNow'\tbutton\tto\tenable\tCluster\tAuditing. Default\tValue: By\tdefault,\tcluster\tauditing\tis\tdisabled. References: 1. https://kubernetes.io/docs/tasks/debug-application-cluster/audit/ 2. https://www.alibabacloud.com/help/doc-detail/91406.htm 269\t|\tP a g e 3. https://www.alibabacloud.com/help/doc-detail/107745.htm CIS\tControls: Version\t7 6.2\tActivate\taudit\tlogging Ensure\tthat\tlocal\tlogging\thas\tbeen\tenabled\ton\tall\tsystems\tand\tnetworking\tdevices. 270\t|\tP a g e 6.6 Other Cluster Configurations This\tsection\tcontains\trecommendations\trelating\tto\tany\tremaining\tsecurity-related\tcluster configurations\tin\tACK.",
    "references": "1. https://kubernetes.io/docs/tasks/debug-application-cluster/audit/ 2. https://www.alibabacloud.com/help/doc-detail/91406.htm 269\t|\tP a g e 3. https://www.alibabacloud.com/help/doc-detail/107745.htm CIS\tControls: Version\t7 6.2\tActivate\taudit\tlogging Ensure\tthat\tlocal\tlogging\thas\tbeen\tenabled\ton\tall\tsystems\tand\tnetworking\tdevices. 270\t|\tP a g e 6.6 Other Cluster Configurations This\tsection\tcontains\trecommendations\trelating\tto\tany\tremaining\tsecurity-related\tcluster configurations\tin\tACK.",
    "function_names": [
      "kubernetes_cluster_auditing_enabled",
      "kubernetes_cluster_audit_logs_remote_aggregator",
      "kubernetes_cluster_audit_logs_tamper_proof",
      "kubernetes_cluster_audit_logs_remote_export",
      "kubernetes_cluster_audit_logs_centralized"
    ]
  },
  {
    "id": "6.6.1",
    "title": "Ensure Pod Security Policy is Enabled and set as appropriate",
    "assessment": "Manual",
    "description": "Pod\tSecurity\tPolicy\tshould\tbe\tused\tto\tprevent\tprivileged\tcontainers\twhere\tpossible\tand enforce\tnamespace\tand\tworkload\tconfigurations.",
    "rationale": "A\tPod\tSecurity\tPolicy\tis\ta\tcluster-level\tresource\tthat\tcontrols\tsecurity\tsensitive\taspects\tof the\tpod\tspecification.\tA\tPodSecurityPolicy\tobject\tdefines\ta\tset\tof\tconditions\tthat\ta\tpod must\trun\twith\tin\torder\tto\tbe\taccepted\tinto\tthe\tsystem,\tas\twell\tas\tdefaults\tfor\tthe\trelated fields.\tWhen\ta\trequest\tto\tcreate\tor\tupdate\ta\tPod\tdoes\tnot\tmeet\tthe\tconditions\tin\tthe\tPod Security\tPolicy,\tthat\trequest\tis\trejected\tand\tan\terror\tis\treturned.\tThe\tPod\tSecurity\tPolicy admission\tcontroller\tvalidates\trequests\tagainst\tavailable\tPod\tSecurity\tPolicies. PodSecurityPolicies\tspecify\ta\tlist\tof\trestrictions,\trequirements,\tand\tdefaults\tfor\tPods created\tunder\tthe\tpolicy.\tSee\tfurther\tdetails\ton\trecommended\tpolicies\tin\tRecommendation section\t5.2. Impact: If\tyou\tenable\tthe\tPod\tSecurity\tPolicy\tcontroller\twithout\tfirst\tdefining\tand\tauthorizing\tany actual\tpolicies,\tno\tusers,\tcontrollers,\tor\tservice\taccounts\tcan\tcreate\tor\tupdate\tPods.\tIf\tyou are\tworking\twith\tan\texisting\tcluster,\tyou\tshould\tdefine\tand\tauthorize\tpolicies\tbefore enabling\tthe\tcontroller.",
    "audit": "Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 271\t|\tP a g e 2. Select\tthe\tdesired\tcluster,\tand\twithin\tthe\t'Security\t>\tPodSecurityPolicies'\tpane, make\tsure\tthe\tPSP\tState\tis\t'enabled'\tand\tthere\tare\tmany\tpolicies\tdefined.",
    "remediation": "Using\tAlibaba\tCloud\tConsole 1. Go\tto\tACK\tby\tvisiting\thttps://cs.console.aliyun.com/ 2. Select\tthe\tdesired\tcluster,\tand\twithin\tthe\t'Security\t>\tPodSecurityPolicies'\tpane,\tclick on\tPSP\tState\tbutton\tto\tenable\tPSP. 3. Follow\tthe\tACK\tdocument\tto\tsetup\trecommended\tpolicies\tin\tRecommendation section\t5.2: https://www.alibabacloud.com/help/doc-detail/173620.htm Default\tValue: By\tdefault,\tPod\tSecurity\tPolicy\tis\tdisabled. References: 1. https://www.alibabacloud.com/help/doc-detail/173620.htm 2. https://kubernetes.io/docs/concepts/policy/pod-security-policy Additional\tInformation: Pod\tSecurity\tPolicy\tis\tBeta\tin\tKubernetes\tand\tin\tACK.\tThis\tfeature\tis\tnot\tcovered\tby\tany SLA\tor\tdeprecation\tpolicy\tand\tmight\tbe\tsubject\tto\tbackward-incompatible\tchanges. CIS\tControls: Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 5.4\tDeploy\tSystem\tConfiguration\tManagement\tTools Deploy\tsystem\tconfiguration\tmanagement\ttools\tthat\twill\tautomatically\tenforce\tand redeploy\tconfiguration\tsettings\tto\tsystems\tat\tregularly\tscheduled\tintervals. 272\t|\tP a g e",
    "impact": "If\tyou\tenable\tthe\tPod\tSecurity\tPolicy\tcontroller\twithout\tfirst\tdefining\tand\tauthorizing\tany actual\tpolicies,\tno\tusers,\tcontrollers,\tor\tservice\taccounts\tcan\tcreate\tor\tupdate\tPods.\tIf\tyou are\tworking\twith\tan\texisting\tcluster,\tyou\tshould\tdefine\tand\tauthorize\tpolicies\tbefore enabling\tthe\tcontroller.",
    "references": "1. https://www.alibabacloud.com/help/doc-detail/173620.htm 2. https://kubernetes.io/docs/concepts/policy/pod-security-policy Additional\tInformation: Pod\tSecurity\tPolicy\tis\tBeta\tin\tKubernetes\tand\tin\tACK.\tThis\tfeature\tis\tnot\tcovered\tby\tany SLA\tor\tdeprecation\tpolicy\tand\tmight\tbe\tsubject\tto\tbackward-incompatible\tchanges. CIS\tControls: Version\t7 5.1\tEstablish\tSecure\tConfigurations Maintain\tdocumented,\tstandard\tsecurity\tconfiguration\tstandards\tfor\tall\tauthorized operating\tsystems\tand\tsoftware. 5.4\tDeploy\tSystem\tConfiguration\tManagement\tTools Deploy\tsystem\tconfiguration\tmanagement\ttools\tthat\twill\tautomatically\tenforce\tand redeploy\tconfiguration\tsettings\tto\tsystems\tat\tregularly\tscheduled\tintervals. 272\t|\tP a g e",
    "function_names": [
      "kubernetes_pod_security_policy_enabled",
      "kubernetes_pod_no_privileged_containers",
      "kubernetes_pod_security_policy_namespace_enforced",
      "kubernetes_pod_security_policy_workload_config_enforced",
      "kubernetes_pod_security_policy_appropriate_settings"
    ]
  },
  {
    "id": "6.6.2",
    "title": "Enable Cloud Security Center",
    "assessment": "Manual",
    "description": "Enable\tCloud\tSecurity\tCenter\tto\tprovide\ta\tcentralized\tview\tof\tsecurity\tfor\tyour\tACK clusters.",
    "rationale": "Cloud\tSecurity\tCenter\tis\tthe\tcanonical\tsecurity\tand\tdata\trisk\tdatabase\tfor\tACK.\tCloud Security\tCenter\tenables\tyou\tto\tunderstand\tyour\tsecurity\tand\tdata\tattack\tsurface\tby providing\tasset\tinventory,\tdiscovery,\tsearch,\tand\tmanagement.",
    "audit": "Using\tAlibaba\tCloud\tConsole 1. Go\tto\tCloud\tSecurity\tCenter\tby\tvisiting\thttps://yundun.console.aliyun.com/ 2. Observe\tthe\t'Assets\tSummary'\tis\tpopulated\twith\tresources.",
    "remediation": "Follow\tthe\tinstructions\tat\thttps://www.alibabacloud.com/help/doc-detail/68651.htm Default\tValue: By\tdefault,\tCloud\tSecurity\tCenter\tis\tdisabled. References: 1. https://www.alibabacloud.com/help/product/28498.htm 2. https://www.alibabacloud.com/help/doc-detail/68651.htm CIS\tControls: Version\t7 2\tInventory\tand\tControl\tof\tSoftware\tAssets Inventory\tand\tControl\tof\tSoftware\tAssets 273\t|\tP a g e 3\tContinuous\tVulnerability\tManagement Continuous\tVulnerability\tManagement 4\tControlled\tUse\tof\tAdministrative\tPrivileges Controlled\tUse\tof\tAdministrative\tPrivileges 5\tSecure\tConfiguration\tfor\tHardware\tand\tSoftware\ton\tMobile\tDevices,\tLaptops, Workstations\tand\tServers Secure\tConfiguration\tfor\tHardware\tand\tSoftware\ton\tMobile\tDevices,\tLaptops, Workstations\tand\tServers 6\tMaintenance,\tMonitoring\tand\tAnalysis\tof\tAudit\tLogs Maintenance,\tMonitoring\tand\tAnalysis\tof\tAudit\tLogs 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices 10\tData\tRecovery\tCapabilities Data\tRecovery\tCapabilities 11\tSecure\tConfiguration\tfor\tNetwork\tDevices,\tsuch\tas\tFirewalls,\tRouters\tand\tSwitches Secure\tConfiguration\tfor\tNetwork\tDevices,\tsuch\tas\tFirewalls,\tRouters\tand\tSwitches 12\tBoundary\tDefense Boundary\tDefense 13\tData\tProtection Data\tProtection 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 16\tAccount\tMonitoring\tand\tControl Account\tMonitoring\tand\tControl 18\tApplication\tSoftware\tSecurity Application\tSoftware\tSecurity 274\t|\tP a g e",
    "references": "1. https://www.alibabacloud.com/help/product/28498.htm 2. https://www.alibabacloud.com/help/doc-detail/68651.htm CIS\tControls: Version\t7 2\tInventory\tand\tControl\tof\tSoftware\tAssets Inventory\tand\tControl\tof\tSoftware\tAssets 273\t|\tP a g e 3\tContinuous\tVulnerability\tManagement Continuous\tVulnerability\tManagement 4\tControlled\tUse\tof\tAdministrative\tPrivileges Controlled\tUse\tof\tAdministrative\tPrivileges 5\tSecure\tConfiguration\tfor\tHardware\tand\tSoftware\ton\tMobile\tDevices,\tLaptops, Workstations\tand\tServers Secure\tConfiguration\tfor\tHardware\tand\tSoftware\ton\tMobile\tDevices,\tLaptops, Workstations\tand\tServers 6\tMaintenance,\tMonitoring\tand\tAnalysis\tof\tAudit\tLogs Maintenance,\tMonitoring\tand\tAnalysis\tof\tAudit\tLogs 9\tLimitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices Limitation\tand\tControl\tof\tNetwork\tPorts,\tProtocols,\tand\tServices 10\tData\tRecovery\tCapabilities Data\tRecovery\tCapabilities 11\tSecure\tConfiguration\tfor\tNetwork\tDevices,\tsuch\tas\tFirewalls,\tRouters\tand\tSwitches Secure\tConfiguration\tfor\tNetwork\tDevices,\tsuch\tas\tFirewalls,\tRouters\tand\tSwitches 12\tBoundary\tDefense Boundary\tDefense 13\tData\tProtection Data\tProtection 14\tControlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow Controlled\tAccess\tBased\ton\tthe\tNeed\tto\tKnow 16\tAccount\tMonitoring\tand\tControl Account\tMonitoring\tand\tControl 18\tApplication\tSoftware\tSecurity Application\tSoftware\tSecurity 274\t|\tP a g e",
    "function_names": [
      "cloud_security_center_enabled",
      "cloud_security_center_ack_clusters_monitoring_enabled",
      "cloud_security_center_centralized_security_view_enabled",
      "cloud_security_center_ack_clusters_security_enabled",
      "cloud_security_center_ack_clusters_visibility_enabled"
    ]
  },
  {
    "id": "6.6.3",
    "title": "Consider ACK Sandboxed-Container for running untrusted workloads",
    "assessment": "Manual",
    "description": "Use\tACK\tSandboxed-Container\tto\trestrict\tuntrusted\tworkloads\tas\tan\tadditional\tlayer\tof protection\twhen\trunning\tin\ta\tmulti-tenant\tenvironment.",
    "rationale": "Sandboxed-Container\tprovides\tan\talternative\tto\tthe\tDocker\truntime.\tIt\tallows\tyou\tto\trun applications\tin\ta\tsandboxed\tand\tlightweight\tvirtual\tmachine\tthat\thas\ta\tdedicated\tkernel. This\tenhances\tresource\tisolation\tand\timproves\tsecurity.\tCompared\twith\tDocker, SandboxedContainer\thas\tthe\tfollowing\tbenefits: • Strong\tisolation\tbased\ton\tsandboxed\tand\tlightweight\tvirtual\tmachines. • Network\tAttached\tStorage\t(NAS)\tfile\tsystems\tand\tAlibaba\tCloud\tdisks\tcan\tbe mounted\tto\tSandboxed-Container.\tThis\tprovides\tthe\tsame\tstorage\tperformance\tas storage\tvolumes\tthat\tare\tmounted\tto\tthe\thost. • Compatibility\twith\trunC\tin\tterms\tof\tapplication\tmanagement. • High\tperformance\tthat\tcorresponds\tto\t90%\tperformance\tof\tapplications\tbased\ton runC. • The\tsame\tuser\texperience\tas\trunC\tin\tterms\tof\tlogging,\tmonitoring,\tand\tstorage. • Support\tfor\tRuntimeClass. • Easy\tto\tuse\twith\tlimited\texpertise\tthat\tis\trequired\tto\tuse\tvirtual\tmachines. • Higher\tstability\tthan\tthat\tprovided\tby\tKata\tContainers.",
    "audit": "Remediation: For\tcreate\tcluster: 1. Log\ton\tto\tthe\tACK\tconsole\thttps://cs.console.aliyun.com/. 2. In\tthe\tleft-side\tnavigation\tpane,\tclick\tClusters. 3. On\tthe\tClusters\tpage,\tclick\tCreate\tKubernetes\tCluster\tin\tthe\tupper-right\tcorner\tof the\tpage. 4. On\tthe\tSelect\tCluster\tTemplate\tpage,\tfind\tStandard\tManaged\tCluster\tand\tclick\tCreate in\tthe\tStandard\tManaged\tCluster\tsection. 275\t|\tP a g e 5. On\tthe\tACK\tmanaged\tedition\ttab,\tconfigure\tthe\tcluster\tand\tset\tthe\tparameters\tas required\tin\tthe\tfollowing\tlist: • Zone:\tSelect\ta\tzone\twhere\tElastics\tCompute\tService\t(ECS)\tBare\tMetal\tinstances\tare deployed.\tSandboxed\tcontainers\tsupport\tonly\tECS\tBare\tMetal\tinstances. • Kubernetes\tVersion:\tSelect\t1.18.8-aliyun.1\tor\tlater. • Container\tRuntime:\tSelect\tSandboxed-Container. • Worker\tInstance:\tAdd\tworker\tnodes\tby\tcreating\tnew\tECS\tinstances. • Billing\tMethod:\tSelect\tthe\tsubscription\tbilling\tmethod. • Instance\tType:\tSelect\tECS\tBare\tMetal\tinstances. • Mount\tData\tDisk:\tMount\ta\tdata\tdisk\tof\tat\tleast\t200\tGiB.\tWe\trecommend\tthat\tyou mount\ta\tdata\tdisk\tof\tat\tleast\t1\tTB. • Operating\tsystem:\tBy\tdefault,\tthe\tAliyunLinux\toperating\tsystem\tis\tused.\tYou\tcannot change\tthe\toperating\tsystem. Default\tValue: By\tdefault,\tSandboxed\tcontainer\tis\tdisabled References: 1. https://www.alibabacloud.com/help/doc-detail/142151.htm 2. https://www.alibabacloud.com/help/doc-detail/140541.htm 3. https://www.alibabacloud.com/help/doc-detail/160288.htm CIS\tControls: Version\t7 18.9\tSeparate\tProduction\tand\tNon-Production\tSystems Maintain\tseparate\tenvironments\tfor\tproduction\tand\tnonproduction\tsystems.\tDevelopers should\tnot\thave\tunmonitored\taccess\tto\tproduction\tenvironments. 276\t|\tP a g e",
    "remediation": null,
    "references": "1. https://www.alibabacloud.com/help/doc-detail/142151.htm 2. https://www.alibabacloud.com/help/doc-detail/140541.htm 3. https://www.alibabacloud.com/help/doc-detail/160288.htm CIS\tControls: Version\t7 18.9\tSeparate\tProduction\tand\tNon-Production\tSystems Maintain\tseparate\tenvironments\tfor\tproduction\tand\tnonproduction\tsystems.\tDevelopers should\tnot\thave\tunmonitored\taccess\tto\tproduction\tenvironments. 276\t|\tP a g e",
    "function_names": [
      "ack_container_sandboxed_enabled",
      "ack_container_untrusted_workload_restricted",
      "ack_container_multi_tenant_protection_enabled",
      "ack_container_sandboxed_for_untrusted_workloads",
      "ack_container_isolation_enabled_for_untrusted_workloads"
    ]
  },
  {
    "id": "6.6.4",
    "title": "Consider ACK TEE-based when running confidential computing",
    "assessment": "Manual",
    "description": "ACK\tprovides\tTEE-based\tconfidential\tcomputing.\tThis\tis\ta\tcloud-native\tand\tall-in-one solution\tbased\ton\tIntel\tSoftware\tGuard\tExtensions\t(SGX).\tIt\taims\tto\tdeliver\tand\tmanage trusted\tapplications\tand\tconfidential\tcomputing\tapplications\tby\tensuring\tthe\tsecurity, integrity,\tand\tconfidentiality\tof\tdata\tin\tuse.",
    "rationale": "ACK\tTEE-based\tconfidential\tcomputing\tallows\tyou\tto\tisolate\tsensitive\tdata\tand\tcode\tin\ta trusted\texecution\tenvironment.\tThis\tprevents\tthe\trest\tpart\tof\tthe\tsystem\tfrom\taccessing the\tdata.\tEncrypted\tdata\tin\ta\ttrusted\texecution\tenvironment\tis\tunavailable\tto\tother applications,\tthe\tBIOS,\tthe\toperating\tsystem,\tthe\tkernel,\tadministrators,\tO&M\tpersonnel, cloud\tvendors,\tand\thardware\tcomponents\texcept\tCPUs.\tThis\treduces\tthe\tpossibility\tof sensitive\tdata\tleaks\tand\tsimplifies\tdata\tmanagement.",
    "audit": "Remediation: For\tcreate\tcluster: 1. Log\ton\tto\tthe\tACK\tconsole\thttps://cs.console.aliyun.com/. 2. In\tthe\tleft-side\tnavigation\tpane,\tclick\tClusters. 3. On\tthe\tClusters\tpage,\tclick\tCreate\tKubernetes\tCluster\tin\tthe\tupper-right\tcorner\tof the page. 4. In\tthe\tSelect\tCluster\tTemplate\tdialog\tbox,\tfind\tConfidential\tComputing\tCluster\tin\tthe Managed\tClusters\tsection\tand\tclick\tCreate. 5. On\tthe\tACK\tmanaged\tedition\ttab,\tconfigure\tthe\tcluster\tand\tset\tthe\tparameters\tas required in\tthe\tfollowing\tlist: • Zone:\tOnly\tECS\tBare\tMetal\tinstances\tof\tthe\tecs.ebmhfg5.2xlarge\ttype\tsupport confidential\tcomputing\tclusters.\tMake\tsure\tthat\tthis\tinstance\ttype\tis\tavailable\tin\tthe selected\tzone. • Container\tRuntime:\tDocker\t18.09.2. 277\t|\tP a g e • Instance\tType:\tSelect\tecs.ebmhfg5.2xlarge\tof\tthe\tECS\tBare\tMetal\tinstance\tfamily. • Operating\tSystem:\tAliyunLinux\t2.xxxx. • Network\tPlug-in:\tFlannel. • Custom\tImage:\tDo\tnot\tuse\tcustom\timages.\tOtherwise,\tconfidential\tcomputing\tmay be\tunavailable. Default\tValue: By\tdefault,\tACK\tTEE-based\tconfidential\tcomputing\tis\tdisabled References: 1. https://www.alibabacloud.com/help/doc-detail/164536.htm 2. https://www.alibabacloud.com/help/doc-detail/150518.htm 3. https://www.alibabacloud.com/help/doc-detail/164537.htm CIS\tControls: Version\t7 18.9\tSeparate\tProduction\tand\tNon-Production\tSystems Maintain\tseparate\tenvironments\tfor\tproduction\tand\tnonproduction\tsystems.\tDevelopers should\tnot\thave\tunmonitored\taccess\tto\tproduction\tenvironments. 278\t|\tP a g e",
    "remediation": null,
    "references": "1. https://www.alibabacloud.com/help/doc-detail/164536.htm 2. https://www.alibabacloud.com/help/doc-detail/150518.htm 3. https://www.alibabacloud.com/help/doc-detail/164537.htm CIS\tControls: Version\t7 18.9\tSeparate\tProduction\tand\tNon-Production\tSystems Maintain\tseparate\tenvironments\tfor\tproduction\tand\tnonproduction\tsystems.\tDevelopers should\tnot\thave\tunmonitored\taccess\tto\tproduction\tenvironments. 278\t|\tP a g e",
    "function_names": [
      "ack_cluster_tee_based_enabled",
      "ack_node_tee_based_enabled",
      "ack_workload_tee_based_enabled",
      "ack_confidential_computing_enabled",
      "ack_sgx_based_computing_enabled",
      "ack_trusted_application_environment_enabled",
      "ack_data_in_use_protected",
      "ack_confidential_computing_integrity_verified"
    ]
  },
  {
    "id": "6.6.5",
    "title": "Consider use service account token volume projection",
    "assessment": "Manual",
    "description": "Use\tservice\taccount\ttoken\tvolume\tprojection\tto\tenhance\tsecurity\twhen\tyou\tuse\tservice accounts.",
    "rationale": "The\tfeature\tof\tservice\taccount\ttoken\tvolume\tprojection\tenables\tthe\tkubelet\tto\trequest\tand store\tthe\ttoken\ton\tbehalf\tof\tthe\tpod,\tand\tallows\tyou\tto\tconfigure\ttoken\tproperties\tsuch\tas the\taudience\tand\tvalidity\tduration.\tAs\tthe\ttoken\tapproaches\texpiration,\tthe\tkubelet proactively\trotates\tthe\ttoken\tif\tit\tis\tolder\tthan\t80\tpercent\tof\tits\ttime\tto\tlive\t(TTL)\tor\tif\tit\tis older\tthan\t24\thours.",
    "audit": "Using\tCommand\tLine: 1. Log\tin\tto\tthe\tmaster\tnode\tof\tan\texisting\tdedicated\tcluser\twhich\thas\tenabled\tservice account\ttoken\tvolume\tprojection 2. Use\tthe\tfollowing\tcommand\tto\tcreate\ta\tserviceaccount: kubectl apply -f - <<EOF apiVersion: v1 kind: ServiceAccount metadata: name: xxxxx EOF  3. Use\tthe\tfollowing\tcommand\tto\tcreate\ta\tpod\twhich\tusing\tthe\tprojected serviceaccount token: kubectl apply -f - <<EOF apiVersion: v1 kind: Pod metadata: name: nginx spec: containers: 279\t|\tP a g e - image: nginx name: nginx volumeMounts: - mountPath: /var/run/secrets/tokens #customized volumemounts path for the token file name: vault-token serviceAccountName: xxxxx volumes: - name: vault-token projected: sources: - serviceAccountToken: path: vault-token  #customized audie expirationSeconds: 7200  #customized token expiration seconds audience: xxxxx    #customized audience which used to validate the tokens at the API server side  4. When\tpod\trunning,\tlog\tinto\tthe\tpod\tand\tmake\tsure\tthere\tis\ta\tprojected\ttoken\tfile generated under\tthe\tspecific\tpath\tdefined\tthe\tpod\tspec\t(e.g.\t/var/run/secrets/tokens/vault- token\tin the\tsample\tbefore).",
    "remediation": "For\tcreate\tcluster: 1. Log\ton\tto\tthe\tACK\tconsole\thttps://cs.console.aliyun.com/. 2. In\tthe\tleft-side\tnavigation\tpane,\tclick\tClusters. 3. On\tthe\tClusters\tpage,\tclick\tCreate\tKubernetes\tCluster\tin\tthe\tupper-right\tcorner\tof the page. 4. On\tthe\tACK\tmanaged\tedition\ttab,\tclick\tthe\tShow\tAdvanced\tOptions,\tand\tselect\tthe Enable check\tbox\tto\tenable\tservice\taccount\ttoken\tvolume\tprojection. 5. Configure\tthe\tthe\tparameters\tof\tservice_account_issuer\tand\tapi_audiences\tupon\tto the needed. Default\tValue: By\tdefault,\tthe\tuse\tof\tservice\taccount\ttoken\tvolume\tprojection\tis\tdisabled References: 1. https://www.alibabacloud.com/help/doc-detail/160384.htm 280\t|\tP a g e 2. https://kubernetes.io/docs/tasks/configure-pod-container/configure-service- account/ CIS\tControls: Version\t7 4.3\tEnsure\tthe\tUse\tof\tDedicated\tAdministrative\tAccounts Ensure\tthat\tall\tusers\twith\tadministrative\taccount\taccess\tuse\ta\tdedicated\tor\tsecondary account\tfor\televated\tactivities.\tThis\taccount\tshould\tonly\tbe\tused\tfor\tadministrative activities\tand\tnot\tinternet\tbrowsing,\temail,\tor\tsimilar\tactivities. 281\t|\tP a g e Appendix:\tSummary\tTable Control\t Set Correctly Yes\t No 1\t Control\tPlane\tComponents 1.1\t Master\tNode\tConfiguration\tFiles 1.1.1\t Ensure\tthat\tthe\tAPI\tserver\tpod\tspecification\tfile\tpermissions are\tset\tto\t644\tor\tmore\trestrictive\t(Automated)\t o\t o 1.1.2\t Ensure\tthat\tthe\tAPI\tserver\tpod\tspecification\tfile\townership is\tset\tto\troot:root\t(Automated)\t o\t o 1.1.3\t Ensure\tthat\tthe\tcontroller\tmanager\tpod\tspecification\tfile permissions\tare\tset\tto\t644\tor\tmore\trestrictive\t(Automated)\t o\t o 1.1.4\t Ensure\tthat\tthe\tcontroller\tmanager\tpod\tspecification\tfile ownership\tis\tset\tto\troot:root\t(Automated)\t o\t o 1.1.5\t Ensure\tthat\tthe\tscheduler\tpod\tspecification\tfile\tpermissions are\tset\tto\t644\tor\tmore\trestrictive\t(Automated)\t o\t o 1.1.6\t Ensure\tthat\tthe\tscheduler\tpod\tspecification\tfile\townership\tis set\tto\troot:root\t(Automated)\t o\t o 1.1.7\t Ensure\tthat\tthe\tetcd\tservice\tfile\tpermissions\tare\tset\tto\t644 or\tmore\trestrictive\t(Automated)\t o\t o 1.1.8\t Ensure\tthat\tthe\tetcd\tservice\tfile\townership\tis\tset\tto root:root\t(Automated)\t o\t o 1.1.9\t Ensure\tthat\tthe\tContainer\tNetwork\tInterface\tfile permissions\tare\tset\tto\t644\tor\tmore\trestrictive\t(Manual)\t o\t o 1.1.10\t Ensure\tthat\tthe\tContainer\tNetwork\tInterface\tfile\townership is\tset\tto\troot:root\t(Manual)\t o\t o 1.1.11\t Ensure\tthat\tthe\tetcd\tdata\tdirectory\tpermissions\tare\tset\tto 700\tor\tmore\trestrictive\t(Automated)\t o\t o 1.1.12\t Ensure\tthat\tthe\tetcd\tdata\tdirectory\townership\tis\tset\tto etcd:etcd\t(Automated)\t o\t o 1.1.13\t Ensure\tthat\tthe\tadmin.conf\tfile\tpermissions\tare\tset\tto\t644\tor more\trestrictive\t(Automated)\t o\t o 1.1.14\t Ensure\tthat\tthe\tadmin.conf\tfile\townership\tis\tset\tto\troot:root (Automated)\t o\t o 1.1.15\t Ensure\tthat\tthe\tscheduler.conf\tfile\tpermissions\tare\tset\tto 644\tor\tmore\trestrictive\t(Automated)\t o\t o 1.1.16\t Ensure\tthat\tthe\tscheduler.conf\tfile\townership\tis\tset\tto root:root\t(Automated)\t o\t o 1.1.17\t Ensure\tthat\tthe\tcontroller-manager.conf\tfile\tpermissions\tare set\tto\t644\tor\tmore\trestrictive\t(Automated)\t o\t o 1.1.18\t Ensure\tthat\tthe\tcontroller-manager.conf\tfile\townership\tis set\tto\troot:root\t(Automated)\t o\t o 282\t|\tP a g e 1.1.19\t Ensure\tthat\tthe\tKubernetes\tPKI\tdirectory\tand\tfile ownership\tis\tset\tto\troot:root\t(Automated)\t o\t o 1.1.20\t Ensure\tthat\tthe\tKubernetes\tPKI\tcertificate\tfile\tpermissions are\tset\tto\t644\tor\tmore\trestrictive\t(Manual)\t o\t o 1.1.21\t Ensure\tthat\tthe\tKubernetes\tPKI\tkey\tfile\tpermissions\tare\tset to\t600\t(Manual)\t o\t o 1.2\t API\tServer 1.2.1\t Ensure\tthat\tthe\t--basic-auth-file\targument\tis\tnot\tset (Automated)\t o\t o 1.2.2\t Ensure\tthat\tthe\t--token-auth-file\tparameter\tis\tnot\tset (Automated)\t o\t o 1.2.3\t Ensure\tthat\tthe\t--kubelet-https\targument\tis\tset\tto\ttrue (Automated)\t o\t o 1.2.4\t Ensure\tthat\tthe\t--kubelet-client-certificate\tand\t--kubelet- client-key\targuments\tare\tset\tas\tappropriate\t(Automated)\t o\t o 1.2.5\t Ensure\tthat\tthe\t--authorization-mode\targument\tis\tnot\tset\tto AlwaysAllow\t(Automated)\t o\t o 1.2.6\t Ensure\tthat\tthe\t--authorization-mode\targument\tincludes Node\t(Automated)\t o\t o 1.2.7\t Ensure\tthat\tthe\t--authorization-mode\targument\tincludes RBAC\t(Automated)\t o\t o 1.2.8\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin\tEventRateLimit\tis set\t(Manual)\t o\t o 1.2.9\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin\tAlwaysAdmit\tis not\tset\t(Automated)\t o\t o 1.2.10\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin\tAlwaysPullImages is\tset\t(Manual)\t o\t o 1.2.11\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin SecurityContextDeny\tis\tset\tif\tPodSecurityPolicy\tis\tnot\tused (Manual) o\t o 1.2.12\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin\tServiceAccount\tis set\t(Automated)\t o\t o 1.2.13\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin NamespaceLifecycle\tis\tset\t(Automated)\t o\t o 1.2.14\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin\tPodSecurityPolicy is\tset\t(Automated)\t o\t o 1.2.15\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin\tNodeRestriction\tis set\t(Automated)\t o\t o 1.2.16\t Ensure\tthat\tthe\t--insecure-bind-address\targument\tis\tnot\tset (Automated)\t o\t o 1.2.17\t Ensure\tthat\tthe\t--insecure-port\targument\tis\tset\tto\t0 (Automated)\t o\t o 1.2.18\t Ensure\tthat\tthe\t--secure-port\targument\tis\tnot\tset\tto\t0 (Automated)\t o\t o 283\t|\tP a g e 1.2.19\t Ensure\tthat\tthe\t--profiling\targument\tis\tset\tto\tfalse (Automated)\t o\t o 1.2.20\t Ensure\tthat\tthe\t--audit-log-path\targument\tis\tset (Automated)\t o\t o 1.2.21\t Ensure\tthat\tthe\t--audit-log-maxage\targument\tis\tset\tto\t30\tor as\tappropriate\t(Automated)\t o\t o 1.2.22\t Ensure\tthat\tthe\t--audit-log-maxbackup\targument\tis\tset\tto\t10 or\tas\tappropriate\t(Automated)\t o\t o 1.2.23\t Ensure\tthat\tthe\t--audit-log-maxsize\targument\tis\tset\tto\t100 or\tas\tappropriate\t(Automated)\t o\t o 1.2.24\t Ensure\tthat\tthe\t--request-timeout\targument\tis\tset\tas appropriate\t(Automated)\t o\t o 1.2.25\t Ensure\tthat\tthe\t--service-account-lookup\targument\tis\tset\tto true\t(Automated)\t o\t o 1.2.26\t Ensure\tthat\tthe\t--service-account-key-file\targument\tis\tset\tas appropriate\t(Automated)\t o\t o 1.2.27\t Ensure\tthat\tthe\t--etcd-certfile\tand\t--etcd-keyfile\targuments are\tset\tas\tappropriate\t(Automated)\t o\t o 1.2.28\t Ensure\tthat\tthe\t--tls-cert-file\tand\t--tls-private-key-file arguments\tare\tset\tas\tappropriate\t(Automated)\t o\t o 1.2.29\t Ensure\tthat\tthe\t--client-ca-file\targument\tis\tset\tas appropriate\t(Automated)\t o\t o 1.2.30\t Ensure\tthat\tthe\t--etcd-cafile\targument\tis\tset\tas\tappropriate (Automated)\t o\t o 1.2.31\t Ensure\tthat\tthe\t--encryption-provider-config\targument\tis set\tas\tappropriate\t(Manual)\t o\t o 1.2.32\t Ensure\tthat\tencryption\tproviders\tare\tappropriately configured\t(Manual)\t o\t o 1.2.33\t Ensure\tthat\tthe\tAPI\tServer\tonly\tmakes\tuse\tof\tStrong Cryptographic\tCiphers\t(Manual)\t o\t o 1.3\t Controller\tManager 1.3.1\t Ensure\tthat\tthe\t--terminated-pod-gc-threshold\targument\tis set\tas\tappropriate\t(Manual)\t o\t o 1.3.2\t Ensure\tthat\tthe\t--profiling\targument\tis\tset\tto\tfalse (Automated)\t o\t o 1.3.3\t Ensure\tthat\tthe\t--use-service-account-credentials\targument is\tset\tto\ttrue\t(Automated)\t o\t o 1.3.4\t Ensure\tthat\tthe\t--service-account-private-key-file\t\targument is\tset\tas\tappropriate\t(Automated)\t o\t o 1.3.5\t Ensure\tthat\tthe\t--root-ca-file\targument\tis\tset\tas\tappropriate (Automated)\t o\t o 1.3.6\t Ensure\tthat\tthe\t--bind-address\targument\tis\tset\tto\t127.0.0.1 (Automated)\t o\t o 1.4\t Scheduler 284\t|\tP a g e 1.4.1\t Ensure\tthat\tthe\t--profiling\targument\tis\tset\tto\tfalse (Automated)\t o\t o 1.4.2\t Ensure\tthat\tthe\t--bind-address\targument\tis\tset\tto\t127.0.0.1 (Automated)\t o\t o 2\t etcd 2.1\t Ensure\tthat\tthe\t--cert-file\tand\t--key-file\targuments\tare\tset\tas appropriate\t(Automated)\t o\t o 2.2\t Ensure\tthat\tthe\t--client-cert-auth\targument\tis\tset\tto\ttrue (Automated)\t o\t o 2.3\t Ensure\tthat\tthe\t--auto-tls\targument\tis\tnot\tset\tto\ttrue (Automated)\t o\t o 2.4\t Ensure\tthat\tthe\t--peer-cert-file\tand\t--peer-key-file arguments\tare\tset\tas\tappropriate\t(Automated)\t o\t o 2.5\t Ensure\tthat\tthe\t--peer-client-cert-auth\targument\tis\tset\tto true\t(Automated)\t o\t o 2.6\t Ensure\tthat\tthe\t--peer-auto-tls\targument\tis\tnot\tset\tto\ttrue (Automated)\t o\t o 2.7\t Ensure\tthat\ta\tunique\tCertificate\tAuthority\tis\tused\tfor\tetcd (Manual)\t o\t o 3\t Control\tPlane\tConfiguration 3.1\t Authentication\tand\tAuthorization 3.1.1\t Revoke\tclient\tcertificate\twhen\tpossible\tleakage\t(Manual)\t o\t o 3.2\t Logging 3.2.1\t Ensure\tthat\ta\tminimal\taudit\tpolicy\tis\tcreated\t(Manual)\t o\t o 3.2.2\t Ensure\tthat\tthe\taudit\tpolicy\tcovers\tkey\tsecurity\tconcerns (Manual)\t o\t o 4\t Worker\tNodes 4.1\t Worker\tNode\tConfiguration\tFiles 4.1.1\t Ensure\tthat\tthe\tkubelet\tservice\tfile\tpermissions\tare\tset\tto 644\tor\tmore\trestrictive\t(Automated)\t o\t o 4.1.2\t Ensure\tthat\tthe\tkubelet\tservice\tfile\townership\tis\tset\tto root:root\t(Automated)\t o\t o 4.1.3\t If\tproxy\tkubeconfig\tfile\texists\tensure\tpermissions\tare\tset\tto 644\tor\tmore\trestrictive\t(Manual)\t o\t o 4.1.4\t If\tproxy\tkubeconfig\tfile\texists\tensure\townership\tis\tset\tto root:root\t(Manual)\t o\t o 4.1.5\t Ensure\tthat\tthe\t--kubeconfig\tkubelet.conf\tfile\tpermissions are\tset\tto\t644\tor\tmore\trestrictive\t(Automated)\t o\t o 4.1.6\t Ensure\tthat\tthe\t--kubeconfig\tkubelet.conf\tfile\townership\tis set\tto\troot:root\t(Manual)\t o\t o 4.1.7\t Ensure\tthat\tthe\tcertificate\tauthorities\tfile\tpermissions\tare set\tto\t644\tor\tmore\trestrictive\t(Manual)\t o\t o 4.1.8\t Ensure\tthat\tthe\tclient\tcertificate\tauthorities\tfile\townership is\tset\tto\troot:root\t(Manual)\t o\t o 285\t|\tP a g e 4.1.9\t Ensure\tthat\tthe\tkubelet\t--config\tconfiguration\tfile\thas permissions\tset\tto\t644\tor\tmore\trestrictive\t(Automated)\t o\t o 4.1.10\t Ensure\tthat\tthe\tkubelet\t--config\tconfiguration\tfile ownership\tis\tset\tto\troot:root\t(Automated)\t o\t o 4.2\t Kubelet 4.2.1\t Ensure\tthat\tthe\t--anonymous-auth\targument\tis\tset\tto\tfalse (Automated)\t o\t o 4.2.2\t Ensure\tthat\tthe\t--authorization-mode\targument\tis\tnot\tset\tto AlwaysAllow\t(Automated)\t o\t o 4.2.3\t Ensure\tthat\tthe\t--client-ca-file\targument\tis\tset\tas appropriate\t(Automated)\t o\t o 4.2.4\t Verify\tthat\tthe\t--read-only-port\targument\tis\tset\tto\t0 (Manual)\t o\t o 4.2.5\t Ensure\tthat\tthe\t--streaming-connection-idle-timeout argument\tis\tnot\tset\tto\t0\t(Manual)\t o\t o 4.2.6\t Ensure\tthat\tthe\t--protect-kernel-defaults\targument\tis\tset\tto true\t(Manual)\t o\t o 4.2.7\t Ensure\tthat\tthe\t--make-iptables-util-chains\targument\tis\tset to\ttrue\t(Automated)\t o\t o 4.2.8\t Ensure\tthat\tthe\t--event-qps\targument\tis\tset\tto\t0\tor\ta\tlevel which\tensures\tappropriate\tevent\tcapture\t(Manual)\t o\t o 4.2.9\t Ensure\tthat\tthe\t--tls-cert-file\tand\t--tls-private-key-file arguments\tare\tset\tas\tappropriate\t(Manual)\t o\t o 4.2.10\t Ensure\tthat\tthe\tKubelet\tonly\tmakes\tuse\tof\tStrong Cryptographic\tCiphers\t(Manual)\t o\t o 5\t Policies 5.1\t RBAC\tand\tService\tAccounts 5.1.1\t Ensure\tthat\tthe\tcluster-admin\trole\tis\tonly\tused\twhere required\t(Manual)\t o\t o 5.1.2\t Minimize\taccess\tto\tsecrets\t(Manual)\t o\t o 5.1.3\t Minimize\twildcard\tuse\tin\tRoles\tand\tClusterRoles\t(Manual)\t o\t o 5.1.4\t Minimize\taccess\tto\tcreate\tpods\t(Manual)\t o\t o 5.1.5\t Ensure\tthat\tdefault\tservice\taccounts\tare\tnot\tactively\tused. (Manual)\t o\t o 5.1.6\t Ensure\tthat\tService\tAccount\tTokens\tare\tonly\tmounted where\tnecessary\t(Manual)\t o\t o 5.2\t Pod\tSecurity\tPolicies 5.2.1\t Minimize\tthe\tadmission\tof\tprivileged\tcontainers\t(Manual)\t o\t o 5.2.2\t Minimize\tthe\tadmission\tof\tcontainers\twishing\tto\tshare\tthe host\tprocess\tID\tnamespace\t(Manual)\t o\t o 5.2.3\t Minimize\tthe\tadmission\tof\tcontainers\twishing\tto\tshare\tthe host\tIPC\tnamespace\t(Manual)\t o\t o 5.2.4\t Minimize\tthe\tadmission\tof\tcontainers\twishing\tto\tshare\tthe host\tnetwork\tnamespace\t(Manual)\t o\t o 286\t|\tP a g e 5.2.5\t Minimize\tthe\tadmission\tof\tcontainers\twith allowPrivilegeEscalation\t(Manual)\t o\t o 5.2.6\t Minimize\tthe\tadmission\tof\troot\tcontainers\t(Manual)\t o\t o 5.2.7\t Minimize\tthe\tadmission\tof\tcontainers\twith\tthe\tNET_RAW capability\t(Manual)\t o\t o 5.2.8\t Minimize\tthe\tadmission\tof\tcontainers\twith\tadded capabilities\t(Manual)\t o\t o 5.2.9\t Minimize\tthe\tadmission\tof\tcontainers\twith\tcapabilities assigned\t(Manual)\t o\t o 5.3\t Network\tPolicies\tand\tCNI 5.3.1\t Ensure\tthat\tthe\tCNI\tin\tuse\tsupports\tNetwork\tPolicies (Manual)\t o\t o 5.3.2\t Ensure\tthat\tall\tNamespaces\thave\tNetwork\tPolicies\tdefined (Manual)\t o\t o 5.4\t Secrets\tManagement 5.4.1\t Prefer\tusing\tsecrets\tas\tfiles\tover\tsecrets\tas\tenvironment variables\t(Manual)\t o\t o 5.4.2\t Consider\texternal\tsecret\tstorage\t(Manual)\t o\t o 5.5\t Extensible\tAdmission\tControl 5.5.1\t Configure\tImage\tProvenance\tusing\tImagePolicyWebhook admission\tcontroller\t(Manual)\t o\t o 5.6\t General\tPolicies 5.6.1\t Create\tadministrative\tboundaries\tbetween\tresources\tusing namespaces\t(Manual)\t o\t o 5.6.2\t Ensure\tthat\tthe\tseccomp\tprofile\tis\tset\tto\truntime/default\tin your\tpod\tdefinitions\t(Manual)\t o\t o 5.6.3\t Apply\tSecurity\tContext\tto\tYour\tPods\tand\tContainers (Manual)\t o\t o 5.6.4\t The\tdefault\tnamespace\tshould\tnot\tbe\tused\t(Manual)\t o\t o 6\t Managed\tservices 6.1\t Image\tRegistry\tand\tImage\tScanning 6.1.1\t Ensure\tImage\tVulnerability\tScanning\tusing\tACR\timage scanning\tor\ta\tthird\tparty\tprovider\t(Manual)\t o\t o 6.1.2\t Minimize\tuser\taccess\tto\tACR\t(Manual)\t o\t o 6.1.3\t Minimize\tcluster\taccess\tto\tread-only\tfor\tACR\t(Manual)\t o\t o 6.1.4\t Minimize\tContainer\tRegistries\tto\tonly\tthose\tapproved (Manual)\t o\t o 6.2\t Key\tManagement\tService\t(KMS) 6.2.1\t Ensure\tKubernetes\tSecrets\tare\tencrypted\tusing\tkeys managed\tin\tKMS\t(Manual)\t o\t o 6.3\t Cluster\tNetworking 6.3.1\t Restrict\tAccess\tto\tthe\tControl\tPlane\tEndpoint\t(Manual)\t o\t o 287\t|\tP a g e 6.3.2\t Ensure\tclusters\tare\tcreated\twith\tPrivate\tEndpoint\tEnabled and\tPublic\tAccess\tDisabled\t(Manual)\t o\t o 6.3.3\t Ensure\tclusters\tare\tcreated\twith\tPrivate\tNodes\t(Manual)\t o\t o 6.3.4\t Ensure\tNetwork\tPolicy\tis\tEnabled\tand\tset\tas\tappropriate (Manual)\t o\t o 6.3.5\t Encrypt\ttraffic\tto\tHTTPS\tload\tbalancers\twith\tTLS\tcertificates (Manual)\t o\t o 6.4\t Storage 6.4.1\t Enable\tdata\tdisk\tencryption\tfor\tAlibaba\tCloud\tDisks (Manual)\t o\t o 6.5\t Logging 6.5.1\t Ensure\tCluster\tAuditing\tis\tEnabled\t(Manual)\t o\t o 6.6\t Other\tCluster\tConfigurations 6.6.1\t Ensure\tPod\tSecurity\tPolicy\tis\tEnabled\tand\tset\tas appropriate\t(Manual)\t o\t o 6.6.2\t Enable\tCloud\tSecurity\tCenter\t(Manual)\t o\t o 6.6.3\t Consider\tACK\tSandboxed-Container\tfor\trunning\tuntrusted workloads\t(Manual)\t o\t o 6.6.4\t Consider\tACK\tTEE-based\twhen\trunning\tconfidential computing\t(Manual)\t o\t o 6.6.5\t Consider\tuse\tservice\taccount\ttoken\tvolume\tprojection (Manual)\t o\t o 288\t|\tP a g e  Appendix:\tChange\tHistory Date\t Version\t Changes\tfor\tthis\tversion",
    "references": "1. https://www.alibabacloud.com/help/doc-detail/160384.htm 280\t|\tP a g e 2. https://kubernetes.io/docs/tasks/configure-pod-container/configure-service- account/ CIS\tControls: Version\t7 4.3\tEnsure\tthe\tUse\tof\tDedicated\tAdministrative\tAccounts Ensure\tthat\tall\tusers\twith\tadministrative\taccount\taccess\tuse\ta\tdedicated\tor\tsecondary account\tfor\televated\tactivities.\tThis\taccount\tshould\tonly\tbe\tused\tfor\tadministrative activities\tand\tnot\tinternet\tbrowsing,\temail,\tor\tsimilar\tactivities. 281\t|\tP a g e Appendix:\tSummary\tTable Control\t Set Correctly Yes\t No 1\t Control\tPlane\tComponents 1.1\t Master\tNode\tConfiguration\tFiles 1.1.1\t Ensure\tthat\tthe\tAPI\tserver\tpod\tspecification\tfile\tpermissions are\tset\tto\t644\tor\tmore\trestrictive\t(Automated)\t o\t o 1.1.2\t Ensure\tthat\tthe\tAPI\tserver\tpod\tspecification\tfile\townership is\tset\tto\troot:root\t(Automated)\t o\t o 1.1.3\t Ensure\tthat\tthe\tcontroller\tmanager\tpod\tspecification\tfile permissions\tare\tset\tto\t644\tor\tmore\trestrictive\t(Automated)\t o\t o 1.1.4\t Ensure\tthat\tthe\tcontroller\tmanager\tpod\tspecification\tfile ownership\tis\tset\tto\troot:root\t(Automated)\t o\t o 1.1.5\t Ensure\tthat\tthe\tscheduler\tpod\tspecification\tfile\tpermissions are\tset\tto\t644\tor\tmore\trestrictive\t(Automated)\t o\t o 1.1.6\t Ensure\tthat\tthe\tscheduler\tpod\tspecification\tfile\townership\tis set\tto\troot:root\t(Automated)\t o\t o 1.1.7\t Ensure\tthat\tthe\tetcd\tservice\tfile\tpermissions\tare\tset\tto\t644 or\tmore\trestrictive\t(Automated)\t o\t o 1.1.8\t Ensure\tthat\tthe\tetcd\tservice\tfile\townership\tis\tset\tto root:root\t(Automated)\t o\t o 1.1.9\t Ensure\tthat\tthe\tContainer\tNetwork\tInterface\tfile permissions\tare\tset\tto\t644\tor\tmore\trestrictive\t(Manual)\t o\t o 1.1.10\t Ensure\tthat\tthe\tContainer\tNetwork\tInterface\tfile\townership is\tset\tto\troot:root\t(Manual)\t o\t o 1.1.11\t Ensure\tthat\tthe\tetcd\tdata\tdirectory\tpermissions\tare\tset\tto 700\tor\tmore\trestrictive\t(Automated)\t o\t o 1.1.12\t Ensure\tthat\tthe\tetcd\tdata\tdirectory\townership\tis\tset\tto etcd:etcd\t(Automated)\t o\t o 1.1.13\t Ensure\tthat\tthe\tadmin.conf\tfile\tpermissions\tare\tset\tto\t644\tor more\trestrictive\t(Automated)\t o\t o 1.1.14\t Ensure\tthat\tthe\tadmin.conf\tfile\townership\tis\tset\tto\troot:root (Automated)\t o\t o 1.1.15\t Ensure\tthat\tthe\tscheduler.conf\tfile\tpermissions\tare\tset\tto 644\tor\tmore\trestrictive\t(Automated)\t o\t o 1.1.16\t Ensure\tthat\tthe\tscheduler.conf\tfile\townership\tis\tset\tto root:root\t(Automated)\t o\t o 1.1.17\t Ensure\tthat\tthe\tcontroller-manager.conf\tfile\tpermissions\tare set\tto\t644\tor\tmore\trestrictive\t(Automated)\t o\t o 1.1.18\t Ensure\tthat\tthe\tcontroller-manager.conf\tfile\townership\tis set\tto\troot:root\t(Automated)\t o\t o 282\t|\tP a g e 1.1.19\t Ensure\tthat\tthe\tKubernetes\tPKI\tdirectory\tand\tfile ownership\tis\tset\tto\troot:root\t(Automated)\t o\t o 1.1.20\t Ensure\tthat\tthe\tKubernetes\tPKI\tcertificate\tfile\tpermissions are\tset\tto\t644\tor\tmore\trestrictive\t(Manual)\t o\t o 1.1.21\t Ensure\tthat\tthe\tKubernetes\tPKI\tkey\tfile\tpermissions\tare\tset to\t600\t(Manual)\t o\t o 1.2\t API\tServer 1.2.1\t Ensure\tthat\tthe\t--basic-auth-file\targument\tis\tnot\tset (Automated)\t o\t o 1.2.2\t Ensure\tthat\tthe\t--token-auth-file\tparameter\tis\tnot\tset (Automated)\t o\t o 1.2.3\t Ensure\tthat\tthe\t--kubelet-https\targument\tis\tset\tto\ttrue (Automated)\t o\t o 1.2.4\t Ensure\tthat\tthe\t--kubelet-client-certificate\tand\t--kubelet- client-key\targuments\tare\tset\tas\tappropriate\t(Automated)\t o\t o 1.2.5\t Ensure\tthat\tthe\t--authorization-mode\targument\tis\tnot\tset\tto AlwaysAllow\t(Automated)\t o\t o 1.2.6\t Ensure\tthat\tthe\t--authorization-mode\targument\tincludes Node\t(Automated)\t o\t o 1.2.7\t Ensure\tthat\tthe\t--authorization-mode\targument\tincludes RBAC\t(Automated)\t o\t o 1.2.8\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin\tEventRateLimit\tis set\t(Manual)\t o\t o 1.2.9\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin\tAlwaysAdmit\tis not\tset\t(Automated)\t o\t o 1.2.10\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin\tAlwaysPullImages is\tset\t(Manual)\t o\t o 1.2.11\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin SecurityContextDeny\tis\tset\tif\tPodSecurityPolicy\tis\tnot\tused (Manual) o\t o 1.2.12\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin\tServiceAccount\tis set\t(Automated)\t o\t o 1.2.13\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin NamespaceLifecycle\tis\tset\t(Automated)\t o\t o 1.2.14\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin\tPodSecurityPolicy is\tset\t(Automated)\t o\t o 1.2.15\t Ensure\tthat\tthe\tadmission\tcontrol\tplugin\tNodeRestriction\tis set\t(Automated)\t o\t o 1.2.16\t Ensure\tthat\tthe\t--insecure-bind-address\targument\tis\tnot\tset (Automated)\t o\t o 1.2.17\t Ensure\tthat\tthe\t--insecure-port\targument\tis\tset\tto\t0 (Automated)\t o\t o 1.2.18\t Ensure\tthat\tthe\t--secure-port\targument\tis\tnot\tset\tto\t0 (Automated)\t o\t o 283\t|\tP a g e 1.2.19\t Ensure\tthat\tthe\t--profiling\targument\tis\tset\tto\tfalse (Automated)\t o\t o 1.2.20\t Ensure\tthat\tthe\t--audit-log-path\targument\tis\tset (Automated)\t o\t o 1.2.21\t Ensure\tthat\tthe\t--audit-log-maxage\targument\tis\tset\tto\t30\tor as\tappropriate\t(Automated)\t o\t o 1.2.22\t Ensure\tthat\tthe\t--audit-log-maxbackup\targument\tis\tset\tto\t10 or\tas\tappropriate\t(Automated)\t o\t o 1.2.23\t Ensure\tthat\tthe\t--audit-log-maxsize\targument\tis\tset\tto\t100 or\tas\tappropriate\t(Automated)\t o\t o 1.2.24\t Ensure\tthat\tthe\t--request-timeout\targument\tis\tset\tas appropriate\t(Automated)\t o\t o 1.2.25\t Ensure\tthat\tthe\t--service-account-lookup\targument\tis\tset\tto true\t(Automated)\t o\t o 1.2.26\t Ensure\tthat\tthe\t--service-account-key-file\targument\tis\tset\tas appropriate\t(Automated)\t o\t o 1.2.27\t Ensure\tthat\tthe\t--etcd-certfile\tand\t--etcd-keyfile\targuments are\tset\tas\tappropriate\t(Automated)\t o\t o 1.2.28\t Ensure\tthat\tthe\t--tls-cert-file\tand\t--tls-private-key-file arguments\tare\tset\tas\tappropriate\t(Automated)\t o\t o 1.2.29\t Ensure\tthat\tthe\t--client-ca-file\targument\tis\tset\tas appropriate\t(Automated)\t o\t o 1.2.30\t Ensure\tthat\tthe\t--etcd-cafile\targument\tis\tset\tas\tappropriate (Automated)\t o\t o 1.2.31\t Ensure\tthat\tthe\t--encryption-provider-config\targument\tis set\tas\tappropriate\t(Manual)\t o\t o 1.2.32\t Ensure\tthat\tencryption\tproviders\tare\tappropriately configured\t(Manual)\t o\t o 1.2.33\t Ensure\tthat\tthe\tAPI\tServer\tonly\tmakes\tuse\tof\tStrong Cryptographic\tCiphers\t(Manual)\t o\t o 1.3\t Controller\tManager 1.3.1\t Ensure\tthat\tthe\t--terminated-pod-gc-threshold\targument\tis set\tas\tappropriate\t(Manual)\t o\t o 1.3.2\t Ensure\tthat\tthe\t--profiling\targument\tis\tset\tto\tfalse (Automated)\t o\t o 1.3.3\t Ensure\tthat\tthe\t--use-service-account-credentials\targument is\tset\tto\ttrue\t(Automated)\t o\t o 1.3.4\t Ensure\tthat\tthe\t--service-account-private-key-file\t\targument is\tset\tas\tappropriate\t(Automated)\t o\t o 1.3.5\t Ensure\tthat\tthe\t--root-ca-file\targument\tis\tset\tas\tappropriate (Automated)\t o\t o 1.3.6\t Ensure\tthat\tthe\t--bind-address\targument\tis\tset\tto\t127.0.0.1 (Automated)\t o\t o 1.4\t Scheduler 284\t|\tP a g e 1.4.1\t Ensure\tthat\tthe\t--profiling\targument\tis\tset\tto\tfalse (Automated)\t o\t o 1.4.2\t Ensure\tthat\tthe\t--bind-address\targument\tis\tset\tto\t127.0.0.1 (Automated)\t o\t o 2\t etcd 2.1\t Ensure\tthat\tthe\t--cert-file\tand\t--key-file\targuments\tare\tset\tas appropriate\t(Automated)\t o\t o 2.2\t Ensure\tthat\tthe\t--client-cert-auth\targument\tis\tset\tto\ttrue (Automated)\t o\t o 2.3\t Ensure\tthat\tthe\t--auto-tls\targument\tis\tnot\tset\tto\ttrue (Automated)\t o\t o 2.4\t Ensure\tthat\tthe\t--peer-cert-file\tand\t--peer-key-file arguments\tare\tset\tas\tappropriate\t(Automated)\t o\t o 2.5\t Ensure\tthat\tthe\t--peer-client-cert-auth\targument\tis\tset\tto true\t(Automated)\t o\t o 2.6\t Ensure\tthat\tthe\t--peer-auto-tls\targument\tis\tnot\tset\tto\ttrue (Automated)\t o\t o 2.7\t Ensure\tthat\ta\tunique\tCertificate\tAuthority\tis\tused\tfor\tetcd (Manual)\t o\t o 3\t Control\tPlane\tConfiguration 3.1\t Authentication\tand\tAuthorization 3.1.1\t Revoke\tclient\tcertificate\twhen\tpossible\tleakage\t(Manual)\t o\t o 3.2\t Logging 3.2.1\t Ensure\tthat\ta\tminimal\taudit\tpolicy\tis\tcreated\t(Manual)\t o\t o 3.2.2\t Ensure\tthat\tthe\taudit\tpolicy\tcovers\tkey\tsecurity\tconcerns (Manual)\t o\t o 4\t Worker\tNodes 4.1\t Worker\tNode\tConfiguration\tFiles 4.1.1\t Ensure\tthat\tthe\tkubelet\tservice\tfile\tpermissions\tare\tset\tto 644\tor\tmore\trestrictive\t(Automated)\t o\t o 4.1.2\t Ensure\tthat\tthe\tkubelet\tservice\tfile\townership\tis\tset\tto root:root\t(Automated)\t o\t o 4.1.3\t If\tproxy\tkubeconfig\tfile\texists\tensure\tpermissions\tare\tset\tto 644\tor\tmore\trestrictive\t(Manual)\t o\t o 4.1.4\t If\tproxy\tkubeconfig\tfile\texists\tensure\townership\tis\tset\tto root:root\t(Manual)\t o\t o 4.1.5\t Ensure\tthat\tthe\t--kubeconfig\tkubelet.conf\tfile\tpermissions are\tset\tto\t644\tor\tmore\trestrictive\t(Automated)\t o\t o 4.1.6\t Ensure\tthat\tthe\t--kubeconfig\tkubelet.conf\tfile\townership\tis set\tto\troot:root\t(Manual)\t o\t o 4.1.7\t Ensure\tthat\tthe\tcertificate\tauthorities\tfile\tpermissions\tare set\tto\t644\tor\tmore\trestrictive\t(Manual)\t o\t o 4.1.8\t Ensure\tthat\tthe\tclient\tcertificate\tauthorities\tfile\townership is\tset\tto\troot:root\t(Manual)\t o\t o 285\t|\tP a g e 4.1.9\t Ensure\tthat\tthe\tkubelet\t--config\tconfiguration\tfile\thas permissions\tset\tto\t644\tor\tmore\trestrictive\t(Automated)\t o\t o 4.1.10\t Ensure\tthat\tthe\tkubelet\t--config\tconfiguration\tfile ownership\tis\tset\tto\troot:root\t(Automated)\t o\t o 4.2\t Kubelet 4.2.1\t Ensure\tthat\tthe\t--anonymous-auth\targument\tis\tset\tto\tfalse (Automated)\t o\t o 4.2.2\t Ensure\tthat\tthe\t--authorization-mode\targument\tis\tnot\tset\tto AlwaysAllow\t(Automated)\t o\t o 4.2.3\t Ensure\tthat\tthe\t--client-ca-file\targument\tis\tset\tas appropriate\t(Automated)\t o\t o 4.2.4\t Verify\tthat\tthe\t--read-only-port\targument\tis\tset\tto\t0 (Manual)\t o\t o 4.2.5\t Ensure\tthat\tthe\t--streaming-connection-idle-timeout argument\tis\tnot\tset\tto\t0\t(Manual)\t o\t o 4.2.6\t Ensure\tthat\tthe\t--protect-kernel-defaults\targument\tis\tset\tto true\t(Manual)\t o\t o 4.2.7\t Ensure\tthat\tthe\t--make-iptables-util-chains\targument\tis\tset to\ttrue\t(Automated)\t o\t o 4.2.8\t Ensure\tthat\tthe\t--event-qps\targument\tis\tset\tto\t0\tor\ta\tlevel which\tensures\tappropriate\tevent\tcapture\t(Manual)\t o\t o 4.2.9\t Ensure\tthat\tthe\t--tls-cert-file\tand\t--tls-private-key-file arguments\tare\tset\tas\tappropriate\t(Manual)\t o\t o 4.2.10\t Ensure\tthat\tthe\tKubelet\tonly\tmakes\tuse\tof\tStrong Cryptographic\tCiphers\t(Manual)\t o\t o 5\t Policies 5.1\t RBAC\tand\tService\tAccounts 5.1.1\t Ensure\tthat\tthe\tcluster-admin\trole\tis\tonly\tused\twhere required\t(Manual)\t o\t o 5.1.2\t Minimize\taccess\tto\tsecrets\t(Manual)\t o\t o 5.1.3\t Minimize\twildcard\tuse\tin\tRoles\tand\tClusterRoles\t(Manual)\t o\t o 5.1.4\t Minimize\taccess\tto\tcreate\tpods\t(Manual)\t o\t o 5.1.5\t Ensure\tthat\tdefault\tservice\taccounts\tare\tnot\tactively\tused. (Manual)\t o\t o 5.1.6\t Ensure\tthat\tService\tAccount\tTokens\tare\tonly\tmounted where\tnecessary\t(Manual)\t o\t o 5.2\t Pod\tSecurity\tPolicies 5.2.1\t Minimize\tthe\tadmission\tof\tprivileged\tcontainers\t(Manual)\t o\t o 5.2.2\t Minimize\tthe\tadmission\tof\tcontainers\twishing\tto\tshare\tthe host\tprocess\tID\tnamespace\t(Manual)\t o\t o 5.2.3\t Minimize\tthe\tadmission\tof\tcontainers\twishing\tto\tshare\tthe host\tIPC\tnamespace\t(Manual)\t o\t o 5.2.4\t Minimize\tthe\tadmission\tof\tcontainers\twishing\tto\tshare\tthe host\tnetwork\tnamespace\t(Manual)\t o\t o 286\t|\tP a g e 5.2.5\t Minimize\tthe\tadmission\tof\tcontainers\twith allowPrivilegeEscalation\t(Manual)\t o\t o 5.2.6\t Minimize\tthe\tadmission\tof\troot\tcontainers\t(Manual)\t o\t o 5.2.7\t Minimize\tthe\tadmission\tof\tcontainers\twith\tthe\tNET_RAW capability\t(Manual)\t o\t o 5.2.8\t Minimize\tthe\tadmission\tof\tcontainers\twith\tadded capabilities\t(Manual)\t o\t o 5.2.9\t Minimize\tthe\tadmission\tof\tcontainers\twith\tcapabilities assigned\t(Manual)\t o\t o 5.3\t Network\tPolicies\tand\tCNI 5.3.1\t Ensure\tthat\tthe\tCNI\tin\tuse\tsupports\tNetwork\tPolicies (Manual)\t o\t o 5.3.2\t Ensure\tthat\tall\tNamespaces\thave\tNetwork\tPolicies\tdefined (Manual)\t o\t o 5.4\t Secrets\tManagement 5.4.1\t Prefer\tusing\tsecrets\tas\tfiles\tover\tsecrets\tas\tenvironment variables\t(Manual)\t o\t o 5.4.2\t Consider\texternal\tsecret\tstorage\t(Manual)\t o\t o 5.5\t Extensible\tAdmission\tControl 5.5.1\t Configure\tImage\tProvenance\tusing\tImagePolicyWebhook admission\tcontroller\t(Manual)\t o\t o 5.6\t General\tPolicies 5.6.1\t Create\tadministrative\tboundaries\tbetween\tresources\tusing namespaces\t(Manual)\t o\t o 5.6.2\t Ensure\tthat\tthe\tseccomp\tprofile\tis\tset\tto\truntime/default\tin your\tpod\tdefinitions\t(Manual)\t o\t o 5.6.3\t Apply\tSecurity\tContext\tto\tYour\tPods\tand\tContainers (Manual)\t o\t o 5.6.4\t The\tdefault\tnamespace\tshould\tnot\tbe\tused\t(Manual)\t o\t o 6\t Managed\tservices 6.1\t Image\tRegistry\tand\tImage\tScanning 6.1.1\t Ensure\tImage\tVulnerability\tScanning\tusing\tACR\timage scanning\tor\ta\tthird\tparty\tprovider\t(Manual)\t o\t o 6.1.2\t Minimize\tuser\taccess\tto\tACR\t(Manual)\t o\t o 6.1.3\t Minimize\tcluster\taccess\tto\tread-only\tfor\tACR\t(Manual)\t o\t o 6.1.4\t Minimize\tContainer\tRegistries\tto\tonly\tthose\tapproved (Manual)\t o\t o 6.2\t Key\tManagement\tService\t(KMS) 6.2.1\t Ensure\tKubernetes\tSecrets\tare\tencrypted\tusing\tkeys managed\tin\tKMS\t(Manual)\t o\t o 6.3\t Cluster\tNetworking 6.3.1\t Restrict\tAccess\tto\tthe\tControl\tPlane\tEndpoint\t(Manual)\t o\t o 287\t|\tP a g e 6.3.2\t Ensure\tclusters\tare\tcreated\twith\tPrivate\tEndpoint\tEnabled and\tPublic\tAccess\tDisabled\t(Manual)\t o\t o 6.3.3\t Ensure\tclusters\tare\tcreated\twith\tPrivate\tNodes\t(Manual)\t o\t o 6.3.4\t Ensure\tNetwork\tPolicy\tis\tEnabled\tand\tset\tas\tappropriate (Manual)\t o\t o 6.3.5\t Encrypt\ttraffic\tto\tHTTPS\tload\tbalancers\twith\tTLS\tcertificates (Manual)\t o\t o 6.4\t Storage 6.4.1\t Enable\tdata\tdisk\tencryption\tfor\tAlibaba\tCloud\tDisks (Manual)\t o\t o 6.5\t Logging 6.5.1\t Ensure\tCluster\tAuditing\tis\tEnabled\t(Manual)\t o\t o 6.6\t Other\tCluster\tConfigurations 6.6.1\t Ensure\tPod\tSecurity\tPolicy\tis\tEnabled\tand\tset\tas appropriate\t(Manual)\t o\t o 6.6.2\t Enable\tCloud\tSecurity\tCenter\t(Manual)\t o\t o 6.6.3\t Consider\tACK\tSandboxed-Container\tfor\trunning\tuntrusted workloads\t(Manual)\t o\t o 6.6.4\t Consider\tACK\tTEE-based\twhen\trunning\tconfidential computing\t(Manual)\t o\t o 6.6.5\t Consider\tuse\tservice\taccount\ttoken\tvolume\tprojection (Manual)\t o\t o 288\t|\tP a g e  Appendix:\tChange\tHistory Date\t Version\t Changes\tfor\tthis\tversion",
    "function_names": [
      "compute_pod_service_account_token_projection_enabled",
      "compute_pod_service_account_token_volume_projection_enabled",
      "kubernetes_pod_service_account_token_projection_enabled",
      "kubernetes_pod_service_account_token_volume_projection_enabled",
      "container_pod_service_account_token_projection_enabled",
      "container_pod_service_account_token_volume_projection_enabled"
    ]
  }
]