[
  {
    "id": "1.1",
    "title": "Remove extraneous files and directories",
    "assessment": "Scored",
    "description": "The installation may provide example applications, documentation, and other directories which may not serve a production use.",
    "rationale": "Removing sample resources is a defense in depth measure that reduces potential exposures introduced by these resources.",
    "audit": "Perform the following to determine the existence of extraneous resources: 1.      List all files extraneous files. The following should yield no output: $ ls -l $CATALINA_HOME/webapps/js-examples \\ $CATALINA_HOME/webapps/servlet-example \\ $CATALINA_HOME/webapps/webdav \\ $CATALINA_HOME/webapps/tomcat-docs \\ $CATALINA_HOME/webapps/balancer \\ $CATALINA_HOME/webapps/ROOT/admin \\ $CATALINA_HOME/webapps/examples \\ $CATALINA_HOME/server/webapps/host-manager \\ $CATALINA_HOME/server/webapps/manager \\ $CATALINA_HOME/conf/Catalina/localhost/host-manager.xml \\ $CATALINA_HOME/conf/Catalina/localhost/manager.xml",
    "remediation": "Perform the following to remove extraneous resources: 1.      The following should yield no output: 10 | P a g e $ rm -rf $CATALINA_HOME/webapps/js-examples \\ $CATALINA_HOME/webapps/servlet-example \\ $CATALINA_HOME/webapps/webdav \\ $CATALINA_HOME/webapps/tomcat-docs \\ $CATALINA_HOME/webapps/balancer \\ $CATALINA_HOME/webapps/ROOT/admin \\$CATALINA_HOME/webapps/examples If the Manager application is not utilized, also remove the following resources: $ rm \u2013rf $CATALINA_HOME/server/webapps/host-manager \\ $CATALINA_HOME/server/webapps/manager \\ $CATALINA_HOME/conf/Catalina/localhost/host-manager.xml \\ $CATALINA_HOME/conf/Catalina/localhost/manager.xml Default Value: Depending on your install method, default extraneous resources will vary. 11 | P a g e",
    "function_names": [
      "system_files_unnecessary_removed",
      "system_directories_unnecessary_removed",
      "system_examples_unnecessary_removed",
      "system_documentation_unnecessary_removed",
      "system_installation_cleanup_required",
      "system_production_unused_files_removed",
      "system_production_unused_directories_removed"
    ],
    "profile_applicability": "\uf0b7  Level 2"
  },
  {
    "id": "1.2",
    "title": "Disable Unused Connectors",
    "assessment": "Not Scored",
    "description": "The default installation of Tomcat includes connectors with default settings. These are traditionally set up for convenience. It is best to remove these connectors and enable only what is needed.",
    "rationale": "Improperly configured or unnecessarily installed Connectors may lead to a security exposure.",
    "audit": "Perform the following to identify configured Connectors: 1.      Execute the following command to find configured Connectors. Ensure only those required are present and not commented out: $ grep \u201cConnector\u201d $CATALINA_HOME/conf/server.xml",
    "remediation": "Perform the following to disable unused Connectors: 1. Within $CATALINA_HOME/conf/server.xml, remove or comment each unused Connector. For example, to disable an instance of the HTTPConnector, remove the following: <Connector className=\"org.apache.catalina.connector.http.HttpConnector\" ... connectionTimeout=\"60000\"/>  Default Value: $CATALINA_HOME/conf/server.xml, has the following connectors defined by default: \uf0b7 A non-SSL Connector bound to port 8080 \uf0b7 An AJP 1.3 Connector bound to port 8009  12 | P a g e References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html#Connector_Comparison 13 | P a g e 2 Limit Server Platform Information Leaks Limiting Server Platform Information Leaks make it harder for attackers to determine which vulnerabilities affect the server platform.",
    "function_names": [
      "tomcat_connector_disabled_unused",
      "tomcat_connector_default_removed",
      "tomcat_connector_only_required_enabled",
      "tomcat_connector_default_settings_disabled",
      "tomcat_connector_unused_removed"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html#Connector_Comparison 13 | P a g e 2 Limit Server Platform Information Leaks Limiting Server Platform Information Leaks make it harder for attackers to determine which vulnerabilities affect the server platform."
  },
  {
    "id": "2.1",
    "title": "Alter the Advertised server.info String",
    "assessment": "Scored",
    "description": "The server.info attribute contains the name of the application service. This value is presented to Tomcat clients when clients connect to the tomcat server.",
    "rationale": "Altering the server.info attribute may make it harder for attackers to determine which vulnerabilities affect the server platform.",
    "audit": "Perform the following to determine if the server.info value has been changed: 1. Extract the ServerInfo.properties file and examine the server.info attribute. $ cd $CATALINA_HOME/lib $ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties $ grep server.info org/apache/catalina/util/ServerInfo.properties",
    "remediation": "Perform the following to alter the server platform string that gets displayed when clients connect to the tomcat server. 1. Extract the ServerInfo.properties file from the catalina.jar file: $ cd $CATALINA_HOME/lib $ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties 2. Navigate to the util directory that was created cd org/apache/Catalina/util 3. Open ServerInfo.properties in an editor 4. Update the server.info attribute in the ServerInfo.properties file. 14 | P a g e server.info=<SomeWebServer> 5. Update the catalina.jar with the modified ServerInfo.properties file. $ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties Impact: Altering the server.info attribute may make it harder for attackers to determine which vulnerabilities affect the server platform. Default Value: The default value for the server.info attribute is Apache Tomcat/.. For example, Apache Tomcat/7.0. References: 1. http://www.owasp.org/index.php/Securing_tomcat 15 | P a g e",
    "function_names": [
      "tomcat_server_info_altered",
      "tomcat_server_info_customized",
      "tomcat_server_info_obfuscated",
      "tomcat_server_info_removed",
      "tomcat_server_info_non_default",
      "tomcat_server_info_hardened",
      "tomcat_server_info_minimized",
      "tomcat_server_info_secure_value"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "impact": "Altering the server.info attribute may make it harder for attackers to determine which vulnerabilities affect the server platform. Default Value: The default value for the server.info attribute is Apache Tomcat/.. For example, Apache Tomcat/7.0.",
    "references": "1. http://www.owasp.org/index.php/Securing_tomcat 15 | P a g e"
  },
  {
    "id": "2.2",
    "title": "Alter the Advertised server.number String",
    "assessment": "Scored",
    "description": "The server.number attribute represents the specific version of Tomcat that is executing. This value is presented to Tomcat clients when connect.",
    "rationale": "Advertising a valid server version may provide attackers with information useful for locating vulnerabilities that affect the server platform. Altering the server version string may make it harder for attackers to determine which vulnerabilities affect the server platform.",
    "audit": "Perform the following to determine if the server.number value has been changed: 1. Extract the ServerInfo.properties file and examine the server.number attribute. $ cd $CATALINA_HOME/lib $ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties $ grep server.number org/apache/catalina/util/ServerInfo.properties",
    "remediation": "Perform the following to alter the server version string that gets displayed when clients connect to the server. 1. Extract the ServerInfo.properties file from the catalina.jar file: $ cd $CATALINA_HOME/lib $ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties 2. Navigate to the util directory that was created $ cd org/apache/Catalina/util 3. Open ServerInfo.properties in an editor 4. Update the server.number attribute server.number=<someversion> 5. Update the catalina.jar with the modified ServerInfo.properties file. 16 | P a g e $ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties  Default Value: The default value for the server.number attribute is a four part version number, such as 5.5.20.0. 17 | P a g e",
    "function_names": [
      "tomcat_server_version_obfuscated",
      "tomcat_server_number_removed",
      "tomcat_server_version_hidden",
      "tomcat_server_info_masked",
      "tomcat_server_header_sanitized"
    ],
    "profile_applicability": "\uf0b7  Level 2"
  },
  {
    "id": "2.3",
    "title": "Alter the Advertised server.built Date",
    "assessment": "Scored",
    "description": "The server.built date represents the date which Tomcat was compiled and packaged. This value is presented to Tomcat clients when clients connect to the server.",
    "rationale": "Altering the server.built string may make it harder for attackers to fingerprint which vulnerabilities affect the server platform.",
    "audit": "Perform the following to determine if the server.built value has been changed: 1. Extract the ServerInfo.properties file and examine the server.built attribute. $ cd $CATALINA_HOME/lib $ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties $ grep server.built org/apache/catalina/util/ServerInfo.properties",
    "remediation": "Perform the following to alter the server version string that gets displayed when clients connect to the server. 1. Extract the ServerInfo.properties file from the catalina.jar file: $ cd $CATALINA_HOME/lib $ jar xf catalina.jar org/apache/catalina/util/ServerInfo.properties 2. Navigate to the util directory that was created $ cd org/apache/Catalina/util 3. Open ServerInfo.properties in an editor 4. Update the server.built attribute in the ServerInfo.properties file. server.built= 5. Update the catalina.jar with the modified ServerInfo.properties file. $ jar uf catalina.jar org/apache/catalina/util/ServerInfo.properties  18 | P a g e Default Value: The default value for the server.built attribute is build date and time. For example, Jul 8 2008 11:40:35. 19 | P a g e",
    "function_names": [
      "tomcat_server_built_date_modified",
      "tomcat_server_built_date_hidden",
      "tomcat_server_built_date_obfuscated",
      "tomcat_server_built_date_customized",
      "tomcat_server_built_date_removed"
    ],
    "profile_applicability": "\uf0b7  Level 2"
  },
  {
    "id": "2.4",
    "title": "Disable X-Powered-By HTTP Header and Rename the Server Value for all Connectors",
    "assessment": "Scored",
    "description": "The xpoweredBy setting determines if Apache Tomcat will advertise its presence via the XPowered-By HTTP header. It is recommended that this value be set to false. The server attribute overrides the default value that is sent down in the HTTP header further masking Apache Tomcat.",
    "rationale": "Preventing Tomcat from advertising its presence in this manner may make it harder for attackers to determine which vulnerabilities affect the server platform.",
    "audit": "Perform the following to determine if the server platform, as advertised in the HTTP Server header, has been changed: 1. Locate all Connector elements in $CATALINA_HOME/conf/server.xml. 2. Ensure each Connector has a server attribute and that the server attribute does not reflect Apache Tomcat. Also, make sure that the xpoweredBy attribute is NOT set to true.",
    "remediation": "Perform the following to prevent Tomcat from advertising its presence via the X- PoweredBy HTTP header. 1. Add the xpoweredBy attribute to each Connector specified in $CATALINA_HOME/conf/server.xml. Set the xpoweredBy attributes value to false. <Connector ... xpoweredBy=\"false\" /> Alternatively, ensure the xpoweredBy attribute for each Connector specified in $CATALINA_HOME/conf/server.xml is absent. 20 | P a g e 2. Add the server attribute to each Connector specified in $CATALINA_HOME/conf/server.xml. Set the server attribute value to anything except a blank string. Default Value: The default value is false. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html  21 | P a g e",
    "function_names": [
      "tomcat_connector_xpoweredby_disabled",
      "tomcat_connector_server_header_renamed",
      "tomcat_connector_http_headers_secure",
      "tomcat_connector_advertisement_disabled",
      "tomcat_connector_server_value_masked"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html  21 | P a g e"
  },
  {
    "id": "2.5",
    "title": "Disable client facing Stack Traces",
    "assessment": "Scored",
    "description": "When a runtime error occurs during request processing, Apache Tomcat will display debugging information to the requestor. It is recommended that such debug information be withheld from the requestor.",
    "rationale": "Debugging information, such as that found in call stacks, often contains sensitive information that may useful to an attacker. By preventing Tomcat from providing this information, the risk of leaking sensitive information to a potential attacker is reduced.",
    "audit": "Perform the following to determine if Tomcat is configured to prevent sending debug information to the requestor 1. Ensure an <error-page> element is defined in$ CATALINA_HOME/conf/web.xml. 2. Ensure the <error-page> element has an <exception-type> child element with a value of java.lang.Throwable. 3. Ensure the <error-page> element has a <location> child element. Note: Perform the above for each application hosted within Tomcat. Per application instances of web.xml can be found at $CATALINA_HOME/webapps/<APP_NAME>/WEB- INF/web.xml",
    "remediation": "Perform the following to prevent Tomcat from providing debug information to the requestor during runtime errors: 1. Create a web page that contains the logic or message you wish to invoke when encountering a runtime error. For example, purposes, assume this page is located at /error.jsp. 2. Add a child element, <error-page>, to the <web-app>element, in the $CATALINA_HOME/conf/web.xml file. 3. Add a child element, <exception-type>, to the <error-page> element. Set the value of the <exception-type> element to java.lang.Throwable. 22 | P a g e 4. Add a child element, <location>, to the <error-page> element. Set the value of the <location> element to the location of page created in #1. The resulting entry will look as follows: <error-page> <exception-type>java.lang.Throwable</exception-type> <location>/error.jsp</location> </error-page> Default Value: Tomcat\u2019s default configuration does not include an <error-page> element in $CATALINA_HOME/conf/web.xml. Therefore, Tomcat will provide debug information to the requestor by default. References: 1. https://tomcat.apache.org/tomcat-7.0- doc/api/org/apache/catalina/deploy/ErrorPage.html 23 | P a g e",
    "function_names": [
      "tomcat_server_stack_trace_disabled",
      "tomcat_server_debug_info_disabled",
      "tomcat_server_error_details_suppressed",
      "tomcat_server_runtime_error_hidden",
      "tomcat_server_debugging_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. https://tomcat.apache.org/tomcat-7.0- doc/api/org/apache/catalina/deploy/ErrorPage.html 23 | P a g e"
  },
  {
    "id": "2.6",
    "title": "Turn off TRACE",
    "assessment": "Scored",
    "description": "The HTTP TRACE verb provides debugging and diagnostics information for a given request.",
    "rationale": "Diagnostic information, such as that found in the response to a TRACE request, often contains sensitive information that may useful to an attacker. By preventing Tomcat from providing this information, the risk of leaking sensitive information to a potential attacker is reduced.",
    "audit": "Perform the following to determine if the server platform, as advertised in the HTTP Server header, has been changed: 1. Locate all Connector elements in $CATALINA_HOME/conf/server.xml. 2. Ensure each Connector does not have a getTrace attribute or if the getTrace attribute is not set true. Note: Perform the above for each application hosted within Tomcat. Per application instances of web.xml can be found at $CATALINA_HOME/webapps/<APP_NAME>/WEBINF/web.xml",
    "remediation": "Perform the following to prevent Tomcat from accepting a TRACE request: 1. Add the allowTrace attribute to each Connector specified in $CATALINA_HOME/conf/server.xml. Set the allowTrace attributes value to false. 2. <Connector ... allowTrace=\"false\" /> Alternatively, ensure the allowTrace attribute for each Connector specified in $CATALINA_HOME/conf/server.xml is absent. 24 | P a g e Default Value: Tomcat does not allow the TRACE HTTP verb by default. Tomcat will only allow TRACE if the allowTrace attribute is present and set to true. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html 25 | P a g e 3 Protect the Shutdown Port Tomcat listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted.",
    "function_names": [
      "cloud_cdn_distribution_trace_disabled",
      "compute_load_balancer_trace_disabled",
      "cloudfront_distribution_trace_disabled",
      "api_gateway_trace_disabled",
      "application_load_balancer_trace_disabled",
      "network_load_balancer_trace_disabled",
      "web_application_firewall_trace_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html 25 | P a g e 3 Protect the Shutdown Port Tomcat listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted."
  },
  {
    "id": "3.1",
    "title": "Set a nondeterministic Shutdown command value",
    "assessment": "Scored",
    "description": "Tomcat listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not exposed to the network as it is bound to the loopback interface. It is recommended that a nondeterministic value be set for the shutdown attribute in $CATALINA_HOME/conf/server.xml.",
    "rationale": "Setting the shutdown attribute to a nondeterministic value will prevent malicious local users from shutting down Tomcat.",
    "audit": "Perform the following to determine if the shutdown port is configured to use the default shutdown command: 1. Ensure the shutdown attribute in $CATALINA_HOME/conf/server.xml is not set to SHUTDOWN. $ cd $CATALINA_HOME/conf $ grep \u2018shutdown[[:space:]]*=[[:space:]]*\u201dSHUTDOWN\u201f\u2019 server.xml",
    "remediation": "Perform the following to set a nondeterministic value for the shutdown attribute. 1. Update the shutdown attribute in $CATALINA_HOME/conf/server.xml as follows: 2. <Server port=\"8005\" shutdown=\"NONDETERMINISTICVALUE\"> 26 | P a g e Note: NONDETERMINISTICVALUE should be replaced with a sequence of random characters. Default Value: The default value for the shutdown attribute is SHUTDOWN. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/server.html 27 | P a g e",
    "function_names": [
      "tomcat_server_shutdown_nondeterministic",
      "tomcat_server_shutdown_command_secure",
      "tomcat_server_shutdown_port_protected",
      "tomcat_server_shutdown_value_randomized",
      "tomcat_server_shutdown_config_secure"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/server.html 27 | P a g e"
  },
  {
    "id": "3.2",
    "title": "Disable the Shutdown port",
    "assessment": "Not Scored",
    "description": "Tomcat listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not exposed to the network as it is bound to the loopback interface. If this functionality is not used, it is recommended that the Shutdown port be disabled.",
    "rationale": "Disabling the Shutdown port will eliminate the risk of malicious local entities using the shutdown command to disable the Tomcat server.",
    "audit": "Perform the following to determine if the shutdown port has been disabled: 1. Ensure the port attribute in $CATALINA_HOME/conf/server.xml is set to -1. 2. $ cd $CATALINA_HOME/conf/ 3. $ grep '<Server[[:space:]]\\+[^>]*port[[:space:]]*=[[:space:]]*\"-1\"' server.xml",
    "remediation": "Perform the following to disable the Shutdown port. 1. Set the port to -1 in the $CATALINA_HOME/conf/server.xml file: <Server port=\"-1\" shutdown=\"SHUTDOWN\"> Default Value: The shutdown port is enabled on TCP port 8005, bound to the loopback address. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/server.html 28 | P a g e 4 Protect Tomcat Configurations The security of processes and data that traverse or depend on Tomcat may become compromised if the is not Tomcat configurations are not secured.",
    "function_names": [
      "tomcat_server_shutdown_port_disabled",
      "tomcat_server_shutdown_port_loopback_restricted",
      "tomcat_server_shutdown_port_unused_removed",
      "tomcat_server_shutdown_port_access_restricted",
      "tomcat_server_shutdown_port_default_closed"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/server.html 28 | P a g e 4 Protect Tomcat Configurations The security of processes and data that traverse or depend on Tomcat may become compromised if the is not Tomcat configurations are not secured."
  },
  {
    "id": "4.1",
    "title": "Restrict access to $CATALINA_HOME",
    "assessment": "Scored",
    "description": "$CATALINA_HOME is the environment variable which holds the path to the root Tomcat directory. It is important to protect access to this in order to protect the Tomcat binaries and libraries from unauthorized modification. It is recommended that the ownership of $CATALINA_HOME be tomcat_admin:tomcat. It is also recommended that the permission on $CATALINA_HOME prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w).",
    "rationale": "The security of processes and data that traverse or depend on Tomcat may become compromised if the $CATALINA_HOME is not secured.",
    "audit": "Perform the following to ensure the permission on the $CATALINA_HOME directory prevent unauthorized modification. $ cd $CATALINA_HOME $ find . -follow -maxdepth 0 \\( -perm -o-rwx -o -perm -g-w ! -user tomcat_admin \\) -ls The above command should not emit any output.",
    "remediation": "Perform the following to establish the recommended state: 1. Set the ownership of the $CATALINA_HOME to tomcat_admin.tomcat. 2. Remove read, write, and execute permissions for the world 3. Remove write permissions for the group. # chown tomcat_admin.tomcat $CATALINA_HOME # chmod g-w,o-rwx $CATALINA_HOME 29 | P a g e",
    "function_names": [
      "tomcat_home_ownership_restricted",
      "tomcat_home_permissions_restricted",
      "catalina_home_ownership_correct",
      "catalina_home_permissions_secure",
      "catalina_home_world_access_denied",
      "catalina_home_group_write_denied",
      "catalina_home_admin_ownership_enforced",
      "catalina_home_directory_protected"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "4.2",
    "title": "Restrict access to $CATALINA_BASE",
    "assessment": "Scored",
    "description": "$CATALINA_BASE is the environment variable that specifies the base directory which most relative paths are resolved. $CATALINA_BASE is usually used when there is multiple instances of Tomcat running. It is important to protect access to this in order to protect the Tomcat-related binaries and libraries from unauthorized modification. It is recommended that the ownership of $CATALINA_BASE be tomcat_admin:tomcat. It is also recommended that the permission on $CATALINA_BASE prevent read, write, and execute for the world (o- rwx) and prevent write access to the group (g-w).",
    "rationale": "The security of processes and data that traverse or depend on Tomcat may become compromised if the $CATALINA_BASE is not secured.",
    "audit": "Perform the following to ensure the permission on the $CATALINA_BASE directory prevent unauthorized modification. $ cd $CATALINA_BASE $ find . -follow -maxdepth 0 \\( -perm -o-rwx -o -perm -g-w ! -user tomcat_admin \\) -ls  The above command should not emit any output.",
    "remediation": "Perform the following to establish the recommended state: 1. Set the ownership of the $CATALINA_BASE to tomcat_admin.tomcat. 2. Remove read, write, and execute permissions for the world 3. Remove write permissions for the group. 4. # chown tomcat_admin.tomcat $CATALINA_BASE # chmod g-w,o-rwx $CATALINA_BASE 30 | P a g e",
    "function_names": [
      "tomcat_base_directory_secure_ownership",
      "tomcat_base_directory_restrict_world_access",
      "tomcat_base_directory_restrict_group_write",
      "tomcat_base_directory_protected_permissions",
      "tomcat_base_directory_admin_ownership",
      "tomcat_base_directory_no_world_permissions",
      "tomcat_base_directory_group_write_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "4.3",
    "title": "Restrict access to Tomcat configuration directory",
    "assessment": "Scored",
    "description": "The Tomcat $CATALINA_HOME/conf/ directory contains Tomcat configuration files. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permissions on this directory prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w).",
    "rationale": "Restricting access to these directories will prevent local users from maliciously or inadvertently altering Tomcat\u2019s configuration.",
    "audit": "Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf are securely configured. 1. Change to the location of the $CATALINA_HOME/conf and execute the following: 2. # cd $CATALINA_HOME/conf # find catalina.policy -follow -maxdepth 0 \\( -perm \u2013o-rwx -o -perm \u2013gw ! -user tomcat_admin \\) -ls Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command.",
    "remediation": "Perform the following to restrict access to Tomcat configuration files: 1. Set the ownership of the $CATALINA_HOME/conf to tomcat_admin:tomcat. 2. Remove read, write, and execute permissions for the world 3. Remove write permissions for the group. 4. # chown tomcat_admin:tomcat $CATALINA_HOME/conf # chmod g-w,o-rwx $CATALINA_HOME/conf  31 | P a g e Default Value: The default permission of the top-level directories is 770. 32 | P a g e",
    "function_names": [
      "tomcat_conf_directory_ownership_restricted",
      "tomcat_conf_directory_permissions_restricted",
      "tomcat_conf_directory_world_access_disabled",
      "tomcat_conf_directory_group_write_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "4.4",
    "title": "Restrict access to Tomcat logs directory",
    "assessment": "Scored",
    "description": "The Tomcat $CATALINA_HOME/logs/ directory contains Tomcat logs. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permissions on this directory prevent read, write, and execute for the world (o-rwx).",
    "rationale": "Restricting access to these directories will prevent local users from maliciously or inadvertently altering Tomcat\u2019s logs.",
    "audit": "Perform the following to determine if the ownership and permissions on $CATALINA_HOME/logs are securely configured. 1. Change to the location of the $CATALINA_HOME/logs and execute the following: # cd $CATALINA_HOME # find logs -follow -maxdepth 0 \\( -perm \u2013o-rwx! -user tomcat_admin \\) -ls Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command.",
    "remediation": "Perform the following to restrict access to Tomcat log files: 1. Set the ownership of the $CATALINA_HOME/logs to tomcat_admin:tomcat. 2. Remove read, write, and execute permissions for the world # chown tomcat_admin:tomcat $CATALINA_HOME/logs # chmod o-rwx $CATALINA_HOME/logs Default Value: The default permission of the top-level directories is 770. 33 | P a g e",
    "function_names": [
      "tomcat_logs_directory_ownership_restricted",
      "tomcat_logs_directory_permissions_restricted",
      "tomcat_logs_directory_world_access_denied",
      "tomcat_logs_directory_admin_ownership_required",
      "tomcat_logs_directory_strict_permissions_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "4.5",
    "title": "Restrict access to Tomcat temp directory",
    "assessment": "Scored",
    "description": "The Tomcat $CATALINA_HOME/temp/ directory is used by Tomcat to persist temporary information to disk. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permissions on this directory prevent read, write, and execute for the world (o-rwx).",
    "rationale": "Restricting access to these directories will prevent local users from maliciously or inadvertently affecting the integrity of Tomcat processes.",
    "audit": "Perform the following to determine if the ownership and permissions on $CATALINA_HOME/temp are securely configured. 1. Change to the location of the $CATALINA_HOME/temp and execute the following: # cd $CATALINA_HOME # find temp -follow -maxdepth 0 \\( -perm \u2013o-rwx -o ! -user tomcat_admin \\) -ls Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command.",
    "remediation": "Perform the following to restrict access to Tomcat log files: 1. Set the ownership of the $CATALINA_HOME/logs to tomcat_admin:tomcat. 2. Remove read, write, and execute permissions for the world # chown tomcat_admin:tomcat $CATALINA_HOME/temp # chmod o-rwx $CATALINA_HOME/temp Default Value: The default permission of the top-level directories is 770. 34 | P a g e",
    "function_names": [
      "tomcat_temp_directory_restrict_ownership",
      "tomcat_temp_directory_restrict_permissions",
      "tomcat_temp_directory_no_world_access",
      "tomcat_temp_directory_secure_ownership",
      "tomcat_temp_directory_secure_permissions"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "4.6",
    "title": "Restrict access to Tomcat binaries directory",
    "assessment": "Scored",
    "description": "The Tomcat $CATALINA_HOME/bin/ directory contains executes that are part of the Tomcat run-time. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permission on $CATALINA_HOME prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w).",
    "rationale": "Restricting access to these directories will prevent local users from maliciously or inadvertently affecting the integrity of Tomcat processes.",
    "audit": "Perform the following to determine if the ownership and permissions on $CATALINA_HOME/bin are securely configured. 1. Change to the location of the $CATALINA_HOME/bin and execute the following: # cd $CATALINA_HOME # find bin -follow -maxdepth 0 \\( -perm \u2013o-rwx -o -perm \u2013g-w ! - user tomcat_admin \\) -ls Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command.",
    "remediation": "Perform the following to restrict access to Tomcat log files: 1. Set the ownership of the $CATALINA_HOME/logs to tomcat_admin:tomcat. 2. Remove read, write, and execute permissions for the world # chown tomcat_admin:tomcat $CATALINA_HOME/bin # chmod g-w,o-rwx $CATALINA_HOME/bin Default Value: The default permission of the top-level directories is 770. 35 | P a g e",
    "function_names": [
      "tomcat_binaries_directory_ownership_restricted",
      "tomcat_binaries_directory_permissions_restricted",
      "tomcat_binaries_directory_world_access_disabled",
      "tomcat_binaries_directory_group_write_disabled",
      "tomcat_binaries_directory_admin_ownership_enforced",
      "tomcat_binaries_directory_secure_permissions_enforced"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "4.7",
    "title": "Restrict access to Tomcat web application directory",
    "assessment": "Scored",
    "description": "The Tomcat $CATALINA_HOME/webapps directory contains web applications that are deployed through Tomcat. It is recommended that the ownership of this directory be tomcat_admin:tomcat. It is also recommended that the permission on $CATALINA_HOME/webapps prevent read, write, and execute for the world (o-rwx) and prevent write access to the group (g-w).",
    "rationale": "Restricting access to these directories will prevent local users from maliciously or inadvertently affecting the integrity of web applications.",
    "audit": "Perform the following to determine if the ownership and permissions on $CATALINA_HOME/webapps are securely configured. 1. Change to the location of the $CATALINA_HOME/webapps and execute the following: # cd $CATALINA_HOME # find webapps -follow -maxdepth 0 \\( -perm \u2013o-rwx -o -perm \u2013g-w ! -user tomcat_admin \\) -ls Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command.",
    "remediation": "Perform the following to restrict access to Tomcat log files: 1. Set the ownership of the $CATALINA_HOME/webapps to tomcat_admin:tomcat. 2. Remove read, write, and execute permissions for the world. # chown tomcat_admin:tomcat $CATALINA_HOME/webapps # chmod g-w,o-rwx $CATALINA_HOME/webapps 36 | P a g e Default Value: The default permission of the top-level directories is 770. 37 | P a g e",
    "function_names": [
      "tomcat_webapps_directory_ownership_restricted",
      "tomcat_webapps_directory_permissions_restricted",
      "tomcat_webapps_directory_world_access_denied",
      "tomcat_webapps_directory_group_write_denied"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "4.8",
    "title": "Restrict access to Tomcat catalina.policy",
    "assessment": "Scored",
    "description": "The catalina.policy file is used to configure security policies for Tomcat. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
    "rationale": "Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat\u2019s security policy.",
    "audit": "Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/catalina.policy care securely configured. 1. Change to the location of the $CATALINA_HOME/ and execute the following: # cd $CATALINA_HOME/conf/ # find catalina.policy -follow -maxdepth 0 \\( -perm -o+rwx -o -perm -g+rwx ! - user tomcat_admin -group tomcat -perm /770 \\) -ls Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command.",
    "remediation": "Perform the following to restrict access to $CATALINA_HOME/conf/catalina.policy. 1. Set the owner and group owner of the contents of $CATALINA_HOME/ to tomcat_admin and tomcat, respectively. # chmod 770 $CATALINA_HOME/conf/catalina.policy # chown tomcat_admin:tomcat $CATALINA_HOME/conf/catalina.policy Default Value: The default permission of catalina.policy is 600. 38 | P a g e",
    "function_names": [
      "tomcat_catalina_policy_restrict_access",
      "tomcat_catalina_policy_permissions_secure",
      "tomcat_catalina_policy_unauthorized_changes_prevented",
      "tomcat_catalina_policy_file_protected",
      "tomcat_catalina_policy_access_controlled"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "4.9",
    "title": "Restrict access to Tomcat catalina.properties",
    "assessment": "Scored",
    "description": "catalina.properties is a Java properties files that contains settings for Tomcat including class loader information, security package lists, and performance properties. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
    "rationale": "Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat\u2019s security policy.",
    "audit": "Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/catalina.properties care securely configured. 1. Change to the location of the $CATALINA_HOME/ and execute the following: # cd $CATALINA_HOME/conf/ # find catalina.properties -follow -maxdepth 0 \\( -perm -o-rwx -o -perm -g-w ! -user tomcat_admin \\) -ls Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command.",
    "remediation": "Perform the following to restrict access to catalina.policy: 1. Set the ownership of the $CATALINA_HOME/conf/catalina.policy to tomcat_admin:tomcat. 2. Remove read, write, and execute permissions for the world. 3. Remove write permissions for the group. # chown tomcat_admin:tomcat $CATALINA_HOME/conf/catalina.properties # chmod g-w,o-rwx $CATALINA_HOME/conf/catalina.properties 39 | P a g e Default Value: The default permission of the top-level directories is 600. 40 | P a g e",
    "function_names": [
      "tomcat_catalina_properties_restrict_access",
      "tomcat_catalina_properties_permissions_secure",
      "tomcat_catalina_properties_unauthorized_changes_prevented",
      "tomcat_catalina_properties_file_protected",
      "tomcat_catalina_properties_access_controlled"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "4.10",
    "title": "Restrict access to Tomcat context.xml",
    "assessment": "Scored",
    "description": "The context.xml file is loaded by all web applications and sets certain configuration options. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
    "rationale": "Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat\u2019s security policy.",
    "audit": "Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/context.xml care securely configured. 1. Change to the location of the $CATALINA_HOME/conf and execute the following: # cd $CATALINA_HOME/conf # find context.xml -follow -maxdepth 0 \\( -perm -o-rwx -o -perm -g-w ! -user tomcat_admin \\) -ls Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command.",
    "remediation": "Perform the following to restrict access to context.xml: 1. Set the ownership of the $CATALINA_HOME/conf/context.xml to tomcat_admin:tomcat. 2. Remove read, write, and execute permissions for the world. 3. Remove write permissions for the group. # chown tomcat_admin:tomcat $CATALINA_HOME/conf/context.xml # chmod g-w,o-rwx $CATALINA_HOME/conf/context.xml  41 | P a g e Default Value: The default permission of context.xml is 600. 42 | P a g e",
    "function_names": [
      "tomcat_context_xml_restrict_access",
      "tomcat_context_xml_proper_permissions",
      "tomcat_context_xml_unauthorized_changes_protected",
      "tomcat_context_xml_file_permissions_secure",
      "tomcat_context_xml_access_controlled"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "4.11",
    "title": "Restrict access to Tomcat logging.properties",
    "assessment": "Scored",
    "description": "logging.properties is a Tomcat files which specifies the logging configuration. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
    "rationale": "Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat\u2019s security policy.",
    "audit": "Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/logging.properties care securely configured. 1. Change to the location of the $CATALINA_HOME/conf and execute the following: # cd $CATALINA_HOME/conf/ # find logging.properties -follow -maxdepth 0 \\( -perm -o-rwx -o -perm -g-w ! - user tomcat_admin \\) -ls Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command.",
    "remediation": "Perform the following to restrict access to logging.properties: 1. Set the ownership of the $CATALINA_HOME/conf/logging.properties to tomcat_admin:tomcat. 2. Remove read, write, and execute permissions for the world. 3. Remove write permissions for the group. # chown tomcat_admin:tomcat $CATALINA_HOME/conf/logging.properties # chmod g-w,o-rwx $CATALINA_HOME/conf/logging.properties  43 | P a g e Default Value: The default permission is 600. 44 | P a g e",
    "function_names": [
      "tomcat_logging_properties_restrict_access",
      "tomcat_logging_properties_file_permissions_secure",
      "tomcat_logging_properties_unauthorized_access_prevented",
      "tomcat_logging_properties_secure_permissions",
      "tomcat_logging_properties_write_access_restricted"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "4.12",
    "title": "Restrict access to Tomcat server.xml",
    "assessment": "Scored",
    "description": "server.xml contains Tomcat servlet definitions and configurations. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
    "rationale": "Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat\u2019s security policy.",
    "audit": "Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/server.xml care securely configured. 1. Change to the location of the $CATALINA_HOME/conf and execute the following: # cd $CATALINA_HOME/conf/ # find server.xml -follow -maxdepth 0 \\( -perm -o-rwx -o -perm -g-w ! -user tomcat_admin \\) -ls Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command.",
    "remediation": "Perform the following to restrict access to server.xml: 1. Set the ownership of the $CATALINA_HOME/conf/server.xml to tomcat_admin:tomcat. 2. Remove read, write, and execute permissions for the world. 3. Remove write permissions for the group. # chown tomcat_admin:tomcat $CATALINA_HOME/conf/server.xml # chmod g-w,o-rwx $CATALINA_HOME/conf/server.xml  45 | P a g e Default Value: The default permission of the top-level directories is 600. 46 | P a g e",
    "function_names": [
      "tomcat_server_xml_restrict_access",
      "tomcat_server_xml_permissions_secure",
      "tomcat_server_xml_unauthorized_changes_prevented",
      "tomcat_server_xml_file_protected",
      "tomcat_server_xml_secure_config"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "4.13",
    "title": "Restrict access to Tomcat tomcat-users.xml",
    "assessment": "Scored",
    "description": "tomcat-users.xml contains authentication information for Tomcat applications. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
    "rationale": "Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat\u2019s security policy.",
    "audit": "Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/tomcat-users.xml care securely configured. 1. Change to the location of the $CATALINA_HOME/conf and execute the following: # cd $CATALINA_HOME/conf/ # find tomcat-users.xml -follow -maxdepth 0 \\( -perm -o-rwx -o -perm -g-w ! - user tomcat_admin \\) -ls Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command.",
    "remediation": "Perform the following to restrict access to tomcat-users.xml: 1. Set the ownership of the $CATALINA_HOME/conf/tomcat-users.xml to tomcat_admin:tomcat. 2. Remove read, write, and execute permissions for the world. 3. Remove write permissions for the group. # chown tomcat_admin:tomcat $CATALINA_HOME/conf/tomcat-users.xml # chmod g-w,o-rwx $CATALINA_HOME/conf/tomcat-users.xml  47 | P a g e Default Value: The default permission of the top-level directories is 600. 48 | P a g e",
    "function_names": [
      "compute_tomcat_users_xml_restricted_access",
      "compute_tomcat_users_xml_protected_permissions",
      "compute_tomcat_users_xml_auth_file_secure",
      "compute_tomcat_users_xml_read_only_access",
      "compute_tomcat_users_xml_unauthorized_changes_prevented"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "4.14",
    "title": "Restrict access to Tomcat web.xml",
    "assessment": "Scored",
    "description": "web.xml is a Tomcat configuration file that stores application configuration settings. It is recommended that access to this file has the proper permissions to properly protect from unauthorized changes.",
    "rationale": "Restricting access to this file will prevent local users from maliciously or inadvertently altering Tomcat\u2019s security policy.",
    "audit": "Perform the following to determine if the ownership and permissions on $CATALINA_HOME/conf/web.xml care securely configured. 1. Change to the location of the $CATALINA_HOME/conf and execute the following: # cd $CATALINA_HOME/conf/ # find web.xml -follow -maxdepth 0 \\( -perm -o-rwx -o -perm -g-w ! -user tomcat_admin \\) -ls Note: If the ownership and permission are set correctly, no output should be displayed when executing the above command.",
    "remediation": "Perform the following to restrict access to web.xml: 1. Set the ownership of the $CATALINA_HOME/conf/web.xml to tomcat_admin:tomcat. 2. Remove read, write, and execute permissions for the world. 3. Remove write permissions for the group. # chown tomcat_admin:tomcat $CATALINA_HOME/conf/web.xml # chmod g-w,o-rwx $CATALINA_HOME/conf/web.xml Default Value: The default permission of web.xml is 400. 49 | P a g e 5 Configure Realms A Tomcat realm is a database of usernames and passwords used to identify valid users of web applications.",
    "function_names": [
      "tomcat_web_xml_restricted_permissions",
      "tomcat_web_xml_read_only",
      "tomcat_web_xml_no_world_writable",
      "tomcat_web_xml_owner_root",
      "tomcat_web_xml_group_restricted",
      "tomcat_web_xml_no_public_access",
      "tomcat_web_xml_secure_ownership",
      "tomcat_web_xml_minimal_permissions"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "5.1",
    "title": "Use secure Realms",
    "assessment": "Scored",
    "description": "A realm is a database of usernames and passwords used to identify valid users of web applications. Review the Realms configuration to ensure Tomcat is configured to use JDBCRealm, DataSourceRealm, JNDIRealm, or JAASRealm. Specifically, Tomcat should not utilize MemoryRealm.",
    "rationale": "According to the Tomcat documentation, MemoryRealm is not designed for production usage and could result in reduced availability.",
    "audit": "Perform the following to ensure the MemoryRealm is not in use: # grep \"Realm className\" $CATALINA_HOME/conf/server.xml | grep MemoryRealm The above command should not emit any output.",
    "remediation": "Set the Realm className setting in $CATALINA_HOME/conf/server.xml to one of the appropriate realms. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/realm-howto.html 50 | P a g e",
    "function_names": [
      "tomcat_realm_secure_type",
      "tomcat_realm_no_memory_realm",
      "tomcat_realm_jdbc_required",
      "tomcat_realm_datasource_required",
      "tomcat_realm_jndi_required",
      "tomcat_realm_jaas_required"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/realm-howto.html 50 | P a g e"
  },
  {
    "id": "5.2",
    "title": "Use LockOut Realms",
    "assessment": "Scored",
    "description": "A LockOut realm wraps around standard realms adding the ability to lock a user out after multiple failed logins.",
    "rationale": "Locking out a user after multiple failed logins slows down attackers from brute forcing logins.",
    "audit": "Perform the following to check to see if a LockOut realm is being used: # grep \"LockOutRealm\" $CATALINA_HOME/conf/server.xml",
    "remediation": "Create a lockout realm wrapping the main realm like the example below: <Realm className=\"org.apache.catalina.realm.LockOutRealm\" failureCount=\"3\" lockOutTime=\"600\" cacheSize=\"1000\" cacheRemovalWarningTime=\"3600\"> <Realm className=\"org.apache.catalina.realm.DataSourceRealm\" dataSourceName=... /> </Realm> References: 1. http://tomcat.apache.org/tomcat-7.0-doc/realm-howto.html 2. http://tomcat.apache.org/tomcat-7.0-doc/config/realm.html 51 | P a g e 6 Connector Security Tomcat Connector Security will ensure applications built on Tomcat have an accurate depiction of the context and security guarantees provided to them.",
    "function_names": [
      "security_realm_lockout_enabled",
      "security_realm_lockout_threshold_set",
      "security_realm_lockout_duration_configured",
      "security_realm_lockout_user_notification_enabled",
      "security_realm_lockout_logging_enabled",
      "security_realm_lockout_all_users_applied",
      "security_realm_lockout_custom_threshold_set",
      "security_realm_lockout_brute_force_protection_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/realm-howto.html 2. http://tomcat.apache.org/tomcat-7.0-doc/config/realm.html 51 | P a g e 6 Connector Security Tomcat Connector Security will ensure applications built on Tomcat have an accurate depiction of the context and security guarantees provided to them."
  },
  {
    "id": "6.1",
    "title": "Setup Client-cert Authentication",
    "assessment": "Scored",
    "description": "Client-cert authentication requires that each client connecting to the server has a certificate used to authenticate. This is generally regarded as strong authentication than a password as it requires the client to have the cert and not just know a password.",
    "rationale": "Certificate based authentication is more secure than password based authentication.",
    "audit": "Review the Connector configuration in server.xml and ensure the clientAuth parameter is set to true.",
    "remediation": "In the Connector element, set the clientAuth parameter to true. <-- Define a SSL Coyote HTTP/1.1 Connector on port 8443 --> <Connector port=\"8443\" minProcessors=\"5\" maxProcessors=\"75\" enableLookups=\"true\" disableUploadTimeout=\"true\" acceptCount=\"100\" debug=\"0\" scheme=\"https\" secure=\"true\"; clientAuth=\"true\" sslProtocol=\"TLS\"/> Default Value: Not configured References: 1. http://wiki.apache.org/tomcat/SSLWithFORMFallback 2. http://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html 52 | P a g e",
    "function_names": [
      "compute_instance_client_cert_authentication_enabled",
      "compute_load_balancer_client_cert_authentication_enabled",
      "cloud_cdn_client_cert_authentication_enabled",
      "network_load_balancer_client_cert_authentication_enabled",
      "api_gateway_client_cert_authentication_enabled",
      "app_gateway_client_cert_authentication_enabled",
      "vpn_gateway_client_cert_authentication_enabled",
      "ssl_certificate_client_authentication_required"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://wiki.apache.org/tomcat/SSLWithFORMFallback 2. http://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html 52 | P a g e"
  },
  {
    "id": "6.2",
    "title": "Ensure SSLEnabled is set to True for Sensitive Connectors",
    "assessment": "Not Scored",
    "description": "The SSLEnabled setting determines if SSL is enabled for a specific Connector. It is recommended that SSL be utilized for any Connector that sends or receives sensitive information, such as authentication credentials or personal information.",
    "rationale": "The SSLEnabled setting ensures SSL is active, which will in-turn ensure the confidentiality and integrity of sensitive information while in transit.",
    "audit": "Review server.xml and ensure all Connectors sending or receiving sensitive information have the SSLEnabled attribute set to true.",
    "remediation": "Set the SSLEngine attribute is set to on in the Listener node within server.xml. Also in server.xml, set the SSLEnabled attribute to true for each Connector that sends or receives sensitive information <Listener className=\"org.apache.catalina.core.AprLifecycleListener\" SSLEngine=\"on\" /> <Connector \u2026 SSLEnabled=\"true\" \u2026 /> Default Value: SSLEnabled is set to false. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html  53 | P a g e",
    "function_names": [
      "connector_ssl_enabled",
      "connector_sensitive_data_ssl_enabled",
      "connector_ssl_enabled_for_auth_credentials",
      "connector_ssl_enabled_for_personal_data",
      "connector_secure_transport_enabled",
      "connector_encryption_in_transit_enabled",
      "connector_tls_enabled_for_sensitive_data",
      "connector_secure_communication_enabled",
      "connector_ssl_required_for_sensitive_info",
      "connector_secure_channel_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html  53 | P a g e"
  },
  {
    "id": "6.3",
    "title": "Ensure scheme is set accurately",
    "assessment": "Scored",
    "description": "The scheme attribute is used to indicate to callers of request.getScheme() which scheme is in use by the Connector. Ensure the scheme attribute is set to http for Connectors operating over HTTP. Ensure the scheme attribute is set to https for Connectors operating of HTTPS.",
    "rationale": "Maintaining parity between the scheme in use by the Connector and advertised by request.getScheme() will ensure applications built on Tomcat have an accurate depiction of the context and security guarantees provided to them.",
    "audit": "Review server.xml to ensure the Connector\u2019s scheme attribute is set to http for Connectors operating over HTTP. Also ensure the Connector\u2019s scheme attribute is set to https for Connectors operating over HTTPS.",
    "remediation": "In server.xml, set the Connector\u2019s scheme attribute to http for Connectors operating over HTTP. Set the Connector\u2019s scheme attribute to https for Connectors operating of HTTPS. <Connector \u2026 scheme=\"https\" \u2026 /> Default Value: The scheme attribute is set to http. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html 2. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html 54 | P a g e",
    "function_names": [
      "connector_scheme_http_configured",
      "connector_scheme_https_configured",
      "connector_scheme_accurate",
      "connector_scheme_http_only",
      "connector_scheme_https_only",
      "connector_scheme_protocol_valid",
      "connector_scheme_http_enforced",
      "connector_scheme_https_enforced"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html 2. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html 54 | P a g e"
  },
  {
    "id": "6.4",
    "title": "Ensure secure is set to true only for SSL-enabled Connectors",
    "assessment": "Scored",
    "description": "The secure attribute is used to convey Connector security status to applications operating over the Connector. This is typically achieved by calling request.isSecure(). Ensure the secure attribute is only set to true for Connectors operating with the SSLEnabled attribute set to true.",
    "rationale": "Accurately reporting the security state of the Connector will help ensure that applications built on Tomcat are not unknowingly relying on security controls that are not in place.",
    "audit": "Review server.xml and ensure the secure attribute is set to true for those Connectors having SSLEnabled set to true. Also, ensure the secure attribute set to false for those Connectors having SSLEnabled set to false.",
    "remediation": "For each Connector defined in server.xml, set the secure attribute to true for those Connectors having SSLEnabled set to true. Set the secure attribute set to false for those Connectors having SSLEnabled set to false. Default Value: The secure attribute is set to false. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html 2. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html 55 | P a g e",
    "function_names": [
      "connector_secure_attribute_ssl_enabled",
      "connector_ssl_enabled_secure_attribute",
      "connector_secure_attribute_valid",
      "connector_ssl_enabled_secure_true",
      "connector_secure_attribute_matches_ssl"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html 2. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html 55 | P a g e"
  },
  {
    "id": "6.5",
    "title": "Ensure SSL Protocol is set to TLS for Secure Connectors",
    "assessment": "Scored",
    "description": "The sslProtocol setting determines which protocol Tomcat will use to protect traffic. It is recommended that sslProtocol attribute be set to TLS.",
    "rationale": "The TLS protocol does not contain weaknesses that affect other secure transport protocols, such as SSLv1 or SSLv2. Therefore, TLS is leveraged to protect the confidentiality and integrity of data while in transit.",
    "audit": "Review server.xml to ensure the sslProtocol attribute is set to TLS for all Connectors having SSLEngine set to on.",
    "remediation": "In server.xml, set the sslProtocol attribute to TLS for all Connectors having SSLEngine set to on. <Connector \u2026 sslProtocol=\"TLS\" \u2026 /> Default Value: If the sslProtocol attribute is not set, Tomcat will utilize TLS. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html 2. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html 56 | P a g e 7 Establish and Protect Logging Facilities Enable logging and ensure logs are properly protected",
    "function_names": [
      "tomcat_connector_ssl_protocol_tls",
      "tomcat_connector_tls_enabled",
      "tomcat_secure_connector_tls_required",
      "tomcat_connector_ssl_protocol_tls_only",
      "tomcat_connector_tls_protocol_enforced"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html 2. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html 56 | P a g e 7 Establish and Protect Logging Facilities Enable logging and ensure logs are properly protected"
  },
  {
    "id": "7.1",
    "title": "Application specific logging",
    "assessment": "Scored",
    "description": "By default, java.util.logging does not provide the capabilities to configure per-web application settings, only per VM. In order to overcome this limitation Tomcat implements JULI as a wrapper for java.util.logging. JULI provides additional configuration functionality so you can set each web application with different logging specifications.",
    "rationale": "Establishing per application logging profiles will help ensure that each application\u2019s logging verbosity is set to an appropriate level in order to provide appropriate information when needed for security review.",
    "audit": "Ensure a logging.properties file is locate at $CATALINA_BASE\\<app_name>\\WEBINF\\classes.",
    "remediation": "Create a logging.properties file and place that into your application WEB-INF\\classes directory. Note: By default, installing Tomcat places a logging.properties file in $CATALINA_HOME\\conf. This file can be used as base for an application specific logging properties file Default Value: By default, per application logging is not configured. 57 | P a g e",
    "function_names": [
      "tomcat_web_app_logging_enabled",
      "tomcat_juli_logging_configured",
      "tomcat_web_app_logging_isolated",
      "tomcat_logging_per_app_customized",
      "tomcat_juli_wrapper_enabled",
      "tomcat_logging_vm_isolation_disabled",
      "tomcat_web_app_logging_specified",
      "tomcat_juli_logging_per_app_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 2"
  },
  {
    "id": "7.2",
    "title": "Specify file handler in logging.properties files",
    "assessment": "Scored",
    "description": "Handlers specify where log messages are sent. Console handlers send log messages to the Java console and File handlers specify logging to a file.",
    "rationale": "Utilizing file handlers will ensure that security event information is persisted to disk.",
    "audit": "Review each application\u2019s logging.properties file located in the applications $CATALINA_BASE\\\\WEB-INF\\classes directory and determine if the file handler properties are set. $ grep handlers \\ $CATALINA_BASE\\<app name>\\WEB-INF\\classes\\logging.properties  In the instance where an application specific logging has not been created, the logging.properties file will be located in $CATALINA_BASE\\conf $ grep handlers $CATALINA_BASE\\conf\\logging.properties",
    "remediation": "Add the following entries to your logging.properties file if they do not exist. handlers=org.apache.juli.FileHandler, java.util.logging.ConsoleHandler Ensure logging is not off and set the logging level to the desired level such as: org.apache.juli.FileHandler.level=FINEST Default Value: No value for new applications by default. 58 | P a g e",
    "function_names": [
      "logging_properties_file_handler_specified",
      "logging_properties_console_handler_disabled",
      "logging_properties_file_handler_configured",
      "logging_properties_handler_type_valid",
      "logging_properties_file_handler_path_defined"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "7.3",
    "title": "Ensure className is set correctly in context.xml",
    "assessment": "Scored",
    "description": "Ensure the className attribute is set to AccessLogValve. The className attribute determines the access log valve to be used for logging.",
    "rationale": "Some log valves are not suited for production and should be used. Apache recommends org.apache.catalina.valves.AccessLogValve",
    "audit": "Execute the following to ensure className is set properly: # grep org.apache.catalina.valves.AccessLogValve context.xml",
    "remediation": "Add the following statement into the $CATALINA_BASE\\\\META-INF\\context.xml file if it does not already exist. <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"$CATALINA_HOME/logs/\" prefix=\"access_log\" fileDateFormat=\"yyyy-MM-dd.HH\" suffix=\".log\" pattern=\"%t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r\" /> Default Value: Does not exist by default. 59 | P a g e",
    "function_names": [
      "tomcat_context_classname_access_log_valve",
      "tomcat_context_access_log_valve_configured",
      "tomcat_context_classname_correct",
      "tomcat_context_access_log_valve_set"
    ],
    "profile_applicability": "\uf0b7  Level 2"
  },
  {
    "id": "7.4",
    "title": "Ensure directory in context.xml is a secure location",
    "assessment": "Scored",
    "description": "The directory attribute tells Tomcat where to store logs. It is recommended that the location pointed to by the directory attribute be secured.",
    "rationale": "Securing the log location will help ensure the integrity and confidentiality of web application activity.",
    "audit": "Review the permissions of the directory specified by the directory setting to ensure the permissions are o-rwx and owned by tomcat_admin:tomcat: # grep directory context.xml # ls \u2013l <log location>",
    "remediation": "Perform the following: 1. Add the following statement into the $CATALINA_BASE\\<app-name>\\META- INF\\context.xml file if it does not already exist. <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"$CATALINA_HOME/logs/\" prefix=\"access_log\" fileDateFormat=\"yyyy-MM-dd.HH\" suffix=\".log\" pattern=\"%t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r\" /> 2. Set the location pointed to by the directory attribute to be owned by tomcat_admin:tomcat with permissions of o-rwx. # chown tomcat_admin:tomcat $CATALINA_HOME/logs # chmod o-rwx $CATALINA_HOME/logs Default Value: Does not exist by default 60 | P a g e",
    "function_names": [
      "tomcat_context_xml_directory_secure_location",
      "tomcat_context_xml_directory_restricted_access",
      "tomcat_context_xml_directory_protected_path",
      "tomcat_context_xml_directory_non_public",
      "tomcat_context_xml_directory_secure_permissions"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "7.5",
    "title": "Ensure pattern in context.xml is correct",
    "assessment": "Scored",
    "description": "The pattern setting informs Tomcat what information should be logged. At a minimum, enough information to uniquely identify a request, what was requested, where the requested originated from, and when the request occurred should be logged. The following will log the request date and time (%t), the requested URL (%U), the remote IP address (%a), the local IP address (%A), the request method (%m), the local port (%p), query string, if present, (%q), and the HTTP status code of the response (%s). pattern=\"%t %U %a %A %m %p %q %s\u201d",
    "rationale": "The level of logging detail prescribed will assist in identifying correlating security events or incidents.",
    "audit": "Review the pattern settings to ensure it contains all the variables required by the installation. # grep pattern context.xml",
    "remediation": "Add the following statement into the $CATALINA_BASE\\<app-name>\\META- INF\\context.xml file if it does not already exist. <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"$CATALINA_HOME/logs/\" prefix=\"access_log\" fileDateFormat=\"yyyy-MM-dd.HH\" suffix=\".log\" pattern=\"%h %t %H cookie:%{SESSIONID}c request:%{SESSIONID}r %m %U %s %q %r\" /> Default Value: Does not exist by default References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/valve.html 61 | P a g e",
    "function_names": [
      "tomcat_context_xml_pattern_correct",
      "tomcat_context_xml_logging_pattern_complete",
      "tomcat_context_xml_request_logging_enabled",
      "tomcat_context_xml_minimum_logging_fields_present",
      "tomcat_context_xml_logging_fields_valid",
      "tomcat_context_xml_pattern_contains_required_fields",
      "tomcat_context_xml_logging_pattern_compliant",
      "tomcat_context_xml_request_metadata_logged",
      "tomcat_context_xml_logging_pattern_standardized",
      "tomcat_context_xml_logging_fields_complete"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/valve.html 61 | P a g e"
  },
  {
    "id": "7.6",
    "title": "Ensure directory in logging.properties is a secure location",
    "assessment": "Scored",
    "description": "The directory attribute tells Tomcat where to store logs. The directory value should be a secure location with restricted access.",
    "rationale": "Securing the log location will help ensure the integrity and confidentiality of web application activity records.",
    "audit": "Review the permissions of the directory specified by the directory setting to ensure the permissions are o-rwx and owned by tomcat_admin:tomcat: # grep directory logging.properties # ls \u2013l <log_location>",
    "remediation": "Perform the following: 1. Add the following properties into your logging.properties file if they do not exist <application_name>.org.apache.juli.FileHandler.directory=<log_location> <application_name>.org.apache.juli.FileHandler.prefix=<application_name> 2. Set the location pointed to by the directory attribute to be owned by tomcat_admin:tomcat with permissions of o-rwx. # chown tomcat_admin:tomcat <log_location> # chmod o-rwx <log_location> Default Value: The directory location is configured to store logs in $CATALINA_BASE/logs 62 | P a g e",
    "function_names": [
      "tomcat_logging_properties_directory_secure_location",
      "tomcat_logging_properties_directory_restricted_access",
      "tomcat_logging_directory_secure_location",
      "tomcat_logging_directory_restricted_access"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "7.7",
    "title": "Configure log file size limit",
    "assessment": "Scored",
    "description": "By default, the logging.properties file will have no defined limit for the log file size. This is a potential denial of service attack as it would be possible to fill a drive or partition containing the log files.",
    "rationale": "Establishing a maximum log size that is smaller than the partition size will help mitigate the risk of an attacker maliciously exhausting disk space.",
    "audit": "Validate the max file limit is not greater than the size of the partition where the log files are stored.",
    "remediation": "Create the following entry in your logging.properties file. This field is specified in bytes. java.util.logging.FileHandler.limit=10000 Default Value: No limit by default. 63 | P a g e 8 Configure Catalina Policy Configuring Catalina Policy prevents web applications from accessing restricted or unknown packages which may be malicious or dangerous to the application.",
    "function_names": [
      "cloudtrail_trail_log_file_size_limited",
      "cloudtrail_trail_log_file_size_defined",
      "cloudtrail_trail_log_file_size_restricted",
      "cloudtrail_trail_log_file_size_capped",
      "cloudtrail_trail_log_file_size_constrained",
      "cloudtrail_trail_log_file_size_max_set",
      "cloudtrail_trail_log_file_size_threshold_set",
      "cloudtrail_trail_log_file_size_protected",
      "cloudtrail_trail_log_file_size_quota_enforced",
      "cloudtrail_trail_log_file_size_limit_enforced"
    ],
    "profile_applicability": "\uf0b7  Level 2"
  },
  {
    "id": "8.1",
    "title": "Restrict runtime access to sensitive packages",
    "assessment": "Scored",
    "description": "package.access grants or revokes access to listed packages during runtime. It is recommended that application access to certain packages be restricted.",
    "rationale": "Prevent web applications from accessing restricted or unknown packages which may be malicious or dangerous to the application.",
    "audit": "Review package.access list in $CATALINA_BASE/conf/catalina.properties to ensure only allowed packages are defined.",
    "remediation": "Edit $CATALINA_BASE/conf/catalina.properties by adding allowed packages to the package.access list: package.access = sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat., org.apache.jasper Default Value: The default package.access value within $CATALINA_BASE/conf/catalina.properties is: package.access = sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat., org.apache.jasper 64 | P a g e 9 Application Deployment By running Tomcat with the Security Manager, applications are run in a sandbox which can prevent untrusted code from accessing files on the file system.",
    "function_names": [
      "compute_package_access_restricted",
      "compute_package_access_no_sensitive_packages",
      "compute_runtime_package_access_restricted",
      "compute_runtime_sensitive_package_access_blocked",
      "compute_package_access_sensitive_denied",
      "compute_runtime_package_access_denied",
      "compute_sensitive_package_access_restricted",
      "compute_package_access_minimal_permissions"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "9.1",
    "title": "Starting Tomcat with Security Manager",
    "assessment": "Scored",
    "description": "Configure application to run in a sandbox using the Security Manager. The Security Manager restricts what classes Tomcat can access thus protecting your server from mistakes, Trojans, and malicious code.",
    "rationale": "By running Tomcat with the Security Manager, applications are run in a sandbox which can prevent untrusted code from accessing files on the file system.",
    "audit": "Review the start up configuration in /etc/init.d for Tomcat to ascertain if Tomcat is started with the -security option",
    "remediation": "The security policies implemented by the Java SecurityManager are configured in the $CATALINA_HOME/conf/catalina.policy file. Once you have configured the catalina.policy file for use with a SecurityManager, Tomcat can be started with a SecurityManager in place by using the --security option: $ $CATALINA_HOME/bin/catalina.sh start -security (Unix) C:\\> %CATALINA_HOME%\\bin\\catalina start -security (Windows) Default Value: By default, the -security option is not utilized. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/security-manager-howto.html 65 | P a g e",
    "function_names": [
      "compute_tomcat_security_manager_enabled",
      "compute_tomcat_sandbox_mode_enabled",
      "compute_tomcat_restricted_class_access",
      "compute_tomcat_security_manager_configured",
      "compute_tomcat_sandbox_policy_configured"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/security-manager-howto.html 65 | P a g e"
  },
  {
    "id": "9.2",
    "title": "Disabling auto deployment of applications",
    "assessment": "Scored",
    "description": "Tomcat allows auto deployment of applications while Tomcat is running. It is recommended that this capability be disabled.",
    "rationale": "This could allow malicious or untested applications to be deployed and should be disabled.",
    "audit": "Perform the following to ensure autoDeploy is set to false. # grep \"autoDeploy\" $CATALINA_HOME/conf/server.xml",
    "remediation": "In the $CATALINA_HOME/conf/server.xml file, change autoDeploy to false. autoDeploy=\"false\" Default Value: autoDeploy is set to true References: 1. http://tomcat.apache.org/tomcat-7.0-doc/deployer- howto.html#Deploying_on_a_running_Tomcat_server 66 | P a g e",
    "function_names": [
      "tomcat_server_auto_deploy_disabled",
      "tomcat_host_auto_deploy_disabled",
      "tomcat_context_auto_deploy_disabled",
      "tomcat_engine_auto_deploy_disabled",
      "tomcat_service_auto_deploy_disabled",
      "tomcat_application_auto_deploy_disabled",
      "tomcat_manager_auto_deploy_disabled",
      "tomcat_deployment_auto_deploy_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/deployer- howto.html#Deploying_on_a_running_Tomcat_server 66 | P a g e"
  },
  {
    "id": "9.3",
    "title": "Disable deploy on startup of applications",
    "assessment": "Scored",
    "description": "Tomcat allows auto deployment of applications. It is recommended that this capability be disabled.",
    "rationale": "This could allow malicious or untested applications to be deployed and should be disabled.",
    "audit": "Perform the following to ensure deployOnStartup is set to false. # grep \"deployOnStartup\" $CATALINA_HOME/conf/server.xml",
    "remediation": "In the $CATALINA_HOME/conf/server.xml file, change deployOnStartup to false. deployOnStartup=\"false\" Default Value: deployOnStartup is set to true References: 1. http://tomcat.apache.org/tomcat-7.0-doc/deployer- howto.html#Deployment_on_Tomcat_startup 67 | P a g e 10 Miscellaneous Configuration Settings Store web content on a separate partition from Tomcat system files.",
    "function_names": [
      "tomcat_application_auto_deploy_disabled",
      "tomcat_application_deploy_on_startup_disabled",
      "tomcat_application_auto_deployment_disabled",
      "tomcat_application_startup_deploy_disabled",
      "tomcat_application_host_auto_deploy_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/deployer- howto.html#Deployment_on_Tomcat_startup 67 | P a g e 10 Miscellaneous Configuration Settings Store web content on a separate partition from Tomcat system files."
  },
  {
    "id": "10.1",
    "title": "Ensure Web content directory is on a separate partition from the Tomcat system files",
    "assessment": "Not Scored",
    "description": "Store web content on a separate partition from Tomcat system files.",
    "rationale": "The web document directory is where the files which are severed to the end user reside. In the past, directory traversal exploits have allowed malicious users to play havoc on a web server including executing code, uploading files, and reading sensitive data. Even if you do not have any directory traversal exploits in your server or code at this time, that doesn\u2019t mean they won\u2019t be introduced in the future. Moving your web document directory onto a different partition will prevent these kinds of attacks from doing more damage to other part of the file system.",
    "audit": "Locate the Tomcat system files and web content directory. Review the system partitions and ensure the system files and web content directory are on separate partitions. # more /etc/init.d/tomcat* | grep $CATALINA_HOME # more /etc/fstab",
    "remediation": "Move the web content files to a separate partition from the tomcat system files and update your configuration. Default Value: Not Applicable 68 | P a g e",
    "function_names": [
      "compute_tomcat_web_content_separate_partition",
      "compute_tomcat_system_files_isolated",
      "compute_tomcat_content_partition_segregated",
      "compute_tomcat_web_content_dedicated_partition",
      "compute_tomcat_system_files_separate_volume"
    ],
    "profile_applicability": "\uf0b7  Level 1"
  },
  {
    "id": "10.2",
    "title": "Restrict access to the web administration",
    "assessment": "Not Scored",
    "description": "Limit access to the web administration application to only those with a required needed.",
    "rationale": "Limiting access to the least privilege required will ensure only those people with required need have access to a resource. The web administration application should be limited to only administrators.",
    "audit": "Review $CATALINA_HOME/conf/server.xml to ascertain that the RemoteAddrValve option is uncommented and configured to only allow access to systems required to connect.",
    "remediation": "For the administration application, edit $CATALINA_HOME/conf/server.xml and uncomment the following: <Valve className=\"org.apache.catalina.valves.RemoteAddrValve\" allow=\"127\\.0\\.0\\.1\"/> Note: The RemoteAddrValve property expects a regular expression, therefore periods and other regular expression meta-characters must be escaped. Default Value: By default, this configuration is not present. References: 1. https://tomcat.apache.org/tomcat-7.0-doc/config/valve.html 69 | P a g e",
    "function_names": [
      "iam_user_web_admin_access_restricted",
      "iam_role_web_admin_access_restricted",
      "iam_policy_web_admin_access_restricted",
      "compute_instance_web_admin_access_restricted",
      "network_firewall_web_admin_access_restricted",
      "cloud_cdn_web_admin_access_restricted",
      "load_balancer_web_admin_access_restricted",
      "api_gateway_web_admin_access_restricted",
      "cloudtrail_web_admin_access_restricted",
      "s3_bucket_web_admin_access_restricted"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. https://tomcat.apache.org/tomcat-7.0-doc/config/valve.html 69 | P a g e"
  },
  {
    "id": "10.3",
    "title": "Restrict manager application",
    "assessment": "Not Scored",
    "description": "Limit access to the manager application to only those with a required needed.",
    "rationale": "Limiting access to the least privilege required will ensure only those people with required need have access to a resource. The manager application should be limited to only administrators.",
    "audit": "Review $CATALINA_HOME/webapps/host-manager/manager.xml to ascertain that the RemoteAddrValve option is uncommented and configured to only allow access to systems required to connect.",
    "remediation": "For the manager application, edit $CATALINA_HOME/webapps/host- manager/manager.xml, and add the bolded line: <Context path=\"/manager\" docBase=\"${catalina.home}/server/webapps/manager\" debug=\"0\" privileged=\"true\"> <Valve className=\"org.apache.catalina.valves.RemoteAddrValve\" allow=\"127\\.0\\.0\\.1\"/> <!-- Link to the user database we will get roles from --> <ResourceLink name=\"users\" global=\"UserDatabase\" type=\"org.apache.catalina.UserDatabase\"/> </Context> Add hosts, comma separated, which are allowed to access the admin application. Note: The RemoteAddrValve property expects a regular expression, therefore periods and other regular expression meta-characters must be escaped. Default Value: By default, this setting is not present References: 1. https://tomcat.apache.org/tomcat-7.0-doc/config/valve.html 70 | P a g e",
    "function_names": [
      "iam_user_manager_access_restricted",
      "iam_role_manager_access_restricted",
      "iam_policy_manager_access_restricted",
      "compute_instance_manager_access_restricted",
      "network_security_group_manager_access_restricted",
      "cloud_cdn_manager_access_restricted",
      "cloudtrail_manager_access_restricted",
      "s3_bucket_manager_access_restricted",
      "kms_key_manager_access_restricted",
      "lambda_function_manager_access_restricted"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. https://tomcat.apache.org/tomcat-7.0-doc/config/valve.html 70 | P a g e"
  },
  {
    "id": "10.4",
    "title": "Force SSL when accessing the manager application",
    "assessment": "Scored",
    "description": "Use the transport-guarantee attribute to ensure SSL protection when accessing the manager application.",
    "rationale": "By default, when accessing the manager application, login information is sent over the wire in plain text. By using the transport-guarantee attribute within web.xml, SSL is enforced. NOTE: This requires SSL to be configured.",
    "audit": "Ensure $CATALINA_HOME/webapps/manager/WEB-INF/web.xml has the <transport- guarantee> attribute set to CONFIDENTIAL. # grep transport-guarantee $CATALINA_HOME/webapps/manager/WEB-INF/web.xml",
    "remediation": "Set $CATALINA_HOME/webapps/manager/WEB-INF/web.xml: <security-constraint> <user-data-constraint> <transport-guarantee>CONFIDENTIAL<</transport-guarantee>> <user-data-constraint> </security-constraint> Default Value: By default, this configuration is not present. References: 1. https://www.owasp.org/index.php/Securing_tomcat 71 | P a g e",
    "function_names": [
      "compute_manager_application_ssl_enforced",
      "compute_manager_application_transport_guarantee_ssl",
      "compute_manager_application_https_required",
      "compute_manager_application_secure_transport_enabled",
      "compute_manager_application_tls_enforced"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. https://www.owasp.org/index.php/Securing_tomcat 71 | P a g e"
  },
  {
    "id": "10.5",
    "title": "Rename the manager application",
    "assessment": "Scored",
    "description": "The manager application allows administrators to manage Tomcat remotely via a web interface. The manager application should be renamed to make it harder for attackers or automated scripts to locate.",
    "rationale": "Obscurity can be helpful when used with other security measures. By relocating the manager applications, an attacker will need to guess its location rather than simply navigate to the standard location in order to carry out an attack.",
    "audit": "Ensure $CATALINA_HOME/conf/Catalina/localhost/manager.xml, $CATALINA_HOME/webapps/host-manager/manager.xml, $CATALINA_HOME/server/webapps/manager and $CATALINA_HOME/webapps/manager do not exsist.",
    "remediation": "Perform the following to rename the manager application: 1. Rename the manager application XML file: # mv $CATALINA_HOME/webapps/host-manager/manager.xml \\ $CATALINA_HOME/webapps/host-manager/new-name.xml 2. Update the docBase attribute within $CATALINA_HOME/webapps/host-manager/new- name.xml to ${catalina.home}/server/webapps/new-name 3. Move $CATALINA_HOME/webapps/manager to $CATALINA_HOME/webapps/new- name # mv $CATALINA_HOME/webapps/manager $CATALINA_HOME/webapps/new-name   72 | P a g e Default Value: The default name of the manager application is \u201cmanager\" and is located at: $CATALINA_HOME/webapps/manager References: 1. https://www.owasp.org/index.php/Securing_tomcat 73 | P a g e",
    "function_names": [
      "tomcat_manager_application_renamed",
      "tomcat_manager_application_custom_name",
      "tomcat_manager_application_non_default_name",
      "tomcat_web_interface_renamed",
      "tomcat_admin_interface_custom_name"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. https://www.owasp.org/index.php/Securing_tomcat 73 | P a g e"
  },
  {
    "id": "10.6",
    "title": "Enable strict servlet Compliance",
    "assessment": "Scored",
    "description": "The STRICT_SERVLET_COMPLIANCE influences Tomcat\u2019s behavior in several subtle ways. See the References below for the complete list. It is recommended that STRICT_SERVLET_COMPLIANCE be set to true.",
    "rationale": "When STRICT_SERVLET_COMPLIANCE is set to true, Tomcat will always send an HTTP Content-type header when responding to requests. This is significant as the behavior of web browsers is inconsistent in the absence of the Content-type header. Some browsers will attempt to determine the appropriate content-type by sniffing",
    "audit": "Ensure the above parameter is added to the startup script which by default is located at $CATALINA_HOME\\bin\\catalina.sh.",
    "remediation": "Start Tomcat with strict compliance enabled. Add the following to your startup script. -Dorg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true Default Value: By default, this configuration parameter is not present. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/systemprops.html 74 | P a g e",
    "function_names": [
      "tomcat_servlet_compliance_strict_enabled",
      "tomcat_servlet_compliance_strict_config",
      "tomcat_servlet_compliance_strict_setting",
      "tomcat_servlet_compliance_strict_mode",
      "tomcat_servlet_compliance_strict_configured"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/systemprops.html 74 | P a g e"
  },
  {
    "id": "10.7",
    "title": "Turn off session fa\u00e7ade recycling",
    "assessment": "Scored",
    "description": "The RECYCLE_FACADES can specify if a new fa\u00e7ade will be created for each request. If a new fa\u00e7ade is not created there is a potential for information leakage from other sessions.",
    "rationale": "When RECYCLE_FACADES is set to true, Tomcat will recycle the session fa\u00e7ade between requests. This will allow for information leakage between requests.",
    "audit": "Ensure the above parameter is added to the startup script which by default is located at $CATALINA_HOME\\bin\\catalina.sh.",
    "remediation": "Start Tomcat with RECYCLE_FACADES set to false. Add the following to your startup script. -Dorg.apache.catalina.connector.RECYCLE_FACADES=false Impact: By default, recycling of facades is set to false. If this is true or if a security manager is in use a new facade object will be created for each request. Default Value: If not specified, the default value of false will be used. References: 1. https://tomcat.apache.org/tomcat-7.0-doc/config/valve.html 75 | P a g e",
    "function_names": [
      "compute_instance_recycle_facades_disabled",
      "compute_session_facade_recycling_disabled",
      "compute_facade_information_leakage_prevented",
      "compute_instance_session_isolation_enabled",
      "compute_facade_recycling_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "By default, recycling of facades is set to false. If this is true or if a security manager is in use a new facade object will be created for each request. Default Value: If not specified, the default value of false will be used.",
    "references": "1. https://tomcat.apache.org/tomcat-7.0-doc/config/valve.html 75 | P a g e"
  },
  {
    "id": "10.8",
    "title": "Do not allow additional path delimiters",
    "assessment": "Scored",
    "description": "Being able to specify different path-delimiters on Tomcat creates the possibility that an attacker can access applications that were previously blocked a proxy like mod_proxy",
    "rationale": "Allowing additional path-delimiters allows for an attacker to get an application or area that was not previously visible.",
    "audit": "Ensure the above parameters are added to the startup script which by default is located at $CATALINA_HOME\\bin\\catalina.sh.",
    "remediation": "Start Tomcat with ALLOW_BACKSLASH set to false and ALLOW_ENCODED_SLASH set to false. Add the following to your startup script. -Dorg.apache.catalina.connector.CoyoteAdapter.ALLOW_BACKSLASH=false -Dorg.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH=false Default Value: By default, allowing additional parameters is set to false. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/systemprops.html  76 | P a g e",
    "function_names": [
      "tomcat_connector_path_delimiters_restricted",
      "tomcat_connector_additional_delimiters_disabled",
      "tomcat_connector_path_delimiter_compliance",
      "tomcat_connector_strict_path_delimiters",
      "tomcat_connector_delimiter_restriction_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/systemprops.html  76 | P a g e"
  },
  {
    "id": "10.9",
    "title": "Do not allow custom header status messages",
    "assessment": "Scored",
    "description": "Being able to specify custom status messages opens up the possibility for additional headers to be injected. If custom header status messages are required, make sure it is only in US-ASCII and does not include any user-supplied data.",
    "rationale": "Allowing user-supplied data into a header allows the possibility of XSS.",
    "audit": "Ensure the above parameter is added to the startup script which by default is located at $CATALINA_HOME\\bin\\catalina.sh.",
    "remediation": "Start Tomcat with USE_CUSTOM_STATUS_MSG_IN_HEADER set to false. Add the following to your startup script. -Dorg.apache.coyote.USE_CUSTOM_STATUS_MSG_IN_HEADER=false Default Value: By default, allowing custom header status messages is set to false. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/systemprops.html 77 | P a g e",
    "function_names": [
      "cloud_cdn_distribution_custom_header_status_disabled",
      "cloud_cdn_distribution_header_status_ascii_only",
      "cloud_cdn_distribution_header_status_no_user_data",
      "cloud_cdn_distribution_header_status_restricted",
      "cloud_cdn_distribution_header_status_compliant"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/systemprops.html 77 | P a g e"
  },
  {
    "id": "10.10",
    "title": "Configure connectionTimeout",
    "assessment": "Scored",
    "description": "The connectionTimeout setting allows Tomcat to close idle sockets after a specific amount of time to save system resources.",
    "rationale": "Closing idle sockets reduces system resource usage thus can provide better performance and help protect against Denial of Service attacks.",
    "audit": "Locate each connectionTimeout setting in $CATALINA_HOME/conf/server.xml and verify the setting is correct. # grep connectionTimeout $CATALINA_HOME/conf/server.xml",
    "remediation": "Within $CATALINA_HOME/conf/server.xml ensure each connector is configured to the connectionTimeout setting that is optimal based on hardware resources, load, and number of concurrent connections. connectionTimeout=\"60000\" Default Value: connectionTimeout is set to 60000 References: 1. https://tomcat.apache.org/tomcat-7.0-doc/config/http.html 78 | P a g e",
    "function_names": [
      "tomcat_connector_connection_timeout_configured",
      "tomcat_connector_idle_socket_termination_enabled",
      "tomcat_connector_resource_optimization_enabled",
      "tomcat_connector_timeout_value_set",
      "tomcat_connector_socket_management_configured"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. https://tomcat.apache.org/tomcat-7.0-doc/config/http.html 78 | P a g e"
  },
  {
    "id": "10.11",
    "title": "Configure maxHttpHeaderSize",
    "assessment": "Scored",
    "description": "The maxHttpHeaderSize limits the size of the request and response headers defined in bytes. If not specified, the default is 8192 bytes.",
    "rationale": "Limiting the size of the header request can help protect against Denial of Service requests.",
    "audit": "Locate each maxHttpHeaderSize setting in $CATALINA_HOME/conf/server.xml and verify that they are set to 8192. # grep maxHttpHeaderSize $CATALINA_HOME/conf/server.xml",
    "remediation": "Within $CATALINA_HOME/conf/server.xml ensure each connector is configured to the appropriate maxHttpHeaderSize setting. maxHttpHeaderSize=\u201d8192\u201d Default Value: maxHttpHeaderSize is set to 8192 References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html 79 | P a g e",
    "function_names": [
      "cloud_cdn_load_balancer_max_http_header_size_configured",
      "cloud_cdn_load_balancer_header_size_limited",
      "cloud_cdn_load_balancer_default_header_size_override",
      "cloud_cdn_load_balancer_request_header_size_restricted",
      "cloud_cdn_load_balancer_response_header_size_restricted"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/http.html 79 | P a g e"
  },
  {
    "id": "10.12",
    "title": "Force SSL for all applications",
    "assessment": "Scored",
    "description": "Use the transport-guarantee attribute to ensure SSL protection when accessing all applications. This can be overridden to be disabled on a per application basis in the application configuration.",
    "rationale": "By default, when accessing applications SSL will be enforced to protect information sent over the network. By using the transport-guarantee attribute within web.xml, SSL is enforced. NOTE: This requires SSL to be configured.",
    "audit": "Ensure $CATALINA_HOME/conf/web.xml has the attribute set to CONFIDENTIAL. # grep transport-guarantee $CATALINA_HOME/conf/web.xml",
    "remediation": "In $CATALINA_HOME/conf/web.xml, set the following: <user-data-constraint> <transport-guarantee>CONFIDENTIAL</transport-guarantee> <user-data-constraint> Default Value: By default, this configuration is not present. References: 1. http://www.owasp.org/index.php/Securing_tomcat 80 | P a g e",
    "function_names": [
      "compute_application_ssl_enforced",
      "compute_application_transport_guarantee_enabled",
      "compute_application_https_required",
      "compute_application_secure_transport_enabled",
      "compute_application_tls_enforced",
      "compute_application_ssl_protection_enabled",
      "compute_application_secure_connection_required"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://www.owasp.org/index.php/Securing_tomcat 80 | P a g e"
  },
  {
    "id": "10.13",
    "title": "Increase the entropy in session identifiers",
    "assessment": "Scored",
    "description": "Having a server that has deterministic session identifiers can lead to session hi-jacking. Specifying a secureRandomClass attribute allows for truly random session identifiers.",
    "rationale": "By default, the entropy attribute on session managers uses the string representation of the Manager class name. Leading to a deterministic session identifier.",
    "audit": "Ensure $CATALINA_HOME/conf/context.xml has the secureRandomClass attribute set to java.security.SecureRandom. # grep secureRandomClass $CATALINA_HOME/conf/context.xml",
    "remediation": "In $CATALINA_HOME/conf/context.xml, set the following: <Manager ... secureRandomClass=\"java.security.SecureRandom\" /> Default Value: By default, the string representation of the Manager class is used for entropy. References: 1. http://www.jeremythomerson.com/blog/2008/11/apachecon-securing-apache- tomcat-for-your-environment/ 81 | P a g e",
    "function_names": [
      "compute_session_secure_random_class_enabled",
      "compute_session_entropy_increased",
      "compute_session_identifier_randomized",
      "compute_session_secure_random_class_configured",
      "compute_session_secure_random_class_specified"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://www.jeremythomerson.com/blog/2008/11/apachecon-securing-apache- tomcat-for-your-environment/ 81 | P a g e"
  },
  {
    "id": "10.14",
    "title": "Do not allow symbolic linking",
    "assessment": "Scored",
    "description": "Symbolic links allows one application to include the libraries from another. This allows for re-use of code but also allows for potential security issues when applications include libraries from other applications they should not have access to.",
    "rationale": "Allowing symbolic links opens up Tomcat to directory traversal vulnerability. Also there is a potential that an application could link to another application it should not be linking too. On case-insensitive operating systems there is also the threat of source code disclosure.",
    "audit": "Ensure all context.xml have the allowLinking attribute set to false or allowLinking does not exist. # find . -name context.xml | xargs grep \"allowLinking\"",
    "remediation": "In all context.xml, set the allowLinking attribute to false: <Context ... allowLinking=\u201dfalse\u201d /> Default Value: By default, allowLinking has a value of false References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/context.html 82 | P a g e",
    "function_names": [
      "compute_instance_symbolic_linking_disabled",
      "compute_container_symbolic_linking_disabled",
      "compute_vm_symbolic_linking_disabled",
      "storage_volume_symbolic_linking_disabled",
      "storage_filesystem_symbolic_linking_disabled",
      "app_service_symbolic_linking_disabled",
      "app_container_symbolic_linking_disabled",
      "os_system_symbolic_linking_disabled",
      "os_library_symbolic_linking_disabled",
      "os_kernel_symbolic_linking_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/context.html 82 | P a g e"
  },
  {
    "id": "10.15",
    "title": "Do not run applications as privileged",
    "assessment": "Scored",
    "description": "Setting the privileged attribute for an application changes the class loader to the Server class loader instead of the Shared class loader.",
    "rationale": "Running an application in privileged mode allows an application to load the manager libraries.",
    "audit": "Ensure all context.xml have the privileged attribute set to false or privileged does not exist. # find . -name context.xml | xargs grep \"privileged\"",
    "remediation": "In all context.xml, set the privileged attribute to false unless it is required like the manager application: <Context ... privileged=\u201dfalse\u201d /> Default Value: By default, privileged has a value of false. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/context.html 83 | P a g e",
    "function_names": [
      "compute_container_privileged_disabled",
      "compute_pod_privileged_disabled",
      "compute_application_privileged_disabled",
      "compute_workload_privileged_disabled",
      "compute_task_privileged_disabled",
      "compute_service_privileged_disabled",
      "compute_deployment_privileged_disabled",
      "compute_namespace_privileged_disabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/context.html 83 | P a g e"
  },
  {
    "id": "10.16",
    "title": "Do not allow cross context requests",
    "assessment": "Scored",
    "description": "Setting crossContext to true allows for an application to call ServletConext.getContext to return a dispatcher for another application.",
    "rationale": "Allowing crossContext creates the possibility for a malicious application to make requests to a restricted application.",
    "audit": "Ensure all context.xml have the crossContext attribute set to false or crossContext does not exist. # find . -name context.xml | xargs grep \"crossContext\"",
    "remediation": "In all context.xml, set the crossContext attribute to false: <Context ... crossContext=\u201dfalse\u201d /> Default Value: By default, crossContext has a value of false. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/context.html 84 | P a g e",
    "function_names": [
      "compute_web_app_cross_context_disabled",
      "compute_web_app_cross_context_restricted",
      "compute_web_app_cross_context_protected",
      "compute_web_app_cross_context_secure",
      "compute_web_app_cross_context_blocked"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/context.html 84 | P a g e"
  },
  {
    "id": "10.17",
    "title": "Do not resolve hosts on logging valves",
    "assessment": "Scored",
    "description": "Setting resolveHosts to true on logging valves requires a DNS look-up before logging the information. This adds additional resources when logging.",
    "rationale": "Allowing resolveHosts adds additional overhead that is rarely needed.",
    "audit": "Ensure all Valve nodes have the resolveHosts attribute set to false or resolveHosts does not exist. # find . -name *.xml | xargs grep \"resolveHosts\"",
    "remediation": "In all context.xml and server.xml that have Valve nodes, set the resolveHosts attribute to false: <Valve ... resolveHosts=\u201dfalse\u201d /> Default Value: By default, resolveHosts has a value of false. References: 1. http://tomcat.apache.org/tomcat-7.0-doc/config/valve.html 85 | P a g e",
    "function_names": [
      "logging_valve_resolve_hosts_disabled",
      "logging_valve_no_host_resolution",
      "logging_valve_dns_lookup_disabled",
      "logging_valve_host_resolution_avoided",
      "logging_valve_direct_logging_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 2",
    "references": "1. http://tomcat.apache.org/tomcat-7.0-doc/config/valve.html 85 | P a g e"
  },
  {
    "id": "10.18",
    "title": "Enable memory leak listener",
    "assessment": "Scored",
    "description": "The JRE Memory Leak Prevention Listener provides workarounds for known places where the Java Runtime environment uses the context class loader to load a singleton as this will cause a memory leak if a web application class loader happens to be the context class loader at the time. The work-around is to initialize these singletons when this listener starts as Tomcat's common class loader is the context class loader at that time. It also provides workarounds for known issues that can result in locked JAR files.",
    "rationale": "Enable the JRE Memory Leak Prevention Listener provides workarounds for preventing memory leak.",
    "audit": "Review the $CATALINA_HOME/conf/server.xml and see whether JRE Memory Leak Prevention Listener is enabled.",
    "remediation": "Uncomment the JRE Memory Leak Prevention Listener in $CATALINA_HOME/conf/server.xml <Listener className=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\" /> Impact: A memory leak is the repetitive allocation of memory without consequential release of it when no longer used, leading to the consumption of ever increasing memory limited by external measures not controlled by the program possibly rendering the execution to a degraded state. References: 1. https://tomcat.apache.org/tomcat-7.0- doc/config/listeners.html#JRE_Memory_Leak_Prevention_Listener_- _org.apache.catalina.core.JreMemoryLeakPreventionListener 86 | P a g e",
    "function_names": [
      "compute_tomcat_memory_leak_listener_enabled",
      "compute_tomcat_jre_leak_prevention_enabled",
      "compute_tomcat_context_class_loader_secure",
      "compute_tomcat_singleton_initialization_enabled",
      "compute_tomcat_jar_file_lock_prevention_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "impact": "A memory leak is the repetitive allocation of memory without consequential release of it when no longer used, leading to the consumption of ever increasing memory limited by external measures not controlled by the program possibly rendering the execution to a degraded state.",
    "references": "1. https://tomcat.apache.org/tomcat-7.0- doc/config/listeners.html#JRE_Memory_Leak_Prevention_Listener_- _org.apache.catalina.core.JreMemoryLeakPreventionListener 86 | P a g e"
  },
  {
    "id": "10.19",
    "title": "Setting Security Lifecycle Listener",
    "assessment": "Scored",
    "description": "The Security Lifecycle Listener performs a number of security checks when Tomcat starts and prevents Tomcat from starting if they fail.",
    "rationale": "Enable the Security Lifecycle Listener can \uf0b7 Enforce a blacklist of OS users that must not be used to start Tomcat. \uf0b7 set the least restrictive umask before Tomcat start",
    "audit": "Review server.xml to ensure the Security Lifecycle Listener element is uncommented and checkedOsUsers, minimumUmask attributes are set with expected value.",
    "remediation": "To enabled it uncomment the listener in $CATALINA_BASE/conf/server.xml. If the operating system supports umask then the line in $CATALINA_HOME/bin/catalina.sh that obtains the umask also needs to be uncommented. Within Server elements add: \uf0b7 checkedOsUsers: A comma separated list of OS users that must not be used to start Tomcat. If not specified, the default value of root is used. \uf0b7 minimumUmask: The least restrictive umask that must be configured before Tomcat will start. If not specified, the default value of 0007 is used. <Listener className=\"org.apache.catalina.security.SecurityListener\" checkedOsUsers=\"alex,bob\" minimumUmask=\"0007\" /> Default Value: The Security Lifecycle Listener is not enabled by default. For checkedOsUsers, If not specified, the default value of root is used. For minimumUmask, if not specified, the default value of 0007 is used. 87 | P a g e References: 1. https://tomcat.apache.org/tomcat-7.0- doc/config/listeners.html#Security_Lifecycle_Listener_- _org.apache.catalina.security.SecurityListener 88 | P a g e",
    "function_names": [
      "tomcat_server_security_lifecycle_listener_enabled",
      "tomcat_server_security_lifecycle_listener_configured",
      "tomcat_server_security_lifecycle_listener_strict_mode",
      "tomcat_server_security_lifecycle_listener_startup_checks_enabled",
      "tomcat_server_security_lifecycle_listener_failure_prevention_enabled"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. https://tomcat.apache.org/tomcat-7.0- doc/config/listeners.html#Security_Lifecycle_Listener_- _org.apache.catalina.security.SecurityListener 88 | P a g e"
  },
  {
    "id": "10.20",
    "title": "use the logEffectiveWebXml and metadata-complete settings for deploying applications in production",
    "assessment": "Scored",
    "description": "Both Fragments and annotations give rise to security concerns. web.xml contains a metadata-complete attribute in the web-app element whose binary value defines whether other sources of metadata should be considered when deploying this web application, this includes annotations on class files (@WebServlet, but also @WebListener, @WebFilter, \u2026), web-fragment.xml as well as classes located in WEB-INF/classes. In addition, Tomcat 7 could allow you to log the effective web.xml, when an application starts, and the effective web.xml is the result of taking the main web.xml for your application merging in all the fragments applying all the annotations. By logging that you are able to review it, and see if that is in fact what you actually want.",
    "rationale": "Enable \"logEffectiveWebXml\" will allow you to log the effective web.xml and you are able to see if that is in fact what you actually want. Enable \"metadata-complete\" so that the web.xml is the only metadata considered.",
    "audit": "1. Review each application\u2019s web.xml file located in the applications $CATALINA_BASE\\<app name>\\WEB-INF\\web.xml and determine if the metadata- complete property is set. <web-app ... metadata-complete=\"true\" ... > 2. Review each application\u2019s context.xml file located in the applications $CATALINA_BASE\\<app name>\\META-INF\\context.xml and determine if the metadata-complete property is set. <Context ... logEffectiveWebXml=\"true\" ... > 89 | P a g e",
    "remediation": "\uf0b7 Set the metadata-complete value in the web.xml in each of applications to true, the web.xml contains a metadata-complete attribute in the web-app element whose binary value defines whether other sources of metadata should be considered when deploying this web application, this includes annotations on class files (@WebServlet, but also @WebListener, @WebFilter, ...), web-fragment.xml as well as classes located in WEB-INF/classes. If set to true all of these will be ignored and web.xml is the only metadata considered. NOTE: \"The metadata-complete option is not enough to disable all of annotation scanning. If there is a ServletContainerInitializer with a @HandlesTypes annotation, Tomcat has to scan your application for classes that use annotations or interfaces specified in that annotation. \uf0b7 Set the logEffectiveWebXml value in the context.xml in each of applications to true Default Value: If logEffectiveWebXml not specified, the default value of false is used; If metadata- complete not specified, the default value of false is used; References: 1. https://tomcat.apache.org/tomcat-7.0-doc/config/context.html 2. https://tomcat.apache.org/migration-7.html#Annotation_scanning 3. https://alexismp.wordpress.com/2010/07/28/servlet-3-0-fragments-and-web- xml-to-rule-them-all/   90 | P a g e Control Set Correctly Yes No 1 Remove Extraneous Resources 1.1 Remove extraneous files and directories (Scored) \uf06f \uf06f 1.2 Disable Unused Connectors (Not Scored) \uf06f \uf06f 2 Limit Server Platform Information Leaks 2.1 Alter the Advertised server.info String (Scored) \uf06f \uf06f 2.2 Alter the Advertised server.number String (Scored) \uf06f \uf06f 2.3 Alter the Advertised server.built Date  (Scored) \uf06f \uf06f 2.4 Disable X-Powered-By HTTP Header and Rename the Server Value for all Connectors  (Scored) \uf06f \uf06f 2.5 Disable client facing Stack Traces  (Scored) \uf06f \uf06f 2.6 Turn off TRACE (Scored) \uf06f \uf06f 3 Protect the Shutdown Port 3.1 Set a nondeterministic Shutdown command value  (Scored) \uf06f \uf06f 3.2 Disable the Shutdown port (Not Scored) \uf06f \uf06f 4 Protect Tomcat Configurations 4.1 Restrict access to $CATALINA_HOME (Scored) \uf06f \uf06f 4.2 Restrict access to $CATALINA_BASE (Scored) \uf06f \uf06f 4.3 Restrict access to Tomcat configuration directory  (Scored) \uf06f \uf06f 4.4 Restrict access to Tomcat logs directory  (Scored) \uf06f \uf06f 4.5 Restrict access to Tomcat temp directory  (Scored) \uf06f \uf06f 4.6 Restrict access to Tomcat binaries directory (Scored) \uf06f \uf06f 4.7 Restrict access to Tomcat web application directory (Scored) \uf06f \uf06f 4.8 Restrict access to Tomcat catalina.policy  (Scored) \uf06f \uf06f 4.9 Restrict access to Tomcat catalina.properties  (Scored) \uf06f \uf06f 4.10 Restrict access to Tomcat context.xml  (Scored) \uf06f \uf06f 4.11 Restrict access to Tomcat logging.properties  (Scored) \uf06f \uf06f 4.12 Restrict access to Tomcat server.xml  (Scored) \uf06f \uf06f 4.13 Restrict access to Tomcat tomcat-users.xml  (Scored) \uf06f \uf06f 4.14 Restrict access to Tomcat web.xml  (Scored) \uf06f \uf06f 5 Configure Realms 5.1 Use secure Realms (Scored) \uf06f \uf06f 5.2 Use LockOut Realms (Scored) \uf06f \uf06f 6 Connector Security 6.1 Setup Client-cert Authentication (Scored) \uf06f \uf06f 6.2 Ensure SSLEnabled is set to True for Sensitive Connectors (Not Scored) \uf06f \uf06f 6.3 Ensure scheme is set accurately (Scored) \uf06f \uf06f 6.4 Ensure secure is set to true only for SSL-enabled Connectors (Scored) \uf06f \uf06f 91 | P a g e 6.5 Ensure SSL Protocol is set to TLS for Secure Connectors (Scored) \uf06f \uf06f 7 Establish and Protect Logging Facilities 7.1  Application specific logging (Scored) \uf06f \uf06f 7.2 Specify file handler in logging.properties files (Scored) \uf06f \uf06f 7.3 Ensure className is set correctly in context.xml (Scored) \uf06f \uf06f 7.4 Ensure directory in context.xml is a secure location (Scored) \uf06f \uf06f 7.5 Ensure pattern in context.xml is correct (Scored) \uf06f \uf06f 7.6  Ensure directory in logging.properties is a secure location (Scored) \uf06f \uf06f 7.7 Configure log file size limit (Scored) \uf06f \uf06f 8 Configure Catalina Policy 8.1 Restrict runtime access to sensitive packages (Scored) \uf06f \uf06f 9 Application Deployment 9.1 Starting Tomcat with Security Manager (Scored) \uf06f \uf06f 9.2 Disabling auto deployment of applications (Scored) \uf06f \uf06f 9.3 Disable deploy on startup of applications  (Scored) \uf06f \uf06f 10 Miscellaneous Configuration Settings 10.1 Ensure Web content directory is on a separate partition from the Tomcat system files  (Not Scored) \uf06f \uf06f 10.2 Restrict access to the web administration (Not Scored) \uf06f \uf06f 10.3 Restrict manager application (Not Scored) \uf06f \uf06f 10.4 Force SSL when accessing the manager application  (Scored) \uf06f \uf06f 10.5 Rename the manager application  (Scored) \uf06f \uf06f 10.6 Enable strict servlet Compliance  (Scored) \uf06f \uf06f 10.7 Turn off session fa\u00e7ade recycling (Scored) \uf06f \uf06f 10.8 Do not allow additional path delimiters (Scored) \uf06f \uf06f 10.9 Do not allow custom header status messages (Scored) \uf06f \uf06f 10.10 Configure connectionTimeout (Scored) \uf06f \uf06f 10.11 Configure maxHttpHeaderSize (Scored) \uf06f \uf06f 10.12 Force SSL for all applications  (Scored) \uf06f \uf06f 10.13 Increase the entropy in session identifiers (Scored) \uf06f \uf06f 10.14 Do not allow symbolic linking  (Scored) \uf06f \uf06f 10.15 Do not run applications as privileged (Scored) \uf06f \uf06f 10.16 Do not allow cross context requests (Scored) \uf06f \uf06f 10.17 Do not resolve hosts on logging valves  (Scored) \uf06f \uf06f 10.18 Enable memory leak listener (Scored) \uf06f \uf06f 10.19 Setting Security Liftcycle Listener (Scored) \uf06f \uf06f 10.20 use the logEffectiveWebXml and metadata-complete settings for deploying applications in production (Scored) \uf06f \uf06f   92 | P a g e  Appendix: Change History Date Version Changes for this version 3/11/16 1.0.0 Initial Release",
    "function_names": [
      "tomcat_web_app_metadata_complete_enabled",
      "tomcat_web_app_log_effective_web_xml_enabled",
      "tomcat_web_app_annotations_disabled",
      "tomcat_web_app_fragments_disabled",
      "tomcat_web_app_deployment_secure_config",
      "tomcat_web_app_web_xml_merged_logging_enabled",
      "tomcat_web_app_production_deployment_secure"
    ],
    "profile_applicability": "\uf0b7  Level 1",
    "references": "1. https://tomcat.apache.org/tomcat-7.0-doc/config/context.html 2. https://tomcat.apache.org/migration-7.html#Annotation_scanning 3. https://alexismp.wordpress.com/2010/07/28/servlet-3-0-fragments-and-web- xml-to-rule-them-all/   90 | P a g e Control Set Correctly Yes No 1 Remove Extraneous Resources 1.1 Remove extraneous files and directories (Scored) \uf06f \uf06f 1.2 Disable Unused Connectors (Not Scored) \uf06f \uf06f 2 Limit Server Platform Information Leaks 2.1 Alter the Advertised server.info String (Scored) \uf06f \uf06f 2.2 Alter the Advertised server.number String (Scored) \uf06f \uf06f 2.3 Alter the Advertised server.built Date  (Scored) \uf06f \uf06f 2.4 Disable X-Powered-By HTTP Header and Rename the Server Value for all Connectors  (Scored) \uf06f \uf06f 2.5 Disable client facing Stack Traces  (Scored) \uf06f \uf06f 2.6 Turn off TRACE (Scored) \uf06f \uf06f 3 Protect the Shutdown Port 3.1 Set a nondeterministic Shutdown command value  (Scored) \uf06f \uf06f 3.2 Disable the Shutdown port (Not Scored) \uf06f \uf06f 4 Protect Tomcat Configurations 4.1 Restrict access to $CATALINA_HOME (Scored) \uf06f \uf06f 4.2 Restrict access to $CATALINA_BASE (Scored) \uf06f \uf06f 4.3 Restrict access to Tomcat configuration directory  (Scored) \uf06f \uf06f 4.4 Restrict access to Tomcat logs directory  (Scored) \uf06f \uf06f 4.5 Restrict access to Tomcat temp directory  (Scored) \uf06f \uf06f 4.6 Restrict access to Tomcat binaries directory (Scored) \uf06f \uf06f 4.7 Restrict access to Tomcat web application directory (Scored) \uf06f \uf06f 4.8 Restrict access to Tomcat catalina.policy  (Scored) \uf06f \uf06f 4.9 Restrict access to Tomcat catalina.properties  (Scored) \uf06f \uf06f 4.10 Restrict access to Tomcat context.xml  (Scored) \uf06f \uf06f 4.11 Restrict access to Tomcat logging.properties  (Scored) \uf06f \uf06f 4.12 Restrict access to Tomcat server.xml  (Scored) \uf06f \uf06f 4.13 Restrict access to Tomcat tomcat-users.xml  (Scored) \uf06f \uf06f 4.14 Restrict access to Tomcat web.xml  (Scored) \uf06f \uf06f 5 Configure Realms 5.1 Use secure Realms (Scored) \uf06f \uf06f 5.2 Use LockOut Realms (Scored) \uf06f \uf06f 6 Connector Security 6.1 Setup Client-cert Authentication (Scored) \uf06f \uf06f 6.2 Ensure SSLEnabled is set to True for Sensitive Connectors (Not Scored) \uf06f \uf06f 6.3 Ensure scheme is set accurately (Scored) \uf06f \uf06f 6.4 Ensure secure is set to true only for SSL-enabled Connectors (Scored) \uf06f \uf06f 91 | P a g e 6.5 Ensure SSL Protocol is set to TLS for Secure Connectors (Scored) \uf06f \uf06f 7 Establish and Protect Logging Facilities 7.1  Application specific logging (Scored) \uf06f \uf06f 7.2 Specify file handler in logging.properties files (Scored) \uf06f \uf06f 7.3 Ensure className is set correctly in context.xml (Scored) \uf06f \uf06f 7.4 Ensure directory in context.xml is a secure location (Scored) \uf06f \uf06f 7.5 Ensure pattern in context.xml is correct (Scored) \uf06f \uf06f 7.6  Ensure directory in logging.properties is a secure location (Scored) \uf06f \uf06f 7.7 Configure log file size limit (Scored) \uf06f \uf06f 8 Configure Catalina Policy 8.1 Restrict runtime access to sensitive packages (Scored) \uf06f \uf06f 9 Application Deployment 9.1 Starting Tomcat with Security Manager (Scored) \uf06f \uf06f 9.2 Disabling auto deployment of applications (Scored) \uf06f \uf06f 9.3 Disable deploy on startup of applications  (Scored) \uf06f \uf06f 10 Miscellaneous Configuration Settings 10.1 Ensure Web content directory is on a separate partition from the Tomcat system files  (Not Scored) \uf06f \uf06f 10.2 Restrict access to the web administration (Not Scored) \uf06f \uf06f 10.3 Restrict manager application (Not Scored) \uf06f \uf06f 10.4 Force SSL when accessing the manager application  (Scored) \uf06f \uf06f 10.5 Rename the manager application  (Scored) \uf06f \uf06f 10.6 Enable strict servlet Compliance  (Scored) \uf06f \uf06f 10.7 Turn off session fa\u00e7ade recycling (Scored) \uf06f \uf06f 10.8 Do not allow additional path delimiters (Scored) \uf06f \uf06f 10.9 Do not allow custom header status messages (Scored) \uf06f \uf06f 10.10 Configure connectionTimeout (Scored) \uf06f \uf06f 10.11 Configure maxHttpHeaderSize (Scored) \uf06f \uf06f 10.12 Force SSL for all applications  (Scored) \uf06f \uf06f 10.13 Increase the entropy in session identifiers (Scored) \uf06f \uf06f 10.14 Do not allow symbolic linking  (Scored) \uf06f \uf06f 10.15 Do not run applications as privileged (Scored) \uf06f \uf06f 10.16 Do not allow cross context requests (Scored) \uf06f \uf06f 10.17 Do not resolve hosts on logging valves  (Scored) \uf06f \uf06f 10.18 Enable memory leak listener (Scored) \uf06f \uf06f 10.19 Setting Security Liftcycle Listener (Scored) \uf06f \uf06f 10.20 use the logEffectiveWebXml and metadata-complete settings for deploying applications in production (Scored) \uf06f \uf06f   92 | P a g e  Appendix: Change History Date Version Changes for this version 3/11/16 1.0.0 Initial Release"
  }
]