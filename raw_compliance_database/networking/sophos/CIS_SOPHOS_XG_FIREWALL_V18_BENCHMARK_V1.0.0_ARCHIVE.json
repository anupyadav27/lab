[
  {
    "id": "1.1.1",
    "title": "Ensure admin session 'lock', 'logout' for inactivity and 'block' is configured for failed sign-in",
    "assessment": "Automated",
    "description": "Set to automatically lock the session after the configured time of inactivity (in minutes). This setting applies to the web admin and CLI console, the IPSec connection wizard, the network wizard, and the group import wizard. (Default: 3 minutes) Set to automatically sign out the administrator from the web admin console after the configured time of inactivity. (Default: 10 minutes) Set to block sign-in to the web admin console and CLI after the maximum numbers of failed sign-in attempts and the duration (in seconds) which attempts can be made from a single IP address.",
    "rationale": "An unattended computer with an open administrative session to the device could allow an unauthorized user access to the firewall\u2019s management interface. Thwart bruteforce attempts against login sessions to block multiple sign-in failures.",
    "audit": "Navigate to `System > Administration > Admin settings > Login security`. Verify that `Lock admin session after _ Minutes of inactivity` is checked and configured with no more than 3 minutes of default value. Verify that `Logout admin session after _ Minutes of inactivity` is checked and configured with no more than 10 minutes of default value. Verify that `Block login` is checked.    11 | P a g e",
    "remediation": "Navigate to `System > Administration > Admin settings > Login security`. Set `Lock admin session after _ Minutes of inactivity` is checked and configured with no more than 3 minutes of default value. Set `Logout admin session after _ Minutes of inactivity` is checked and configured with no more than 10 minutes of default value. Set `Block login` is checked. Default Value: Lock admin session after 3 minutes. Log out admin session after 10 minutes. References: 1. https://support.sophos.com/support/s/article/KB-000035727?language=en_US",
    "function_names": [
      "admin_session_inactivity_lock_enabled",
      "admin_session_inactivity_logout_enabled",
      "admin_session_failed_signin_block_enabled",
      "admin_session_inactivity_lock_min_3",
      "admin_session_inactivity_logout_min_10",
      "admin_session_failed_signin_block_max_attempts",
      "admin_session_failed_signin_block_duration_seconds"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://support.sophos.com/support/s/article/KB-000035727?language=en_US"
  },
  {
    "id": "1.1.2",
    "title": "Ensure login disclaimer is set",
    "assessment": "Automated",
    "description": "Configure a login disclaimer, ideally approved by the organization\u2019s legal team. This banner should at minimum prohibit unauthorized access, provide notice of logging or monitoring, and avoid using the word \u201cwelcome\u201d or similar words of invitation.",
    "rationale": "Through a properly stated login banner, the risk of unintentional access to the device by unauthorized users is reduced. Should legal action take place against a person accessing the device without authorization, the login banner greatly diminishes a defendant\u2019s claim of ignorance.",
    "audit": "Navigate to `System > Administration > Admin Settings > Login Disclaimer Settings`. Verify `Enable login disclaimer` is checked and disclaimer message is set appropriately.",
    "remediation": "Navigate to `System > Administration > Admin Settings > Login Disclaimer Settings`. `Enable login disclaimer` is checked and set the disclaimer message appropriately. Default Value: Not Configured References: 1. https://community.sophos.com/kb/en-us/123142",
    "function_names": [
      "iam_account_login_disclaimer_configured",
      "iam_account_login_disclaimer_legal_approved",
      "iam_account_login_disclaimer_unauthorized_access_prohibited",
      "iam_account_login_disclaimer_monitoring_notice_included",
      "iam_account_login_disclaimer_no_welcome_message"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://community.sophos.com/kb/en-us/123142"
  },
  {
    "id": "1.1.3",
    "title": "Ensure NTP servers are configured appropriately",
    "assessment": "Automated",
    "description": "Synchronize the clock on XG firewall with NTP servers.",
    "rationale": "NTP enables the device to maintain an accurate time and date when receiving updates from a reliable NTP server. Accurate timestamps are critical when correlating events with other systems, troubleshooting, or performing investigative work. Logs and certain cryptographic functions, such as those utilizing certificates, rely on accurate time and date parameters. In addition, rules referencing a Schedule object will not function as intended if the device\u2019s time and date are incorrect.",
    "audit": "Navigate to `System > Administration > Time`. Verify that `Time Zone` is set correctly. Verify that `Use pre-defined NTP Server` Or `Use custom NTP Server` is checked and synchronize the device's clock.",
    "remediation": "Navigate to `System > Administration > Time`. Set `Time Zone` correctly. Set `Use pre-defined NTP Server` Or `Use custom NTP Server` is checked and synchronize the device's clock. Default Value: Not configured References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/tasks/AdministrationTimeSet.html   14 | P a g e",
    "function_names": [
      "firewall_ntp_servers_configured",
      "firewall_ntp_servers_synchronized",
      "firewall_ntp_servers_secure",
      "firewall_ntp_servers_reachable",
      "firewall_ntp_servers_time_sync_enabled",
      "firewall_ntp_servers_valid_sources",
      "firewall_ntp_servers_authentication_enabled",
      "firewall_ntp_servers_minimum_count",
      "firewall_ntp_servers_stratum_configured",
      "firewall_ntp_servers_no_default_servers"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/tasks/AdministrationTimeSet.html   14 | P a g e"
  },
  {
    "id": "1.1.4",
    "title": "Ensure SSL server certificate for remote SSL VPN is configured correctly",
    "assessment": "Manual",
    "description": "The Certificate used to secure SSL VPN should satisfy the following criteria. \u2022 It should be a valid certificate from a trusted source. In most cases this means a trusted Public Certificate Authority as remote sslvpn users may not have access to any Private Certificate Authorities for Certificate validation. \u2022 The certificate should have a valid date. It should not have a \"to\" date in the past (it should not be expired), and should not have a \"from\" date in the future. \u2022 The key length used to encrypt the certificate should be 2048 bits or more. \u2022 The hash used to sign the certificate should be SHA-2 or better.",
    "rationale": "If presented with a certificate error, the end user in most cases will not be able to tell if their session is using a self-signed or expired certificate, or if their session is being eavesdropped on or injected into by a \"Man in the Middle\" attack. Impact: Not using a trusted Certificate, issued by a trusted Public Certificate Authority means that clients establishing VPN sessions will always see an error indicating an untrusted Certificate. This means that they will have no method of validating if their VPN session is being hijacked by a \"Man in the Middle\" (MitM) attack. It also \"trains\" them to bypass certificate warnings for other services, making MitM attacks easier for those other services as well.",
    "audit": "Verify that the certificate being used to secure the SSL VPN meets the criteria listed. Navigate to `System > Administration > Admin settings > Admin console and end-user interaction > Certificate` Ensure that a valid certificate is applied to the User portal. Navigate to `Configure > VPN > Show VPN settings > SSL VPN settings > SSL server certificate`.  16 | P a g e Ensure that a valid certificate is used for the SSL VPN Gateway.",
    "remediation": "Create a CSR and install a certificate from a public CA. Navigate to `System > Administration > Admin settings > Admin console and end-user interaction > Certificate`. Set a valid certificate to the User portal. Navigate to `Configure > Show VPN settings > SSL VPN settings > SSL server certificate`. Set a valid certificate for the SSL VPN Gateway. Default Value: Not configured References: 1. http://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/VPNSettings.html",
    "function_names": [
      "ssl_vpn_certificate_valid_source",
      "ssl_vpn_certificate_not_expired",
      "ssl_vpn_certificate_date_valid",
      "ssl_vpn_certificate_key_length_min_2048",
      "ssl_vpn_certificate_hash_sha2_or_better"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Not using a trusted Certificate, issued by a trusted Public Certificate Authority means that clients establishing VPN sessions will always see an error indicating an untrusted Certificate. This means that they will have no method of validating if their VPN session is being hijacked by a \"Man in the Middle\" (MitM) attack. It also \"trains\" them to bypass certificate warnings for other services, making MitM attacks easier for those other services as well.",
    "references": "1. http://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/VPNSettings.html"
  },
  {
    "id": "1.1.5",
    "title": "Ensure password complexity check is enabled",
    "assessment": "Automated",
    "description": "This checks all new passwords to ensure that they meet basic requirements for strong passwords.",
    "rationale": "Password complexity recommendations are derived from the USGCB (United States Government Configuration Baseline), Common Weakness Enumeration, and benchmarks published by the CIS (Center for Internet Security). Password complexity adds entropy to a password, in comparison to a simple password of the same length. A complex password is more difficult to attack, either directly against administrative interfaces or cryptographically, against captured password hashes. However, making a password of greater length will generally have a greater impact in this regard, in comparison to making a shorter password more complex. Impact: Simple passwords make an attacker's job very easy. There is a reasonably short list of commonly used admin passwords for network infrastructure, not enforcing password lengths and complexity can lend itself to making an attacker's brute force attack successful.",
    "audit": "Navigate to `System > Administration > Admin settings > Administrator password complexity settings > Enable password complexity check`. Verify that `Enable password complexity check` is enabled. Ensure that the various password settings to values that are appropriate to your organization. Should be checked for use at least one uppercase and one lowercase letter, include at least 1 numeric character and include at least 1 special character like @,$,!,etc.",
    "remediation": "Navigate to `System > Administration > Admin settings > Administrator password complexity settings > Enable password complexity check`. Set Enable password complexity check.  18 | P a g e Set that the various password settings to values that are appropriate to your organization. It is suggested that there at least be some special characters enforced, and that a minimum length be set. Ensure that Minimum Uppercase, Lowercase and Special Characters. Operationally, dictionary words should be avoided for all passwords - passphrases are a much better alternative. Default Value: Not enabled References: 1. https://support.sophos.com/support/s/article/KB-000035727?language=en_US",
    "function_names": [
      "iam_password_policy_complexity_enabled",
      "iam_password_policy_min_length_14",
      "iam_password_policy_require_uppercase",
      "iam_password_policy_require_lowercase",
      "iam_password_policy_require_numbers",
      "iam_password_policy_require_symbols",
      "iam_password_policy_no_reuse_24",
      "iam_password_policy_expiration_90d",
      "iam_password_policy_max_age_enabled",
      "iam_password_policy_hard_expiry_enabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "Simple passwords make an attacker's job very easy. There is a reasonably short list of commonly used admin passwords for network infrastructure, not enforcing password lengths and complexity can lend itself to making an attacker's brute force attack successful.",
    "references": "1. https://support.sophos.com/support/s/article/KB-000035727?language=en_US"
  },
  {
    "id": "1.1.6",
    "title": "Ensure management access to the device is restricted from selected IP addresses and disable from WAN Zone",
    "assessment": "Automated",
    "description": "It is recommended to limit exposure of Firewall administration services from WAN/untrusted zone. When necessary, leverage on remote VPN or limiting only from selected IP addresses, or use of Sophos Central for firewall administration. For additional security control - RBAC and administrative accounts can be enabled with 2- factor authentication using built-in RADIUS Server. By disabling \u2018HTTPS\u2019, \u2018SSH\u2019 and \u2018Network services (PING/PING6, DNS, SMTP RELAY, SNMP)\u2019 on WAN zone to protect against reconnaissance attempts, network scanners and potential adversary.",
    "rationale": "When the device is exposed to the internet with service ports, it could be subjected to DOS, brute-force attempts, and underlying vulnerability on service ports can be discovered by the attacker. Impact: When left enabled - it could lead to brute force attempt on the Webadmin interface, denial of service attack from wide range of IP addresses and increase attack surface from potential adversary.",
    "audit": "Navigate to `System > Administration > Device Access > Local service ACL`. Verify `HTTPS,SSH,PING/PING6,DNS,SMTP RELAY, SNMP` on `WAN Zone` is unchecked. Navigate to `Local service ACL exception rule`. Verify that `Added exception rule` only allows limited IP addresses for device management.   20 | P a g e",
    "remediation": "Navigate to `System > Administration > Device Access > Local service ACL`. Uncheck `HTTPS,SSH,PING/PING6,DNS,SMTP RELAY, SNMP` on `WAN Zone`. Default Value: Not configured References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/AdministrationDeviceAccess.html",
    "function_names": [
      "firewall_management_access_restricted_to_selected_ips",
      "firewall_management_access_wan_zone_disabled",
      "firewall_management_access_vpn_required",
      "firewall_management_access_rbac_enabled",
      "firewall_management_access_mfa_enabled",
      "firewall_management_https_disabled_on_wan",
      "firewall_management_ssh_disabled_on_wan",
      "firewall_management_network_services_disabled_on_wan",
      "firewall_management_snmp_disabled_on_wan",
      "firewall_management_dns_disabled_on_wan",
      "firewall_management_smtp_relay_disabled_on_wan",
      "firewall_management_ping_disabled_on_wan",
      "firewall_management_ping6_disabled_on_wan"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "When left enabled - it could lead to brute force attempt on the Webadmin interface, denial of service attack from wide range of IP addresses and increase attack surface from potential adversary.",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/AdministrationDeviceAccess.html"
  },
  {
    "id": "1.1.7",
    "title": "Ensure valid certificate is set for web browser used to access Webadmin interface",
    "assessment": "Automated",
    "description": "Default HTTPS port 4444 is used to access XG Firewall's Webadmin interface. HTTPS certificate used to secure the administrative session should satisfy the following criteria: 1. A valid certificate from a trusted source should be used. While a certificate from a trusted Public Certificate Authority is certainly valid, one from a trusted Private Certificate Authority is absolutely acceptable for this purpose. 2. The certificate should have a valid date. It should not have a \"to\" date in the past (it should not be expired), and should not have a \"from\" date in the future. 3. The certificate should use an acceptable cipher and encryption level.",
    "rationale": "If a certificate that is self-signed, expired, or otherwise invalid is used for HTTPS interface, administrators in most cases will not be able to tell if their session is being eavesdropped or injected into by \"Man in the Middle\" attack. Impact: If the default self-signed certificate is used, an administrator will not be able to tell if their HTTPS session is being hijacked or not. Using a trusted certificate ensures that the session is both encrypted and trusted.",
    "audit": "Navigate to `System > Certificates > Certificates`. Verify that the certificate used to secure HTTPS sessions meets the criteria by reviewing the appropriate certificate. Navigate to `System > Administration > Admin settings > Admin console and end-user interaction > Certificate`. Verify that correct Certificate is used for Webadmin, user portal, captive portal and SPX reply portal.   22 | P a g e",
    "remediation": "If a new administrative Certificate is needed, acquire a Certificate that meets the stated criteria and upload it to the XG Firewall. Optionally, download the appliance Certificate Authority to the web browser used for administration. Navigate to `System > Certificates > Certificates > Add` Import an appropriate Certificate for your administrative session, from a trusted Certificate Authority. Navigate to `System > Administration > Admin settings > Admin console and end-user interaction > Certificate` Choose the correct certificate to use for the web based administrative session. Default Value: A self-signed certificate is used by default for the administrative interface. References: 1. https://community.sophos.com/kb/en-us/132678 Additional Information: Verify that the clock is both accurate and reliable on both the XG and on the administrative workstations before setting the SSL/TLS Service Profile. Inaccurate or mismatched clocks will result in certificate errors and can result in loss of HTTPS administrative access.",
    "function_names": [
      "firewall_webadmin_certificate_valid",
      "firewall_webadmin_certificate_trusted_source",
      "firewall_webadmin_certificate_date_valid",
      "firewall_webadmin_certificate_not_expired",
      "firewall_webadmin_certificate_encryption_strong",
      "firewall_webadmin_https_certificate_secure",
      "firewall_webadmin_certificate_cipher_acceptable",
      "firewall_webadmin_certificate_tls_compliant"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "If the default self-signed certificate is used, an administrator will not be able to tell if their HTTPS session is being hijacked or not. Using a trusted certificate ensures that the session is both encrypted and trusted.",
    "references": "1. https://community.sophos.com/kb/en-us/132678 Additional Information: Verify that the clock is both accurate and reliable on both the XG and on the administrative workstations before setting the SSL/TLS Service Profile. Inaccurate or mismatched clocks will result in certificate errors and can result in loss of HTTPS administrative access."
  },
  {
    "id": "1.2.1",
    "title": "Ensure SNMPv3 is selected for queries and traps",
    "assessment": "Manual",
    "description": "SNMP (Simple Network Management Protocol) gives access to XG Firewall information such as status of the firewall, service availability, CPU, memory and disk usage. Although XG Firewall supports SNMPv1 and SNMPv2c protocols, you should always use SNMPv3 for user and the authorized hosts to send traps. Specify encryption and authentication settings to ensure confidentiality, message integrity, and user validity.",
    "rationale": "SNMPv3 utilizes AES-128 encryption, message integrity, user authorization, and device authentication security features. SNMPv2c does not provide these security features. If an SNMPv2c community string is intercepted or otherwise obtained, an attacker could gain read access to the firewall. Note that SNMP write access is not possible.",
    "audit": "Navigate to `System > Administration > SNMP`. Verify that SNMPv1 and v2 are not configured. Verify that `SNMPv3 users and traps > Encryption algorithm` is configured with either AES or DES. Set appropriate password strength for both authentication and encryption.",
    "remediation": "Navigate to `System > Administration > SNMP`. Remove insecure SNMPv1 and v2 configurations. Set `SNMPv3 users and traps > Encryption algorithm` is configured with either AES or DES. Set appropriate password strength for both authentication and encryption.   24 | P a g e Default Value: Not configured References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/tasks/AdministrationSNMPUserAdd.html",
    "function_names": [
      "snmp_protocol_version_snmpv3_enabled",
      "snmp_query_snmpv3_required",
      "snmp_trap_snmpv3_required",
      "snmp_user_authentication_enabled",
      "snmp_host_authorization_enabled",
      "snmp_encryption_enabled",
      "snmp_message_integrity_enabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/tasks/AdministrationSNMPUserAdd.html"
  },
  {
    "id": "1.2.2",
    "title": "Ensure notification is configured to send system and security events",
    "assessment": "Manual",
    "description": "This recommendation ensures that administrator receives notification on system events, reports and security incidents either via email or SNMP Traps.",
    "rationale": "Verify the notification settings to ensure that correct email address of sender \"From Email Address\u201d and recipient \u201cSend notification to email address\u201d is configured. Both settings should be reflected according to the rightful sender and recipient together with notification list for admin, system, security events. Impact: This recommendation ensures that administrator receives the notifications for critical system, security events and reports.",
    "audit": "Navigate to `System > Administration > Notification settings > Mail server settings`. Verify that `Send notification via > Built-in email server` or `External email server` is checked and configure email settings appropriately. Navigate to `Configure > System services > Notification list`. Verify that appropriate admin, system and security events are checked to send email notification and/or SNMP traps.",
    "remediation": "Navigate to `System > Administration > Notification settings`. When `built-in email server` is used. Set the `from email address` of the sender. Set the `Send notifications to email address` of the administrators\u2019 email address.  26 | P a g e Set `Management interface IP address` to send notification from. When `External mail server` is used. Set the `Mail server IPv4 address/FQDN \u2013 Port` is set to the outgoing mail server. Set `username` and `password` to authenticate to the outgoing mail server. Set `connection security` to `STARTTLS` or `SSL/TLS`. Navigate to `Configure > System services > Notification list`. Set the appropriate admin, system and security events to send email notification and/or SNMP traps. Default Value: Not configured References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/tasks/AdministrationNotificationList.html",
    "function_names": [
      "cloudtrail_trail_logging_enabled",
      "cloudtrail_trail_notification_enabled",
      "cloudtrail_trail_security_events_notified",
      "cloudtrail_trail_system_events_notified",
      "cloudtrail_trail_sns_topic_configured",
      "cloudtrail_trail_email_notification_enabled",
      "cloudtrail_trail_snmp_trap_notification_enabled",
      "cloudtrail_trail_admin_alerts_enabled",
      "cloudtrail_trail_security_incident_notification_enabled",
      "cloudtrail_trail_event_notification_configured"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "This recommendation ensures that administrator receives the notifications for critical system, security events and reports.",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/tasks/AdministrationNotificationList.html"
  },
  {
    "id": "2.1",
    "title": "Ensure Firewall rules are configured to identify users before authorizing access",
    "assessment": "Manual",
    "description": "Configure appropriate settings to map IP addresses to usernames. Mapping users to IP addresses is what permits the firewall to create rules based on users and groups rather than IP addresses and subnets, as well as log events by usernames rather than IP addresses or DNS names. The specifics of how to achieve IP-to-username mapping is highly dependent on the environment. It can be enabled by integrating the firewall with a domain controller, captive portal, Terminal Server, Kerberos, NTLM, and synchronized security heartbeat from a variety of devices.",
    "rationale": "Understanding which user is involved in a security incident allows appropriate personnel to move quickly between the detection and reaction phases of incident response. In environments with either short DHCP lease times, or where users may move frequently between systems, the ability to analyze or report, or alert on events based on user accounts or user groups is a tremendous advantage. For forensics tasks when DHCP lease information may not be available, the Source User information may be the only way to tie together related data.",
    "audit": "Validate allowed fire rules with source zone (LAN/DMZ) are configured with user identification. Source network where users are located must authenticate to XG Firewall first before accessing network resources. Verify that `Protect > Rules and policies > Firewall rules` and within the firewall rule ensure `Match known users` is checked and add authorized `User or groups`. Captive portal redirects to unknown users by ensuring `Use web authentication for unknown users` is checked.",
    "remediation": "To enable user based firewall rule: Navigate to `Protect > Rules and policies > Firewall rules` edit existing policies or when creating a new firewall policy `match known users` is checked. `Log firewall traffic` is checked to log for allowed traffic.  29 | P a g e Configure authentication server to use for firewall connections. Navigate to `Configure > Authentication > Services > Firewall authentication methods` move the primary authentication server at the top. Configure Clientless users for devices such as printers and IoT devices that unable to authenticate with standard authentication options. To add the devices to clientless users, navigate to `Configure > Authentication > Clientless users > Add or Add range` In Active directory environment AD SSO can be configured to allow unauthenticated web access. Navigate to `Configure > Authentication > Web Authentication > Authorize unauthenticated users for web access > Kerberos & NTLM` and `show captive portal link` is checked. In Window only environment clientless SSO can be configured to authenticate with XG based on security logon events at the Domain Controllers. Navigate to `Configure > Authentication > STAS > Enable Sophos Transparent Authentication Suite > Add new collector` and `Restrict client traffic during identity probe > Yes`. Refer to the reference section for more information with the configuration. Default Value: Not configured. References: 1. 1. \u201cHow to integrate Sophos firewall with active directory\u201d - https://community.sophos.com/kb/en-us/123155 2. 2. \u201cClientless SSO in a single AD Domain Controller Environment?\u201d - https://community.sophos.com/kb/en-us/123156 3. 3. \u201cHow to deploy STAS v2.5\u201d \u2013 https://community.sophos.com/kb/en-us/133531 4. 4. \u201cHow to configure clientless users\u201d \u2013 http://docs.sophos.com/nsg/sophos- firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/concepts/ClientlessUserManage.html",
    "function_names": [
      "firewall_rule_user_identification_required",
      "firewall_rule_ip_to_username_mapping_enabled",
      "firewall_rule_user_based_authorization_enabled",
      "firewall_rule_username_logging_enabled",
      "firewall_rule_domain_controller_integration_enabled",
      "firewall_rule_captive_portal_integration_enabled",
      "firewall_rule_kerberos_authentication_enabled",
      "firewall_rule_ntlm_authentication_enabled",
      "firewall_rule_security_heartbeat_synchronized"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. 1. \u201cHow to integrate Sophos firewall with active directory\u201d - https://community.sophos.com/kb/en-us/123155 2. 2. \u201cClientless SSO in a single AD Domain Controller Environment?\u201d - https://community.sophos.com/kb/en-us/123156 3. 3. \u201cHow to deploy STAS v2.5\u201d \u2013 https://community.sophos.com/kb/en-us/133531 4. 4. \u201cHow to configure clientless users\u201d \u2013 http://docs.sophos.com/nsg/sophos- firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/concepts/ClientlessUserManage.html"
  },
  {
    "id": "2.2",
    "title": "Ensure Encrypted connection is used in connecting external Active Directory and LDAP",
    "assessment": "Manual",
    "description": "Microsoft has made secure connections mandatory for recent server versions. The security of the communication can be significantly improved for LDAP simple binds that are performed over SSL/TLS connections.",
    "rationale": "Unsigned network traffic is susceptible to replay attacks in which an intruder intercepts the authentication attempt and the issuance of a ticket. The intruder can reuse the ticket to impersonate the legitimate user. Additionally, unsigned network traffic is susceptible to man-in-the-middle (MiTM) attacks in which an intruder captures packets between the client and the server, changes the packets, and then forward them to the server.",
    "audit": "Navigate to `Configure > Authentication > Servers > Edit` and verify that `Connection security` is selected with either `SSL/TLS` or `STARTTLS` is used and `Validate server certificate` is checked.",
    "remediation": "Navigate to `Configure > Authentication > Servers > Edit or Add` and set `Connection security` with either `SSL/TLS` or `STARTTLS` and `Validate server certificate` is checked. Default Value: Not configured. References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/AuthenticationActiveDirectoryServer.h tml    32 | P a g e",
    "function_names": [
      "active_directory_external_connection_encryption_enabled",
      "ldap_external_connection_encryption_enabled",
      "active_directory_ldap_ssl_tls_enabled",
      "active_directory_ldap_secure_bind_required",
      "ldap_connection_min_tls_1_2",
      "active_directory_external_connection_tls_enabled",
      "ldap_external_connection_secure_channel_required"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/AuthenticationActiveDirectoryServer.h tml    32 | P a g e"
  },
  {
    "id": "3.1",
    "title": "Ensure \"Fully Synchronized\" High Availability peer is configured",
    "assessment": "Manual",
    "description": "High Availability (HA) is a clustering technology that is used to maintain uninterrupted service in the event of power, hardware, or software failure. Sophos Firewall devices can be configured in Active-Active or Active-Passive HA modes. The Devices (The Primary and Auxiliary Device) are physically connected over a dedicated HA link port.",
    "rationale": "To ensure availability of both the firewall and the resources it protects, a High Availability peer is required. In the event a single firewall fails, or when maintenance such as a firmware update is required, the HA peer can be used to automatically fail over session states and maintain overall availability of the network. Impact: Not configuring High Availability (HA) correctly directly impacts the availability of the system. With HA in place, standard maintenance such as OS updates, network and power cabling changes can be accomplished with no outage or a minimum impact.",
    "audit": "Navigate to `System Services > High Availability > High Availability Status`. Verify that `HA status` is either `Established[Active-Passive]` or `Established[Active-Active]` and confirm `Local` and `Peer` devices are not showing `Standalone` or `Faulty`. Navigate to `High Availability Configuration > Select ports to be monitored`. Verify that correct interfaces are monitored. `Keepalive request interval` and `Keepalive attempts` should be set to optimal setting or remain default value of `250` milliseconds and `16` attempts respectively.",
    "remediation": "Navigate to `System Services > High Availability > High Availability Status`. When `Local` and `Peer` devices are shown as `Standalone` or `Faulty`, connection to the auxiliary device could be lost or becomes a faulty node,  35 | P a g e re-configure HA and sync auxiliary device to a working state. Navigate to `High Availability Configuration > Select ports to be monitored`. Set the correct interfaces to be monitored. Configure default value of `Keepalive request interval` to `250` milliseconds and `Keepalive attempts` to `16` attempts or set to optimal setting respectively. Default Value: Not configured References: 1. https://www.sophos.com/en- us/medialibrary/PDFs/documentation/SophosFirewall/Pocket-Guides/Active- Active-HA-Configuration.pdf 2. https://support.sophos.com/support/s/article/KB-000035744?language=en_US",
    "function_names": [
      "firewall_ha_peer_fully_synchronized",
      "firewall_ha_peer_active_active_enabled",
      "firewall_ha_peer_active_passive_enabled",
      "firewall_ha_link_dedicated_port_configured",
      "firewall_ha_peer_connection_verified",
      "firewall_ha_peer_failure_recovery_enabled",
      "firewall_ha_peer_primary_auxiliary_configured"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Not configuring High Availability (HA) correctly directly impacts the availability of the system. With HA in place, standard maintenance such as OS updates, network and power cabling changes can be accomplished with no outage or a minimum impact.",
    "references": "1. https://www.sophos.com/en- us/medialibrary/PDFs/documentation/SophosFirewall/Pocket-Guides/Active- Active-HA-Configuration.pdf 2. https://support.sophos.com/support/s/article/KB-000035744?language=en_US"
  },
  {
    "id": "3.2",
    "title": "Ensure 'Pattern updates' is set to download and install updates every 15 minutes",
    "assessment": "Manual",
    "description": "Set Pattern download/installation to \u2018auto update\u2019 and interval of \u2018every 15 minutes\u2019",
    "rationale": "New protection patterns may be released at any time. With frequent update schedule, the firewall can ensure threats with new definitions are quickly mitigated. A daily update schedule could leave an organization vulnerable to a known virus for nearly 24 hours, in a worst-case scenario. Setting an appropriate threshold value reduces the risk of a bad definition file negatively affecting traffic. Impact: Advanced Threat Protection (ATP) patterns, AV signatures, GeoIP database, IPS and application signatures to block immediate, active threats to the environment. With a 15 minutes update schedule, the firewall can ensure threats with new definitions are quickly mitigated.",
    "audit": "Navigate to `System > Backup & Firmware > Pattern Updates`. Verify that `Pattern download/installation > Auto update` is set to `ON`. Verify that `Interval` is set to `Every 15 minutes`. Verify that `Pattern` `Last successful update` is showing `Success`",
    "remediation": "Navigate to `System > Backup & Firmware > Pattern Updates`. Set `Pattern download/installation > Auto update` to `ON`. Set the download `Interval` to `Every 15 minutes`. When the `Pattern` `Last successful update` is not showing `Success`, click `Update pattern now` to download the updates manually.  37 | P a g e Default Value: Not configured References: 1. http://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/PatternManage.html",
    "function_names": [
      "cloud_cdn_pattern_updates_auto_enabled",
      "cloud_cdn_pattern_updates_interval_15m",
      "cloud_cdn_pattern_updates_auto_interval_15m",
      "cloud_cdn_pattern_updates_frequency_15m",
      "cloud_cdn_pattern_updates_schedule_15m"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "Advanced Threat Protection (ATP) patterns, AV signatures, GeoIP database, IPS and application signatures to block immediate, active threats to the environment. With a 15 minutes update schedule, the firewall can ensure threats with new definitions are quickly mitigated.",
    "references": "1. http://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/PatternManage.html"
  },
  {
    "id": "3.3",
    "title": "Ensure \u2018Hotfix\u2019 is set to \u2018Allow Automatic Installation of hotfixes\u2019",
    "assessment": "Manual",
    "description": "Set hotfixes to be applied automatically whenever there is an out-of-band security update is available for the device.",
    "rationale": "Security updates of the XG device can be released at any time. To ensure XG and the rest of the network remain protected from known vulnerability hotfixes should be allowed and device can be applied automatically.",
    "audit": "Navigate to `System > Backup & Firmware > Firmware > Hotfix`. Verify that `Hotfix > Allow automatic installation of hotfixes` is checked.",
    "remediation": "Navigate to `System > Backup & Firmware > Firmware > Hotfix`. Tick the checkbox `Allow automatic installation of hotfixes`. Default Value: This setting is enabled by default. References: 1. http://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/AvailableFirmware.html     39 | P a g e",
    "function_names": [
      "compute_vm_hotfix_auto_install_enabled",
      "compute_instance_hotfix_auto_install_enabled",
      "compute_device_hotfix_auto_install_enabled",
      "compute_system_hotfix_auto_install_enabled",
      "compute_os_hotfix_auto_install_enabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/AvailableFirmware.html     39 | P a g e"
  },
  {
    "id": "3.4",
    "title": "Ensure XG takes encrypted backup of the configuration and send to designated email address with scheduled frequency",
    "assessment": "Manual",
    "description": "Set XG to send encrypted backup of the configuration to administrators\u2019 email address or store at the backup FTP server.",
    "rationale": "Hardware or software failure can happen any time. In the event network needs to be restored immediately, ensure the backup snapshot of the configuration is taken at regular interval and store in secure encrypted format at the redundant location to restore at the new device.",
    "audit": "Navigate to `System > Backup & Firmware > Backup & Restore > Backup`. Backup mode is set to either `FTP` or `Email`. When `Backup mode` is set to `FTP`, verify that `FTP server IP`, `Username` or `FTP password` is set. When `Backup mode` is set to `Email` verify that `Email Address` is set to the administrators' email address. Verify that `Frequency` is set to `Daily, Weekly or Monthly`. Verify that `Encryption password` is set and ensure that encrypted backup can be sent successfully.",
    "remediation": "Navigate to `System > Backup & Firmware > Backup & Restore > Backup`. Backup mode is set to either `FTP` or `Email`. When `Backup mode` is set to `FTP`, configure `FTP server IP`, `Username` or `FTP password`. When `Backup mode` is set to `Email`, configure `Email Address` to the administrators' email address. `Frequency` is set to `Daily, Weekly or Monthly`. Set strong `Encryption password` and ensure that encrypted backup can be sent  41 | P a g e successfully. Store the `Encryption password` in secure location for future recovery. Default Value: Not enabled. References: 1. http://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/concepts/BackupRestore.html",
    "function_names": [
      "xg_configuration_backup_encrypted",
      "xg_configuration_backup_email_delivery",
      "xg_configuration_backup_scheduled",
      "xg_configuration_backup_ftp_storage",
      "xg_configuration_backup_encrypted_email",
      "xg_configuration_backup_encrypted_ftp",
      "xg_configuration_backup_frequency_scheduled",
      "xg_configuration_backup_designated_email",
      "xg_configuration_backup_secure_transfer",
      "xg_configuration_backup_encrypted_storage"
    ],
    "profile_applicability": "\u2022  Level 1",
    "references": "1. http://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/concepts/BackupRestore.html"
  },
  {
    "id": "3.5",
    "title": "Ensure No Expired Subscription Licenses",
    "assessment": "Manual",
    "description": "Licensing is used to enable various features on XG Firewall regardless whether the license is for hardware or software/virtual firewall.",
    "rationale": "Active subscription will ensure the device is getting up-to-date signatures for both known and unknown threats and remain functional for services requires cloud lookup. Impact: Expired subscription will lapse security updates which will impact the security effectiveness of the feature/functionality.",
    "audit": "Navigate to `System > Administration > Licensing`. Verify under `Module subscription details` under `Status` to ensure there is no expired licenses for all the subscriptions.",
    "remediation": "Navigate to `System > Administration > Licensing`. Under `Module subscription details` and click `Synchronize` to connect to the licensing server to get latest subscription details. Or contact Sophos immediately to renew the expired licenses. References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/Licensing.html 2. https://support.sophos.com/support/s/article/KB-000038005?language=en_US     43 | P a g e",
    "function_names": [
      "licensing_subscription_active",
      "licensing_subscription_not_expired",
      "firewall_license_valid",
      "firewall_subscription_active",
      "subscription_license_current",
      "firewall_license_not_expired",
      "licensing_subscription_valid",
      "firewall_feature_license_active"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "Expired subscription will lapse security updates which will impact the security effectiveness of the feature/functionality.",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/Licensing.html 2. https://support.sophos.com/support/s/article/KB-000038005?language=en_US     43 | P a g e"
  },
  {
    "id": "3.6",
    "title": "Ensure Site-to-Site IPSec VPN is not configured with \"Aggressive Mode\"",
    "assessment": "Manual",
    "description": "IKEv1 Aggressive Mode does not provide Peer Identity Protection. They are vulnerable to offline dictionary or brute force attack.",
    "rationale": "As stated in CVE-2002-1623, the design of the Internet Key Exchange (IKE) protocol, when using Aggressive Mode for shared secret authentication, does not encrypt initiator or responder identities during negotiation, which may allow remote attackers to determine valid usernames by monitoring responses before the password is supplied or sniffing. Impact: The use of IKEv1 with Aggressive Mode has considerable confidentiality impact.",
    "audit": "Navigate to `Configure > VPN > IPsec policies`. Verify that active `IPsec Policy` in used is not configured with `Key exchange` `IKEv1` and `Authentication mode` `Aggressive mode`.",
    "remediation": "Navigate to `Configure > VPN > IPsec policies`. Remove any active `IPsec Policy` configured with `Key exchange` `IKEv1` and `Authentication mode` `Aggressive mode` and replace with `IKEv2` or `Main mode`. Default Value: Not configured. References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/tasks/IPsecPolicyAdd.html   45 | P a g e",
    "function_names": [
      "vpn_connection_aggressive_mode_disabled",
      "vpn_connection_ikev1_secure_mode_enabled",
      "vpn_connection_peer_identity_protected",
      "vpn_connection_brute_force_protection_enabled",
      "vpn_connection_ikev1_aggressive_mode_denied"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "The use of IKEv1 with Aggressive Mode has considerable confidentiality impact.",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/tasks/IPsecPolicyAdd.html   45 | P a g e"
  },
  {
    "id": "3.7",
    "title": "Ensure Logging is enabled on firewall rules and configured to send logs to the external syslog server",
    "assessment": "Manual",
    "description": "XG Firewall provides extensive logging capabilities for traffic, system, and network protection functions. You can use logs to analyze network activity to help identify security issues and reduce network abuse. You can store logs locally, send them to Sophos Central, or send them to third-party syslog servers. You can select logs to store or send by module or feature, or you can select all logs.",
    "rationale": "Firewall Firewall logs provide information about traffic associated with the firewall configuration, such as firewall rules, MAC filtering, and DoS attacks. IPS IPS logs provide records of detected and dropped attacks based on unknown or suspicious patterns (anomalies) and signatures. Antivirus Antivirus logs provide details of viruses detected in HTTP, SMTP, FTP, POP3, IMAP4, HTTPS, SMTPS, IMAPS, and POPS traffic. Anti-spam Anti-spam logs provide details about SMTP, POP3, IMAP4, SMTPS, POPS, IMAPS spam, and probable spam mails. Content filtering Content filtering logs provide details about web and application filtering events, such as those associated with web policies.  47 | P a g e Events Event logs provide information about configuration activities, authentication activities, and system activities. Web server protection Web server protection logs provide details of web server protection activities, for example, protection policies. Advanced threat protection Advanced threat protection logs provide information about ATP events such as drops or alerts. Wireless Wireless logs provide details about access point activity and SSIDs. Heartbeat Heartbeat logs provide information about the health status of the endpoints. System health System health logs provide details of CPU usage, memory usage, number of live users, interfaces, and disk partitions. Sandstorm Sandstorm logs provide records of all Sandstorm events.",
    "audit": "Navigate to `Protect > Rules and policies`. Verify the configured the Firewall rules and ensure `Log firewall traffic` is checked. Navigate to `Configure > System services > Log settings`. Verify that external syslog server is configured and sending system, security events to external syslog server.",
    "remediation": "Navigate to `Protect > Rules and policies`. Set `Log firewall traffic` is checked for configured firewall rules.  48 | P a g e Navigate to `Configure > System services > Log settings`. Configure external syslog server and set to send system, security events to external syslog server. Default Value: Not configured. References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/ServicesLogSettings.html",
    "function_names": [
      "firewall_rule_logging_enabled",
      "firewall_rule_external_syslog_enabled",
      "firewall_rule_logging_all_modules_enabled",
      "firewall_rule_logging_third_party_syslog_enabled",
      "firewall_rule_logging_sophos_central_enabled",
      "firewall_rule_logging_local_storage_enabled",
      "firewall_rule_logging_traffic_enabled",
      "firewall_rule_logging_system_enabled",
      "firewall_rule_logging_network_protection_enabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/ServicesLogSettings.html"
  },
  {
    "id": "4.1",
    "title": "Ensure 'Enable advanced threat protection' is set to \u2018ON\u2019 and Policy is set to \u2018Log and drop\u2019",
    "assessment": "Manual",
    "description": "Advanced threat protection analyzes incoming and outgoing network traffic (for example, DNS requests, HTTP requests, and IP packets) for threats.",
    "rationale": "Using ATP, you can quickly detect compromised clients in your network and raise an alert or drop the traffic from those clients.",
    "audit": "Navigate to `Advanced threat > Advanced threat protection > Enable advanced threat protection`. Verify that `Enable advanced threat protection` is set to `ON`. Verify that Policy is set to `Log and drop`. Verify that wide range of network/host IP addresses are not added to `Network/Host Exceptions`. Verify that wide range of destination URL/IP addresses are not added to `Threat Exceptions` that may expose network to the security risks.",
    "remediation": "Navigate to `Advanced threat > Advanced threat protection > Enable advanced threat protection`. Verify that `Enable advanced threat protection` is set to `ON`. Set the policy to `Log and drop`. Remove unnecessary exemption from network and threat exceptions.   51 | P a g e Default Value: Not enabled. References: 1. Sandstorm is a cloud-based malware detonation, analysis and blocking service for SOPHOS XG firewalls. It is based on exploit prevention technologies from Endpoint InterceptX combined with deep learning neural network to detect unknown malware delivered through the network. Post-analysis threat intelligence report generated from Sandstorm highlight attack vector and breakdown of threat intelligence obtained through file analysis. Advanced threat protection detects and blocks outbound command and control activity by observing traffic in real-time. This Advanced Threat section covers requirements related to Sandstorm settings and Advanced threat protection configuration.",
    "function_names": [
      "network_security_group_advanced_threat_protection_enabled",
      "network_security_group_policy_log_and_drop_enabled",
      "network_security_group_threat_protection_logging_enabled",
      "network_security_group_traffic_analysis_enabled",
      "network_security_group_dns_requests_monitored",
      "network_security_group_http_requests_monitored",
      "network_security_group_ip_packets_monitored",
      "network_security_group_threat_protection_active",
      "network_security_group_security_policy_enforced",
      "network_security_group_traffic_logging_enabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. Sandstorm is a cloud-based malware detonation, analysis and blocking service for SOPHOS XG firewalls. It is based on exploit prevention technologies from Endpoint InterceptX combined with deep learning neural network to detect unknown malware delivered through the network. Post-analysis threat intelligence report generated from Sandstorm highlight attack vector and breakdown of threat intelligence obtained through file analysis. Advanced threat protection detects and blocks outbound command and control activity by observing traffic in real-time. This Advanced Threat section covers requirements related to Sandstorm settings and Advanced threat protection configuration."
  },
  {
    "id": "4.2",
    "title": "Ensure Sandstorm is enabled at the firewall rule for web protection and does not exclude any file type from Sandstorm analysis",
    "assessment": "Manual",
    "description": "By enabling \u2018Detect zero-day threats with Sandstorm\u2019 at the firewall rule increases the possibility of identifying unknown viruses. And ensure administrator does not exclude file types from Sandstorm analysis.",
    "rationale": "When a user downloads a file from the internet via HTTP/S, FTP protocol and the file contains active content or unknown reputation that cannot be easily detected by signature- based AV engine, it will be uploaded to SOPHOS cloud sandboxing service for additional analysis. Accidental exclusion of file type at Sandbox configuration will reduce the security effectiveness. Impact: With Detect zero-day threats with Sandstorm is unchecked, users may unknowingly download files that have not been seen by AV engines or weaponized office documents. Exclude file types in the Sandstorm settings could also bypass broad range of true filetype from uploading to the cloud for additional analysis.",
    "audit": "For firewall rules that allowed outbound traffic to the internet should be enabled with \u2018detect zero-day threats with Sandstorm\u2019. Navigate to `Protect > Rules and policies > Firewall rules` existing firewall rule with allowed outbound traffic and verify `Security features > Web filtering > Malware and content scanning > Scan HTTP and decrypted HTTPS`, `Detect zero-day threats with Sandstorm` and `Scan FTP for malware` is checked. Navigate to `Protect > Advanced threat > Sandstorm settings` and verify `Exclude file types` to ensure there are no file type is exempted from Sandbox analysis.   53 | P a g e",
    "remediation": "Navigate to `Protect > Rules and policies > Firewall rules` existing firewall rule with allowed outbound traffic and configure `Security features > Web filtering > Malware and content scanning > Scan HTTP and decrypted HTTPS`, `Detect zero-day threats with Sandstorm` and `Scan FTP for malware` is checked. Navigate to `Protect > Advanced threat > Sandstorm settings` and remove file type exceptions from `Exclude file types`. References: 1. https://support.sophos.com/support/s/article/KB-000036574?language=en_US 2. https://support.sophos.com/support/s/article/KB-000036080?language=en_US 3. https://support.sophos.com/support/s/article/KB-000036564?language=en_US",
    "function_names": [
      "firewall_rule_sandstorm_enabled",
      "firewall_rule_sandstorm_file_type_exclusion_disabled",
      "firewall_rule_sandstorm_zero_day_threat_detection_enabled",
      "firewall_rule_sandstorm_analysis_all_file_types_included"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "With Detect zero-day threats with Sandstorm is unchecked, users may unknowingly download files that have not been seen by AV engines or weaponized office documents. Exclude file types in the Sandstorm settings could also bypass broad range of true filetype from uploading to the cloud for additional analysis.",
    "references": "1. https://support.sophos.com/support/s/article/KB-000036574?language=en_US 2. https://support.sophos.com/support/s/article/KB-000036080?language=en_US 3. https://support.sophos.com/support/s/article/KB-000036564?language=en_US"
  },
  {
    "id": "4.3",
    "title": "Ensure Sandstorm is enabled for Email Protection and set to MTA mode",
    "assessment": "Manual",
    "description": "By enabling \u2018Detect zero-day threats with Sandstorm\u2019 at the SMTP policy increases the possibility of identifying unknown viruses delivered through email gateway.",
    "rationale": "Targeted attacks with Email attachments that contain zero-day viruses and weaponized office documents could be thwarted at the Email gateway by scanning at the SMTP proxy before routed to the internal email server. Accidental exclusion of file type at Sandbox configuration will reduce the security effectiveness. Impact: Zero-day viruses and Advanced Persistent Threats (APT) can be delivered via weaponized office documents as a form of attachment to the business email. By setting appropriate malware protection setting to scan for viruses and detect zero-day threats with Sandstorm before delivering the emails to the MTA.",
    "audit": "This configuration option is only applicable when the device is configured with `MTA mode` and set `Sophos` as primary malware scanning engine. Navigate to `Protect > Email`. Verify the existing SMTP policy `Malware protection > Selected antivirus action` to `Drop`. Email attachment successfully verified by antivirus engine as malicious should be set to `Drop`. `Quarantine unscannable content` is checked to prevent files with multiple layers of compression and password protected archives files that cannot be scanned by antivirus engine should be `quarantined`. Verify that `Detect zero-day threats with Sandstorm` should be checked and set the scanned file size to 10 MB.   55 | P a g e",
    "remediation": "This configuration option is only applicable when the device is configured with `MTA mode` and set `Sophos` as primary malware scanning engine. Navigate to `Protect > Email`. Verify the existing SMTP policy and set `Malware protection > Selected antivirus action` to `Drop`. Email attachment successfully verified by antivirus engine as malicious should be set to `Drop`. `Quarantine unscannable content` is checked to prevent files with multiple layers of compression and password protected archives files that cannot be scanned by antivirus engine should be `quarantined`. Set `Detect zero-day threats with Sandstorm` is checked and set the scanned file size to 10 MB. Default Value: Not configured. References: 1. https://support.sophos.com/support/s/article/KB-000036574?language=en_US 2. https://support.sophos.com/support/s/article/KB-000036080?language=en_US 3. https://support.sophos.com/support/s/article/KB-000036564?language=en_US",
    "function_names": [
      "email_smtp_sandstorm_enabled",
      "email_smtp_sandstorm_mta_mode_enabled",
      "email_protection_sandstorm_enabled",
      "email_protection_sandstorm_mta_mode_enabled",
      "email_gateway_sandstorm_enabled",
      "email_gateway_sandstorm_mta_mode_enabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Zero-day viruses and Advanced Persistent Threats (APT) can be delivered via weaponized office documents as a form of attachment to the business email. By setting appropriate malware protection setting to scan for viruses and detect zero-day threats with Sandstorm before delivering the emails to the MTA.",
    "references": "1. https://support.sophos.com/support/s/article/KB-000036574?language=en_US 2. https://support.sophos.com/support/s/article/KB-000036080?language=en_US 3. https://support.sophos.com/support/s/article/KB-000036564?language=en_US"
  },
  {
    "id": "4.4",
    "title": "Ensure Synchronised Security Heartbeat is enforced on Firewall Rules",
    "assessment": "Manual",
    "description": "Security Heartbeat enables XG Firewall and endpoints managed by Sophos Endpoint Protection to communicate through Sophos Central and exchange information on the endpoints\u2019 security status, the so-called health status. XG Firewall administrators as well as Sophos Central administrators are able to define policies for network access based on the endpoints\u2019 health status. Endpoints with security incidents can be immediately isolated thus preventing threats to spread across the network.",
    "rationale": "Sophos Endpoint Protection ensures that the endpoint belongs to the organization and has permission to access the network. These endpoints send at regular intervals updates about their health status to XG Firewall which in turn applies the defined policies based on that information. Impact: Missing heartbeat or endpoint with compromised state should not be allowed to connect to servers, internet and other devices within the network. Synchronized security heartbeat can identify the source of infection and isolate the device from the rest of the network.",
    "audit": "Navigate to `Protect > Central Synchronization`. Verify that `Security Heartbeat` is turned `ON`. Check that XG firewall is registered to Sophos Central, configured to receive Heartbeat from the Sophos Endpoints. Navigate to `Protect > Rules and Policies > Firewall rules`. Filter `Rule type >` `Network` and `User`, filter `source zone > LAN` and `DMZ`. Verify on the configured firewall rule `Configure Synchronized Security Heartbeat` and check that `Minimum source HB permitted` is set to `Green` or `Yellow`. If the rule is configured to allow Egress traffic with clients are connecting resources on `WAN` zone, `Minimum source HB permitted` should be configured  57 | P a g e with either `Green` or `Yellow` for tighter security control. If the rule is configured to allow traffic between `LAN` to `DMZ` zones with communication between Sophos protected Endpoints and Server, please consider additional control with setting both `Minimum source HB permitted` and `Minimum destination HB permitted` to either `Green` or `Yellow`.",
    "remediation": "Navigate to `Protect > Central Synchronization`. Register Sophos XG Firewall to Sophos Central, set `Security Heartbeat` to `ON`. Navigate to `Protect > Rules and Policies`. Filter `Rule type > Network` and `User`, filter `source zone > LAN` and `DMZ`. Navigate to configured firewall rule with `Configure Synchronized Security Heartbeat`. Set `Minimum source HB permitted` to `Green` or `Yellow`. If the rule is configured to allow Egress traffic with Sophos Endpoints are connecting resources on `WAN` zone, set `Minimum source HB permitted` to either `Green` or `Yellow` for tighter security control. If the rule is configured to allow traffic between `LAN` to `DMZ` zones with communication between Sophos protected Endpoints and Server, configure additional control with setting both `Minimum source HB permitted` and `Minimum destination HB permitted` to either `Green` or `Yellow`. Default Value: Not configured. References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/CentralSynchronization.html",
    "function_names": [
      "firewall_rule_security_heartbeat_enabled",
      "firewall_rule_health_status_sync_enabled",
      "firewall_rule_endpoint_communication_enabled",
      "firewall_rule_sophos_central_integration_enabled",
      "firewall_rule_network_access_policy_configured",
      "firewall_rule_endpoint_isolation_enabled",
      "firewall_rule_health_based_access_control_enabled",
      "firewall_rule_synchronized_security_enabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Missing heartbeat or endpoint with compromised state should not be allowed to connect to servers, internet and other devices within the network. Synchronized security heartbeat can identify the source of infection and isolate the device from the rest of the network.",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/CentralSynchronization.html"
  },
  {
    "id": "5.1",
    "title": "Ensure Web Policy is configured to block inappropriate URLs, Malware and content scanning is configured correctly.",
    "assessment": "Manual",
    "description": "Configure Web Policy to control users\u2019 web browsing activities, block inappropriate web categories and enforce malware scanning for FTP and HTTP(S) traffic.",
    "rationale": "Web protection keeps an organization safe from attacks that result from web browsing and helps you increase productivity. By blocking objectionable URL categories and potentially unwanted applications (PUAs), enforcing malware scanning for FTP, HTTP(S), the threat of malware propagation through the firewall is greatly reduced. It is recommended to mitigate malware found in FTP, HTTP(S) through outgoing traffic, you can configure to prevent users downloading certain File Types, Block web category or Warn with appropriate deterrent messages display to the users. Impact: Any misconfigured policies or unintended exceptions will allow users to access inappropriate web categories, URLs that linked to drive-by-downloads and malware.",
    "audit": "Navigate to `Protect > Web`. Verify that configured web policies have categories with `objectionable classification` is set to block. Ensure that Status is set to `ON` with the block rule is on top. Within the web policy `Advanced settings > Enable logging and reporting` is checked. Navigate to `Protect > Web > General settings > Protection > Malware and content scanning`. Verify that `Action on malware scan failure` is set to `Block(best protection)`.  60 | P a g e Verify that `Block potentially unwanted applications` is checked. Navigate to `Protect > Web > Exceptions`. Verify that configured exceptions do not have dangerous `URL patterns, web site categories and wide range of destination IP address(website address)` that will have security impact to the `source IP addresses (end-users' address)` with skipped `HTTPS decryption, HTTPS certificate validation, malware and content scanning, sandstorm and policy check`.",
    "remediation": "Navigate to `Protect > Web` Set the web policy to block categories with `objectionable classification` and change the status to `ON`. Within the web policy set the `Enable logging and reporting`. Navigate to `Protect > Web > General settings > Protection > Malware and content scanning` Action on `malware scan failure` is set to `Block(best protection)`. Enable `Block potentially unwanted applications`. Navigate to `Protect > Web > Exceptions` Remove/edit `exceptions` with `URL patterns, website categories and destination IP address (website address)` that could reduce security effectiveness to the `source IP address (end-users' address)`. Default Value: Not configured References: 1. https://support.sophos.com/support/s/article/KB-000036683?language=en_US 2. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/concepts/WebProtection.html",
    "function_names": [
      "cloud_cdn_web_policy_block_inappropriate_urls",
      "cloud_cdn_web_policy_malware_scanning_enabled",
      "cloud_cdn_web_policy_content_scanning_enabled",
      "cloud_cdn_web_policy_ftp_traffic_scanned",
      "cloud_cdn_web_policy_https_traffic_scanned",
      "cloud_cdn_web_policy_http_traffic_scanned",
      "cloud_cdn_web_policy_web_browsing_controlled",
      "cloud_cdn_web_policy_web_categories_blocked"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Any misconfigured policies or unintended exceptions will allow users to access inappropriate web categories, URLs that linked to drive-by-downloads and malware.",
    "references": "1. https://support.sophos.com/support/s/article/KB-000036683?language=en_US 2. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/concepts/WebProtection.html"
  },
  {
    "id": "5.2",
    "title": "Ensure SSL/TLS inspection rules is enabled to all relevant firewall policies",
    "assessment": "Manual",
    "description": "With SSL/TLS inspection rules, you can intercept and decrypt SSL and TLS connections over TCP, enabling XG firewall to enforce secure connections between clients and web servers. SSL/TLS inspection enables the prevention of malware transmitted through encrypted connections.",
    "rationale": "By applying SSL/TLS inspection rule to the applicable traffic, the threat of malware propagation through the encrypted communication is greatly reduced. SSL/TLS inspection profile also can limit any communication with insecure encryption protocol within the organization. Impact: Not enforcing security policy on encrypted traffic may allow malware to transit the security boundary without blocks or alerts. With proper security policy to scan and decrypt the TLS/SSL traffic, XG firewall has visibility of the communication and not only block the malware at the gateway but also preventing insecure communication to take place.",
    "audit": "Navigate to `Rules and policies > SSL/TLS inspection rules > SSL/TLS inspection settings`. Verify that `Non-decryptable traffic > SSL 2.0 and SSL 3.0` is set to `Reject` or `Drop`. Verify that `SSL compression` is set to `Reject` or `Drop`. Verify that `When SSL/TLS connections exceed limit` is set to `Drop` or `Reject`. Verify that `TLS 1.3 decryption` is set to `Decrypt as 1.3`.  63 | P a g e Verify that `Advanced settings > SSL/TLS engine` is set to `Enabled`. Verify the configured `SSL/TLS inspection rule` and check the `Action` to `Decrypt` and `Log connections` is checked. The rule position should be above rules configured with `Action` set to `Don't decrypt`. Verify the configured Firewall rules and `Scan HTTP and decrypted HTTPS` and `Detect zero-day threats with Sandstorm` is checked.",
    "remediation": "Navigate to `Rules and policies > SSL/TLS inspection rules > SSL/TLS inspection settings`. Set `Non-decryptable traffic > SSL 2.0 and SSL 3.0` to `Reject` or `Drop`. Set `SSL compression` to `Reject` or `Drop`. Set `When SSL/TLS connections exceed limit` to `Drop` or `Reject`. Set `TLS 1.3 decryption` to `Decrypt as 1.3`. Set `Advanced settings > SSL/TLS engine` to `Enabled`. Navigate to configured `SSL/TLS inspection rule` and set the `Action` to `Decrypt` and `Log connections` is checked. Set the rule position to above rules configured with `Action` set to `Don't decrypt`. Navigate to the configured Firewall rules. Set `Scan HTTP and decrypted HTTPS` and `Detect zero-day threats with Sandstorm` is checked. Default Value: No TLS/SSL inspection is enabled on any default or new firewall rule. References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/FirewallSSLTLSRules.html 2. https://docs.sophos.com/nsg/sophos-firewall/18.0/releasenotes/en- us/nsg/sfos/releasenotes/rn_SSLTLSInspectionEdit.html   64 | P a g e",
    "function_names": [
      "firewall_policy_ssl_tls_inspection_enabled",
      "firewall_policy_ssl_tls_inspection_all_rules",
      "firewall_policy_ssl_tls_inspection_all_relevant",
      "firewall_policy_ssl_tls_inspection_decryption_enabled",
      "firewall_policy_ssl_tls_inspection_malware_prevention_enabled",
      "firewall_policy_ssl_tls_inspection_secure_connections_enabled",
      "firewall_policy_ssl_tls_inspection_tcp_connections_enabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "impact": "Not enforcing security policy on encrypted traffic may allow malware to transit the security boundary without blocks or alerts. With proper security policy to scan and decrypt the TLS/SSL traffic, XG firewall has visibility of the communication and not only block the malware at the gateway but also preventing insecure communication to take place.",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/FirewallSSLTLSRules.html 2. https://docs.sophos.com/nsg/sophos-firewall/18.0/releasenotes/en- us/nsg/sfos/releasenotes/rn_SSLTLSInspectionEdit.html   64 | P a g e"
  },
  {
    "id": "5.3",
    "title": "Ensure Application filter is set to block high risk (Risk Level 4 and 5) applications",
    "assessment": "Manual",
    "description": "When there is a firewall rule to allow outgoing traffic, configure it to identify and control Layer-7 applications and drop traffic that are classified under high risk applications (Risk Level 4 and 5) with application filter.",
    "rationale": "Most organizations may require visibility of the Layer-7 applications, and control access to applications for users behind the firewall. Application filter can reduce the attack surface of risk prone applications, peer-to-peer networking (P2P), these applications can be used to distribute bots, spyware, adware, trojans, rootkits, worms, and other types of malware. It is recommended to block traffic classified as high risk applications. Create custom policies according to the requirements of an organization.",
    "audit": "Navigate to `Rules and policies > Firewall rules`. Verify that configured outgoing firewall rules with `Identify and control applications (App control)` is set to `Block high risk (Risk Level 4 and 5) apps`.",
    "remediation": "Navigate to `Rules and policies > Firewall rules`. Set the configured outgoing firewall rules with `Identify and control applications (App control)` to `Block high risk (Risk Level 4 and 5) apps`. Default Value: Not enabled. References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/ApplicationFilter.html 2. https://support.sophos.com/support/s/article/KB-000035669?language=en_US  66 | P a g e",
    "function_names": [
      "firewall_rule_application_filter_high_risk_blocked",
      "firewall_rule_application_filter_risk_level_4_5_blocked",
      "firewall_rule_outbound_traffic_high_risk_apps_blocked",
      "firewall_rule_layer7_application_filter_high_risk_blocked",
      "firewall_rule_application_filter_risk_level_4_and_5_blocked"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/ApplicationFilter.html 2. https://support.sophos.com/support/s/article/KB-000035669?language=en_US  66 | P a g e"
  },
  {
    "id": "5.4",
    "title": "Ensure Intrusion Prevention(IPS) policy is configured on active firewall rules",
    "assessment": "Manual",
    "description": "Network attacks can be prevented using IPS rules. The firewall matches signatures with traffic patterns and takes the action specified in the rule. IPS signatures identify threats and specify a recommended action to take when the firewall encounters matching traffic. Signatures are specific to applications, services, or platforms. The firewall includes predefined signatures and you can also create custom signatures.",
    "rationale": "XG firewall intercepts and blocks network based attacks targeted at both servers and clients protected behind the firewall. The set of default policies prevents network attacks for several common types of traffic. Depending on the traffic requirement, custom IPS rules can be created to take specific actions based on severity, target, platform and category.",
    "audit": "Navigate to `Rules and policies > Firewall rules`. Navigate to configured firewall rules. Verify that `Detect and prevent exploits (IPS)` is configured with appropriate IPS rule based on the direction of the traffic. Either one of these rule should be present gerenalpolicy, lantowan_strict, lantowan_general, dmzpolicy, LAN TO WAN, LAN TO DMZ, WAN TO DMZ, WAN TO LAN, DMZ TO WAN, DMZ TO LAN or \u201ccustom IPS rule\u201d. It's recommended to have IPS rule with client-side exploitation protection policy for user network with allowed outgoing. And similar policy with server side protection for any incoming firewall rules from WAN zone.",
    "remediation": "Navigate to `Rules and policies > Firewall rules`. Navigate to configured firewall rules. Set `Detect and prevent exploits (IPS)` with appropriate IPS rule based on the direction of the traffic. Configure IPS policy with gerenalpolicy, lantowan_strict, lantowan_general, dmzpolicy, LAN TO WAN, LAN TO DMZ, WAN TO DMZ, WAN TO LAN, DMZ TO WAN, DMZ TO LAN or \u201ccustom IPS rule\u201d.  68 | P a g e Set IPS rule with client-side exploitation protection policy for user network with outgoing allowed. And similar policy with server side protection for any incoming firewall rules from WAN zone. Default Value: Not configured. References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/concepts/IPSPolicies.html",
    "function_names": [
      "firewall_rule_ips_policy_enabled",
      "firewall_rule_ips_signature_configured",
      "firewall_rule_active_ips_protection",
      "firewall_rule_threat_prevention_enabled",
      "firewall_rule_signature_action_configured",
      "firewall_rule_custom_ips_signature_enabled",
      "firewall_rule_predefined_ips_signature_enabled",
      "firewall_rule_traffic_inspection_enabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/concepts/IPSPolicies.html"
  },
  {
    "id": "5.5",
    "title": "Ensure Web Application Firewall (WAF) is configured with appropriate protection policies in all the WAF rules in use",
    "assessment": "Manual",
    "description": "XG firewall protects web servers against Layer 7 (application) vulnerability exploits. These attacks include cookie, URL, and form manipulation. It can also mitigate common threats such as application and cross-site scripting (XSS) attacks. XG firewall provides default policies for some common web services.",
    "rationale": "XG firewall\u2019s Web Application Firewall (WAF) feature protects web servers deployed in a network and related applications from any underlying vulnerability exploits. It protects applications accessed via HTTP and HTTPS at the layer-7 Application Layer. Besides Layer 7 based attacks, the web server is safeguarded against cookie tampering, forceful browsing, and hidden field tampering. The WAF also mitigates user-induced vulnerabilities in applications that leave web applications open to attacks, such as cross-site scripting, directory traversal, and forced URL browsing.",
    "audit": "Navigate to `Protect > Web server > General settings > SlowHTTP protection settings`. Verify that `Time-out for request headers` is `ON`. Verify the minimum amount of time to receive a request `Soft limit` is set to optimal configuration. Default setting is `10`. Verify the maximum amount of time to receive the request header `Hard limit` is set to optimal configuration. Default setting is `30`. Verify the amount of data, in bytes, to extend the time-out set by the soft limit. Every time the rate is exceeded, the soft limit is increased by one second. The default extension rate is `5000`. Verify that `TLS version settings > TLS version` is set to TLS 1.2. Select the minimum TLS version that is allowed to connect to the WAF. Note that if TLS version 1.2 is selected, clients like Microsoft Internet Explorer 8 or  70 | P a g e earlier and those running on Window XP won\u2019t be able to connect to the WAF. Navigate to the configure WAF rules `Rules and policies > Firewall rules`, filter `Rule type > WAF`. Verify under `Advanced > Protection > edit protection policy` to check `Mode` is set to `Reject`. Verify that `Cookie signing` is set to `ON`. Verify that `Static URL hardening` is set to `ON` with specify the URLs you want to serve. Note that this feature isn\u2019t effective for dynamic URLs created by the client, for example, using JavaScript. Verify that `Form hardening` is set to `ON`. Verify that `Antivirus` is set to `ON` with `Mode` set to either `Sophos` or `Dual scan`. And Direction of the scanning is set to `Uploads and Downloads`. Verify that `Block unscannable content` is set to `ON`. Verify that `Block clients with bad reputation` is set to `ON`. Verify that `Common threat filter` is set to `ON`. And confirm that these rule IDs (901100,901110,949100,949190,949110,959100,980100,980110,980120,980130,980140 ) are not added to the Skip filter rules. Verify that `Application attacks` is checked. Verify that `SQL injection attacks` is checked. Verify that `XSS attacks` is checked. Verify that `Protocol enforcement` is checked. Verify that `Scanner detection` is checked. Verify that `Data leakage` is checked. Within the configured firewall rule with WAF verify that Intrusion prevention is set to either `WAN TO LAN` or `WAN TO DMZ` or custom IPS rule with target server platform.",
    "remediation": "Navigate to `Protect > Web server > General settings > SlowHTTP protection settings`. Set `Time-out for request headers` to `ON`. Set the minimum amount of time to receive a request `Soft limit` to optimal configuration. Default setting is `10`.  71 | P a g e Set the maximum amount of time to receive the request header `Hard limit` to optimal configuration. Default setting is `30`. Set the amount of data, in bytes, to extend the time-out set by the soft limit. Every time the rate is exceeded, the soft limit is increased by one second. The default extension rate is `5000`. Set `TLS version settings > TLS version` to TLS 1.2. Select the minimum TLS version that is allowed to connect to the WAF. Note that if TLS version 1.2 is selected, clients like Microsoft Internet Explorer 8 or earlier and those running on Window XP won\u2019t be able to connect to the WAF. Navigate to the configure WAF rules `Rules and policies > Firewall rules`, filter `Rule type > WAF`. Under `Advanced > Protection > edit protection policy` set  `Mode` to `Reject`. Set `Cookie signing` to `ON`. Set `Static URL hardening` to `ON` with specify the URLs you want to serve. Note that this feature isn\u2019t effective for dynamic URLs created by the client, for example, using JavaScript. Set `Form hardening` to `ON`. Set `Antivirus` to `ON` with scanning `Mode` to either `Sophos` or `Dual scan`. And Direction of the scanning is set to `Uploads and Downloads`. Set `Block unscannable content` to `ON`. Set `Block clients with bad reputation` to `ON`. Set `Common threat filter` to `ON`. Remove these rule IDs (901100,901110,949100,949190,949110,959100,980100,980110,980120,980130,980140 ) added to the Skip filter rules. Set `Application attacks` to enable. Set `SQL injection attacks` to enable. Set `XSS attacks` to enable. Set `Protocol enforcement` to enable. Set `Scanner detection` to enable. Set `Data leakage` to enable. Within the configured firewall rule with WAF verify that Intrusion prevention is set to either `WAN TO LAN` or `WAN TO DMZ` or custom IPS rule with target server platform.   72 | P a g e Default Value: Not configured. References: 1. https://support.sophos.com/support/s/article/KB-000036712?language=en_US 2. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/tasks/WAFProtectionPolicyAdd.html 3. https://support.sophos.com/support/s/article/KB-000036242?language=en_US 4. https://support.sophos.com/support/s/article/KB-000035562?language=en_US 5. https://support.sophos.com/support/s/article/KB-000035559?language=en_US 6. https://support.sophos.com/support/s/article/KB-000036412?language=en_US 7. https://support.sophos.com/support/s/article/KB-000035560?language=en_US",
    "function_names": [
      "waf_rule_protection_policy_enabled",
      "waf_rule_default_policy_attached",
      "waf_rule_xss_protection_enabled",
      "waf_rule_layer7_exploit_protection_enabled",
      "waf_rule_common_web_service_policy_attached",
      "waf_rule_cookie_manipulation_protection_enabled",
      "waf_rule_url_manipulation_protection_enabled",
      "waf_rule_form_manipulation_protection_enabled",
      "waf_rule_all_policies_active",
      "waf_rule_appropriate_protection_enabled"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://support.sophos.com/support/s/article/KB-000036712?language=en_US 2. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/tasks/WAFProtectionPolicyAdd.html 3. https://support.sophos.com/support/s/article/KB-000036242?language=en_US 4. https://support.sophos.com/support/s/article/KB-000035562?language=en_US 5. https://support.sophos.com/support/s/article/KB-000035559?language=en_US 6. https://support.sophos.com/support/s/article/KB-000036412?language=en_US 7. https://support.sophos.com/support/s/article/KB-000035560?language=en_US"
  },
  {
    "id": "5.6",
    "title": "Ensure Email protection is configured with appropriate protection policies",
    "assessment": "Manual",
    "description": "Create one or more Email protection policy to handle email routing and protect domains and mail servers. You can configure SMTP/S, POP/S, and IMAP/S policies with SPAM and malware checks, data protection, and Email encryption.",
    "rationale": "By scanning both inbound and outbound Email traffic, the threat of malware delivered through Emails and data exfiltration can be prevented at the gateway firewall. Per domain policy allows unrestricted configuration based on security needs. Appropriate Email protection policy enforces TLS, SMTP DoS and other security settings for incoming and outgoing emails.",
    "audit": "Navigate to `Protect > Email > General settings`. Verify that appropriate `SMTP deployment mode` is used. Note that `legacy mode` is not compatible with Sandstorm for Email. Navigate to `SMTP settings`. Verify that `Reject based on IP reputation`. XG Firewall checks the sender's IP reputation before the spam checks specified in the SMTP policy. Verify that `SMTP DoS settings` is Enable. XG Firewall protects the network from SMTP denial-of-service attacks. Navigate to `SMTP TLS configuration`. Verify that `Disable legacy TLS protocols` is Enable. To overcome TLS vulnerabilities, it is recommended to turn off legacy TLS protocols. Navigate to `POP and IMAP TLS configuration`. Verify that `Disable legacy TLS protocols` is Enable. Navigate to `Malware protection`. Verify that `Primary antivirus engine` is  74 | P a g e set to `Sophos`. If `Avira` is selected XG Firewall will turn off Sandstorm in SMTP policies with single antivirus scan. Navigate to `DKIM verification`. Verify that DKIM verification is `ON` and `DKIM verification failed`, `Invalide DKIM signature`, `No DKIM signature found` should be set to `Quarantine` or `Reject`. With DKIM XG validates the source domain name and message integrity through cryptographic authentication, preventing email spoofing. DKIM verification is applied to inbound emails. Note that XG Firewall quarantines DKIM-signed emails that use RSA SHA-1 or have key length less than 1024 or more than 2048 bits. Navigate to `Protect > Email > Relay settings > Host based relay`. Verify that `ANY` is not added to the `allow relay from hosts/networks`. Adding `ANY` will result in an open relay, allowing anyone on the internet to send emails through XG Firewall. Navigate to `Protect > Email > Policy & exceptions`. Verify the configured SMTP policy `Malware protection > Selected antivirus action` is set to `Drop` and `Quarantine unscannable content` is checked and `Detect zero-day threats with Sandstorm Scanned file size` is set to 10 MB.",
    "remediation": "Navigate to `Protect > Email > General settings`. Set the appropriate `SMTP deployment mode` to `MTA mode` when possible. `legacy mode` is not compatible with Sandstorm for Email and reduce the security effectiveness. Navigate to `SMTP settings`. Set `Reject based on IP reputation` to Enable. XG Firewall checks the sender's IP reputation before the spam checks specified in the SMTP policy. Set `SMTP DoS settings` to Enable. XG Firewall protects the network from SMTP denial-of-service attacks. Navigate to `SMTP TLS configuration`. Set `Disable legacy TLS protocols` to Enable. To overcome TLS vulnerabilities, it is recommended to turn off legacy TLS protocols. Navigate to `POP and IMAP TLS configuration`. Set `Disable legacy TLS protocols` to Enable. Navigate to `Malware protection`. Set `Primary antivirus engine` to `Sophos`. If `Avira` is selected XG Firewall will turn off Sandstorm in SMTP policies with single antivirus scan. Navigate to `DKIM verification`. Set `DKIM verification` to `ON` and `DKIM  75 | P a g e verification failed`, `Invalide DKIM signature`, `No DKIM signature found` are set to `Quarantine` or `Reject`. With DKIM XG validates the source domain name and message integrity through cryptographic authentication, preventing email spoofing. DKIM verification is applied to inbound emails. Note that XG Firewall quarantines DKIM-signed emails that use RSA SHA-1 or have key length less than 1024 or more than 2048 bits. Navigate to `Protect > Email > Relay settings > Host based relay`. Remove `ANY` from the `allow relay from hosts/networks`. Adding `ANY` will result in an open relay, allowing anyone on the internet to send emails through XG Firewall. Set only the specified host or enable authenticated relay. Navigate to `Protect > Email > Policy & exceptions`. Set the configured SMTP policy `Malware protection > Selected antivirus action` to `Drop` and `Quarantine unscannable content` is checked and `Detect zero-day threats with Sandstorm Scanned file size` is set to 10 MB. Default Value: Not configured. References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/learningContents/Email_ProtectEmailsMTA.html",
    "function_names": [
      "email_protection_policy_configured",
      "email_protection_policy_spam_check_enabled",
      "email_protection_policy_malware_check_enabled",
      "email_protection_policy_data_protection_enabled",
      "email_protection_policy_encryption_enabled",
      "email_protection_policy_smtp_secure_enabled",
      "email_protection_policy_pop_secure_enabled",
      "email_protection_policy_imap_secure_enabled",
      "email_protection_policy_domain_protected",
      "email_protection_policy_mail_server_protected"
    ],
    "profile_applicability": "\u2022  Level 2",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/learningContents/Email_ProtectEmailsMTA.html"
  },
  {
    "id": "5.7",
    "title": "Ensure DoS & Spoof Protection is enabled with the appropriate settings",
    "assessment": "Manual",
    "description": "Enable SYN/TCP/UDP Flood protection for source and destination networks with appropriate threshold for Flood protection which depend highly on the environment and device used. Default packet/minutes or packet/seconds value may not be appropriate for all the environment and understanding of traffic patterns on the specific environment may be required to set accurate threshold. Enable Spoof protection to drop the packet if the source IP address of a packet does not match any entry on the firewall\u2019s routing table or if the packet is not from a direct subnet.",
    "rationale": "DoS/DDoS attacks where the CPU and memory buffers of the victim device becomes overwhelmed by incomplete sessions. Many attacks can be successfully mitigated against resources protected by firewall or firewall itself. Impact: Organization may expose to both internal and external DoS and reconnaissance attacks. Malicious traffic flooding and malware communication can cause network congestion and consuming valuable network resources.",
    "audit": "Navigate to `Protect > Intrusion Prevention > DoS & Spoof Protection` Verify that `Enable spoof prevention` is checked on LAN and DMZ zones. Verify that `Apply Flag` is checked on `SYN flood`, `UDP flood`, `TCP flood`, `ICMP/ICMPv6` flood on both Source and Destination. Verify that `Apply Flag` is checked on `Dropped source routed packets`, `Disable ICMP/ICMPv6 redirect packet`, `ARP hardening` on Destination. Verify that `DoS bypass rule` is not added with wide range of source or destination networks that will reduce integrity of overall DoS protection.   77 | P a g e",
    "remediation": "Navigate to `Protect > Intrusion Prevention > DoS & Spoof Protection` Set `Enable spoof prevention` is checked on LAN and DMZ zones. Set `Apply Flag` is checked on `SYN flood`, `UDP flood`, `TCP flood`, `ICMP/ICMPv6` flood on both Source and Destination. Set `Apply Flag` is checked on `Dropped source routed packets`, `Disable ICMP/ICMPv6 redirect packet`, `ARP hardening` on Destination. Validate `DoS bypass rule` is not added with wide range of source or destination networks that will reduce integrity of overall DoS protection. Default Value: Not Configured. References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/IPSDoSAndSpoofProtection.html 2. https://support.sophos.com/support/s/article/KB-000035754?language=en_US",
    "function_names": [
      "network_firewall_flood_protection_enabled",
      "network_firewall_spoof_protection_enabled",
      "network_firewall_flood_threshold_configured",
      "network_firewall_spoof_detection_enabled",
      "network_firewall_packet_dropping_enabled",
      "network_firewall_routing_table_validation_enabled",
      "network_firewall_direct_subnet_validation_enabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "Organization may expose to both internal and external DoS and reconnaissance attacks. Malicious traffic flooding and malware communication can cause network congestion and consuming valuable network resources.",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/IPSDoSAndSpoofProtection.html 2. https://support.sophos.com/support/s/article/KB-000035754?language=en_US"
  },
  {
    "id": "5.8",
    "title": "Ensure Firewall Rules with SMB, Netbios, RDP and other unencrypted protocols should not be directly accessible from WAN Zone",
    "assessment": "Manual",
    "description": "Window service ports directly accessible from WAN zone could lead to bruteforce attempts, wormable attacks and other unpatched vulnerabilities. Unencrypted protocols that could potentially impact confidentiality, integrity and availability shouldn't be directly accessible from the WAN Zone.",
    "rationale": "Any allowed rules with port-forwarding (DNAT) enabled to access internal Window services such as (TCP/UDP 445,137-139,3389) and other unencrypted protocols (TCP/UDP 21,23,113,135,513,389,1433,5800,5900) could lead to potential compromise or data leakage. Impact: Directly accessible ports to the internal servers open bigger attack surface for the adversary. For example, allowing Port 3389 RDP from internet could lead to unpatched vulnerability such as Bluekeep CVE-2019-0708, vulnerability known to associate with WannaCry ransomware.",
    "audit": "Navigate to `Rules and policies > Firewall rules`. Verify the `Firewall rules` with `Source zone` `WAN` with service ports `TCP/UDP 445,137-139,3389,21,79,23,113,135,513,389,1433,5800,5900` exists in the allowed rules.",
    "remediation": "Navigate to `Rules and policies > Firewall rules`. Disable or only allow with specific source IP address in `Firewall rules` with `Source zone` `WAN` with service ports `TCP/UDP 445,137- 139,3389,21,79,23,113,135,513,389,1433,5800,5900`. When absolute necessary to allow access from Internet, consider the use of VPN.  79 | P a g e Default Value: Not Configured. References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/learningContent/RulesPoliciesCreateDNATAndFi rewallRulesForInternalServers.html?hl=dnat",
    "function_names": [
      "firewall_rule_smb_protocol_restricted",
      "firewall_rule_netbios_protocol_restricted",
      "firewall_rule_rdp_protocol_restricted",
      "firewall_rule_unencrypted_protocol_restricted",
      "firewall_rule_wan_zone_access_restricted",
      "firewall_rule_high_risk_protocol_blocked",
      "firewall_rule_legacy_protocol_restricted",
      "firewall_rule_bruteforce_protection_enabled",
      "firewall_rule_wan_zone_ingress_restricted",
      "firewall_rule_confidentiality_protection_enabled"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "Directly accessible ports to the internal servers open bigger attack surface for the adversary. For example, allowing Port 3389 RDP from internet could lead to unpatched vulnerability such as Bluekeep CVE-2019-0708, vulnerability known to associate with WannaCry ransomware.",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/learningContent/RulesPoliciesCreateDNATAndFi rewallRulesForInternalServers.html?hl=dnat"
  },
  {
    "id": "5.9",
    "title": "Ensure Wireless Protection is configured with secure configuration",
    "assessment": "Manual",
    "description": "When XG firewall is used as Wireless controller to manage Sophos Access Points, it is important to tighten configuration to prevent unauthorized access to the Wireless network.",
    "rationale": "By providing wireless connectivity to the clients, it creates potential attack surface to the wireless users as well as the local network. Important configurations such as security mode, method of handling traffic should be considered before providing the Wireless access. Impact: Authentication with weaker encryption algorithm could lead to compromising encryption keys and unauthorized access to both Wireless and local network. Due to availability and lack of physical access control to Wireless network, it is important to tighten security settings.",
    "audit": "Navigate to `Wireless > Wireless networks` Verify the existing `Wireless` settings with `Security mode`, either `WPA2 Personal` or `WPA2 Enterprise` should be used. Under `Advanced settings` Verify that `Encryption` is set to `AES[secure]` Verify that `Time-based access` is `Enable` with `Select active time` and appropriate schedule to limit the availability. Verify that `Client isolation` is `Enabled`.",
    "remediation": "Navigate to `Wireless > Wireless networks` Set the existing `Wireless` settings with `Security mode`, either `WPA2 Personal` or `WPA2 Enterprise`. Under `Advanced settings` Set `Encryption` to `AES[secure]`  81 | P a g e Set `Time-based access` to `Enable` with `Select active time` and configure appropriate schedule to limit the availability. Set `Client isolation` to `Enabled`. Default Value: Not Configured. References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/concepts/WirelessNetworks.html?hl=wireless",
    "function_names": [
      "wireless_controller_secure_configuration_enabled",
      "wireless_controller_unauthorized_access_prevented",
      "wireless_controller_encryption_enabled",
      "wireless_controller_authentication_required",
      "wireless_controller_strong_password_policy_enabled",
      "wireless_controller_firmware_up_to_date",
      "wireless_controller_rogue_ap_detection_enabled",
      "wireless_controller_client_isolation_enabled",
      "wireless_controller_wpa3_encryption_enabled",
      "wireless_controller_guest_network_isolated"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "Authentication with weaker encryption algorithm could lead to compromising encryption keys and unauthorized access to both Wireless and local network. Due to availability and lack of physical access control to Wireless network, it is important to tighten security settings.",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/concepts/WirelessNetworks.html?hl=wireless"
  },
  {
    "id": "5.10",
    "title": "Ensure No Firewall Rules with source `ANY`, service `ANY` and destination `ANY` from `WAN` Zone",
    "assessment": "Manual",
    "description": "Allowed firewall rules with no specific source or ANY service definitions from WAN/untrusted zone could lead to unintended exposure to the outside threats.",
    "rationale": "Limit the unintended exposure to systems and services. Allowed rules from WAN zone should be created with very specific source network or GEO IP and targeted service definition to the internal host. On top of the allowed policy, there should be IPS rule enabled with WAN to LAN or WAN to DMZ profile. Impact: Having a allowed firewall rule 'ANY' to 'ANY' with no layer-7 threats protections could lead to threat exposure of unpatched systems, bruteforce attempts and denial of service etc.",
    "audit": "Navigate to `Protect > Rules and policies > Firewall rules`. Filter `Destination zone` to `LAN` or `DMZ`. Verify that no allowed firewall rules from `WAN` zone with service definition `ANY` to `LAN` or `DMZ` zone with destination network set to `ANY`.",
    "remediation": "Navigate to `Protect > Rules and policies > Firewall rules`. Filter `Destination zone` to `LAN` or `DMZ`. Remove allowed firewall rules from `WAN` zone with service definition `ANY` to `LAN` or `DMZ` zone with destination network set to `ANY`. Or change the rule to specific source/destination with target service definition. Default Value: Not Configured.  83 | P a g e References: 1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/FirewallRules.html?hl=firewall%2Crul es",
    "function_names": [
      "firewall_rule_no_any_source_any_service_any_destination_from_wan",
      "firewall_rule_restrict_wan_source_service_destination",
      "firewall_rule_wan_zone_restricted_traffic",
      "firewall_rule_no_unrestricted_wan_access",
      "firewall_rule_wan_zone_specific_source_service_destination",
      "firewall_rule_no_any_any_any_from_wan",
      "firewall_rule_wan_zone_traffic_restricted",
      "firewall_rule_no_broad_wan_access",
      "firewall_rule_wan_zone_specific_traffic_only",
      "firewall_rule_no_untrusted_zone_any_any_any"
    ],
    "profile_applicability": "\u2022  Level 1",
    "impact": "Having a allowed firewall rule 'ANY' to 'ANY' with no layer-7 threats protections could lead to threat exposure of unpatched systems, bruteforce attempts and denial of service etc.",
    "references": "1. https://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en- us/webhelp/onlinehelp/nsg/sfos/concepts/FirewallRules.html?hl=firewall%2Crul es"
  }
]