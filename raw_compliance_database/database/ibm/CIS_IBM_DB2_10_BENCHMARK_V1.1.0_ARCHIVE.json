[
  {
    "id": "1.1",
    "title": "Install the latest fix packs",
    "assessment": "Not Scored",
    "description": "Periodically, IBM releases fix packs to enhance features and resolve defects, including security defects. It is recommended that the DB2 instance remain current with all fix packs.",
    "rationale": "Installing the latest DB2 fix pack will help protect the database from known vulnerabilities as well as reduce downtime that may otherwise result from functional defects.",
    "audit": "Perform the following DB2 commands to obtain the version: Open the DB2 Command Window and type in db2level: $ db2level DB21085I Instance \"DB2\" uses \"32\" bits and DB2 code release \"SQL09050\" with level identifier \"03010107\". Informational tokens are \"DB2 v9.5.0.808\", \"s071001\", \"NT3295\", and Fix Pack \"3\".",
    "remediation": "Apply the latest fix pack as offered from IBM.  13 | P a g e",
    "function_names": [
      "db2_instance_fix_packs_installed",
      "db2_instance_fix_packs_current",
      "db2_instance_fix_packs_up_to_date",
      "db2_instance_latest_fix_packs_applied",
      "db2_instance_security_fix_packs_installed"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 \u2013 RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "1.2",
    "title": "Use IP address rather than hostname",
    "assessment": "Scored",
    "description": "Use an IP address rather than a hostname to connect to the host of the DB2 instance.",
    "rationale": "Using a hostname to connect to a DB2 instance can display useful information about the host to an attacker. For example, hostnames for DB2 instances often contain the DB2 version number, host type, or operating system type.",
    "audit": "Windows: 1. Run DB2 Command Prompt - Administrator 2. Type 'db2 list node directory show detail' 3. Verify that the 'HOSTNAME' values for all nodes listed are in IP address form and not hostnames Linux: 1. Log into DB2 as DB2 Instance owner 2. Type 'db2 list node directory show detail' 3. Verify that the 'HOSTNAME' values for all nodes listed are in IP address form and not hostnames Sample: Node Directory Number of entries in the directory = 2 Node 1 entry: Node name = SAMPLE Comment = Directory entry type = LDAP Protocol = TCPIP Hostname = 192.168.145.10 Service name = 50000  14 | P a g e",
    "remediation": "1. Drop all existing nodes 2. Recreate node directory using IP addresses and not hostnames Default Value: IP address  15 | P a g e",
    "function_names": [
      "db2_instance_host_ip_used",
      "db2_connection_ip_address_required",
      "db2_host_ip_instead_of_hostname",
      "db2_instance_ip_based_connection",
      "db2_host_connection_ip_address_only"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "1.3",
    "title": "Leverage the least privilege principle",
    "assessment": "Not Scored",
    "description": "The DB2 database instance will execute under the context of a given security principle. It is recommended that this service have the least privileges possible. Furthermore, it is advisable to have the DB2 service executed using the DB2 instance owner and monitor such accounts for unauthorized access to the sensitive data.",
    "rationale": "Leveraging a least privilege account for the DB2 service will reduce an attacker's ability to compromise the host operating system should the DB2 service process become compromised.",
    "audit": "Review all accounts that have access to the DB2 database service to ensure least privilege is applied.",
    "remediation": "Ensure that all accounts have the absolute minimal privilege granted to perform their tasks.  16 | P a g e",
    "function_names": [
      "db2_instance_owner_least_privilege",
      "db2_instance_owner_unauthorized_access_monitored",
      "db2_service_account_least_privilege",
      "db2_service_account_sensitive_data_access_monitored"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 \u2013 RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "1.4",
    "title": "Use non-default account names",
    "assessment": "Scored",
    "description": "The DB2 service is installed with default accounts with well-known names such as db2admin, db2inst1, dasusr1, or db2fenc1. It is recommended that the use of these account names be avoided. The default accounts may be renamed and then used.",
    "rationale": "The use of default account names may increase the DB2 service's susceptibility to unauthorized access by an attacker.",
    "audit": "For Windows: 1. Review the list of users for the system and confirm that none of the account names are db2admin, db2inst1, dasusr1, or db2fenc1. For Linux: 1. Review /etc/passwd and confirm that none of the account names are db2admin, db2inst1, dasusr1, or db2fenc1.",
    "remediation": "For each account with a default name, either change the name to a name that is not well- known or delete the account if it is not needed.  17 | P a g e",
    "function_names": [
      "db2_account_default_names_avoided",
      "db2_user_non_default_names_used",
      "db2_account_renamed_from_default",
      "db2_default_accounts_customized",
      "db2_service_account_names_non_default"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "1.5",
    "title": "Configure DB2 to use non-standard ports",
    "assessment": "Not Scored",
    "description": "If enabled, the default DB2 instance will be assigned a default port of TCP:50000 for TCP/IP communication. TCP:50000 is a widely known DB2 port, so this port assignment should be changed. Though deprecated, if you still use the DAS, its default port uses TCP:523 and should be changed.",
    "rationale": "Using a non-default port helps reduce the number of attacks directed at the database through its port.",
    "audit": "Use the appropriate command below to identify the assigned port and confirm that it does not use the default value of 50000. Linux: cat etc/services | grep db2 Windows: netstat -bao",
    "remediation": "Assign a non-default port (a value other than 50000) to the default DB2 instance. Impact: Changing the port will break connectivity for any servers, clients, etc. configured to access the DB instance at the original port. Any port number changes need to be coordinated to prevent inadvertent outages.  18 | P a g e References: 1. http://www.ibm.com/support/knowledgecenter/en/SSEPGG_10.5.0/com.ibm.db2.l uw.admin.config.doc/doc/c0060794.html  19 | P a g e",
    "function_names": [
      "db2_instance_non_standard_port",
      "db2_das_non_standard_port",
      "db2_instance_port_not_default",
      "db2_das_port_not_default",
      "db2_instance_custom_port",
      "db2_das_custom_port"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "impact": "Changing the port will break connectivity for any servers, clients, etc. configured to access the DB instance at the original port. Any port number changes need to be coordinated to prevent inadvertent outages.  18 | P a g e",
    "references": "1. http://www.ibm.com/support/knowledgecenter/en/SSEPGG_10.5.0/com.ibm.db2.l uw.admin.config.doc/doc/c0060794.html  19 | P a g e"
  },
  {
    "id": "1.6",
    "title": "Creating the database with the RESTERICTIVE clause",
    "assessment": "Not Scored",
    "description": "This parameter indicates whether the database was created with the RESTRICTIVE clause in the CREATE DATABASE statement. When creating a database, the use of the RESTRICTIVE clause will cause certain commands to be revoked from PUBLIC.",
    "rationale": "Allowing the default privileges granted to the group PUBLIC to remain in tack can have negative impacts on the database as well as undermine measures put in place to limit access to authorized users.",
    "audit": "db2=> select case when value = '-1' then 'automatic' when value = '' then 'NULL' else value end as value from sysibmadm.dbcfg where name = 'restrict_access'",
    "remediation": "There is no remediation for this parameter due to the fact that the placement of the RESTRICTIVE clause happens within the CREATE DATABASE statement.  Unless your backup strategies allow for a complete overhaul of your environment where you are able to recreate the database with the RESTRICTIVE clause, we do not recommend changing this parameter. However, if you would like to align your database configuration to that which the RESTRICTIVE clause would provide, please ensure the following: 1. SYSCAT.DBAUTH \u2013 Ensure PUBLIC is NOT granted the following authorities: \u2022 CREATETAB \u2022 BINDADD  20 | P a g e \u2022 CONNECT \u2022 IMPLICIT_SCHEMA 2. SYSCAT.TABAUTH \u2013 Ensure PUBLIC is NOT granted the following privileges: \u2022 SELECT on all SYSCAT and SYSIBM tables \u2022 SELECT and UPDATE on all SYSSTAT tables \u2022 SELECT on the following views in schema SYSIBMADM: o ALL_* o USER_* o ROLE_* o SESSION_* o DICTIONARY o TAB 3. SYSCAT.ROUTINEAUTH \u2013 Ensure PUBLIC is NOT granted the following privileges: \u2022 EXECUTE with GRANT on all procedures in schema SQLJ \u2022 EXECUTE with GRANT on all functions and procedures in schema SYSFUN \u2022 EXECUTE with GRANT on all functions and procedures in schema SYSPROC \u2022 EXECUTE on all table functions in schema SYSIBM \u2022 EXECUTE on all other procedures in schema SYSIBM 4. SYSCAT.MODULEAUTH \u2013 Ensure PUBLIC is NOT granted the following privileges: \u2022 EXECUTE on the following modules in schema SYSIBMADM: o DBMS_DDL o DBMS_JOB o DBMS_LOB o DBMS_OUTPUT o DBMS_SQL o DBMS_STANDARD o DBMS_UTILITY 5. SYSCAT.PACKAGEAUTH \u2013 Ensure PUBLIC is NOT granted the following privileges: \u2022 BIND on all packages created in the NULLID schema \u2022 EXECUTE on all packages created in the NULLID schema 6. SYSCAT.SCHEMAAUTH \u2013 Ensure PUBLIC is NOT granted the following privileges: \u2022 CREATEIN on schema SQLJ \u2022 CREATEIN on schema NULLID 7. SYSCAT.TBSPACEAUTH \u2013 Ensure PUBLIC is NOT granted the USE privilege on table space USERSPACE1.  21 | P a g e 8. SYSCAT.WORKLOADAUTH \u2013 Ensure PUBLIC is NOT granted the USAGE privilege on SYSDEFAULTUSERWORKLOAD. 9. SYSCAT.VARIABLEAUTH \u2013 Ensure PUBLIC is NOT granted the READ privilege on schema global variables in the SYSIBM schema. References: 1. https://www.ibm.com/support/knowledgecenter/en/SSEPGG_10.5.0/com.ibm.db2 .luw.admin.cmd.doc/doc/r0001941.html 2. https://www.ibm.com/support/knowledgecenter/en/SSEPGG_10.5.0/com.ibm.db2 .luw.admin.sec.doc/doc/c0054269.html  22 | P a g e 2 DB2 Directory and File Permissions This section provides guidance on securing all operating system specific objects for DB2.",
    "function_names": [
      "database_restrictive_clause_enabled",
      "database_public_revocations_enabled",
      "database_secure_creation_enabled",
      "database_restrictive_mode_enabled",
      "database_public_privileges_revoked"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. https://www.ibm.com/support/knowledgecenter/en/SSEPGG_10.5.0/com.ibm.db2 .luw.admin.cmd.doc/doc/r0001941.html 2. https://www.ibm.com/support/knowledgecenter/en/SSEPGG_10.5.0/com.ibm.db2 .luw.admin.sec.doc/doc/c0054269.html  22 | P a g e 2 DB2 Directory and File Permissions This section provides guidance on securing all operating system specific objects for DB2."
  },
  {
    "id": "2.1",
    "title": "Secure DB2 Runtime Library",
    "assessment": "Scored",
    "description": "A DB2 software installation will place all executables under the default <DB2PATH>\\sqllib directory. This directory needs to be secured so it grants only the necessary access to authorized users and administrators.",
    "rationale": "The DB2 runtime is comprised of files that are executed as part of the DB2 service. If these resources are not secured, an attacker may alter them to execute arbitrary code.",
    "audit": "Perform the following to obtain the value for this setting: For Windows: 1. Connect to the DB2 host 2. Right-click on the NODE000x/sqldbdir directory 3. Choose Properties 4. Select the Security tab 5. Determine the permissions for DB administrator accounts and all other accounts For Linux: 1. Connect to the DB2 host 2. Change to the NODE000x/sqldbdir directory 3. Determine the permissions for the directory OS => ls -al  23 | P a g e",
    "remediation": "For Windows: 1. Connect to the DB2 host 2. Right-click on the \\NODE000x\\sqldbdir directory 3. Choose Properties 4. Select the Security tab 5. Select all DB administrator accounts and grant them the Full Control authority 6. Select all other accounts and revoke all privileges other than Read and Execute For Linux: 1. Connect to the DB2 host 2. Change to the /NODE000x/sqldbdir directory 3. Change the permission level of the directory to this recommended value OS => chmod -R 755  24 | P a g e",
    "function_names": [
      "db2_runtime_library_secure_permissions",
      "db2_runtime_library_restricted_access",
      "db2_runtime_library_authorized_users_only",
      "db2_runtime_library_no_unauthorized_access",
      "db2_runtime_library_minimal_privileges",
      "db2_runtime_library_directory_protected",
      "db2_runtime_library_executable_restrictions",
      "db2_runtime_library_admin_only_access"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "2.2",
    "title": "Secure the database container directory",
    "assessment": "Scored",
    "description": "A DB2 database container is the physical storage of the data.",
    "rationale": "The containers are needed in order for the database to operate properly. The loss of the containers can cause down time. Also, allowing excessive access to the containers may help an attacker to gain access to their contents. Therefore, secure the location(s) of the containers by restricting the access and ownership. Allow only the instance owner to have access to the tablespace containers.",
    "audit": "Review all users that have access to the directory of the containers to ensure only DB2 administrators have full access. All other users should have read-only access.",
    "remediation": "Set the privileges for the directory of the containers so that only DB2 administrators have full access, and all other users have read-only access.  25 | P a g e",
    "function_names": [
      "db2_container_directory_secure_permissions",
      "db2_container_directory_restrict_access",
      "db2_container_directory_encryption_enabled",
      "db2_container_directory_no_world_writable",
      "db2_container_directory_owner_valid",
      "db2_container_directory_no_sensitive_files",
      "db2_container_directory_audit_logging_enabled",
      "db2_container_directory_minimal_permissions",
      "db2_container_directory_no_unauthorized_users",
      "db2_container_directory_integrity_monitoring_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "2.3",
    "title": "Set umask value for DB2 admin user .profile file",
    "assessment": "Scored",
    "description": "The DB2 Admin .profile file in Linux sets the environment variables and the settings for the user.",
    "rationale": "The umask value should be set to 022 for the owner of the DB2 software at all times.",
    "audit": "Ensure that the umask 022 setting exists in the .profile.",
    "remediation": "Add umask 022 to the .profile file.  26 | P a g e",
    "function_names": [
      "db2_profile_umask_configured",
      "db2_admin_user_umask_set",
      "linux_profile_umask_secure",
      "db2_user_environment_umask_enforced",
      "db2_profile_secure_umask_value"
    ],
    "profile_applicability": "\u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "2.4",
    "title": "Verify the groups within the DB2_GRP_LOOKUP environment variable are appropriate (Windows only)",
    "assessment": "Not Scored",
    "description": "The DB2_GRP_LOOKUP environment variable manages which groups are identified on a local machine/domain level.",
    "rationale": "Periodic review of these groups is required to ensure that non-essential groups do not have unnecessary authorization.",
    "audit": "Verify that the DB2_GRP_LOOKUP environment variable includes only the appropriate groups listed within the local machine/domain. db2set -all",
    "remediation": "Alter the value of the DB2_GRP_LOOKUP environment variable so that it includes only the appropriate groups listed within the local machine/domain. References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/t0005914.html  27 | P a g e",
    "function_names": [
      "windows_environment_variable_db2_grp_lookup_groups_appropriate",
      "windows_db2_grp_lookup_groups_valid",
      "windows_environment_variable_db2_grp_lookup_restricted",
      "windows_db2_grp_lookup_groups_secure",
      "windows_environment_variable_db2_grp_lookup_approved_groups"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/t0005914.html  27 | P a g e"
  },
  {
    "id": "2.5",
    "title": "Verify the domains within the DB2DOMAINLIST environment variable are appropriate (Windows only)",
    "assessment": "Not Scored",
    "description": "It is possible to have a user id be represented across multiple domains. Issues could arise when trying to authenticate such a user id. To prevent these issues, a listing of domains should be defined within the DB2DOMAINLIST environment variable. Note: the DB2DOMAINLIST is only effective if the authentication parameter is set to CLIENT.",
    "rationale": "Periodic review of the domain list assigned to the DB2DOMAINLIST environment variable helps ensure that non-essential domains do not have unnecessary authorizations.",
    "audit": "Verify that the DB2DOMAINLIST environment variable includes only the appropriate domains. db2set -all",
    "remediation": "Alter the value of the DB2DOMAINLIST environment variable so that it includes only the appropriate domains. References: 1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/t0011962.html?lang=en    28 | P a g e 3 DB2 Configurations 3.1 DB2 Instance Parameter Settings This section provides guidance on how DB2 will control the data in the databases and the system resources that are allocated to the instance.",
    "function_names": [
      "db2_domain_list_appropriate",
      "db2_domain_list_valid_domains",
      "db2_domain_list_authentication_configured",
      "db2_domain_list_client_auth_required",
      "db2_domain_list_no_invalid_entries"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS",
    "references": "1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/t0011962.html?lang=en    28 | P a g e 3 DB2 Configurations 3.1 DB2 Instance Parameter Settings This section provides guidance on how DB2 will control the data in the databases and the system resources that are allocated to the instance."
  },
  {
    "id": "3.1.1",
    "title": "Enable audit buffer",
    "assessment": "Scored",
    "description": "DB2 can be configured to use an audit buffer. It is recommended that the audit buffer size be set to at least 1000.",
    "rationale": "Increasing the audit buffer size to greater than 0 will allocate space for the audit records generated by the audit facility. At scheduled intervals, or when the audit buffer is full, the db2auditd audit daemon empties the audit buffer to disk, writing the audit records asynchronously.",
    "audit": "Perform the following to determine if the audit buffer is set as recommended: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window:  29 | P a g e db2 => get database manager configuration 3. Locate AUDIT_BUF_SZ value in the output: db2 => get database manager configuration db2 => \u2026 Audit buffer size (4KB) (AUDIT_BUF_SZ) = 1000 Ensure AUDIT_BUF_SZ is greater than or equal to 1000.",
    "remediation": "Perform the following to establish an audit buffer: 1. Attach to the DB2 instance db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using audit_buf_sz 1000  30 | P a g e",
    "function_names": [
      "db2_audit_buffer_size_min_1000",
      "db2_audit_buffer_enabled",
      "db2_audit_buffer_configured",
      "db2_audit_buffer_sufficient_size"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.2",
    "title": "Encrypt user data across the network",
    "assessment": "Scored",
    "description": "DB2 supports a number of authentication mechanisms. It is recommended that the DATA_ENCRYPT authentication mechanism be used.",
    "rationale": "The DATA_ENCRYPT authentication mechanism employs cryptographic algorithms to protect the confidentiality of authentication credentials and user data as they traverse the network between the DB2 client and server.",
    "audit": "Perform the following to determine if the authentication mechanism is set as recommended: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the AUTHENTICATION value in the output: db2 => get database manager configuration db2 => \u2026 Database manager authentication (AUTHENTICATION) = DATA_ENCRYPT Note: AUTHENTICATION is set to DATA_ENCRYPT in the above output.  31 | P a g e",
    "remediation": "Suggested value is DATA_ENCRYPT so that authentication occurs at the server. 1. Attach to the DB2 instance db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using authentication data_encrypt  32 | P a g e",
    "function_names": [
      "db2_database_data_encrypt_enabled",
      "db2_connection_data_encrypt_required",
      "db2_authentication_data_encrypt_enabled",
      "db2_network_data_encrypt_enabled",
      "db2_user_data_encrypt_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.3",
    "title": "Require explicit authorization for cataloging",
    "assessment": "Scored",
    "description": "DB2 can be configured to allow users that do not possess the SYSADM authority to catalog and uncatalog databases and nodes. It is recommended that the catalog_noauth parameter be set to NO.",
    "rationale": "Cataloging a database is the process of registering a database from a remote client to allow remote call and access. Setting catalog-noauth to YES bypasses all permissions checks and allows anyone to catalog and uncatalog databases.",
    "audit": "Perform the following to determine if authorization is explicitly required to catalog and uncatalog databases and nodes: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the value of CATALOG_NOAUTH in the output:  33 | P a g e db2 => get database manager configuration db2 => \u2026 Cataloging allowed without authority (CATALOG_NOAUTH) = NO Note: CATALOG_NOAUTH is set to NO in the above output.",
    "remediation": "Perform the following to require explicit authorization to catalog and uncatalog databases and nodes. 1. Attach to the DB2 instance db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using catalog_noauth no References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_9.1.0/com.ibm.db2.udb.admin.doc /doc/r0000143.htm?cp=SSEPGG_9.1.0%2F11-0-0-4-3  34 | P a g e",
    "function_names": [
      "db2_instance_catalog_noauth_disabled",
      "db2_database_explicit_catalog_auth_required",
      "db2_parameter_catalog_noauth_set_no",
      "db2_instance_catalog_authorization_enforced",
      "db2_database_catalog_privileges_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_9.1.0/com.ibm.db2.udb.admin.doc /doc/r0000143.htm?cp=SSEPGG_9.1.0%2F11-0-0-4-3  34 | P a g e"
  },
  {
    "id": "3.1.4",
    "title": "Disable datalinks support",
    "assessment": "Scored",
    "description": "Datalinks enables the database to support the Data Links Manager to manage unstructured data, such as images, large files and other unstructured files on the host. It is recommended that datalinks support be disabled.",
    "rationale": "Disable datalinks if there is no use for them as this will reduce the attack surface of the DB2 service.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate this value of DATALINKS in the output: db2 => get database manager configuration db2 => \u2026 Data Links support (DATALINKS) = NO Note: DATALINKS is set to NO in the above output.  35 | P a g e",
    "remediation": "1. Attach to the DB2 instance db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using datalinks no  36 | P a g e",
    "function_names": [
      "database_instance_datalinks_disabled",
      "database_instance_datalinks_support_disabled",
      "database_instance_unstructured_data_disabled",
      "database_instance_data_links_disabled",
      "database_instance_datalinks_manager_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.5",
    "title": "Secure permissions for default database file path",
    "assessment": "Scored",
    "description": "The dftdbpath parameter contains the default file path used to create DB2 databases. It is recommended that the permissions for this directory be set to full access for DB2 administrators and read and execute access only for all other accounts. It is also recommended that this directory be owned by the DB2 Administrator.",
    "rationale": "Restricting access to the directory used as the default file path through permissions will help ensure that the confidentiality, integrity, and availability of the files there are protected.",
    "audit": "For Windows and Linux: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate this value in the output to find the default file path:  37 | P a g e db2 => get database manager configuration db2 => \u2026 Default database path (DFTDBPATH) = <valid directory> Additional steps for Windows: 1. Connect to the DB2 host 2. Right-click over the directory used for the default file path 3. Choose Properties 4. Select the Security tab 5. Review and verify the privileges for all accounts. 6. Review and verify that the DB2 Administrator is the owner of the directory. Additional steps for Linux: 1. Connect to the DB2 host 2. Change to the directory used as the default file path 3. Review and verify the permissions for the directory for all users; also ensure that the DB2 Administrator is the owner. OS => ls -al",
    "remediation": "For Windows and Linux: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window to change the default file path, if necessary: db2 => update database manager configuration using dftdbpath <valid directory> Additional steps for Windows: 1. Connect to the DB2 host 2. Right-click over the directory used as the default file path 3. Choose Properties 4. Select the Security tab 5. Assign ownership of the directory to the DB2 Administrator 6. Grant all DB administrator accounts the Full Control authority 7. Grant only read and execute privileges to all other users (revoke all other privileges)   38 | P a g e Additional steps for Linux: 1. Connect to the DB2 host 2. Change to the directory used as the default file path 3. Assign the DB2 Administrator to be the owner of the directory using the chown command 4. Change the permissions for the directory OS => chmod -R 755  39 | P a g e",
    "function_names": [
      "db2_database_dftdbpath_secure_permissions",
      "db2_database_dftdbpath_owner_admin",
      "db2_database_dftdbpath_restrict_access",
      "db2_database_dftdbpath_admin_full_access",
      "db2_database_dftdbpath_non_admin_read_only"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.6",
    "title": "Set diagnostic logging to capture errors and warnings",
    "assessment": "Scored",
    "description": "The diaglevel parameter specifies the type of diagnostic errors that will be recorded in the db2diag.log file. It is recommended that the diaglevel parameter be set to at least 3.",
    "rationale": "The recommended diaglevel setting is 3, but any value greater than 3 is also acceptable. A value of at least 3 will allow the DB2 instance to capture all errors and warnings that occur on the system.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the DIAGLEVEL value in the output: db2 => get database manager configuration db2 => \u2026 Diagnostic error capture level (DIAGLEVEL) = 3 Ensure DIAGLEVEL is greater than or equal to 3.  40 | P a g e",
    "remediation": "1. Attach to the DB2 instance db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using diaglevel 3  41 | P a g e",
    "function_names": [
      "db2_database_diaglevel_min_3",
      "db2_database_logging_errors_warnings_enabled",
      "db2_database_diagnostic_logging_sufficient",
      "db2_database_diaglevel_secure_config",
      "db2_database_logging_errors_captured"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.7",
    "title": "Secure permissions for all diagnostic logs",
    "assessment": "Scored",
    "description": "The diagpath parameter specifies the location of the diagnostic files for the DB2 instance. The directory at this location should be secured so that users have read and execute privileges only (no write privileges). All DB2 administrators should have full access to the directory.",
    "rationale": "Securing the directory will ensure that the confidentiality, integrity, and availability of the diagnostic files contained in the directory are preserved.",
    "audit": "For both Windows and Linux, perform the following DB2 commands to obtain the location of the directory: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the DIAGPATH value in the output: db2 => get database manager configuration db2 => \u2026 Diagnostic data directory path (DIAGPATH) = <valid directory>  42 | P a g e Additional steps for Windows: 1. Connect to the DB2 host 2. Right-click over the diagnostic log directory 3. Choose Properties 4. Select the Security tab 5. Review the access for all accounts Additional steps for Linux: 1. Connect to the DB2 host 2. Change to the diagnostic log directory 3. Review the permissions of the directory OS => ls -al",
    "remediation": "For Windows and Linux, to change the directory for the diagnostic logs: 1. Attach to the DB2 instance db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using diagpath <valid directory> Additional steps for Windows: 1. Connect to the DB2 host 2. Right-click over the diagnostic log directory 3. Choose Properties 4. Select the Security tab 5. Grant the Full Control authority to all DB2 administrator accounts 6. Grant only read and execute privileges to all other accounts (revoke any other privileges) Additional steps for Linux: 1. Connect to the DB2 host 2. Change to the diagnostic log directory 3. Change the permissions of the directory OS => chmod -R 755  43 | P a g e",
    "function_names": [
      "db2_instance_diagpath_read_only",
      "db2_instance_diagpath_no_write_privileges",
      "db2_instance_diagpath_admin_full_access",
      "db2_instance_diagpath_secure_permissions",
      "db2_instance_diagpath_user_restricted_access"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.8",
    "title": "Require instance name for discovery requests",
    "assessment": "Scored",
    "description": "The discover parameter determines what kind of discovery requests, if any, the DB2 server will fulfill. It is recommended that the DB2 server only fulfill requests from clients that know the given instance name (discover parameter value of  known).",
    "rationale": "Discovery capabilities may be used by a malicious entity to derive the names of and target DB2 instances. In this configuration, the client has to specify a known instance name to be able to detect the instance.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the DISCOVER value in the output: db2 => get database manager configuration db2 => \u2026 Discovery mode (DISCOVER) = KNOWN Note: DISCOVER is set to KNOWN in the above output.  44 | P a g e",
    "remediation": "The recommended value is KNOWN. Note: this requires a DB2 restart. 1. Attach to the DB2 instance db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using discover known 3. Restart the DB2 instance. db2 => db2stop db2 => db2start Impact: It is important to be aware that the implementation of this recommendation results in a brief downtime.  It is advisable to ensure that the setting is implemented during an approved maintenance window.  45 | P a g e",
    "function_names": [
      "db2_instance_discover_known",
      "db2_instance_name_required",
      "db2_discover_known_only",
      "db2_instance_discovery_restricted",
      "db2_instance_name_discovery_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "impact": "It is important to be aware that the implementation of this recommendation results in a brief downtime.  It is advisable to ensure that the setting is implemented during an approved maintenance window.  45 | P a g e"
  },
  {
    "id": "3.1.9",
    "title": "Disable instance discoverability",
    "assessment": "Scored",
    "description": "The discover_inst parameter specifies whether the instance can be discovered in the network. It is recommended that instances not be discoverable.",
    "rationale": "Discovery capabilities may be used by a malicious entity to derive the names of and target DB2 instances.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the DISCOVER_INST value in the output: db2 => get database manager configuration db2 => \u2026 Discover server instance (DISCOVER_INST) = DISABLE Note: DISCOVER_INST is set to DISABLE in the above output.  46 | P a g e",
    "remediation": "1. Attach to the DB2 instance db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using discover_inst disable  47 | P a g e",
    "function_names": [
      "compute_instance_discoverability_disabled",
      "compute_instance_discover_inst_disabled",
      "compute_instance_network_discovery_disabled",
      "compute_instance_visibility_disabled",
      "compute_instance_exposure_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.10",
    "title": "Authenticate federated users at the instance level",
    "assessment": "Scored",
    "description": "The fed_noauth parameter determines whether federated authentication will be bypassed at the instance. It is recommended that this parameter be set to no.",
    "rationale": "Setting fed_noauth to no will ensure that authentication is checked at the instance level. This will prevent any federated authentication from bypassing the client and the server.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the FED_NOAUTH value in the output: db2 => get database manager configuration db2 => \u2026 Bypass federated authentication (FED_NOAUTH) = NO Note: FED_NOAUTH is set to NO in the above output.  48 | P a g e",
    "remediation": "1. Attach to the DB2 instance db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using fed_noauth no  49 | P a g e",
    "function_names": [
      "compute_instance_federated_authentication_required",
      "compute_instance_no_federated_auth_bypass",
      "compute_instance_fed_noauth_disabled",
      "compute_instance_federated_auth_enabled",
      "compute_instance_authenticate_federated_users"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.11",
    "title": "Set maximum connection limits",
    "assessment": "Scored",
    "description": "The max_connections parameter indicates the maximum number of client connections allowed per database partition. It is recommended that this parameter be set equal to the max_coordagents parameter. The max_coordagents parameter equals the maximum number of agents needed to perform connections to the database or attachments to the instance. NOTE: Ensure that dependent parameters, such as maxappls, are set less than the max_coordagents parameter. This would ensure that the lock limit isn't reached, which would result in lock escalation issues.",
    "rationale": "By default, DB2 allows an unlimited number of users to access the DB2 instance. In addition to giving access to the DB2 instance to authorized users only, it is recommended to set a limit to the number of users allowed to access a DB2 instance. This helps prevent denial of service conditions should an authorized process malfunction and attempt a large number of simultaneous connections.",
    "audit": "Perform the following DB2 commands to obtain the value(s) for these settings: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE  50 | P a g e 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the MAX_CONNECTIONS and MAX_COORDAGENTS values in the output: db2 => get database manager configuration db2 => \u2026 Max number of client connections (MAX_CONNECTIONS) = 150 Max number of existing agents (MAX_COORDAGENTS) = 150 Note: MAX_CONNECTIONS is set to 150 and the MAX_COORDAGENTS is set to 150 in the above output. Perform the following DB2 commands to obtain the value of the MAXAPPLS parameter: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => get database configuration 3. Locate the MAXAPPLS value in the output: db2 => get database configuration db2 => \u2026 Max Number of Active Applications (MAXAPPLS) = [99] Note: MAXAPPLS is set to 99 in the above output.",
    "remediation": "The default value for max_coordagents is set to AUTOMATIC. Allowable range is 1 to 64,000, or -1 for unlimited. The recommended value is 100.  The following command will set the max_coordagents to 100, as well as set the max_connections to AUTOMATIC which is also recommended. 1. Attach to the DB2 instance db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using max_coordagents 100 AUTOMATIC  51 | P a g e If maxappls is NOT less than the value for max_coordagents, then adjust the value of maxappls accordingly: db2 => update database configuration using maxappls <a number less then max_coordagents> Default Value: The default value for max_connections is AUTOMATIC. The default value for max_coordagents is AUTOMATIC. The default value for maxappls is AUTOMATIC.  52 | P a g e",
    "function_names": [
      "db2_database_max_connections_limited",
      "db2_database_max_connections_matches_max_coordagents",
      "db2_database_max_coordagents_configured",
      "db2_database_maxappls_below_max_coordagents",
      "db2_database_connection_limits_synchronized"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.12",
    "title": "Set administrative notification level",
    "assessment": "Scored",
    "description": "The notifylevel parameter specifies the type of administration notification messages that are written to the administration notification log. It is recommended that this parameter be set greater than or equal to 3. A setting of 3, which includes settings 1 & 2, will log all fatal errors, failing services, system integrity, as well as system health.",
    "rationale": "The system should be monitoring all Health Monitor alarms, warnings, and attentions. This may give an indication of any malicious usage on the DB2 instance.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the NOTIFYLEVEL value in the output: db2 => get database manager configuration db2 => \u2026 Notify Level (NOTIFYLEVEL) = 3  53 | P a g e Note: NOTIFYLEVEL is set to 3 in the above output.",
    "remediation": "1. Attach to the DB2 instance db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using notifylevel 3 Default Value: The default value of notifylevel is 3.  54 | P a g e",
    "function_names": [
      "cloudtrail_trail_notification_level_set",
      "cloudtrail_trail_admin_notification_enabled",
      "cloudtrail_trail_notification_level_min_3",
      "cloudtrail_trail_notification_logging_enabled",
      "cloudtrail_trail_notification_level_secure",
      "cloudtrail_trail_notification_health_logging_enabled",
      "cloudtrail_trail_notification_integrity_logging_enabled",
      "cloudtrail_trail_notification_fatal_errors_logging_enabled",
      "cloudtrail_trail_notification_failing_services_logging_enabled",
      "cloudtrail_trail_notification_level_compliance"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.13",
    "title": "Enable server-based authentication",
    "assessment": "Scored",
    "description": "The srvcon_auth parameter specifies how and where authentication is to take place for incoming connections to the server. It is recommended that this parameter is not set to CLIENT.",
    "rationale": "This parameter will take precedence over and override the authentication level. Authentication should be set on the server side.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the SRVCON_AUTH value in the output: db2 => get database manager configuration db2 => \u2026 Server Connection Authentication (SRVCON_AUTH) = SERVER Note: SRVCON_AUTH is set to SERVER in the above output.  55 | P a g e",
    "remediation": "The recommended value is SERVER. Note: this will require a DB2 restart. 1. Attach to the DB2 instance db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using srvcon_auth server 3. Restart the DB2 instance. db2 => db2stop db2 => db2start Impact: It is important to be aware that the implementation of this recommendation results in a brief downtime. It is advisable to ensure that the setting is implemented during an approved maintenance window.  56 | P a g e",
    "function_names": [
      "database_server_client_auth_disabled",
      "database_server_auth_server_based",
      "database_connection_auth_server_side",
      "database_server_srvcon_auth_not_client",
      "database_server_auth_method_server_enforced"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "impact": "It is important to be aware that the implementation of this recommendation results in a brief downtime. It is advisable to ensure that the setting is implemented during an approved maintenance window.  56 | P a g e"
  },
  {
    "id": "3.1.14",
    "title": "Set failed archive retry delay",
    "assessment": "Scored",
    "description": "The archretrydelay parameter specifies the number of seconds the DB2 service will wait before it reattempts to archive log files after a failure. It is recommended that this parameter be set anywhere in the range of 10-30. You do not want the delay to be so short that the database ends up in a denial of service scenario, but you don't want the delay to be too long if an outside attack happens at the same time.",
    "rationale": "Ensure that the value is non-zero, otherwise archive logging will not retry after the first failure. A denial of service attack can render the database without an archive log if this setting is not set. An archive log will ensure that all transactions can safely be restored or logged for auditing.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => get database configuration  57 | P a g e 3. Locate the ARCHRETRYDELAY value in the output: db2 => get database configuration db2 => \u2026 Log archive retry Delay (secs) (ARCHRETRYDELAY) = 20 Note: ARCHRETRYDELAY is set to 20 in the above output.",
    "remediation": "1. Connect to the DB2 database db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. To successfully set the archretrydelay within the 10-30 range, run the following command from the DB2 command window: db2 => update database configuration using archretrydelay nn (where nn is a range between 10-30) Default Value: The default value for archretrydelay is 20  58 | P a g e",
    "function_names": [
      "db2_log_archive_retry_delay_within_range",
      "db2_log_archive_retry_delay_min_10",
      "db2_log_archive_retry_delay_max_30",
      "db2_log_archive_retry_delay_configured",
      "db2_log_archive_retry_delay_secure_range"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.15",
    "title": "Auto-restart after abnormal termination",
    "assessment": "Scored",
    "description": "The autorestart parameter specifies if the database instance should restart after an abnormal termination. It is recommended that this parameter be set to ON.",
    "rationale": "Setting the database to auto-restart will reduce the downtime of the database.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => get database configuration 3. Locate the AUTORESTART value in the output: db2 => get database configuration db2 => \u2026 Auto restart enabled (AUTORESTART) = ON Note: AUTORESTART is set to ON in the above output.  59 | P a g e",
    "remediation": "1. Connect to the DB2 database db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => update database configuration using autorestart on  60 | P a g e",
    "function_names": [
      "database_instance_autorestart_enabled",
      "database_instance_abnormal_termination_restart_enabled",
      "database_instance_auto_recovery_enabled",
      "database_instance_restart_on_failure_enabled",
      "database_instance_autorestart_on_crash_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.16",
    "title": "Disable database discovery",
    "assessment": "Scored",
    "description": "The discover_db parameter specifies if the database will respond to a discovery request from a client. It is recommended that this parameter be set to DISABLE.",
    "rationale": "Setting the database discovery to disabled can hide a database with sensitive data.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => get database configuration 3. Locate the DISCOVER_DB value in the output: db2 => get database configuration db2 => \u2026 Discovery support for this database (DISCOVER_DB) = DISABLE Note: DISCOVER_DB is set to DISABLE in the above output.   61 | P a g e",
    "remediation": "1. Connect to the DB2 database db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => update database configuration using discover_db disable  62 | P a g e",
    "function_names": [
      "rds_instance_discovery_disabled",
      "rds_cluster_discovery_disabled",
      "database_instance_discovery_disabled",
      "database_cluster_discovery_disabled",
      "db_instance_discovery_disabled",
      "db_cluster_discovery_disabled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.17",
    "title": "Secure permissions for the primary archive log location",
    "assessment": "Scored",
    "description": "The logarchmeth1 parameter specifies the type of media and the location used as the primary destination of archived logs. It is recommended that the directory used for the archived logs be set to full access for DB2 administrator accounts and read and execute for all other accounts.",
    "rationale": "Restricting access to the contents of the primary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected. Although there are many ways to ensure that your primary logs will be archived, we recommend using the value of DISK as part of the logarchmeth1 parameter. This will properly ensure that the primary logs are archived. A finding of OFF is not acceptable.",
    "audit": "For Windows and Linux: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration  63 | P a g e 3. Locate this value in the output to find the primary archive log directory: db2 => get database manager configuration db2 => ... Default database path (LOGARCHMETH1) = <valid directory> Additional steps for Windows: 1. Connect to the DB2 host 2. Right-click on the primary archive log directory 3. Choose Properties 4. Select the Security tab 5. Review and verify the privileges for all accounts Additional steps for Linux: 1. Connect to the DB2 host 2. Change to the primary archive log directory 3. Review and verify the permissions for the directory for all users. OS => ls -al",
    "remediation": "For Windows and Linux: 1. Attach to the DB2 instance. 2. Run the following command from the DB2 command window to change the primary archive log directory, if necessary: db2 => update database configuration using logarchmeth1 <valid directory> Additional steps for Windows (assuming that the logarchmeth1 parameter includes DISK): 1. Connect to the DB2 host 2. Right-click on the primary archive log directory 3. Choose Properties 4. Select the Security tab 5. Grant all DB2 administrator accounts the Full Control authority 6. Grant all other accounts read and execute privileges only (revoke all other privileges) Additional steps for Linux (assuming that the logarchmeth1 parameter includes DISK): 1. Connect to the DB2 host 2. Change to the primary archive log directory 3. Change the permissions for the directory OS => chmod -R 755  64 | P a g e",
    "function_names": [
      "db2_log_archive_directory_secure_permissions",
      "db2_log_archive_location_restricted_access",
      "db2_archive_log_directory_admin_full_access",
      "db2_archive_log_directory_non_admin_read_execute",
      "db2_logarchmeth1_secure_permissions",
      "db2_primary_archive_log_location_restricted",
      "db2_archive_log_directory_permissions_compliant",
      "db2_log_archive_directory_admin_only_full_access"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.18",
    "title": "Secure permissions for the secondary archive log location",
    "assessment": "Scored",
    "description": "The logarchmeth2 parameter specifies the type of media and the location used as the secondary destination for archived logs. It is recommended that the directory used for the archived logs be set to full access for DB2 administrator accounts and read and execute only for all other accounts.",
    "rationale": "Restricting access to the contents of the secondary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected. Although there are many ways to ensure that your logs will be archived, we recommend using the value of DISK as part of the logarchmeth2 parameter. This will properly ensure that the logs are archived. A finding of OFF is not acceptable.",
    "audit": "For Windows and Linux: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate this value in the output to find the secondary archive log directory: db2 => get database manager configuration db2 => ... Default database path (LOGARCHMETH2) = <valid directory>  65 | P a g e Additional steps for Windows: 1. Connect to the DB2 host 2. Right-click on the secondary archive log directory 3. Choose Properties 4. Select the Security tab 5. Review and verify the privileges for all accounts Additional steps for Linux: 1. Connect to the DB2 host 2. Change to the secondary archive log directory 3. Review and verify the permissions for the directory for all users OS => ls -al",
    "remediation": "For Windows and Linux: 1. Attach to the DB2 instance. 2. Run the following command from the DB2 command window to change the secondary archive log directory, if necessary: db2 => update database configuration using logarchmeth2 <valid directory> Additional steps for Windows (assuming that the logarchmeth2 parameter includes DISK): 1. Connect to the DB2 host 2. Right-click on the secondary archive log directory 3. Choose Properties 4. Select the Security tab 5. Grant all DB2 administrator accounts the Full Control authority 6. Grant all other accounts read and execute privileges only (revoke all other privileges) Additional steps for Linux (assuming that the logarchmeth2 parameter includes DISK): 1. Connect to the DB2 host 2. Change to the secondary archive log directory 3. Change the permissions for the directory OS => chmod -R 755  66 | P a g e",
    "function_names": [
      "db2_archive_log_location_permissions_restricted",
      "db2_logarchmeth2_secondary_location_secure",
      "db2_archive_log_directory_admin_only_full_access",
      "db2_secondary_log_archive_read_execute_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.19",
    "title": "Secure permissions for the tertiary archive log location",
    "assessment": "Scored",
    "description": "The failarchpath parameter specifies the type of media and the location used as the tertiary destination of archived logs. It is recommended that the directory used for the archived logs be set to full access for DB2 administrator accounts and read and execute only for all other accounts.",
    "rationale": "Restricting access to the contents of the tertiary archive log directory will help ensure that the confidentiality, integrity, and availability of archive logs are protected. Although there are many ways to ensure that your logs will be archived, we recommend using the value of DISK as part of the failarchpath parameter. This will properly ensure that the logs are archived. A finding of OFF is not acceptable.",
    "audit": "For Windows and Linux: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate this value in the output to find the tertiary archive log directory:  67 | P a g e db2 => get database manager configuration db2 => ... Default database path (FAILARCHPATH) = <valid directory> Additional steps for Windows: 1. Connect to the DB2 host 2. Right-click on the tertiary archive log directory 3. Choose Properties 4. Select the Security tab 5. Review and verify the privileges for all accounts Additional steps for Linux: 1. Connect to the DB2 host 2. Change to the tertiary archive log directory 3. Review and verify the permissions for the directory for all users. OS => ls -al",
    "remediation": "For Windows and Linux: 1. Attach to the DB2 instance. 2. Run the following command from the DB2 command window to change the tertiary archive log directory, if necessary: db2 => update database configuration using failarchpath Additional steps for Windows (assuming that the failarchpath parameter includes DISK): 1. Connect to the DB2 host 2. Right-click on the tertiary archive log directory 3. Choose Properties 4. Select the Security tab 5. Grant all DB2 administrator accounts the Full Control authority 6. Grant all other accounts read and execute privileges only (revoke all other privileges) For Linux (assuming that the failarchpath parameter includes DISK): 1. Connect to the DB2 host 2. Change to the tertiary archive log directory 3. Change the permissions for the directory OS => chmod -R 755  68 | P a g e",
    "function_names": [
      "db2_parameter_failarchpath_secure_permissions",
      "db2_archive_log_location_restrictive_access",
      "db2_log_archive_directory_admin_only_write",
      "db2_failarchpath_directory_permissions_compliant",
      "db2_archive_log_path_non_admin_read_only",
      "db2_tertiary_log_location_secure_access_control"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.20",
    "title": "Secure permissions for the log mirror location",
    "assessment": "Scored",
    "description": "The mirrorlogpath parameter specifies the type of media and the location used to store the mirror copy of the logs. It is recommended that the directory used for the mirror copy of the logs be set to full access for DB2 administrator accounts and read and execute only for all other accounts.",
    "rationale": "A mirror log path should not be empty and it should be a valid path. The mirror log path stores a second copy of the active log files. Access to the directory pointed to by that path should be restricted through permissions to help ensure that the confidentiality, integrity, and availability of the mirror logs are protected.",
    "audit": "For Windows and Linux, perform the following DB2 commands to obtain the directory location: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => get database configuration 3. Locate the MIRRORLOGPATH value in the output:  69 | P a g e db2 => get database configuration db2 => \u2026 Mirror log path (MIRRORLOGPATH) = C:\\DB2MIRRORLOGS Note: MIRRORLOGPATH is set to C:\\DB2MIRRORLOGS in the above output.\u2202 Additional steps for Windows: 1. Connect to the DB2 host 2. Right-click on the mirror log directory 3. Choose Properties 4. Select the Security tab 5. Review and verify the privileges for all accounts Additional steps for Linux: 1. Connect to the DB2 host 2. Change to the mirror log directory 3. Review and verify the permissions for the directory for all users. OS => ls -al",
    "remediation": "For Windows and Linux: 1. Connect to the DB2 database db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window to change the mirror log directory, if necessary: db2 => update database configuration using mirrorlogpath <valid path> Additional steps for Windows: 1. Connect to the DB2 host 2. Right-click on the primary archive log directory 3. Choose Properties 4. Select the Security tab 5. Grant all DB2 administrator accounts the Full Control authority 6. Grant all other accounts read and execute privileges only (revoke all other privileges) Additional steps for Linux: 1. Connect to the DB2 host  70 | P a g e 2. Change to the mirror log directory 3. Change the permissions for the directory OS => chmod -R 755  71 | P a g e",
    "function_names": [
      "db2_log_mirror_location_permissions_restricted",
      "db2_log_mirror_location_admin_full_access",
      "db2_log_mirror_location_non_admin_read_only",
      "db2_log_mirror_location_secure_permissions",
      "db2_log_mirror_location_access_controlled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.21",
    "title": "Establish retention set size for backups",
    "assessment": "Scored",
    "description": "The num_db_backups parameter specifies the number of backups to retain for a database before marking the oldest backup as deleted. It is recommended that this parameter be set to at least 12.",
    "rationale": "Retain multiple copies of the database backup to ensure that the database can recover from an unexpected failure. This parameter should not be set to 0. Multiple backups should be kept to ensure that all logs and transactions can be used for auditing.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => get database configuration 3. Locate the NUM_DB_BACKUPS value in the output: db2 => get database configuration db2 => \u2026 Number of database backups to retain (NUM_DB_BACKUPS) = 12  72 | P a g e Note: NUM_DB_BACKUPS is set to 12 in the above output.",
    "remediation": "1. Connect to the DB2 database db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => update database configuration using num_db_backups 12  73 | P a g e",
    "function_names": [
      "database_backup_retention_set_min_12",
      "database_backup_num_retained_min_12",
      "database_backup_retention_size_configured",
      "database_backup_retention_count_sufficient",
      "database_backup_min_retained_backups_12"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.1.22",
    "title": "Set archive log failover retry limit",
    "assessment": "Scored",
    "description": "The numarchretry parameter determines how many times a database will try to archive the log file to the primary or the secondary archive destination before trying the failover directory. It is recommended that this parameter be set to 5.",
    "rationale": "Establishing a failover retry time limit will ensure that the database will always have a means to recover from an abnormal termination. This parameter should not be set to 0.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => get database configuration 3. Locate the NUMARCHRETRY value in the output: db2 => get database configuration db2 => \u2026 Number of log archive retries on error (NUMARCHRETRY) = 5  74 | P a g e Note: NUMARCHRETRY is set to 5 in the above output.",
    "remediation": "1. Connect to the DB2 database db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => update database configuration using numarchretry 5  75 | P a g e 3.2 Database Manager Configuration parameters Database Configuration Parameters set several resource limits [values] to be allocated to a database. Many database configuration parameters can be modified to optimize performance and capacity.",
    "function_names": [
      "database_instance_archive_log_retry_limit_set",
      "database_instance_archive_log_retry_limit_5",
      "database_instance_archive_log_failover_retry_limit_set",
      "database_instance_archive_log_failover_retry_limit_5"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "3.2.1",
    "title": "TCP/IP service name - svcename",
    "assessment": "Scored",
    "description": "The svcename parameter reserves the port number (or name, on Linux hosts) for listening to incoming communications from a Data Server Runtime Client. Both the database server port number or name and the TCP/IP service name must be defined on the database client.",
    "rationale": "When the database server is started, a port number or name is required to listen for incoming connection requests. The svcename parameter defines the port number or name for incoming connection requests. On Linux systems, the services file is found at: /etc/services",
    "audit": "Run the following command to determine if the svcename parameter value is correctly set and is not the default port (50000). select name, value from sysibmadm.dbmcfg where name = 'svcename'",
    "remediation": "Run the following command to set the svcename parameter value. update dbm cfg using svcename <value> immediate or deferred  76 | P a g e References: 1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.co nfig.doc/doc/r0000273.html?lang=en  77 | P a g e",
    "function_names": [
      "database_svcename_port_reserved",
      "database_svcename_listening_enabled",
      "database_svcename_client_communication_configured",
      "database_svcename_port_defined",
      "database_svcename_client_defined",
      "database_svcename_tcp_service_configured",
      "database_svcename_incoming_communication_allowed"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.co nfig.doc/doc/r0000273.html?lang=en  77 | P a g e"
  },
  {
    "id": "3.2.2",
    "title": "SSL service name - ssl_svcename",
    "assessment": "Scored",
    "description": "The ssl_svcename configuration parameter defines the name or number of the port the database server listens for communications from remote client nodes using SSL protocol. The ssl_svcename and the svcename port numbers cannot be the same. On Linux operating systems, the ssl_svcename file is located in: /etc/services",
    "rationale": "The database requires a defined port to listen for incoming remote clients using the SSL protocol. The ssl_svcename configuration parameter defines the port for communicating with remote clients. Consider using a non-default port to help protect the database from attacks directed to a default port.",
    "audit": "Run the following command to determine if the current ssl_svcename parameter value is correctly set and is not a default port (50000). select name, value from sysibmadm.dbmcfg where name = 'ssl_svcename'",
    "remediation": "Run the following command to set the ssl_svcename parameter value. update dbm cfg using ssl_svcename <value> immediate or deferred Default Value: Null  78 | P a g e References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.co nfig.doc/doc/r0053615.html  79 | P a g e",
    "function_names": [
      "database_ssl_svcname_unique_port",
      "database_ssl_svcname_non_conflicting",
      "database_ssl_svcname_secure_config",
      "database_ssl_svcname_port_mismatch",
      "database_ssl_svcname_valid_port",
      "database_ssl_svcname_remote_client_secure",
      "database_ssl_svcname_linux_compliance",
      "database_ssl_svcname_services_file_valid"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.co nfig.doc/doc/r0053615.html  79 | P a g e"
  },
  {
    "id": "3.2.3",
    "title": "Authentication type for incoming connections at the server - srvcon_auth",
    "assessment": "Scored",
    "description": "The srvcon_auth parameter defines where and how user authentication is done for incoming connections at the server. If no value is used, DB2 uses the database manager configuration parameter authentication .",
    "rationale": "Incoming connections to the DB2 server must follow an authentication protocol. The srvcon_auth server configuration parameter defines how and where user authentication is done.",
    "audit": "Run the following command to identify the current value of the srvcon_auth database configuration parameter: select name, value from sysibmadm.dbmcfg where name = 'srvcon_auth'",
    "remediation": "Run the following command to update the current value of the srvcon_auth database configuration parameter to the correct value: db2 => update dbm cfg using srvcon_auth <any supported authentication> Default Value: Not specified  80 | P a g e References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.co nfig.doc/doc/r0011454.html?lang=en  81 | P a g e",
    "function_names": [
      "db2_server_srvcon_auth_local",
      "db2_server_srvcon_auth_server",
      "db2_server_srvcon_auth_client",
      "db2_server_srvcon_auth_data_encryption",
      "db2_server_srvcon_auth_kerberos",
      "db2_server_srvcon_auth_gss_plugin",
      "db2_server_srvcon_auth_ssl",
      "db2_server_srvcon_auth_ldap",
      "db2_server_srvcon_auth_not_default",
      "db2_server_srvcon_auth_explicitly_configured"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.co nfig.doc/doc/r0011454.html?lang=en  81 | P a g e"
  },
  {
    "id": "3.2.4",
    "title": "Database Manager Configuration parameter: trust_allclnts",
    "assessment": "Not Scored",
    "description": "This parameter is used to determine where users are validated within the database environment (client-side authentication). If the parameter is set to 'YES', the server assumes that the client side is handling authentication to the database. If the parameter is set to 'NO', the client must provide authentication to the server on behalf of the user. This parameter is only active when the authentication parameter is set to CLIENT.",
    "rationale": "This parameter is relied upon to determine whether each user (client) needs to be authenticated by the server or if the server should assume that each user (client) has already been sufficiently authenticated.",
    "audit": "Issue the following command to check the value of the parameter: db2=> select name, value from sysibmadm.dbmcfg where name = 'trust_allclnts' The value should be 'YES' for client-side authentication and 'NO' for server-side authentication.   82 | P a g e",
    "remediation": "To specify client-side authentication, issue the following command to set the parameter to 'YES': db2=> update dbm cfg using trust_allclnts YES To specify server-side authentication, issue the following command to set the parameter to 'NO': db2=> update dbm cfg using trust_allclnts NO References: 1. http://www.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw. admin.config.doc/doc/r0000380.html  83 | P a g e",
    "function_names": [
      "database_manager_parameter_trust_allclnts_disabled",
      "database_manager_authentication_client_side_disabled",
      "database_manager_trust_allclnts_no",
      "database_manager_client_authentication_required",
      "database_manager_parameter_authentication_client_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw. admin.config.doc/doc/r0000380.html  83 | P a g e"
  },
  {
    "id": "3.2.5",
    "title": "Database Manager Configuration parameter: trust_clntauth",
    "assessment": "Not Scored",
    "description": "This parameter specifies where a trusted client is authenticated (at the server or the client) if it provides a user ID and password. If the parameter is set to 'CLIENT', the user ID and password are not needed, but if they are provided, authentication will occur at the client. If the parameter is set to 'SERVER', the user ID and password are needed and will be authenticated at the server. This parameter is only active if the authentication parameter is set to 'CLIENT'.",
    "rationale": "This parameter is relied upon to determine whether each trusted client needs to be authenticated by the server or the client after providing a user ID and password.",
    "audit": "Issue the following command to check the value of the parameter: db2=> select name, value from sysibmadm.dbmcfg where name = 'trust_clntauth' The value should be 'CLIENT' for client-side authentication and 'SERVER' for server-side authentication.",
    "remediation": "Issue the following command to set the parameter to 'CLIENT' or 'SERVER': db2=> update dbm cfg using trust_clntauth <CLIENT/SERVER>   84 | P a g e References: 1. http://www.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw. admin.config.doc/doc/r0000381.html  85 | P a g e 4 Row and Column Access Control (RCAC) DB2 RCAC controls access to a table at the row and column level. Row and column access control is sometimes referred to as fine-grained access control or FGAC. Identify and gather the organization's security policies, management and staff roles, and user and group lists to compare against existing DB2 RCAC policies for compliance.",
    "function_names": [
      "database_manager_parameter_trust_clntauth_server",
      "database_manager_parameter_trust_clntauth_client",
      "database_manager_parameter_trust_clntauth_disabled",
      "database_manager_parameter_trust_clntauth_secure",
      "database_manager_parameter_trust_clntauth_authentication_server",
      "database_manager_parameter_trust_clntauth_authentication_client",
      "database_manager_parameter_trust_clntauth_credentials_required",
      "database_manager_parameter_trust_clntauth_credentials_optional"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw. admin.config.doc/doc/r0000381.html  85 | P a g e 4 Row and Column Access Control (RCAC) DB2 RCAC controls access to a table at the row and column level. Row and column access control is sometimes referred to as fine-grained access control or FGAC. Identify and gather the organization's security policies, management and staff roles, and user and group lists to compare against existing DB2 RCAC policies for compliance."
  },
  {
    "id": "4.1",
    "title": "Review Organization's Policies against DB2 RCAC Policies",
    "assessment": "Not Scored",
    "description": "DB2 Row and Column Access Control (RCAC) Policies control access to DB2 tables. They should match the organization's security and database access policies, and they should be regularly reviewed for gaps.",
    "rationale": "Missing, incomplete, or incorrect DB2 RCAC policies will increase the risks to the organization's protected data and will prevent efforts to monitor, alert, and respond to these risks in the future.",
    "audit": "Schedule and complete a regular review of all organization security and data access database policies against the current DB2 policies to determine if gaps exist. 1. Identify each written organization policy. 2. Find the matching DB2 RCAC policy. 3. Determine if the RCAC policy applies and correctly supports the written policy. 4. If no matching DB2 RCAC policy is found, record a 'gap' for future remediation.",
    "remediation": "1. Create RCAC policies for each 'gap' listed from the Audit procedure.  86 | P a g e 2. Review the newly created DB2 RCAC policy against the organization's written policies. Default Value: Not installed References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0057423.html?lang=en  87 | P a g e",
    "function_names": [
      "db2_rcac_policy_organization_aligned",
      "db2_rcac_policy_reviewed_recently",
      "db2_rcac_policy_gap_analysis_completed",
      "db2_table_access_policy_consistent",
      "db2_column_access_policy_consistent",
      "db2_rcac_policy_security_aligned",
      "db2_rcac_policy_access_restricted",
      "db2_rcac_policy_regularly_updated"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0057423.html?lang=en  87 | P a g e"
  },
  {
    "id": "4.2",
    "title": "Secure SECADM Authority",
    "assessment": "Not Scored",
    "description": "The SECADM (security administrator) role grants the authority to create, alter (where applicable), and drop roles, trusted contexts, audit policies, security label components, security policies and security labels. It is also the authority required to grant and revoke roles, security labels and exemptions, and the SETSESSIONUSER privilege. SECADM authority has no inherent privilege to access data stored in tables. It is recommended that the SECADM role be granted to authorized users only.",
    "rationale": "If an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the DB2 instance will be at increased risk.",
    "audit": "It is important to consider reviewing the members of the SECADM authority when implementing this recommendation. Such consideration of this review is addressed in Section 7.5 of this document.",
    "remediation": "It is important to consider reviewing the members of the SECADM authority when implementing this recommendation. Such consideration of this review is addressed in Section 7.5 of this document.   88 | P a g e References: 1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.1.0/com.ibm.db2.luw.admin.sec .doc/doc/c0021054.html?lang=en  89 | P a g e",
    "function_names": [
      "iam_role_no_secadm_privileges",
      "iam_user_no_secadm_authority",
      "iam_secadm_privileges_restricted",
      "iam_secadm_authority_audit_enabled",
      "iam_secadm_role_minimal_grants",
      "iam_secadm_privileges_reviewed_periodically",
      "iam_secadm_authority_no_data_access",
      "iam_secadm_role_explicit_assignments_only"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.1.0/com.ibm.db2.luw.admin.sec .doc/doc/c0021054.html?lang=en  89 | P a g e"
  },
  {
    "id": "4.3",
    "title": "Review Users, Groups, and Roles",
    "assessment": "Not Scored",
    "description": "With row and column access control, individuals are permitted access to only the subset of data that is required to perform their job tasks.  Periodic review of these individuals is crucial when trying to keep data secure.  As business needs move forward, requirements behind accessing the data may change, leading to a revision in security policy.  By inspecting the list of users, groups, and roles, you are identifying excessive privileges that could pose possible security threats within your infrastructure.",
    "rationale": "If a user (either by himself or part of a group or role) is no longer required access to the data that is protected by row and column access controls, allowing that individual to maintain access allows that individual to compromise the confidentiality, integrity, and/or availability of the data in the DB2 instance.",
    "audit": "1. Review the users within your database environment: Linux: cat /etc/passwd Windows: 1. Run compmgmt.msc 2. Click 'Local Users and Groups' 3. Double click 'Users' 4. Review users  90 | P a g e 2. Review the groups within your database environment: Linux: cat /etc/group Windows: 1. Run compmgmt.msc 2. Click 'Local Users and Groups' 3. Double click 'Groups' 4. Review groups 3. Review the roles and role members within your database environment: a. Attach to DB2 Instance: db2 => attach to $DB2INSTANCE b. Connect to DB2 database: db2 => connect to $DBNAME c. Run the command: db2 => select rolename, grantee from syscat.roleauth where grantortype <> 'S'",
    "remediation": "1. To remove users from your database environment: Linux: userdel -r <user name> Windows: 1. Run compmgmt.msc 2. Click 'Local Users and Groups' 3. Double click 'Users' 4. Right-click on <user name> 5. Select 'Delete'  91 | P a g e 2. To remove groups from your database environment: Linux: groupdel <group name> Windows: 1. Run compmgmt.msc 2. Click 'Local Users and Groups' 3. Double click 'Groups' 4. Right-click on < group name > 5. Select 'Delete' 3. To remove roles or role members from your database environment a. Attach to DB2 Instance: db2 => attach to $DB2INSTANCE b. Connect to DB2 database: db2 => connect to $DBNAME c. To remove role members from roles: db2 => revoke role <role name> from <user/group/role member> d. To remove roles: db2 => drop role <role name>  92 | P a g e",
    "function_names": [
      "iam_user_review_periodic",
      "iam_group_review_periodic",
      "iam_role_review_periodic",
      "iam_user_excessive_privileges_reviewed",
      "iam_group_excessive_privileges_reviewed",
      "iam_role_excessive_privileges_reviewed",
      "iam_user_access_control_reviewed",
      "iam_group_access_control_reviewed",
      "iam_role_access_control_reviewed",
      "iam_user_privilege_review_over_90d",
      "iam_group_privilege_review_over_90d",
      "iam_role_privilege_review_over_90d"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "4.4",
    "title": "Review Row Permission logic according to policy",
    "assessment": "Not Scored",
    "description": "The logic behind instituting row permissions is crucial for a successful security policy.  Inspecting this logic and comparing it to the security policy will assure that all aspects of the data access controls are being adhered to.",
    "rationale": "Missing or incomplete DB2 RCAC Security Policies will increase the risks to the organization's protected data and will prevent efforts to monitor, alert, and respond to these risks in the future.",
    "audit": "1. Attach to the DB2 Instance: db2 => attach to $DB2INSTANCE 2. Connect to database environment: db2 => connect to $DBNAME 3. Run the following and review the results to confirm that the row permissions are correct and that they comply with the existing security policy: db2 => select role.rolename, control.ruletext from syscat.roles role inner join syscat.controls control on locate(role.rolename,control.ruletext) <> 0 where enable = 'Y' and enforced = 'A' and valid = 'Y' and controltype = 'R'",
    "remediation": "1. Create RCAC Policies for each 'gap' listed from the Audit procedure. 2. Review the newly created DB2 RCAC policy against the organization's policy  93 | P a g e References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0057423.html?lang=en  94 | P a g e",
    "function_names": [
      "database_table_row_permissions_policy_compliant",
      "database_row_access_policy_aligned",
      "data_access_controls_policy_valid",
      "row_permissions_security_policy_matched",
      "database_row_security_policy_enforced"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0057423.html?lang=en  94 | P a g e"
  },
  {
    "id": "4.5",
    "title": "Review Column Mask logic according to policy",
    "assessment": "Not Scored",
    "description": "The logic behind instituting column masks is crucial for a successful security policy.  Inspecting this logic and comparing it to the security policy will assure that all aspects of the data access controls are being adhered to.",
    "rationale": "Missing or incomplete DB2 RCAC security policies will increase the risks to the organization's protected data and will prevent efforts to monitor, alert, and respond to these risks in the future.",
    "audit": "1. Attach to the DB2 Instance: db2 => attach to $DB2INSTANCE 2. Connect to database environment: db2 => connect to $DBNAME 3. Run the following and review the results to verify that the permissions are correct and that they comply with the organization's existing security policy: db2 => select role.rolename, control.colname, control.ruletext from syscat.roles role inner join syscat.controls control on locate(role.rolename,control.ruletext) <> 0 where enable = 'Y' and enforced = 'A' and valid = 'Y' and controltype = 'C'",
    "remediation": "1. Create RCAC Policies for each 'gap' listed from the Audit procedure. 2. Review the newly created DB2 RCAC policy against the organization's written policy.  95 | P a g e References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0057423.html?lang=en  96 | P a g e 5 Database Maintenance This section provides guidance on protecting and maintaining the database instance.",
    "function_names": [
      "bigquery_table_column_mask_policy_compliant",
      "bigquery_column_mask_logic_policy_aligned",
      "bigquery_column_mask_policy_validated",
      "bigquery_table_column_mask_security_compliant",
      "bigquery_column_mask_policy_enforced",
      "bigquery_table_column_mask_access_controls_compliant",
      "bigquery_column_mask_policy_consistent",
      "bigquery_table_column_mask_security_policy_aligned"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0057423.html?lang=en  96 | P a g e 5 Database Maintenance This section provides guidance on protecting and maintaining the database instance."
  },
  {
    "id": "5.1",
    "title": "Enable Backup Redundancy",
    "assessment": "Not Scored",
    "description": "Backup redundancy ensures that multiple instances of database backups exist.",
    "rationale": "Maintaining redundant copies of database backups will increase business continuity capabilities should a DB2 service failure coincide with a corrupt backup.",
    "audit": "Review the replication of your backups based on organization policy.",
    "remediation": "Define and implement a process to replicate your backups onto multiple locations.  97 | P a g e",
    "function_names": [
      "database_backup_redundancy_enabled",
      "database_backup_multi_region_enabled",
      "database_backup_replication_enabled",
      "database_backup_retention_policy_set",
      "database_backup_automated_recovery_enabled",
      "database_backup_cross_account_enabled",
      "database_backup_immutable_storage_enabled",
      "database_backup_versioning_enabled",
      "database_backup_encryption_enabled",
      "database_backup_point_in_time_recovery_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "5.2",
    "title": "Protecting Backups",
    "assessment": "Not Scored",
    "description": "Backups of your database should be stored securely in a location with full access for administrators, read and execute access for group, and no access for users.",
    "rationale": "Backups may contain sensitive data that attackers can use to retrieve valuable information about the organization.",
    "audit": "Review the privileges applied to your backups.",
    "remediation": "Define a security policy for all backups that specifies the privileges they should be assigned.  98 | P a g e",
    "function_names": [
      "database_backup_secure_permissions",
      "database_backup_admin_full_access",
      "database_backup_group_read_execute",
      "database_backup_no_user_access",
      "database_backup_restricted_access",
      "database_backup_secure_storage",
      "database_backup_access_control",
      "database_backup_permissions_compliance"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "5.3",
    "title": "Enable Automatic Database Maintenance",
    "assessment": "Scored",
    "description": "Enable automatic database maintenance on your DB2 instance. It is recommended that the DB2 Automatic Maintenance tool be used to ensure that the instance is performing optimally.",
    "rationale": "A well-maintained DB2 instance will provide access to the data and reduce database outages.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database: db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => update database configuration 3. Locate this value in the output: db2 => get database configuration db2 => \u2026 Automatic maintenance (AUTO_MAINT) = ON Note: AUTO_MAINT is set to ON in the above output.  99 | P a g e",
    "remediation": "1. Connect to the DB2 database: db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => update database configuration using auto_maint on  100 | P a g e 6 Securing Database Objects Note: SYSCAT views have underlying SYSIBM tables that are also granted access by the PUBLIC group by default. Ensure that permissions applied to these tables revoke access from unnecessary users. If the database was created using the RESTRICTIVE option, then grants to PUBLIC are voided.",
    "function_names": [
      "db2_instance_automatic_maintenance_enabled",
      "db2_database_maintenance_automatic_enabled",
      "db2_instance_maintenance_schedule_configured",
      "db2_database_automatic_maintenance_active",
      "db2_instance_optimization_tool_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "6.1",
    "title": "Restrict Access to SYSCAT.AUDITPOLICIES",
    "assessment": "Scored",
    "description": "The SYSCAT.AUDITPOLICIES view contains all audit policies for a database. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "This view contains sensitive information about the auditing security for this database. Access to the audit policies may aid attackers in avoiding detection.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window:  101 | P a g e db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'AUDITPOLICIES' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.AUDITPOLICIES FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0050610.html?cp=SSEPGG_10.5.0%2F2-12-8-2&lang=en  102 | P a g e",
    "function_names": [
      "database_audit_policies_public_access_restricted",
      "database_audit_policies_public_role_revoked",
      "database_audit_policies_view_access_controlled",
      "database_audit_policies_public_permissions_denied",
      "database_audit_policies_privileges_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0050610.html?cp=SSEPGG_10.5.0%2F2-12-8-2&lang=en  102 | P a g e"
  },
  {
    "id": "6.2",
    "title": "Restrict Access to SYSCAT.AUDITUSE",
    "assessment": "Scored",
    "description": "The SYSCAT.AUDITUSE view contains database audit policy for all non-database objects, such as authority, groups, roles, and users. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "This view contains sensitive information about the types of objects being audited. Access to the audit policy may aid attackers in avoiding detection.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'AUDITUSE' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Revoke access from PUBLIC.  103 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.AUDITUSE FROM PUBLIC  104 | P a g e",
    "function_names": [
      "db2_audituse_public_access_restricted",
      "db2_audituse_public_role_removed",
      "db2_audituse_authorization_restricted",
      "db2_audituse_non_admin_access_restricted",
      "db2_audituse_view_permissions_locked",
      "db2_audituse_public_privileges_revoked",
      "db2_audituse_access_control_enforced",
      "db2_audituse_unauthorized_access_blocked"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "6.3",
    "title": "Restrict Access to SYSCAT.DBAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.DBAUTH view contains information on authorities granted to users or groups of users. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "This view contains all the grants in the database and may be used as an attack vector.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'DBAUTH' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  105 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.DBAUTH FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001041.html?cp=SSEPGG_10.5.0%2F2-12-8-30&lang=en  106 | P a g e",
    "function_names": [
      "db2_syscat_dbauth_public_restricted",
      "db2_syscat_dbauth_no_public_access",
      "db2_dbauth_public_permissions_removed",
      "db2_dbauth_public_access_disabled",
      "db2_syscat_dbauth_public_denied"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001041.html?cp=SSEPGG_10.5.0%2F2-12-8-30&lang=en  106 | P a g e"
  },
  {
    "id": "6.4",
    "title": "Restrict Access to SYSCAT.COLAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.COLAUTH view contains the column privileges granted to the user, group, or role in the database.",
    "rationale": "The SYSCAT.COLAUTH view contains the column privileges granted to the user or a group of users. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'COLAUTH' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  107 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.COLAUTH FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.db obj.doc/doc/t0005379.html?lang=en  108 | P a g e",
    "function_names": [
      "db2_column_auth_no_public_access",
      "db2_colauth_restricted_privileges",
      "db2_syscat_colauth_secure_permissions",
      "db2_colauth_view_access_controlled",
      "db2_column_privileges_minimized",
      "db2_syscat_colauth_no_unauthorized_access",
      "db2_colauth_privileges_restricted_to_roles",
      "db2_column_auth_secure_configuration"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.db obj.doc/doc/t0005379.html?lang=en  108 | P a g e"
  },
  {
    "id": "6.5",
    "title": "Restrict Access to SYSCAT.EVENTS",
    "assessment": "Scored",
    "description": "The SYSCAT.EVENTS view contains all types of events that the database is currently monitoring. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "The types of events that the database is monitoring should not be made readily available to the public.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'EVENTS' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window:  109 | P a g e db2 => REVOKE SELECT ON SYSCAT.EVENTS FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001043.html?cp=SSEPGG_10.5.0%2F2-12-8-34&lang=en  110 | P a g e",
    "function_names": [
      "database_event_view_no_public_access",
      "syscat_events_restrict_public_role",
      "database_events_view_public_restricted",
      "syscat_events_public_access_disabled",
      "database_event_view_access_controlled"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001043.html?cp=SSEPGG_10.5.0%2F2-12-8-34&lang=en  110 | P a g e"
  },
  {
    "id": "6.6",
    "title": "Restrict Access to SYSCAT.EVENTTABLES",
    "assessment": "Scored",
    "description": "The SYSCAT.EVENTTABLES view contains the name of the destination table that will receive the monitoring events. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "PUBLIC should not have access to see the target name of the event monitoring table.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'EVENTTABLES' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window:  111 | P a g e db2 => REVOKE SELECT ON SYSCAT.EVENTTABLES FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0007483.html?cp=SSEPGG_10.5.0%2F2-12-8-35&lang=en  112 | P a g e",
    "function_names": [
      "db2_syscat_eventtables_public_access_restricted",
      "db2_eventtables_public_permissions_revoked",
      "db2_syscat_eventtables_public_privileges_removed",
      "db2_eventtables_public_access_denied",
      "db2_syscat_eventtables_public_role_restricted"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0007483.html?cp=SSEPGG_10.5.0%2F2-12-8-35&lang=en  112 | P a g e"
  },
  {
    "id": "6.7",
    "title": "Restrict Access to SYSCAT.ROUTINES",
    "assessment": "Scored",
    "description": "The SYSCAT.ROUTINES view contains all user-defined routines, functions, and stored procedures in the database. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "User-defined functions and routines should not be exposed to the public for exploits.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'ROUTINES' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  113 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.ROUTINES FROM PUBLIC  114 | P a g e",
    "function_names": [
      "database_routines_public_access_restricted",
      "database_routines_public_privileges_revoked",
      "database_routines_view_access_limited",
      "database_routines_public_role_restricted",
      "database_routines_unauthorized_access_blocked"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "6.8",
    "title": "Restrict Access to SYSCAT.INDEXAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.INDEXAUTH view contains a list of users or groups that have CONTROL access on an index. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "The list of all users with access to an index should not be exposed to the public.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'INDEXAUTH' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Revoke access from PUBLIC. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window:  115 | P a g e db2 => REVOKE SELECT ON SYSCAT.INDEXAUTH FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001046.html?cp=SSEPGG_10.5.0%2F2-12-8-44&lang=en  116 | P a g e",
    "function_names": [
      "db2_index_auth_public_restricted",
      "db2_index_auth_no_public_access",
      "db2_index_auth_control_access_restricted",
      "db2_index_auth_public_role_revoked",
      "db2_index_auth_view_access_restricted"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001046.html?cp=SSEPGG_10.5.0%2F2-12-8-44&lang=en  116 | P a g e"
  },
  {
    "id": "6.9",
    "title": "Restrict Access to SYSCAT.PACKAGEAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.PACKAGEAUTH view contains a list of users or groups that has EXECUTE privilege on a package. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "The list of all users with access to a package should not be exposed to the public.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'PACKAGEAUTH' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  117 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.PACKAGEAUTH FROM PUBLIC  118 | P a g e",
    "function_names": [
      "db2_package_auth_public_access_restricted",
      "db2_syscat_packageauth_no_public_privileges",
      "db2_package_auth_execute_privilege_restricted",
      "db2_syscat_packageauth_public_role_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "6.10",
    "title": "Restrict Access to SYSCAT.PACKAGES",
    "assessment": "Scored",
    "description": "The SYSCAT.PACKAGES view contains the names of all packages created in the database instance. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "The names of packages created in the database can be used as an entry point if a vulnerable package exists.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'PACKAGES' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  119 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.PACKAGES FROM PUBLIC  120 | P a g e",
    "function_names": [
      "database_package_public_access_restricted",
      "syscat_packages_public_access_revoked",
      "database_package_view_permissions_restricted",
      "syscat_packages_public_role_denied",
      "database_package_metadata_access_controlled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "6.11",
    "title": "Restrict Access to SYSCAT.PASSTHRUAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.PASSTHRUAUTH view contains the names of user or group that have pass- through authorization to query the data source. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "The ability to see which accounts have the pass-through privilege could allow an attacker to exploit these accounts to access another data source.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'PASSTHRUAUTH' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.   121 | P a g e",
    "remediation": "Perform the following to revoke access from PUBLIC. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.PASSTHRUAUTH FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0002184.html?cp=SSEPGG_10.5.0%2F2-12-8-70&lang=en  122 | P a g e",
    "function_names": [
      "db2_pass_through_auth_public_restricted",
      "db2_syscat_view_no_public_access",
      "db2_auth_view_access_restricted",
      "db2_passthruauth_public_denied",
      "db2_syscat_passthruauth_secure_access"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0002184.html?cp=SSEPGG_10.5.0%2F2-12-8-70&lang=en  122 | P a g e"
  },
  {
    "id": "6.12",
    "title": "Restrict Access to SYSCAT.SECURITYPOLICIES",
    "assessment": "Scored",
    "description": "The SYSCAT.SECURITYPOLICIES view contains all database security policies. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "PUBLIC should not be able to view all the database security policies.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'SECURITYPOLICIES' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC. 1. Connect to the DB2 database.  123 | P a g e db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT SYSCAT.SECURITYPOLICIES FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0020048.html?cp=SSEPGG_10.5.0%2F2-12-8-91&lang=en  124 | P a g e",
    "function_names": [
      "db_security_policy_public_access_restricted",
      "db_security_policy_public_role_revoked",
      "db_security_policy_unauthorized_access_denied",
      "db_security_policy_view_access_restricted",
      "db_security_policy_public_privileges_removed"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0020048.html?cp=SSEPGG_10.5.0%2F2-12-8-91&lang=en  124 | P a g e"
  },
  {
    "id": "6.13",
    "title": "Restrict Access to SYSCAT.SECURITYPOLICYEXEMPTIONS",
    "assessment": "Scored",
    "description": "The SYSCAT.SECURITYPOLICYEXEMPTIONS contains the exemption to a security policy that was granted to a database account. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "Public should not be able to view all the exemptions to the database security policies.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'SECURITYPOLICYEXEMPTIONS' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  125 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.SECURITYPOLICYEXEMPTIONS FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0020042.html?cp=SSEPGG_10.5.0%2F2-12-8-93&lang=en  126 | P a g e",
    "function_names": [
      "db2_security_policy_exemptions_public_restricted",
      "db2_security_policy_exemptions_access_controlled",
      "db2_security_policy_exemptions_public_revoked",
      "db2_security_policy_exemptions_privileges_restricted",
      "db2_security_policy_exemptions_public_denied"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0020042.html?cp=SSEPGG_10.5.0%2F2-12-8-93&lang=en  126 | P a g e"
  },
  {
    "id": "6.14",
    "title": "Restrict Access to SYSCAT.SURROGATEAUTHIDS",
    "assessment": "Scored",
    "description": "The SYSCAT.SURROGATEAUTHIDS contains the names of all accounts that have been granted SETSESSIONUSER privilege on a user or to PUBLIC. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "Public should not be able to view the names of all the surrogate accounts with SETSESSIONUSER privilege.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'SURROGATEAUTHIDS' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  127 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.SURROGATEAUTHIDS FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0020044.html?cp=SSEPGG_10.5.0%2F2-12-8-102&lang=en  128 | P a g e",
    "function_names": [
      "db2_surrogateauthids_public_access_restricted",
      "db2_surrogateauthids_setsessionuser_privilege_revoked",
      "db2_surrogateauthids_public_view_access_denied",
      "db2_surrogateauthids_privilege_escalation_prevented",
      "db2_surrogateauthids_public_role_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0020044.html?cp=SSEPGG_10.5.0%2F2-12-8-102&lang=en  128 | P a g e"
  },
  {
    "id": "6.15",
    "title": "Restrict Access to SYSCAT.ROLEAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.ROLEAUTH view contains information on all roles and their respective grantees. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "PUBLIC should not have access to see the grants of the roles because this could be used as a point of exploit.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'ROLEAUTH' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  129 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.ROLEAUTH FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0050619.html?cp=SSEPGG_10.5.0%2F2-12-8-74&lang=en  130 | P a g e",
    "function_names": [
      "db2_roleauth_public_access_restricted",
      "db2_roleauth_public_privileges_revoked",
      "db2_roleauth_public_permissions_denied",
      "db2_roleauth_public_view_access_disabled",
      "db2_roleauth_public_query_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0050619.html?cp=SSEPGG_10.5.0%2F2-12-8-74&lang=en  130 | P a g e"
  },
  {
    "id": "6.16",
    "title": "Restrict Access to SYSCAT.ROLES",
    "assessment": "Scored",
    "description": "The SYSCAT.ROLES view contains all roles available in the database. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "PUBLIC should not have access to see all the roles because this could be used as a point of exploit.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'ROLES' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  131 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.ROLES FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0050612.html?cp=SSEPGG_10.5.0%2F2-12-8-75&lang=en  132 | P a g e",
    "function_names": [
      "database_roles_public_access_restricted",
      "database_roles_public_privileges_revoked",
      "database_syscat_roles_public_access_denied",
      "database_syscat_roles_public_privileges_disabled",
      "database_roles_metadata_public_access_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0050612.html?cp=SSEPGG_10.5.0%2F2-12-8-75&lang=en  132 | P a g e"
  },
  {
    "id": "6.17",
    "title": "Restrict Access to SYSCAT.ROUTINEAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.ROUTINEAUTH view contains a list of all users that have EXECUTE privilege on a routine (function, method, or procedure). It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "PUBLIC should not have access to see all the users because this could be used as a point of exploit.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'ROUTINEAUTH' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  133 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.ROUTINEAUTH FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0007491.html?cp=SSEPGG_10.5.0%2F2-12-8-76&lang=en  134 | P a g e",
    "function_names": [
      "db2_routineauth_public_access_restricted",
      "db2_routineauth_public_privileges_revoked",
      "db2_routineauth_view_access_limited",
      "db2_routineauth_public_execute_disabled",
      "db2_routineauth_privilege_scope_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0007491.html?cp=SSEPGG_10.5.0%2F2-12-8-76&lang=en  134 | P a g e"
  },
  {
    "id": "6.18",
    "title": "Restrict Access to SYSCAT.SCHEMAAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.SCHEMAAUTH view contains a list of all users that have one or more privileges or access to a particular schema. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "PUBLIC should not have access to see all the users because this could be used as a point of exploit.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'SCHEMAAUTH' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  135 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.SCHEMAAUTH FROM PUBLIC  136 | P a g e",
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "6.19",
    "title": "Restrict Access to SYSCAT.SCHEMATA",
    "assessment": "Scored",
    "description": "The SYSCAT.SCHEMATA view contains all schema names in the database. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "PUBLIC should not have access to see all the schema names in the database because this could be used as a point of exploit.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'SCHEMATA' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  137 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.SCHEMATA FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001059.html?cp=SSEPGG_10.5.0%2F2-12-8-85&lang=en  138 | P a g e",
    "function_names": [
      "database_schema_public_access_restricted",
      "database_schema_syscat_schemata_access_restricted",
      "database_schema_public_role_restricted",
      "database_schema_metadata_access_restricted",
      "database_schema_syscat_views_access_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001059.html?cp=SSEPGG_10.5.0%2F2-12-8-85&lang=en  138 | P a g e"
  },
  {
    "id": "6.20",
    "title": "Restrict Access to SYSCAT.SEQUENCEAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.SEQUENCEAUTH view contains users, groups, or roles granted privilege(s) on a sequence. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "PUBLIC should not have access to see all the granted access of a sequence in the database because this could be used as a point of exploit.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'SEQUENCEAUTH' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  139 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.SEQUENCEAUTH FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0008181.html?cp=SSEPGG_10.5.0%2F2-12-8-94&lang=en  140 | P a g e",
    "function_names": [
      "db2_sequence_auth_public_restricted",
      "db2_sequence_auth_no_public_access",
      "db2_sequence_auth_privileges_restricted",
      "db2_sequence_auth_public_denied",
      "db2_sequence_auth_access_controlled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0008181.html?cp=SSEPGG_10.5.0%2F2-12-8-94&lang=en  140 | P a g e"
  },
  {
    "id": "6.21",
    "title": "Restrict Access to SYSCAT.STATEMENTS",
    "assessment": "Scored",
    "description": "The SYSCAT.STATEMENTS view contains all SQL statements of a compiled package. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "PUBLIC should not have access to the SQL statements of a database package. This could lead to an exploit.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'STATEMENTS' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  141 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.STATEMENTS FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001060.html?cp=SSEPGG_10.5.0%2F2-12-8-99&lang=en  142 | P a g e",
    "function_names": [
      "db2_syscat_statements_public_access_restricted",
      "db2_syscat_statements_public_role_revoked",
      "db2_syscat_statements_access_controlled",
      "db2_syscat_statements_public_privileges_removed",
      "db2_syscat_statements_view_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001060.html?cp=SSEPGG_10.5.0%2F2-12-8-99&lang=en  142 | P a g e"
  },
  {
    "id": "6.22",
    "title": "Restrict Access to SYSCAT.TABAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.TABAUTH view contains users or groups that have been granted one or more privileges on a table or view. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "PUBLIC should not have access to the grants of views and tables in a database. This could lead to an exploit.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'TABAUTH' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles. If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  143 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.TABAUTH FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001061.html?cp=SSEPGG_10.5.0%2F2-12-8-103&lang=en  144 | P a g e",
    "function_names": [
      "db2_table_auth_public_access_restricted",
      "db2_syscat_tabauth_public_privileges_revoked",
      "db2_table_auth_view_public_permissions_denied",
      "db2_syscat_tabauth_public_access_disabled",
      "db2_table_auth_public_privileges_removed"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001061.html?cp=SSEPGG_10.5.0%2F2-12-8-103&lang=en  144 | P a g e"
  },
  {
    "id": "6.23",
    "title": "Restrict Access to SYSCAT.TBSPACEAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.TBSPACEAUTH contains users or groups that have been granted the USE privilege on a particular tablespace in the database. It is recommended that the PUBLIC role be restricted from accessing this view.",
    "rationale": "PUBLIC should not have access to the grants of the tablespaces in a database. This could lead to an exploit.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'TBSPACEAUTH' and grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  145 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SELECT ON SYSCAT.TBSPACEAUTH FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0002201.html?cp=SSEPGG_10.5.0%2F2-12-8-110&lang=en  146 | P a g e",
    "function_names": [
      "db2_tablespace_auth_public_restricted",
      "db2_syscat_tbspaceauth_no_public_access",
      "db2_tablespace_privilege_public_denied",
      "db2_syscat_tbspaceauth_use_privilege_restricted",
      "db2_tablespace_auth_public_role_revoked"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0002201.html?cp=SSEPGG_10.5.0%2F2-12-8-110&lang=en  146 | P a g e"
  },
  {
    "id": "6.24",
    "title": "Restrict Access to Tablespaces",
    "assessment": "Scored",
    "description": "A tablespace is where the data is physically stored. It is recommended that tablespace usage be restricted to authorized users.",
    "rationale": "Grant the USE of tablespace privilege to only authorized users. Restrict the privilege from PUBLIC, where applicable, as a malicious user can cause a denial of service at the tablespace level by overloading it with corrupted data.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select grantee, tbspace from sysibm.systbspaceauth where grantee = 'PUBLIC' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC.  147 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE USE OF TABLESPACE [$tablespace_name] FROM PUBLIC References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001064.html?cp=SSEPGG_10.5.0%2F2-12-8-108&lang=en  148 | P a g e",
    "function_names": [
      "database_tablespace_authorized_users_only",
      "database_tablespace_restricted_access",
      "database_tablespace_no_public_access",
      "database_tablespace_secure_permissions",
      "database_tablespace_access_control_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0001064.html?cp=SSEPGG_10.5.0%2F2-12-8-108&lang=en  148 | P a g e"
  },
  {
    "id": "6.25",
    "title": "Restrict Access to SYSCAT.MODULEAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.MODULEAUTH view contains all granted privileges on a module for users, groups, or roles and is read only.",
    "rationale": "Any databases created without the RESTRICT option automatically GRANT the SELECT privilege to PUBLIC for SYSCAT views. Therefore, it is strongly recommended to explicitly REVOKE the SELECT privilege on the SYSCAT.MODULEAUTH view from PUBLIC to reduce risk to the organization's data.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select rtrim(grantee) as grantee, controlauth, alterauth, deleteauth, indexauth, insertauth, selectauth, updateauth, refauth  from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'MODULEAUTH' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD  149 | P a g e 2. Run the following command from the DB2 command window: db2 => revoke select on syscat.moduleauth from public References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0054748.html?lang=en  150 | P a g e",
    "function_names": [
      "db2_moduleauth_restricted_access",
      "db2_moduleauth_no_public_access",
      "db2_moduleauth_privileges_audited",
      "db2_moduleauth_read_only_enforced",
      "db2_moduleauth_user_roles_restricted"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0054748.html?lang=en  150 | P a g e"
  },
  {
    "id": "6.26",
    "title": "Restrict Access to SYSCAT.VARIABLEAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.VARIABLEAUTH view contains the granted privileges on a global variable for users, groups, or roles and is read only.",
    "rationale": "Any databases created without the RESTRICT option automatically GRANT the SELECT privilege to PUBLIC for SYSCAT views. Therefore, it is strongly recommended to explicitly REVOKE the SELECT privilege on the SYSCAT.VARIABLEAUTH view from PUBLIC to reduce risk to the organization's data.",
    "audit": "Determine if SYSCAT.VARIABLEAUTH privileges for users, groups, and roles are correctly set. Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select rtrim(grantee) as grantee, controlauth, alterauth, deleteauth, indexauth, insertauth, selectauth, updateauth, refauth  from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'VARIABLEAUTH' 3. Review privileges for users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.   151 | P a g e",
    "remediation": "Perform the following to revoke access from PUBLIC. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => revoke select on syscat.variableauth from public References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0050504.html?lang=en  152 | P a g e",
    "function_names": [
      "db2_variableauth_restricted_access",
      "db2_variableauth_read_only_enforced",
      "db2_variableauth_privileges_audited",
      "db2_variableauth_user_access_limited",
      "db2_variableauth_group_access_limited",
      "db2_variableauth_role_access_limited",
      "db2_variableauth_privileges_reviewed",
      "db2_variableauth_global_variable_protected"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0050504.html?lang=en  152 | P a g e"
  },
  {
    "id": "6.27",
    "title": "Restrict Access to SYSCAT.WORKLOADAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.WORKLOADAUTH catalog represents the users, groups, or roles that have been granted the USAGE privilege on a workload.",
    "rationale": "Any databases created without the RESTRICT option automatically GRANT the SELECT privilege to PUBLIC for SYSCAT views. Therefore, it is strongly recommended to explicitly REVOKE the SELECT privilege on the SYSCAT.WORKLOADAUTH from PUBLIC to reduce risk to the organization's data.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select rtrim(grantee) as grantee, controlauth, alterauth, deleteauth, indexauth, insertauth, selectauth, updateauth, refauth  from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'WORKLOADAUTH' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD  153 | P a g e 2. Run the following command from the DB2 command window: db2 => db2 => revoke select on syscat.workloadauth from public References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0050558.html?cp=SSEPGG_10.5.0%2F2-12-8-127&lang=en  154 | P a g e",
    "function_names": [
      "iam_workload_auth_usage_restricted",
      "iam_workload_auth_privilege_restricted",
      "iam_workload_auth_access_restricted",
      "iam_workload_auth_usage_limited",
      "iam_workload_auth_privilege_limited"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0050558.html?cp=SSEPGG_10.5.0%2F2-12-8-127&lang=en  154 | P a g e"
  },
  {
    "id": "6.28",
    "title": "Restrict Access to SYSCAT.XSROBJECTAUTH",
    "assessment": "Scored",
    "description": "The SYSCAT.XSROBJECTAUTH view contains granted USAGE privileges on a particular XSR object for users, groups, or roles and is read only.",
    "rationale": "Any databases created without the RESTRICT option automatically GRANT the SELECT privilege to PUBLIC for SYSCAT views. Therefore, it is strongly recommended to explicitly REVOKE the SELECT privilege on the SYSCAT.XSROBJECTAUTH view from PUBLIC to reduce risk to the organization's data.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select rtrim(grantee) as grantee, controlauth, alterauth, deleteauth, indexauth, insertauth, selectauth, updateauth, refauth  from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'XSROBJECTAUTH' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.",
    "remediation": "Perform the following to revoke access from PUBLIC. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD  155 | P a g e 2. Run the following command from the DB2 command window: db2 => revoke select on syscat.xsrmoduleauth from public References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0021693.html?cp=SSEPGG_10.5.0%2F2-12-8-135&lang=en  156 | P a g e",
    "function_names": [
      "db2_syscat_xsrobjectauth_restrict_access",
      "db2_syscat_xsrobjectauth_no_public_access",
      "db2_syscat_xsrobjectauth_usage_privileges_restricted",
      "db2_syscat_xsrobjectauth_read_only_access",
      "db2_syscat_xsrobjectauth_privileges_limited"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.do c/doc/r0021693.html?cp=SSEPGG_10.5.0%2F2-12-8-135&lang=en  156 | P a g e"
  },
  {
    "id": "6.29",
    "title": "Restrict Access to SYSCAT.AUTHORIZATIONIDS",
    "assessment": "Scored",
    "description": "SYSCAT.AUTHORIZATIONIDS is an administrative view for the currently connected server.",
    "rationale": "Databases created without the RESTRICT option automatically GRANT the SELECT privilege to PUBLIC for SYSCAT views. Therefore, it is strongly recommended to explicitly REVOKE the SELECT privilege on the SYSCAT.AUTHORIZATIONIDS view from PUBLIC to reduce risk to the organization's data.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select rtrim(grantee) as grantee, controlauth, alterauth, deleteauth, indexauth, insertauth, selectauth, updateauth, refauth from sysibm.systabauth where tcreator = 'SYSCAT' and ttname = 'AUTHORIZATIONIDS' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.  157 | P a g e",
    "remediation": "Perform the following to revoke access from PUBLIC. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => revoke select on syscat.AUTHORIZATIONIDS from public References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.rtn.do c/doc/r0021977.html?lang=en  158 | P a g e",
    "function_names": [
      "db2_authorization_ids_access_restricted",
      "db2_syscat_authorization_ids_no_public_access",
      "db2_admin_view_access_controlled",
      "db2_authorization_ids_privileges_restricted",
      "db2_syscat_authorization_ids_secure_access"
    ],
    "profile_applicability": "\u2022  Level 1 \u2013 RDBMS \u2022  Level 2 \u2013 RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.rtn.do c/doc/r0021977.html?lang=en  158 | P a g e"
  },
  {
    "id": "6.30",
    "title": "Restrict Access to SYSIBMADM.OBJECTOWNERS",
    "assessment": "Scored",
    "description": "The SYSIBMADM.OBJECTOWNERS administrative view shows the complete object ownership information for each authorization ID for USER owning a system catalog defined object from the connected database.",
    "rationale": "Any databases created without the RESTRICT option automatically GRANT the SELECT privilege to PUBLIC for views. Therefore, it is strongly recommended to explicitly REVOKE the SELECT privilege on the SYSIBMADM.OBJECTOWNERS view from PUBLIC to reduce risk to the organization's data.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select rtrim(grantee) as grantee, controlauth, alterauth, deleteauth, indexauth, insertauth, selectauth, updateauth, refauth from sysibm.systabauth where tcreator = 'SYSIBMADM' and ttname = 'OBJECTOWNERS' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.  159 | P a g e",
    "remediation": "Perform the following to revoke access from PUBLIC. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => revoke select on SYSIBMADM.OBJECTOWNERS from public References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.rtn.do c/doc/r0021979.html?cp=SSEPGG_10.5.0%2F3-6-1-3-12-6&lang=en  160 | P a g e",
    "function_names": [
      "db2_object_owners_access_restricted",
      "db2_object_owners_admin_view_protected",
      "db2_object_owners_privileges_limited",
      "db2_object_owners_read_access_restricted",
      "db2_object_owners_secure_permissions",
      "db2_object_owners_authz_id_restricted",
      "db2_object_owners_admin_view_locked",
      "db2_object_owners_privilege_escalation_prevented"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 \u2013 RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.rtn.do c/doc/r0021979.html?cp=SSEPGG_10.5.0%2F3-6-1-3-12-6&lang=en  160 | P a g e"
  },
  {
    "id": "6.31",
    "title": "Restrict Access to SYSIBMADM.PRIVILEGES",
    "assessment": "Scored",
    "description": "The SYSIBMADM.PRIVILEGES administrative view displays all explicit privileges for all authorization IDs in the currently connected databases' system catalogs. PRIVILEGES schema is SYSIBMADM.",
    "rationale": "Any databases created without the RESTRICT option automatically GRANT the SELECT privilege to PUBLIC for catalog views. Therefore, it is strongly recommended to explicitly REVOKE the SELECT privilege on SYSIBMADM.PRIVILEGES from PUBLIC to reduce risk to the organization's data.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select rtrim(grantee) as grantee, controlauth, alterauth, deleteauth, indexauth, insertauth, selectauth, updateauth, refauth from sysibm.systabauth where tcreator = 'SYSIBMADM' and ttname = 'PRIVILEGES' 3. Review privileges granted to users, groups, and roles.  If the output is BLANK, then it is considered a successful finding.  161 | P a g e",
    "remediation": "Perform the following to revoke access from PUBLIC. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => revoke select on SYSIBMADM.PRIVILEGES from public References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.rtn.do c/doc/r0021978.html?cp=SSEPGG_10.5.0%2F3-6-1-3-12-7&lang=en  162 | P a g e 7 DB2 Authorities This section provides guidance on securing the authorities that exist in the DB2 instance and database.",
    "function_names": [
      "db2_privileges_view_restricted_access",
      "db2_privileges_view_no_public_access",
      "db2_privileges_view_auth_ids_limited",
      "db2_privileges_view_explicit_privileges_only",
      "db2_privileges_view_admin_access_controlled",
      "db2_privileges_view_sysibmadm_protected",
      "db2_privileges_view_catalog_access_restricted",
      "db2_privileges_view_authorization_ids_filtered"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 \u2013 RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.rtn.do c/doc/r0021978.html?cp=SSEPGG_10.5.0%2F3-6-1-3-12-7&lang=en  162 | P a g e 7 DB2 Authorities This section provides guidance on securing the authorities that exist in the DB2 instance and database."
  },
  {
    "id": "7.1",
    "title": "Secure SYSADM authority",
    "assessment": "Scored",
    "description": "The sysadm_group parameter defines the system administrator group (SYSADM) authority. It is recommended that the sysadm_group group contains authorized users only.",
    "rationale": "If an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the DB2 instance will be at increased risk.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the sysadm_group value in the output and ensure the value is not NULL: db2 => get database manager configuration db2 => \u2026 SYSADM group name (SYSADM_GROUP) = DB2ADM Note: sysadm_group is set to DB2ADM in the above output.   163 | P a g e 4. Review the members of the sysadm_group on the operating system. Linux: cat /etc/group | grep <sysadm group name> Windows: 1. Run compmgmt.msc 2. Click 'Local Users and Groups' 3. Double click 'Groups' 4. Double click 5. Review group members",
    "remediation": "Define a valid group name for the SYSADM group. 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using sysadm_group <sys adm group name> Default Value: The default value for sysadm_group is NULL.  164 | P a g e",
    "function_names": [
      "db2_sysadm_group_authorized_users_only",
      "db2_sysadm_authority_restricted",
      "db2_sysadm_group_membership_secure",
      "db2_sysadm_privileges_limited",
      "db2_sysadm_authorization_controlled"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "7.2",
    "title": "Secure SYSCTRL authority",
    "assessment": "Scored",
    "description": "The sysctrl_group parameter defines the system administrator group with system control (SYSCTRL) authority. It is recommended that the sysctrl_group group contains authorized users only.",
    "rationale": "If an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the DB2 instance will be at increased risk.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the sysctrl_group value in the output and ensure the value is not NULL: db2 => get database manager configuration db2 => \u2026 SYSCTRL group name (SYSCTRL_GROUP) = DB2CTRL Note: sysctrl_group is set to DB2CTRL in the above output. 4. Review the members of the sysctrl_group on the operating system. Linux: cat /etc/group | grep <sysctrl group name> Windows:  165 | P a g e 1. Run compmgmt.msc 2. Click 'Local Users and Groups' 3. Double click 'Groups' 4. Double click <sysctrl group name> 5. Review group members",
    "remediation": "Define a valid group name for the SYSCTRL group. 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using sysctrl_group <sys control group name> Default Value: The default value for sysctrl_group is NULL.  166 | P a g e",
    "function_names": [
      "sysctrl_group_authorized_users_only",
      "sysctrl_group_no_unauthorized_members",
      "sysctrl_authority_restricted_group",
      "sysctrl_group_membership_audited",
      "sysctrl_group_minimal_privileges",
      "sysctrl_authority_exclusive_membership",
      "sysctrl_group_secure_configuration",
      "sysctrl_authority_authorized_only"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "7.3",
    "title": "Secure SYSMAINT Authority",
    "assessment": "Scored",
    "description": "The sysmaint_group parameter defines the system administrator group that possesses the system maintenance (SYSMAINT) authority. It is recommended that the sysmaint_group group contains authorized users only.",
    "rationale": "If an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the DB2 instance will be at increased risk.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the sysmaint_group value in the output and ensure the value is not NULL: db2 => get database manager configuration db2 => \u2026 SYSMAINT group name (SYSMAINT_GROUP) = DB2MAINT Note: sysmaint_group is set to DB2MAINT in the above output.  167 | P a g e 4. Review the members of the sysmaint_group on the operating system. Linux: cat /etc/group | grep <sysmaint group name> Windows: 1. Run compmgmt.msc 2. Click 'Local Users and Groups' 3. Double click 'Groups' 4. Double click <sysmaint group name> 5. Review group members",
    "remediation": "Define a valid group name for the SYSMAINT group. 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using sysmaint_group <sys maintenance group name> Default Value: The default value for sysmaint_group is NULL.  168 | P a g e",
    "function_names": [
      "iam_sysmaint_group_authorized_users_only",
      "iam_group_sysmaint_authority_restricted",
      "iam_sysmaint_authority_group_membership_controlled",
      "iam_sysmaint_group_unauthorized_users_removed",
      "iam_sysmaint_authority_group_audit_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 \u2013 RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "7.4",
    "title": "Secure SYSMON Authority",
    "assessment": "Scored",
    "description": "The sysmon_group parameter defines the operating system groups with system monitor (SYSMON) authority. It is recommended that the sysmon_group group contain authorized users only.",
    "rationale": "If an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the DB2 instance will be at increased risk.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => get database manager configuration 3. Locate the sysmon_group value in the output and ensure the value is not NULL: db2 => get database manager configuration db2 => \u2026 SYSMON group name (SYSMON_GROUP) = DB2MON Note: sysmon_group is set to DB2MON in the above output.  169 | P a g e 4. Review the members of the sysmon_group on the operating system. Linux: cat /etc/group | grep <sysmon group name> Windows: 1. Run compmgmt.msc 2. Click 'Local Users and Groups' 3. Double click 'Groups' 4. Double click 5. Review group members",
    "remediation": "Define a valid group name for the SYSMON group. 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => update database manager configuration using sysmon_group <sys monitor group name> Default Value: The default value for sysmon_group is NULL.  170 | P a g e",
    "function_names": [
      "iam_group_sysmon_authority_restricted",
      "iam_group_sysmon_membership_authorized_only",
      "iam_group_sysmon_privileges_limited",
      "iam_group_sysmon_access_controlled",
      "iam_group_sysmon_members_validated"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 \u2013 RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "7.5",
    "title": "Secure SECADM Authority",
    "assessment": "Scored",
    "description": "The SECADM (security administrator) role grants the authority to create, alter (where applicable), and drop roles, trusted contexts, audit policies, security label components, security policies and security labels. It is also the authority required to grant and revoke roles, security labels and exemptions, and the SETSESSIONUSER privilege. SECADM authority has no inherent privilege to access data stored in tables. It is recommended that the SECADM role be granted to authorized users only.",
    "rationale": "If an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the DB2 instance will be at increased risk.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select distinct grantee, granteetype from syscat.dbauth where securityadmauth = 'Y'  171 | P a g e 3. Review the list of users in the above output to ensure only approved users are assigned.",
    "remediation": "Revoke this permission from any unauthorized users. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE SECADM ON DATABASE FROM USER <username> References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0021054.html?lang=en  172 | P a g e",
    "function_names": [
      "iam_role_secadm_privileges_restricted",
      "iam_role_secadm_authorized_users_only",
      "iam_role_secadm_no_data_access",
      "iam_role_secadm_audit_policy_management_restricted",
      "iam_role_secadm_security_label_management_restricted",
      "iam_role_secadm_privilege_escalation_prevented",
      "iam_role_secadm_session_user_privilege_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 \u2013 RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0021054.html?lang=en  172 | P a g e"
  },
  {
    "id": "7.6",
    "title": "Secure DBADM Authority",
    "assessment": "Scored",
    "description": "The DBADM (database administration) role grants the authority to a user to perform administrative tasks on a specific database. It is recommended that the DBADM role be granted to authorized users only.",
    "rationale": "If an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the database will be at increased risk.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select distinct grantee, granteetype from syscat.dbauth where dbadmauth = 'Y' 3. Review the list of users in the above output to ensure only approved users are assigned.",
    "remediation": "173 | P a g e Revoke this permission from any unauthorized users. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE DBADM ON DATABASE FROM USER <username> References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0005521.html?lang=en  174 | P a g e",
    "function_names": [
      "iam_user_no_dbadmin_privileges",
      "iam_role_no_dbadmin_privileges",
      "iam_group_no_dbadmin_privileges",
      "database_user_no_dbadmin_privileges",
      "database_role_no_dbadmin_privileges",
      "database_dbadmin_authorized_users_only",
      "database_dbadmin_least_privilege",
      "database_dbadmin_restricted_access"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 \u2013 RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0005521.html?lang=en  174 | P a g e"
  },
  {
    "id": "7.7",
    "title": "Secure SQLADM Authority",
    "assessment": "Scored",
    "description": "The SQLADM authority is required to monitor, tune, and alter SQL statements.",
    "rationale": "The SQLADM authority can CREATE, SET, FLUSH, DROP EVENT MONITORS and perform RUNSTATS and REORG INDEXES and TABLES. SQLADM can be granted to users, groups, or roles or PUBLIC. SQLADM authority is a subset of the DBADM authority and can be granted by the SECADM authority.",
    "audit": "1. Run the following command from the DB2 command window: select distinct grantee, granteetype from syscat.dbauth where sqladmauth = 'Y' 2. Review the list of users in the above output to ensure only approved users are assigned.",
    "remediation": "Revoke SQLADM authority from any unauthorized users. REVOKE SQLADM ON DATABASE FROM USER <username>  175 | P a g e References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0053931.html?lang=en  176 | P a g e",
    "function_names": [
      "db2_sqladm_authority_no_admin_privileges",
      "db2_sqladm_authority_restricted_access",
      "db2_sqladm_authority_monitoring_enabled",
      "db2_sqladm_authority_audit_logging_enabled",
      "db2_sqladm_authority_least_privilege_enforced",
      "db2_sqladm_authority_secure_authentication",
      "db2_sqladm_authority_activity_logging_enabled",
      "db2_sqladm_authority_rotation_required",
      "db2_sqladm_authority_no_public_access",
      "db2_sqladm_authority_secure_connection_required"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0053931.html?lang=en  176 | P a g e"
  },
  {
    "id": "7.8",
    "title": "Secure DATAACCESS Authority",
    "assessment": "Scored",
    "description": "Grants the authority to access data. The DATAACCESS authority allows the grantee to leverage DML level commands i.e. SELECT, INSERT, UPDATE, DELETE, LOAD, and EXECUTE any package or routine. The DATAACCESS authority cannot be granted to PUBLIC.",
    "rationale": "The DATAACCESS authority gives the grantee read access and also control over manipulating the data. DATAACCESS can be granted to users, groups, or roles, but not PUBLIC. DATAACCESS authority is a subset of the DBADM authority and can be granted by the SECADM authority.",
    "audit": "1. Run the following command from the DB2 command window: select distinct grantee, granteetype from syscat.dbauth where dataaccessauth = 'Y' 2. Review the list of users in the above output to ensure only approved users are assigned.",
    "remediation": "Revoke DATAACCESS authority from any unauthorized users. REVOKE DATAACCESS ON DATABASE FROM USER <username>  177 | P a g e References: 1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0005524.html?lang=en  178 | P a g e",
    "function_names": [
      "iam_user_no_dataaccess_public",
      "iam_role_no_dataaccess_public",
      "iam_group_no_dataaccess_public",
      "database_user_no_dataaccess_public",
      "database_role_no_dataaccess_public",
      "database_schema_no_dataaccess_public",
      "data_lake_no_dataaccess_public",
      "analytics_service_no_dataaccess_public",
      "data_pipeline_no_dataaccess_public",
      "data_warehouse_no_dataaccess_public"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0005524.html?lang=en  178 | P a g e"
  },
  {
    "id": "7.9",
    "title": "Secure ACCESSCTRL Authority",
    "assessment": "Scored",
    "description": "ACCESSCTRL authority is the authority required to grant and revoke privileges on objects within a specific database. Some of these privileges include BINDADD, CONNECT, CREATETAB, CREATE_EXTERNAL_ROUTINE, LOAD, and QUIESCE_CONNECT. It has no inherent privilege to access data stored in tables, except the catalog tables and views. The ACCESSCTRL authority cannot be granted to PUBLIC.",
    "rationale": "The ACCESSCTRL authority gives the grantee access control to a specified database. With this authority, the grantee can grant/revoke privileges to other users. ACCESSCTRL can be granted to users, groups, or roles, but not PUBLIC. ACCESSCTRL authority can only be granted by the SECADM authority.",
    "audit": "1. Run the following command from the DB2 command window: select distinct grantee, granteetype from syscat.dbauth where accessctrlauth = 'Y' 2. Review the list of users in the above output to ensure only approved users are assigned.",
    "remediation": "Revoke ACCESSCTRL authority from any unauthorized users.  179 | P a g e REVOKE ACCESSCTRL ON DATABASE FROM USER <username> References: 1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0053933.html?lang=en  180 | P a g e",
    "function_names": [
      "db2_accessctrl_no_public_grant",
      "db2_accessctrl_privileges_restricted",
      "db2_accessctrl_no_data_access",
      "db2_accessctrl_authority_secure",
      "db2_accessctrl_no_bindadd_public",
      "db2_accessctrl_no_connect_public",
      "db2_accessctrl_no_createtab_public",
      "db2_accessctrl_no_create_external_routine_public",
      "db2_accessctrl_no_load_public",
      "db2_accessctrl_no_quiesce_connect_public"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0053933.html?lang=en  180 | P a g e"
  },
  {
    "id": "7.10",
    "title": "Secure WLMADM authority",
    "assessment": "Scored",
    "description": "The WLMADM authority manages workload objects for a database. Holders of DBADM authority implicitly also hold WLMADM authority.",
    "rationale": "The WLMADM authority enables creating, altering, dropping, commenting, granting, and revoking access to workload objects for a database.",
    "audit": "1.  Run the following command from the DB2 command window: select grantee, wlmadmauth from syscat.dbauth 2. Determine if the grantee(s) are correctly set.",
    "remediation": "Revoke any user who should NOT have WLMADM authority: REVOKE WLMADM ON DATABASE FROM USER <username> References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0053932.html?lang=en  181 | P a g e",
    "function_names": [
      "db2_wlmadm_authority_restricted",
      "db2_wlmadm_authority_no_implicit_grant",
      "db2_wlmadm_authority_explicit_assignment",
      "db2_wlmadm_authority_minimal_privileges",
      "db2_wlmadm_authority_audit_enabled",
      "db2_wlmadm_authority_review_periodic",
      "db2_wlmadm_authority_no_dbadm_inheritance"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0053932.html?lang=en  181 | P a g e"
  },
  {
    "id": "7.11",
    "title": "Secure CREATAB Authority",
    "assessment": "Scored",
    "description": "The CREATAB (create table) role grants the authority to a user to create tables within a specific database. It is recommended that the CREATAB role be granted to authorized users only.",
    "rationale": "Review all users that have access to this authority to avoid the addition of unnecessary and/or inappropriate users.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select distinct grantee, granteetype from syscat.dbauth where creatabauth = 'Y' 3. Review the list of users in the above output to ensure only approved users are assigned.",
    "remediation": "Revoke this permission from any unauthorized users.  182 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE CREATAB ON DATABASE FROM USER <username> References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0054269.html?lang=en  183 | P a g e",
    "function_names": [
      "iam_role_creatab_restricted",
      "iam_user_creatab_authorized_only",
      "database_role_creatab_secure",
      "database_user_creatab_privileges_restricted",
      "iam_policy_creatab_least_privilege",
      "database_authority_creatab_secure",
      "iam_creatab_role_authorized_users_only"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0054269.html?lang=en  183 | P a g e"
  },
  {
    "id": "7.12",
    "title": "Secure BINDADD Authority",
    "assessment": "Scored",
    "description": "The BINDADD (bind application) role grants the authority to a user to create packages on a specific database. It is recommended that the BINDADD role be granted to authorized users only.",
    "rationale": "If an account that possesses this authority is compromised or used in a malicious manner, the confidentiality, integrity, and availability of data in the database will be at increased risk.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select distinct grantee, granteetype from syscat.dbauth where bindaddauth = 'Y' 3. Review the list of users in the above output to ensure only approved users are assigned.  184 | P a g e",
    "remediation": "Revoke this permission from any unauthorized users. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE BINDADD ON DATABASE FROM USER <username> References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0005524.html?lang=en  185 | P a g e",
    "function_names": [
      "iam_role_bindadd_restricted",
      "iam_user_bindadd_authorized_only",
      "database_role_bindadd_secure",
      "database_user_bindadd_privileges_restricted",
      "iam_bindadd_privileges_minimized",
      "database_bindadd_authority_secure",
      "iam_bindadd_grants_audited",
      "database_bindadd_role_restricted"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0005524.html?lang=en  185 | P a g e"
  },
  {
    "id": "7.13",
    "title": "Secure CONNECT Authority",
    "assessment": "Scored",
    "description": "The CONNECT role grants the authority to a user to connect to mainframe and midrange databases from Windows, Unix, and Linux operating systems. It is recommended that the CONNECT role be granted to authorized users only.",
    "rationale": "All users that have access to this authority should be regularly reviewed.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select distinct grantee, granteetype from syscat.dbauth where connectauth = 'Y' 3. Review the list of users in the above output to ensure only approved users are assigned.",
    "remediation": "Revoke this permission from any unauthorized users.  186 | P a g e 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE CONNECT ON DATABASE FROM USER <username> References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.qb.dbcon n.doc/doc/r0059046.html?cp=SSEPGG_10.5.0%2F6&lang=en  187 | P a g e",
    "function_names": [
      "iam_role_connect_authority_restricted",
      "iam_role_connect_no_public_access",
      "iam_role_connect_privileges_minimized",
      "iam_role_connect_user_authorized_only",
      "iam_role_connect_secure_assignment",
      "iam_role_connect_no_unrestricted_grants",
      "iam_role_connect_explicit_permissions",
      "iam_role_connect_approved_users_only"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.qb.dbcon n.doc/doc/r0059046.html?cp=SSEPGG_10.5.0%2F6&lang=en  187 | P a g e"
  },
  {
    "id": "7.14",
    "title": "Secure LOAD Authority",
    "assessment": "Scored",
    "description": "The LOAD role grants the authority to a user to load data into tables. It is recommended that the LOAD role be granted to authorized users only.",
    "rationale": "All users that have access to this authority should be regularly reviewed.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select distinct grantee, granteetype from syscat.dbauth where loadauth = 'Y' 3. Review the list of users in the above output to ensure only approved users are assigned.",
    "remediation": "Revoke this permission from any unauthorized users. 1. Connect to the DB2 database.  188 | P a g e db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE LOAD ON DATABASE FROM USER <username> References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0005522.html?lang=en  189 | P a g e",
    "function_names": [
      "iam_role_load_authorization_restricted",
      "iam_user_load_privileges_limited",
      "iam_load_role_granted_to_authorized_users",
      "iam_load_authority_minimal_privileges",
      "iam_load_role_exclusive_assignments",
      "iam_load_authorization_audit_enabled",
      "iam_load_role_usage_monitored",
      "iam_load_privileges_reviewed_periodically"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0005522.html?lang=en  189 | P a g e"
  },
  {
    "id": "7.15",
    "title": "Secure EXTERNALROUTINE Authority",
    "assessment": "Scored",
    "description": "The EXTERNALROUTINE authority grants a user the privilege to create user-defined functions and procedures in a specific database.",
    "rationale": "All users with this authority should be regularly reviewed and approved.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select distinct grantee, granteetype from syscat.dbauth where externalroutineauth = 'Y' 3. Review the list of users in the above output to ensure only approved users are assigned.",
    "remediation": "Revoke this permission from any unauthorized users. 1. Connect to the DB2 database.  190 | P a g e db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE CREATE_EXTERNAL_ROUTINE ON DATABASE FROM USER <username> References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.apdv.rout ines.doc/doc/c0009198.html?lang=en  191 | P a g e",
    "function_names": [
      "iam_user_external_routine_authority_restricted",
      "database_user_external_routine_privilege_revoked",
      "database_role_external_routine_authority_denied",
      "database_external_routine_creation_disabled",
      "iam_user_external_routine_authority_audited",
      "database_external_routine_authority_minimal",
      "database_user_external_routine_privilege_limited",
      "database_external_routine_authority_monitored"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.apdv.rout ines.doc/doc/c0009198.html?lang=en  191 | P a g e"
  },
  {
    "id": "7.16",
    "title": "Secure QUIESCECONNECT Authority",
    "assessment": "Scored",
    "description": "The QUIESCECONNECT role grants the authority to a user to access a database even in the quiesced state.",
    "rationale": "It is recommended that the QUIESCECONNECT role be granted to authorized users only.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select distinct grantee, granteetype from syscat.dbauth where quiesceconnectauth = 'Y' 3. Review the list of users in the above output to ensure only approved users are assigned.",
    "remediation": "Revoke this permission from any unauthorized users. 1. Connect to the DB2 database.  192 | P a g e db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => REVOKE QUIESCE_CONNECT ON DATABASE FROM USER <username> References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.apdv.api. doc/doc/r0009331.html?lang=en  193 | P a g e 8 DB2 Roles Roles simplify the administration and management of privileges by offering an equivalent capability as groups but without the same restrictions.  A role is a database object that groups together one or more privileges and can be assigned to users, groups, PUBLIC, or other roles by using a GRANT statement.  All the roles assigned to a user are enabled when that user establishes a connection, so all privileges and authorities granted to roles are taken into account when a user connects. Roles cannot be explicitly enabled or disabled.",
    "function_names": [
      "iam_role_quiesceconnect_restricted",
      "iam_user_quiesceconnect_disabled",
      "database_role_quiesceconnect_revoked",
      "database_user_quiesceconnect_denied",
      "iam_policy_quiesceconnect_removed",
      "database_authority_quiesceconnect_limited"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.apdv.api. doc/doc/r0009331.html?lang=en  193 | P a g e 8 DB2 Roles Roles simplify the administration and management of privileges by offering an equivalent capability as groups but without the same restrictions.  A role is a database object that groups together one or more privileges and can be assigned to users, groups, PUBLIC, or other roles by using a GRANT statement.  All the roles assigned to a user are enabled when that user establishes a connection, so all privileges and authorities granted to roles are taken into account when a user connects. Roles cannot be explicitly enabled or disabled."
  },
  {
    "id": "8.1",
    "title": "Review Roles",
    "assessment": "Scored",
    "description": "Roles provide several advantages that make it easier to manage privileges in a database system.  Security administrators can control access to their databases in a way that mirrors the structure of their organizations (they can create roles in the database that map directly to the job functions in their organizations).  The assignment of privileges is simplified. Instead of granting the same set of privileges to each individual user in a particular job function, the administrator can grant this set of privileges to a role representing that job function and then grant that role to each user in that job function.",
    "rationale": "Reviewing the roles within a database helps minimize the possibility of unwanted access.",
    "audit": "1. Attach to a DB2 Instance: db2 => attach to $DB2INSTANCE  194 | P a g e 2. Connect to DB2 database: db2 => connect to $DBNAME 3. Run the following and review the results to determine if each role name still has a business requirement to access the data: db2 => select rolename from syscat.roleauth where grantortype <> 'S' group by rolename",
    "remediation": "To remove a role from the database: 1. Attach to a DB2 Instance: db2 => attach to $DB2INSTANCE 2. Connect to DB2 database: db2 => connect to $DBNAME 3. Run the following: db2 => drop role <role name> References: 1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0050531.html  195 | P a g e",
    "function_names": [
      "iam_role_privileges_reviewed",
      "iam_role_privileges_minimized",
      "iam_role_privileges_organization_mapping",
      "iam_role_privileges_job_function_aligned",
      "iam_role_privileges_centralized_management",
      "iam_role_privileges_regular_review",
      "iam_role_privileges_least_privilege",
      "iam_role_privileges_audit_logging_enabled",
      "iam_role_privileges_usage_monitored",
      "iam_role_privileges_rotation_policy_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0050531.html  195 | P a g e"
  },
  {
    "id": "8.2",
    "title": "Review Role Members",
    "assessment": "Scored",
    "description": "Having roles that have been granted specific privileges, then assigning users to the roles, is usually considered the best way to grant application access. Because granting privileges to individual users can be more difficult to track and maintain against unauthorized access, users should be assigned to organization-defined database roles according to the needs of the business. As users leave the organization or change responsibilities within the organization, the appropriate roles for them change as well, so role membership needs to be reviewed and verified periodically.",
    "rationale": "Users who have excessive privileges not needed to do their jobs pose an unnecessary risk to the organization as an insider threat.",
    "audit": "1. Attach to a DB2 Instance: db2 => attach to $DB2INSTANCE 2. Connect to DB2 database: db2 => connect to $DBNAME  196 | P a g e 3. Run the following to review and verify that the role members are correct for each role: db2 => select rolename,grantee from syscat.roleauth where grantortype <> 'S' group by rolename, grantee",
    "remediation": "To remove a role member from a particular role: 1. Attach to a DB2 Instance: db2 => attach to $DB2INSTANCE 2. Connect to DB2 database: db2 => connect to $DBNAME 3. Run the following: db2 => revoke role <role name> from <role member> References: 1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0050531.html  197 | P a g e",
    "function_names": [
      "iam_role_membership_reviewed_periodically",
      "iam_user_role_assignment_verified",
      "iam_role_privileges_tracked",
      "iam_user_privileges_no_direct_grants",
      "iam_role_membership_updated_on_change",
      "iam_user_role_membership_reviewed_over_90d",
      "iam_role_assignment_business_aligned",
      "iam_user_role_membership_audited",
      "iam_role_privileges_minimized",
      "iam_user_role_membership_consistent"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0050531.html  197 | P a g e"
  },
  {
    "id": "8.3",
    "title": "Nested Roles",
    "assessment": "Scored",
    "description": "The user-defined roles in DB2 can be nested in the same fashion as Windows security groups--a nested group has both its directly assigned permissions as well as the assigned group permissions. By nesting roles, the database administrator is saving time by only having to assign a group of users versus assigning them individually. Nesting roles properly can often ease the application of the security model if it's kept fairly shallow, and if the roles are logically named. If these are all true, then nesting of roles is a good idea.",
    "rationale": "As tracking multiple levels of permissions can result in unauthorized access to data resources, this capability should be restricted according to the needs of the business.",
    "audit": "1. Attach to DB2 Instance: db2 => attach to $DB2INSTANCE 2. Connect to DB2 database: db2 => connect to $DBNAME 3. Run the following to identify any nested roles: db2 => select grantee, rolename from syscat.roleauth where grantee in (select rolename from syscat.roles) Note: If value is blank, this would be considered passing.",
    "remediation": "To remove a nested role, perform the following: 1. Attach to DB2 Instance:  198 | P a g e db2 => attach to $DB2INSTANCE 2. Connect to DB2 database: db2 => connect to $DBNAME 3. Run the following: db2 => revoke role <role name> from role <role>  199 | P a g e",
    "function_names": [
      "iam_role_nested_properly",
      "iam_role_nesting_shallow",
      "iam_role_nesting_logical_names",
      "iam_role_nesting_secure_model",
      "iam_role_nesting_depth_limited",
      "iam_role_nesting_permissions_inherited",
      "iam_role_nesting_user_group_assignment",
      "iam_role_nesting_secure_hierarchy"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "8.4",
    "title": "Review Roles granted to PUBLIC",
    "assessment": "Scored",
    "description": "Granting to PUBLIC increases the risk of unauthorized entry into the database. Because PUBLIC is accessible by any database user, it is important to understand the exposure it has on all database objects. It would make sense to grant role membership to PUBLIC if all users required all the privileges granted through that role.",
    "rationale": "As any role granted to PUBLIC can potentially allow the compromise of database availability, confidentiality, or integrity, these roles should be restricted according to the needs of the business.",
    "audit": "1. Attach to a DB2 Instance: db2 => attach to $DB2INSTANCE 2. Connect to DB2 database: db2 => connect to $DBNAME 3. Run the following: db2 => select grantee, rolename from syscat.roleauth where grantee = 'PUBLIC' Note: If the value returned is blank, that is considered a passable finding.   200 | P a g e",
    "remediation": "To remove a role member from a particular role: 1. Attach to a DB2 Instance: db2 => attach to $DB2INSTANCE 2. Connect to DB2 database: db2 => connect to $DBNAME 3. Run the following: db2 => revoke role <role name> from PUBLIC References: 1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0050531.html  201 | P a g e",
    "function_names": [
      "iam_role_no_public_access",
      "iam_role_restrict_public_membership",
      "iam_role_minimize_public_privileges",
      "database_role_no_public_grants",
      "database_role_public_access_reviewed",
      "database_role_public_privileges_audited",
      "database_role_public_membership_restricted",
      "database_role_public_grants_removed"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. https://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0050531.html  201 | P a g e"
  },
  {
    "id": "8.5",
    "title": "Review Role Grantees with WITH ADMIN OPTION",
    "assessment": "Scored",
    "description": "Using the WITH ADMIN OPTION clause of the GRANT (Role) SQL statement, the security administrator can delegate the management and control of membership in a role to someone else.",
    "rationale": "The WITH ADMIN OPTION clause gives another user the authority to grant membership in the role to other users, to revoke membership in the role from other members of the role, and to comment on a role, but not to drop the role.",
    "audit": "1. Attach to DB2 Instance: db2 => attach to $DB2INSTANCE 2. Connect to DB2 database: db2 => connect to $DBNAME 3. Perform the following query: db2 => select rolename, grantee, admin from syscat.roleauth where grantortype <> 'S' and admin = 'Y' Note: If the value returned is blank, that is considered a passable finding.",
    "remediation": "1. Attach to DB2 Instance: db2 => attach to $DB2INSTANCE 2. Connect to DB2 database:  202 | P a g e db2 => connect to $DBNAME 3. Perform the following query: db2=> revoke admin option for role <role name> from user <user name>  203 | P a g e 9 General Policy and Procedures [This space intentionally left blank]",
    "function_names": [
      "iam_role_no_admin_option",
      "iam_role_admin_option_reviewed",
      "iam_role_grantee_admin_option_disabled",
      "iam_role_grantee_admin_option_restricted",
      "iam_role_admin_privilege_delegation_reviewed"
    ],
    "profile_applicability": "\u2022  Level 2 - RDBMS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "9.1",
    "title": "Start and Stop DB2 Instance",
    "assessment": "Not Scored",
    "description": "The DB2 instance manages the database environment and sets the configuration parameters. It is recommended that only administrators are allowed to start and stop the DB2 instance.",
    "rationale": "Only privileged users should have access to start and stop the DB2 instance. This will ensure that the DB2 instance is controlled by authorized administrators.",
    "audit": "On Windows: 1. Go to Start, then to the Run option. 2. Type in services.msc in the command prompt. 3. Locate the DB2 service and identify the users/groups that can start and stop the service. On Linux: 1. Identify the name of the local DB2 admin group. 2. Identify the members of that group. 3. Identify the members that have access to stop and start the DB2 instance.   204 | P a g e",
    "remediation": "Revoke access from any unnecessary users. 1. Connect to the host 2. Review users and groups that have access to start and stop the DB2 instance. 3. Remove start and stop privileges from all users and groups that should not have them.  205 | P a g e",
    "function_names": [
      "db2_instance_start_stop_restricted",
      "db2_instance_admin_only_control",
      "db2_instance_privileged_operations_restricted",
      "db2_instance_management_admin_only",
      "db2_instance_operations_restricted_to_admins"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "9.2",
    "title": "Remove Unused Schemas",
    "assessment": "Not Scored",
    "description": "A schema is a logical grouping of database objects. It is recommended that unused schemas be removed from the database.",
    "rationale": "Unused schemas can be left unmonitored and may be subjected to abuse and therefore should be removed.",
    "audit": "1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select schemaname from syscat.schemata 3. Review the list of schemas",
    "remediation": "Remote unnecessary schemas. 1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD  206 | P a g e 2. Run the following command from the DB2 command window: db2 => drop scheme <scheme name> restrict 3. Review unused schemas and remove if necessary  207 | P a g e",
    "function_names": [
      "database_schema_unused_removed",
      "database_schema_unused_cleanup",
      "database_schema_active_only",
      "database_schema_unused_identify",
      "database_schema_unused_deleted",
      "database_schema_unused_removed_all_regions",
      "database_schema_unused_removed_over_90d"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "9.3",
    "title": "Review System Tablespaces",
    "assessment": "Scored",
    "description": "System tablespaces store all system object data within that database. It is recommended that system tablespaces are used to stored system data only and not user data.",
    "rationale": "Users should not have privileges to create user data objects within the system tablespaces. User data objects created within the system tablespaces should be removed.",
    "audit": "1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD 2. Run the following command from the DB2 command window: db2 => select tabschema,tabname,tbspace from syscat.tables where tabschema not in ('ADMINISTRATOR','SYSIBM','SYSTOOLS') and tbspace in ('SYSCATSPACE','SYSTOOLSPACE','SYSTOOLSTMPSPACE','TEMPSPACE') 3. Review the list of system tablespaces. If the output is BLANK, that is considered a successful finding.",
    "remediation": "1. Connect to the DB2 database. db2 => connect to $DB2DATABASE user $USERNAME using $PASSWORD  208 | P a g e 2. Review the system tablespaces to identify any user data objects within them. 3. Drop, migrate, or otherwise remove all user data objects (tables, schemas, etc.) from within the system tablespaces. 4. Revoke write access for the system tablespaces from all users.  209 | P a g e",
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "9.4",
    "title": "Remove Default Databases",
    "assessment": "Scored",
    "description": "A DB2 instance may come installed with default databases. It is recommended that the SAMPLE database be removed.",
    "rationale": "Removing unused, well-known databases will reduce the attack surface of the system.",
    "audit": "Perform the following DB2 commands to obtain the list of databases: 1. Attach to the DB2 instance. db2 => attach to $DB2INSTANCE 2. Run the following command from the DB2 command window: db2 => list database directory 3. Locate this value in the output: db2 => Database 3 entry: Database alias                       = SAMPLE Database name                        = SAMPLE Local database directory             = C: Database release level               = c.00 Comment = Directory entry type       = Indirect Catalog database partition number    = 0 Alternate server hostname            =  210 | P a g e 4. Review the output above and identify the SAMPLE database.  If there is no SAMPLE database, then it is considered a successful finding.",
    "remediation": "Drop unused sample databases: 1. Connect to the DB2 instance. 2. Run the following command from the DB2 command window: db2 => drop database sample  211 | P a g e",
    "function_names": [
      "db2_instance_default_databases_removed",
      "db2_instance_sample_database_removed",
      "db2_database_default_instances_removed",
      "db2_database_sample_instance_removed",
      "db2_instance_unused_databases_removed"
    ],
    "profile_applicability": "\u2022  Level 1 - RDBMS \u2022  Level 2 - RDBMS \u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "9.5",
    "title": "Enable SSL communication with LDAP server",
    "assessment": "Scored",
    "description": "The communication layer between a DB2 instance and the LDAP server should be encrypted. It is recommended that the ENABLE_SSL parameter in the IBMLDAPSecurity.ini file be set to TRUE.",
    "rationale": "Enabling SSL will help ensure the confidentiality of authentication credentials and other information that is sent between the DB2 instance and the LDAP server. Note : The file is located under INSTANCE_HOME/sqllib/cfg/, for Linux; and %DB2PATH%\\cfg\\, for Windows.",
    "audit": "Perform the following commands to obtain the parameter setting: 1. Connect to the DB2 host 2. Edit the IBMLDAPSecurity.ini file 3. Verify the existence of this parameter: ENABLE_SSL = TRUE",
    "remediation": "Verify the parameter: 1. Connect to the DB2 host 2. Edit the IBMLDAPSecurity.ini file 3. Add or modify the file to include the following parameter: ENABLE_SSL = TRUE  212 | P a g e Default Value: The default value is the omission of this parameter.  213 | P a g e",
    "function_names": [
      "db2_ldap_ssl_enabled",
      "db2_ldap_encryption_required",
      "db2_ldap_secure_communication",
      "db2_ldap_tls_enabled",
      "db2_ldap_connection_encrypted"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "9.6",
    "title": "Secure the permission of the IBMLDAPSecurity.ini file",
    "assessment": "Scored",
    "description": "The IBMLDAPSecurity.ini file contains the IBM LDAP security plug-in configurations.",
    "rationale": "Recommended value is read and write access to DB2 administrators only and read-only to Everyone/Other/Users/Domain Users. This will ensure that the parameter file is protected. Note : the file is located under INSTANCE_HOME/sqllib/cfg/, for Linux; and %DB2PATH%\\cfg\\, for Windows.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: For Windows: 1. Connect to the DB2 host 2. Right-click over the file directory 3. Choose Properties 4. Select the Security tab 5. Review access for all accounts For Linux: 1. Connect to the DB2 host 2. Change to the file directory 3. Check the permissions of the directory OS => ls -al   214 | P a g e",
    "remediation": "For Windows: 1. Connect to the DB2 host 2. Right-click over the file directory 3. Choose Properties 4. Select the Security tab 5. Select all administrator accounts and grant them Read and Write authority only (revoke all others). 6. Select all non-administrator accounts and grant them Read authority only (revoke all others). For Linux: 1. Connect to the DB2 host 2. Change to the file directory 3. Change the permission level of the directory OS => chmod -R 664  215 | P a g e",
    "function_names": [
      "ldap_config_file_permissions_secure",
      "ldap_config_file_ownership_correct",
      "ldap_config_file_world_writable_disabled",
      "ldap_config_file_group_writable_restricted",
      "ldap_config_file_strict_permissions_enforced",
      "ldap_config_file_unauthorized_access_prevented",
      "ldap_config_file_encryption_enabled",
      "ldap_config_file_backup_protected",
      "ldap_config_file_integrity_verified",
      "ldap_config_file_default_permissions_removed"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "9.7",
    "title": "Secure the permission of the SSLconfig.ini file",
    "assessment": "Scored",
    "description": "The SSLconfig.ini file contains the SSL configuration parameters for the DB2 instance, including the password for KeyStore.",
    "rationale": "Recommended value is full access to DB2 administrators only, read and write access only to members of the SYSADM group, and no access to other users. This will ensure that the parameter file is protected. Note : the file is located under INSTANCE_HOME/sqllib/cfg/, for Linux; and %INSTHOME%\\, for Windows.",
    "audit": "Perform the following DB2 commands to obtain the value for this setting: For Windows: 1. Connect to the DB2 host 2. Right-click over the file directory 3. Choose Properties 4. Select the Security tab 5. Review access for all accounts For Linux: 1. Connect to the DB2 host 2. Change to the file directory 3. Check the permissions of the directory  216 | P a g e OS => ls -al",
    "remediation": "For Windows: 1. Connect to the DB2 host 2. Right-click over the file directory 3. Choose Properties 4. Select the Security tab 5. Select all administrator accounts and grant them the Full Control authority 6. Select the SYSADM group and grant it Read and Write authority only (revoke all others) 7. Select all other accounts and revoke all privileges to the directory For Unix: 1. Connect to the DB2 host 2. Change to the file directory 3. Change the permission level of the directory OS => chmod -R 760  217 | P a g e",
    "function_names": [
      "db2_ssl_config_file_permissions_restricted",
      "db2_ssl_config_file_secure_ownership",
      "db2_ssl_config_file_read_write_restricted",
      "db2_ssl_config_file_world_accessible_disabled",
      "db2_ssl_config_file_group_access_restricted",
      "db2_ssl_config_file_password_protected",
      "db2_ssl_config_file_encryption_enabled",
      "db2_ssl_config_file_unauthorized_access_blocked"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "9.8",
    "title": "Ensure Trusted Contexts are enabled",
    "assessment": "Not Scored",
    "description": "A Trusted Context object provides a means of enforcing encryption, assigning privileges based on roles, and ensuring that the actions performed on behalf of a user are performed in the context of the user\u2019s ID and privileges.",
    "rationale": "Creating Trusted Context objects to enforce encryption and assign roles will protect data in transit and limit access to information on a per user/role basis. Additionally, it ensures actions can be traced back to the user.",
    "audit": "Issue the following command to verify that a Trusted Context object is enabled: select contextname, enabled from syscat.contexts where enabled = 'Y'",
    "remediation": "If there is no enabled Trusted Context object, create a Trusted Context object if needed and enable it. References: 1. http://www.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw. admin.sec.doc/doc/c0050514.html  218 | P a g e",
    "function_names": [
      "iam_trusted_context_enabled",
      "iam_trusted_context_encryption_enabled",
      "iam_trusted_context_role_based_privileges_enabled",
      "iam_trusted_context_user_id_enforced",
      "iam_trusted_context_privileges_enforced"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw. admin.sec.doc/doc/c0050514.html  218 | P a g e"
  },
  {
    "id": "9.9",
    "title": "Secure plug-in library locations",
    "assessment": "Not Scored",
    "description": "Whether developing your own security plug-ins or migrating established plug-ins into your environment, it is important to ensure that the plug-in directories are secure.",
    "rationale": "If plug-in directories are not secure, the plug-ins could be misused, tampered with, or otherwise accessed in ways that could jeopardize the security of the server.",
    "audit": "Linux 32-bit: Review the privileges assigned to the plug-in directories to ensure they are set to 755. \u2022 For client-side plug-ins: $DB2PATH/security32/plugin/client \u2022 For server-side plug-ins: $DB2PATH/security32/plugin/server \u2022 For group plug-ins: $DB2PATH/security32/plugin/group Linux 64-bit: Review the privileges assigned to the plug-in directories to ensure they are set to 755. \u2022 For client-side plug-ins: $DB2PATH/security64/plugin/client \u2022 For server-side plug-ins: $DB2PATH/security64/plugin/server \u2022 For group plug-ins: $DB2PATH/security64/plugin/group   219 | P a g e Windows 32-bit and 64-bit: Review the privileges assigned to the plug-in directories to ensure they are set to 755. Note: The sub-directories 'instance name' and 'client', 'server', and 'group' are not created automatically. The instance owner has to manually create them. \u2022 For client-side plug-ins: $DB2PATH\\security\\plugin\\instance name\\client \u2022 For server-side plug-ins: $DB2PATH\\security\\plugin\\instance name\\server \u2022 For group plug-ins: $DB2PATH\\security\\plugin\\instance name\\group",
    "remediation": "Change the privileges for all plug-in directories so they are set to 755. On a Linux system, perform the following for each directory needing its privileges changed: [db2inst1@tgt-db2-101-abc123 IBM]$ chmod 755 <directory>   220 | P a g e",
    "function_names": [
      "compute_plugin_library_secure_location",
      "compute_plugin_directory_restricted_permissions",
      "compute_plugin_library_integrity_monitoring_enabled",
      "compute_plugin_directory_owner_validated",
      "compute_plugin_library_immutable_files_enabled",
      "compute_plugin_directory_audit_logging_enabled",
      "compute_plugin_library_signature_verification_enabled",
      "compute_plugin_directory_network_isolation_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS"
  },
  {
    "id": "9.10",
    "title": "Ensure that security plug-in support for two-part user IDs is enabled",
    "assessment": "Not Scored",
    "description": "The DB2 database manager on Windows supports the use of two-part user IDs and the mapping of two-part user IDs to two-part authorization IDs.",
    "rationale": "Having a two-part authorization scheme increases the security of user IDs by making them harder to compromise.",
    "audit": "Issue the following command and confirm that the clnt_pw_plugin, srvcon_gssplugin_list, and srvcon_pw_plugin parameters are all set to 'DISABLED': db2=> select name, case when ((name = 'srvcon_pw_plugin' AND value in ('IBMOSauthserverTwoPart','IBMOSauthserverTwoPart64')) AND (name = 'clnt_pw_plugin' and value in ('IBMOSauthclientTwoPart','IBMOSauthclientTwoPart64'))) OR ((name = 'srvcon_gssplugin_list' AND value in ('IBMOSkrb5TwoPart','IBMOSkrb5TwoPart64')) AND (name = 'clnt_krb_plugin' and value in ('IBMkrb5TwoPart','IBMkrb5TwoPart64')))then 'ENABLED' else 'DISABLED' end as Status from sysibmadm.dbmcfg where (name = 'srvcon_pw_plugin' OR name = 'srvcon_gssplugin_list' OR name = 'clnt_pw_plugin')   221 | P a g e",
    "remediation": "To enable server authentication that maps two-part user IDs to two-part authorization IDs, you must set: \u2022 srvcon_pw_plugin to IBMOSauthserverTwoPart \u2022 clnt_pw_plugin to IBMOSauthclientTwoPart To enable client authentication that maps two-part user IDs to two-part authorization IDs, you must set: \u2022 srvcon_pw_plugin to IBMOSauthserverTwoPart \u2022 clnt_pw_plugin to IBMOSauthclientTwoPart To enable Kerberos authentication that maps two-part user IDs to two-part authorization IDs, you must set: \u2022 srvcon_gssplugin_list to IBMOSkrb5TwoPart \u2022 clnt_krb_plugin to IBMkrb5TwoPart For example: db2=> update dbm cfg using srvcon_pw_plugin IBMOSauthserverTwoPart References: 1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0012039.html  222 | P a g e",
    "function_names": [
      "db2_database_manager_two_part_user_ids_enabled",
      "db2_database_manager_security_plugin_support_enabled",
      "db2_user_auth_two_part_ids_enabled",
      "db2_auth_two_part_mapping_enabled",
      "db2_security_plugin_two_part_support_enabled"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www- 01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.sec .doc/doc/c0012039.html  222 | P a g e"
  },
  {
    "id": "9.11",
    "title": "Ensure permissions on communication exit library locations",
    "assessment": "Not Scored",
    "description": "DB2 communication exit libraries must exist in specific directories. There should be proper permissions on these directories.",
    "rationale": "If the permissions on the DB2 communication exit library directories are not set properly, the contents of those directories could be misused, tampered with, or otherwise accessed to negatively impact the security of the server.",
    "audit": "Linux 64-bit: Issue the following command to check the permissions for the communication exit library: [db2inst1@tgt-db2-101-abcd plugin]$ ll /opt/ibm/db2/V10.5/security64/plugin total 12 drwxr-x--- 2 db2iadm1 db2inst1 4096 Aug 17  2013 commexit  223 | P a g e",
    "remediation": "The database manager looks for communication exit libraries in the following directories: \u2022 Linux 32-bit: $DB2PATH/security32/plugin/commexit \u2022 Linux 64-bit: $DB2PATH/security64/plugin/commexit \u2022 Windows 32-bit and 64-bit: $DB2PATH\\security\\plugin\\commexit\\instance_name After locating the directory, update its permissions. The following is an example for a Linux 64-bit system: [db2inst1@tgt-db2-101-abcd plugin]$ pwd /opt/ibm/db2/V10.5/security64/plugin [db2inst1@tgt-db2-101-abcd IBM]$ chmod -R 750 commexit References: 1. http://www.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw. admin.sec.doc/doc/c0060264.html  224 | P a g e",
    "function_names": [
      "db2_communication_exit_library_location_permissions",
      "db2_communication_exit_library_directory_restricted",
      "db2_communication_exit_library_directory_permissions",
      "db2_communication_exit_library_location_secure",
      "db2_communication_exit_library_directory_protected"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw. admin.sec.doc/doc/c0060264.html  224 | P a g e"
  },
  {
    "id": "9.12",
    "title": "Ensure audit policies are enabled within the database",
    "assessment": "Not Scored",
    "description": "Creating and applying audit policies is crucial for securing and discovering issues within your databases. Audit policies can help trigger events for changes to data objects, table DML, and user access.",
    "rationale": "If audit policies are not enabled, issues may go undiscovered, and compromises and other incidents may occur without being quickly detected. It may also not be possible to provide evidence of compliance with security laws, regulations, and other requirements.",
    "audit": "Issue the following command to ensure that at least one audit policy returns an auditstatus not equal to 'N'. The assumption is that if there is an active policy, then information is being captured to audit. db2=> select auditpolicyname, auditstatus from syscat.auditpolicies",
    "remediation": "Issue the following command to create an audit policy: db2=> create audit policy AUDIT_TEST CATEGORIES ALL STATUS BOTH References: 1. http://www.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw. sql.ref.doc/doc/r0050607.html   225 | P a g e Appendix: Summary Table Control Set Correctly Yes No 1 Installation and Patches 1.1 Install the latest fix packs (Not Scored) \uf06f \uf06f 1.2 Use IP address rather than hostname (Scored) \uf06f \uf06f 1.3 Leverage the least privilege principle (Not Scored) \uf06f \uf06f 1.4 Use non-default account names (Scored) \uf06f \uf06f 1.5 Configure DB2 to use non-standard ports (Not Scored) \uf06f \uf06f 1.6 Creating the database with the RESTERICTIVE clause (Not Scored) \uf06f \uf06f 2 DB2 Directory and File Permissions 2.1 Secure DB2 Runtime Library (Scored) \uf06f \uf06f 2.2 Secure the database container directory (Scored) \uf06f \uf06f 2.3 Set umask value for DB2 admin user .profile file (Scored) \uf06f \uf06f 2.4 Verify the groups within the DB2_GRP_LOOKUP environment variable are appropriate (Windows only) (Not Scored) \uf06f \uf06f 2.5 Verify the domains within the DB2DOMAINLIST environment variable are appropriate (Windows only) (Not Scored) \uf06f \uf06f 3 DB2 Configurations 3.1 DB2 Instance Parameter Settings 3.1.1 Enable audit buffer (Scored) \uf06f \uf06f 3.1.2 Encrypt user data across the network (Scored) \uf06f \uf06f 3.1.3 Require explicit authorization for cataloging (Scored) \uf06f \uf06f 3.1.4 Disable datalinks support (Scored) \uf06f \uf06f 3.1.5 Secure permissions for default database file path (Scored) \uf06f \uf06f 3.1.6 Set diagnostic logging to capture errors and warnings (Scored) \uf06f \uf06f 3.1.7 Secure permissions for all diagnostic logs (Scored) \uf06f \uf06f 3.1.8 Require instance name for discovery requests (Scored) \uf06f \uf06f 3.1.9 Disable instance discoverability (Scored) \uf06f \uf06f 3.1.10 Authenticate federated users at the instance level (Scored) \uf06f \uf06f 3.1.11 Set maximum connection limits (Scored) \uf06f \uf06f 3.1.12 Set administrative notification level (Scored) \uf06f \uf06f 3.1.13 Enable server-based authentication (Scored) \uf06f \uf06f 3.1.14 Set failed archive retry delay (Scored) \uf06f \uf06f 3.1.15 Auto-restart after abnormal termination (Scored) \uf06f \uf06f 3.1.16 Disable database discovery (Scored) \uf06f \uf06f 3.1.17 Secure permissions for the primary archive log location (Scored) \uf06f \uf06f  226 | P a g e 3.1.18 Secure permissions for the secondary archive log location (Scored) \uf06f \uf06f 3.1.19 Secure permissions for the tertiary archive log location (Scored) \uf06f \uf06f 3.1.20 Secure permissions for the log mirror location (Scored) \uf06f \uf06f 3.1.21 Establish retention set size for backups (Scored) \uf06f \uf06f 3.1.22 Set archive log failover retry limit (Scored) \uf06f \uf06f 3.2 Database Manager Configuration parameters 3.2.1 TCP/IP service name - svcename (Scored) \uf06f \uf06f 3.2.2 SSL service name - ssl_svcename (Scored) \uf06f \uf06f 3.2.3 Authentication type for incoming connections at the server - srvcon_auth (Scored) \uf06f \uf06f 3.2.4 Database Manager Configuration parameter: trust_allclnts (Not Scored) \uf06f \uf06f 3.2.5 Database Manager Configuration parameter: trust_clntauth (Not Scored) \uf06f \uf06f 4 Row and Column Access Control (RCAC) 4.1 Review Organization's Policies against DB2 RCAC Policies (Not Scored) \uf06f \uf06f 4.2 Secure SECADM Authority (Not Scored) \uf06f \uf06f 4.3 Review Users, Groups, and Roles (Not Scored) \uf06f \uf06f 4.4 Review Row Permission logic according to policy (Not Scored) \uf06f \uf06f 4.5 Review Column Mask logic according to policy (Not Scored) \uf06f \uf06f 5 Database Maintenance 5.1 Enable Backup Redundancy (Not Scored) \uf06f \uf06f 5.2 Protecting Backups (Not Scored) \uf06f \uf06f 5.3 Enable Automatic Database Maintenance (Scored) \uf06f \uf06f 6 Securing Database Objects 6.1 Restrict Access to SYSCAT.AUDITPOLICIES (Scored) \uf06f \uf06f 6.2 Restrict Access to SYSCAT.AUDITUSE (Scored) \uf06f \uf06f 6.3 Restrict Access to SYSCAT.DBAUTH (Scored) \uf06f \uf06f 6.4 Restrict Access to SYSCAT.COLAUTH (Scored) \uf06f \uf06f 6.5 Restrict Access to SYSCAT.EVENTS (Scored) \uf06f \uf06f 6.6 Restrict Access to SYSCAT.EVENTTABLES (Scored) \uf06f \uf06f 6.7 Restrict Access to SYSCAT.ROUTINES (Scored) \uf06f \uf06f 6.8 Restrict Access to SYSCAT.INDEXAUTH (Scored) \uf06f \uf06f 6.9 Restrict Access to SYSCAT.PACKAGEAUTH (Scored) \uf06f \uf06f 6.10 Restrict Access to SYSCAT.PACKAGES (Scored) \uf06f \uf06f 6.11 Restrict Access to SYSCAT.PASSTHRUAUTH (Scored) \uf06f \uf06f 6.12 Restrict Access to SYSCAT.SECURITYPOLICIES (Scored) \uf06f \uf06f 6.13 Restrict Access to SYSCAT.SECURITYPOLICYEXEMPTIONS (Scored) \uf06f \uf06f  227 | P a g e 6.14 Restrict Access to SYSCAT.SURROGATEAUTHIDS (Scored) \uf06f \uf06f 6.15 Restrict Access to SYSCAT.ROLEAUTH (Scored) \uf06f \uf06f 6.16 Restrict Access to SYSCAT.ROLES (Scored) \uf06f \uf06f 6.17 Restrict Access to SYSCAT.ROUTINEAUTH (Scored) \uf06f \uf06f 6.18 Restrict Access to SYSCAT.SCHEMAAUTH (Scored) \uf06f \uf06f 6.19 Restrict Access to SYSCAT.SCHEMATA (Scored) \uf06f \uf06f 6.20 Restrict Access to SYSCAT.SEQUENCEAUTH (Scored) \uf06f \uf06f 6.21 Restrict Access to SYSCAT.STATEMENTS (Scored) \uf06f \uf06f 6.22 Restrict Access to SYSCAT.TABAUTH (Scored) \uf06f \uf06f 6.23 Restrict Access to SYSCAT.TBSPACEAUTH (Scored) \uf06f \uf06f 6.24 Restrict Access to Tablespaces (Scored) \uf06f \uf06f 6.25 Restrict Access to SYSCAT.MODULEAUTH (Scored) \uf06f \uf06f 6.26 Restrict Access to SYSCAT.VARIABLEAUTH (Scored) \uf06f \uf06f 6.27 Restrict Access to SYSCAT.WORKLOADAUTH (Scored) \uf06f \uf06f 6.28 Restrict Access to SYSCAT.XSROBJECTAUTH (Scored) \uf06f \uf06f 6.29 Restrict Access to SYSCAT.AUTHORIZATIONIDS (Scored) \uf06f \uf06f 6.30 Restrict Access to SYSIBMADM.OBJECTOWNERS (Scored) \uf06f \uf06f 6.31 Restrict Access to SYSIBMADM.PRIVILEGES (Scored) \uf06f \uf06f 7 DB2 Authorities 7.1 Secure SYSADM authority (Scored) \uf06f \uf06f 7.2 Secure SYSCTRL authority (Scored) \uf06f \uf06f 7.3 Secure SYSMAINT Authority (Scored) \uf06f \uf06f 7.4 Secure SYSMON Authority (Scored) \uf06f \uf06f 7.5 Secure SECADM Authority (Scored) \uf06f \uf06f 7.6 Secure DBADM Authority (Scored) \uf06f \uf06f 7.7 Secure SQLADM Authority (Scored) \uf06f \uf06f 7.8 Secure DATAACCESS Authority (Scored) \uf06f \uf06f 7.9 Secure ACCESSCTRL Authority (Scored) \uf06f \uf06f 7.10 Secure WLMADM authority (Scored) \uf06f \uf06f 7.11 Secure CREATAB Authority (Scored) \uf06f \uf06f 7.12 Secure BINDADD Authority (Scored) \uf06f \uf06f 7.13 Secure CONNECT Authority (Scored) \uf06f \uf06f 7.14 Secure LOAD Authority (Scored) \uf06f \uf06f 7.15 Secure EXTERNALROUTINE Authority (Scored) \uf06f \uf06f 7.16 Secure QUIESCECONNECT Authority (Scored) \uf06f \uf06f 8 DB2 Roles 8.1 Review Roles (Scored) \uf06f \uf06f 8.2 Review Role Members (Scored) \uf06f \uf06f 8.3 Nested Roles (Scored) \uf06f \uf06f 8.4 Review Roles granted to PUBLIC (Scored) \uf06f \uf06f 8.5 Review Role Grantees with WITH ADMIN OPTION (Scored) \uf06f \uf06f 9 General Policy and Procedures  228 | P a g e 9.1 Start and Stop DB2 Instance (Not Scored) \uf06f \uf06f 9.2 Remove Unused Schemas (Not Scored) \uf06f \uf06f 9.3 Review System Tablespaces (Scored) \uf06f \uf06f 9.4 Remove Default Databases (Scored) \uf06f \uf06f 9.5 Enable SSL communication with LDAP server (Scored) \uf06f \uf06f 9.6 Secure the permission of the IBMLDAPSecurity.ini file (Scored) \uf06f \uf06f 9.7 Secure the permission of the SSLconfig.ini file (Scored) \uf06f \uf06f 9.8 Ensure Trusted Contexts are enabled (Not Scored) \uf06f \uf06f 9.9 Secure plug-in library locations (Not Scored) \uf06f \uf06f 9.10 Ensure that security plug-in support for two-part user IDs is enabled (Not Scored) \uf06f \uf06f 9.11 Ensure permissions on communication exit library locations (Not Scored) \uf06f \uf06f 9.12 Ensure audit policies are enabled within the database (Not Scored) \uf06f \uf06f    229 | P a g e  Appendix: Change History Date Version Changes for this version 12-19-2015 1.0.0 Initial Release 08-05-2016 1.1.0 Ticket # 144: Added a recommendation for DB2 to use non-standard ports. 08-10-2016 1.1.0 Ticket # 141:  Added a recommendation for Trusted Contexts. 08-10-2016 1.1.0 Ticket # 148: Added a recommendation for the trust_allclnts parameter. 08-10-2016 1.1.0 Ticket # 152: Added a recommendation for secure plug-in library locations. 08-10-2016 1.1.0 Ticket # 155: Added a recommendation for security plug-in support of two-part user IDs. 08-10-2016 1.1.0 Ticket # 156: Added a recommendation for the communication exit library location. 08-10-2016 1.1.0 Ticket # 157: Added a recommendation for enabling audit policies. 08-10-2016 1.1.0 Ticket # 159: Added a recommendation for the DB2_GRP_LOOKUP environmental variable. 08-10-2016 1.1.0 Ticket # 160: Added a recommendation for the DB2DOMAINLIST environmental variable. 08-17-2016 1.1.0 Ticket # 146: Added a recommendation for the RESTRICTIVE parameter.    230 | P a g e",
    "function_names": [
      "database_audit_policy_enabled",
      "database_audit_policy_logging_enabled",
      "database_audit_policy_data_events_enabled",
      "database_audit_policy_dml_events_enabled",
      "database_audit_policy_user_access_enabled",
      "database_audit_policy_all_events_enabled",
      "database_audit_policy_retention_enabled",
      "database_audit_policy_retention_over_90d"
    ],
    "profile_applicability": "\u2022  Level 1 - Windows Host OS \u2022  Level 2 - Windows Host OS \u2022  Level 1 - Linux Host OS \u2022  Level 2 - Linux Host OS",
    "references": "1. http://www.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw. sql.ref.doc/doc/r0050607.html   225 | P a g e Appendix: Summary Table Control Set Correctly Yes No 1 Installation and Patches 1.1 Install the latest fix packs (Not Scored) \uf06f \uf06f 1.2 Use IP address rather than hostname (Scored) \uf06f \uf06f 1.3 Leverage the least privilege principle (Not Scored) \uf06f \uf06f 1.4 Use non-default account names (Scored) \uf06f \uf06f 1.5 Configure DB2 to use non-standard ports (Not Scored) \uf06f \uf06f 1.6 Creating the database with the RESTERICTIVE clause (Not Scored) \uf06f \uf06f 2 DB2 Directory and File Permissions 2.1 Secure DB2 Runtime Library (Scored) \uf06f \uf06f 2.2 Secure the database container directory (Scored) \uf06f \uf06f 2.3 Set umask value for DB2 admin user .profile file (Scored) \uf06f \uf06f 2.4 Verify the groups within the DB2_GRP_LOOKUP environment variable are appropriate (Windows only) (Not Scored) \uf06f \uf06f 2.5 Verify the domains within the DB2DOMAINLIST environment variable are appropriate (Windows only) (Not Scored) \uf06f \uf06f 3 DB2 Configurations 3.1 DB2 Instance Parameter Settings 3.1.1 Enable audit buffer (Scored) \uf06f \uf06f 3.1.2 Encrypt user data across the network (Scored) \uf06f \uf06f 3.1.3 Require explicit authorization for cataloging (Scored) \uf06f \uf06f 3.1.4 Disable datalinks support (Scored) \uf06f \uf06f 3.1.5 Secure permissions for default database file path (Scored) \uf06f \uf06f 3.1.6 Set diagnostic logging to capture errors and warnings (Scored) \uf06f \uf06f 3.1.7 Secure permissions for all diagnostic logs (Scored) \uf06f \uf06f 3.1.8 Require instance name for discovery requests (Scored) \uf06f \uf06f 3.1.9 Disable instance discoverability (Scored) \uf06f \uf06f 3.1.10 Authenticate federated users at the instance level (Scored) \uf06f \uf06f 3.1.11 Set maximum connection limits (Scored) \uf06f \uf06f 3.1.12 Set administrative notification level (Scored) \uf06f \uf06f 3.1.13 Enable server-based authentication (Scored) \uf06f \uf06f 3.1.14 Set failed archive retry delay (Scored) \uf06f \uf06f 3.1.15 Auto-restart after abnormal termination (Scored) \uf06f \uf06f 3.1.16 Disable database discovery (Scored) \uf06f \uf06f 3.1.17 Secure permissions for the primary archive log location (Scored) \uf06f \uf06f  226 | P a g e 3.1.18 Secure permissions for the secondary archive log location (Scored) \uf06f \uf06f 3.1.19 Secure permissions for the tertiary archive log location (Scored) \uf06f \uf06f 3.1.20 Secure permissions for the log mirror location (Scored) \uf06f \uf06f 3.1.21 Establish retention set size for backups (Scored) \uf06f \uf06f 3.1.22 Set archive log failover retry limit (Scored) \uf06f \uf06f 3.2 Database Manager Configuration parameters 3.2.1 TCP/IP service name - svcename (Scored) \uf06f \uf06f 3.2.2 SSL service name - ssl_svcename (Scored) \uf06f \uf06f 3.2.3 Authentication type for incoming connections at the server - srvcon_auth (Scored) \uf06f \uf06f 3.2.4 Database Manager Configuration parameter: trust_allclnts (Not Scored) \uf06f \uf06f 3.2.5 Database Manager Configuration parameter: trust_clntauth (Not Scored) \uf06f \uf06f 4 Row and Column Access Control (RCAC) 4.1 Review Organization's Policies against DB2 RCAC Policies (Not Scored) \uf06f \uf06f 4.2 Secure SECADM Authority (Not Scored) \uf06f \uf06f 4.3 Review Users, Groups, and Roles (Not Scored) \uf06f \uf06f 4.4 Review Row Permission logic according to policy (Not Scored) \uf06f \uf06f 4.5 Review Column Mask logic according to policy (Not Scored) \uf06f \uf06f 5 Database Maintenance 5.1 Enable Backup Redundancy (Not Scored) \uf06f \uf06f 5.2 Protecting Backups (Not Scored) \uf06f \uf06f 5.3 Enable Automatic Database Maintenance (Scored) \uf06f \uf06f 6 Securing Database Objects 6.1 Restrict Access to SYSCAT.AUDITPOLICIES (Scored) \uf06f \uf06f 6.2 Restrict Access to SYSCAT.AUDITUSE (Scored) \uf06f \uf06f 6.3 Restrict Access to SYSCAT.DBAUTH (Scored) \uf06f \uf06f 6.4 Restrict Access to SYSCAT.COLAUTH (Scored) \uf06f \uf06f 6.5 Restrict Access to SYSCAT.EVENTS (Scored) \uf06f \uf06f 6.6 Restrict Access to SYSCAT.EVENTTABLES (Scored) \uf06f \uf06f 6.7 Restrict Access to SYSCAT.ROUTINES (Scored) \uf06f \uf06f 6.8 Restrict Access to SYSCAT.INDEXAUTH (Scored) \uf06f \uf06f 6.9 Restrict Access to SYSCAT.PACKAGEAUTH (Scored) \uf06f \uf06f 6.10 Restrict Access to SYSCAT.PACKAGES (Scored) \uf06f \uf06f 6.11 Restrict Access to SYSCAT.PASSTHRUAUTH (Scored) \uf06f \uf06f 6.12 Restrict Access to SYSCAT.SECURITYPOLICIES (Scored) \uf06f \uf06f 6.13 Restrict Access to SYSCAT.SECURITYPOLICYEXEMPTIONS (Scored) \uf06f \uf06f  227 | P a g e 6.14 Restrict Access to SYSCAT.SURROGATEAUTHIDS (Scored) \uf06f \uf06f 6.15 Restrict Access to SYSCAT.ROLEAUTH (Scored) \uf06f \uf06f 6.16 Restrict Access to SYSCAT.ROLES (Scored) \uf06f \uf06f 6.17 Restrict Access to SYSCAT.ROUTINEAUTH (Scored) \uf06f \uf06f 6.18 Restrict Access to SYSCAT.SCHEMAAUTH (Scored) \uf06f \uf06f 6.19 Restrict Access to SYSCAT.SCHEMATA (Scored) \uf06f \uf06f 6.20 Restrict Access to SYSCAT.SEQUENCEAUTH (Scored) \uf06f \uf06f 6.21 Restrict Access to SYSCAT.STATEMENTS (Scored) \uf06f \uf06f 6.22 Restrict Access to SYSCAT.TABAUTH (Scored) \uf06f \uf06f 6.23 Restrict Access to SYSCAT.TBSPACEAUTH (Scored) \uf06f \uf06f 6.24 Restrict Access to Tablespaces (Scored) \uf06f \uf06f 6.25 Restrict Access to SYSCAT.MODULEAUTH (Scored) \uf06f \uf06f 6.26 Restrict Access to SYSCAT.VARIABLEAUTH (Scored) \uf06f \uf06f 6.27 Restrict Access to SYSCAT.WORKLOADAUTH (Scored) \uf06f \uf06f 6.28 Restrict Access to SYSCAT.XSROBJECTAUTH (Scored) \uf06f \uf06f 6.29 Restrict Access to SYSCAT.AUTHORIZATIONIDS (Scored) \uf06f \uf06f 6.30 Restrict Access to SYSIBMADM.OBJECTOWNERS (Scored) \uf06f \uf06f 6.31 Restrict Access to SYSIBMADM.PRIVILEGES (Scored) \uf06f \uf06f 7 DB2 Authorities 7.1 Secure SYSADM authority (Scored) \uf06f \uf06f 7.2 Secure SYSCTRL authority (Scored) \uf06f \uf06f 7.3 Secure SYSMAINT Authority (Scored) \uf06f \uf06f 7.4 Secure SYSMON Authority (Scored) \uf06f \uf06f 7.5 Secure SECADM Authority (Scored) \uf06f \uf06f 7.6 Secure DBADM Authority (Scored) \uf06f \uf06f 7.7 Secure SQLADM Authority (Scored) \uf06f \uf06f 7.8 Secure DATAACCESS Authority (Scored) \uf06f \uf06f 7.9 Secure ACCESSCTRL Authority (Scored) \uf06f \uf06f 7.10 Secure WLMADM authority (Scored) \uf06f \uf06f 7.11 Secure CREATAB Authority (Scored) \uf06f \uf06f 7.12 Secure BINDADD Authority (Scored) \uf06f \uf06f 7.13 Secure CONNECT Authority (Scored) \uf06f \uf06f 7.14 Secure LOAD Authority (Scored) \uf06f \uf06f 7.15 Secure EXTERNALROUTINE Authority (Scored) \uf06f \uf06f 7.16 Secure QUIESCECONNECT Authority (Scored) \uf06f \uf06f 8 DB2 Roles 8.1 Review Roles (Scored) \uf06f \uf06f 8.2 Review Role Members (Scored) \uf06f \uf06f 8.3 Nested Roles (Scored) \uf06f \uf06f 8.4 Review Roles granted to PUBLIC (Scored) \uf06f \uf06f 8.5 Review Role Grantees with WITH ADMIN OPTION (Scored) \uf06f \uf06f 9 General Policy and Procedures  228 | P a g e 9.1 Start and Stop DB2 Instance (Not Scored) \uf06f \uf06f 9.2 Remove Unused Schemas (Not Scored) \uf06f \uf06f 9.3 Review System Tablespaces (Scored) \uf06f \uf06f 9.4 Remove Default Databases (Scored) \uf06f \uf06f 9.5 Enable SSL communication with LDAP server (Scored) \uf06f \uf06f 9.6 Secure the permission of the IBMLDAPSecurity.ini file (Scored) \uf06f \uf06f 9.7 Secure the permission of the SSLconfig.ini file (Scored) \uf06f \uf06f 9.8 Ensure Trusted Contexts are enabled (Not Scored) \uf06f \uf06f 9.9 Secure plug-in library locations (Not Scored) \uf06f \uf06f 9.10 Ensure that security plug-in support for two-part user IDs is enabled (Not Scored) \uf06f \uf06f 9.11 Ensure permissions on communication exit library locations (Not Scored) \uf06f \uf06f 9.12 Ensure audit policies are enabled within the database (Not Scored) \uf06f \uf06f    229 | P a g e  Appendix: Change History Date Version Changes for this version 12-19-2015 1.0.0 Initial Release 08-05-2016 1.1.0 Ticket # 144: Added a recommendation for DB2 to use non-standard ports. 08-10-2016 1.1.0 Ticket # 141:  Added a recommendation for Trusted Contexts. 08-10-2016 1.1.0 Ticket # 148: Added a recommendation for the trust_allclnts parameter. 08-10-2016 1.1.0 Ticket # 152: Added a recommendation for secure plug-in library locations. 08-10-2016 1.1.0 Ticket # 155: Added a recommendation for security plug-in support of two-part user IDs. 08-10-2016 1.1.0 Ticket # 156: Added a recommendation for the communication exit library location. 08-10-2016 1.1.0 Ticket # 157: Added a recommendation for enabling audit policies. 08-10-2016 1.1.0 Ticket # 159: Added a recommendation for the DB2_GRP_LOOKUP environmental variable. 08-10-2016 1.1.0 Ticket # 160: Added a recommendation for the DB2DOMAINLIST environmental variable. 08-17-2016 1.1.0 Ticket # 146: Added a recommendation for the RESTRICTIVE parameter.    230 | P a g e"
  }
]