{
  "nist_aws_function_mapping": {
    "metadata": {
      "segment": "01_access_control_ac",
      "description": "NIST Access Control (AC) Family - AWS Function Mapping",
      "total_controls": 142,
      "mapping_status": "complete",
      "created": "2025-01-27",
      "priority": "HIGH"
    },
    "access_control_family": {
      "AC-1": {
        "title": "Policy and Procedures",
        "controls": {
          "AC-1-a": {
            "description": "Develop, document, and disseminate access control policy",
            "aws_functions": [],
            "manual_effort": "Policy documentation review and validation",
            "manual_details": "Review access control policies, procedures, and documentation for completeness and accuracy. Validate that policies address purpose, scope, roles, responsibilities, management commitment, coordination, and compliance requirements.",
            "compliance_level": "manual_only"
          },
          "AC-1-b": {
            "description": "Designate official to manage access control policy",
            "aws_functions": [],
            "manual_effort": "Role assignment and responsibility review",
            "manual_details": "Review organizational structure to ensure designated officials are assigned for access control policy management. Document roles and responsibilities.",
            "compliance_level": "manual_only"
          },
          "AC-1-c": {
            "description": "Review and update access control policy and procedures",
            "aws_functions": [],
            "manual_effort": "Policy review and update process",
            "manual_details": "Establish and maintain process for regular review and updates of access control policies and procedures. Document review frequency and triggers.",
            "compliance_level": "manual_only"
          }
        }
      },
      "AC-2": {
        "title": "Account Management",
        "controls": {
          "AC-2-a": {
            "description": "Define and document account types allowed and prohibited",
            "aws_functions": [
              "iam_user_existence_check",
              "iam_user_inventory_check",
              "iam_user_account_review"
            ],
            "manual_effort": "Account type policy review",
            "manual_details": "Review and validate account type definitions, document prohibited account types, and ensure policies are enforced.",
            "compliance_level": "function_plus_manual"
          },
          "AC-2-b": {
            "description": "Assign account managers",
            "aws_functions": [
              "iam_user_existence_check",
              "iam_user_inventory_check"
            ],
            "manual_effort": "Account manager assignment review",
            "manual_details": "Review account manager assignments, ensure proper role assignments, and validate accountability structure.",
            "compliance_level": "function_plus_manual"
          },
          "AC-2-c": {
            "description": "Require prerequisites and criteria for group and role membership",
            "aws_functions": [
              "iam_group_creation_check",
              "iam_role_existence_check",
              "iam_role_assume_policy_check"
            ],
            "manual_effort": "Membership criteria validation",
            "manual_details": "Review group and role membership criteria, validate prerequisites are enforced, and ensure proper approval processes.",
            "compliance_level": "function_plus_manual"
          },
          "AC-2-d": {
            "description": "Specify authorized users, group membership, and access authorizations",
            "aws_functions": [
              "iam_user_existence_check",
              "iam_user_inventory_check",
              "iam_user_group_only_permissions_check",
              "iam_user_policy_attachment_check",
              "iam_role_policy_check",
              "iam_role_permissions_policy_check"
            ],
            "manual_effort": "Access authorization review",
            "manual_details": "Review and validate user authorizations, group memberships, and access privileges. Ensure least privilege principles are followed.",
            "compliance_level": "function_plus_manual"
          },
          "AC-2-e": {
            "description": "Require approvals for account creation requests",
            "aws_functions": [
              "iam_user_creation_check",
              "iam_user_existence_check"
            ],
            "manual_effort": "Approval process review",
            "manual_details": "Review account creation approval processes, validate approval workflows, and ensure proper authorization.",
            "compliance_level": "function_plus_manual"
          },
          "AC-2-f": {
            "description": "Create, enable, modify, disable, and remove accounts according to policy",
            "aws_functions": [
              "iam_user_creation_check",
              "iam_user_existence_check",
              "iam_user_lifecycle_management_check",
              "iam_user_credentials_unused_check",
              "iam_user_access_last_used_check",
              "iam_user_accesskey_unused",
              "iam_inactive_user_account_check",
              "iam_terminated_user_access_revocation_check"
            ],
            "manual_effort": "Account lifecycle process review",
            "manual_details": "Review account lifecycle management processes, validate automation where possible, and ensure policy compliance.",
            "compliance_level": "function_plus_manual"
          },
          "AC-2-g": {
            "description": "Monitor the use of accounts",
            "aws_functions": [
              "iam_user_account_activity_monitoring",
              "iam_user_access_last_used_check",
              "iam_user_accesskey_unused",
              "iam_user_console_access_unused",
              "iam_user_credentials_unused_check"
            ],
            "manual_effort": "Account monitoring review",
            "manual_details": "Review account monitoring mechanisms, validate monitoring coverage, and ensure proper alerting.",
            "compliance_level": "function_plus_manual"
          },
          "AC-2-h": {
            "description": "Notify account managers of account changes",
            "aws_functions": [
              "iam_user_creation_check",
              "iam_user_existence_check",
              "iam_user_lifecycle_management_check"
            ],
            "manual_effort": "Notification process review",
            "manual_details": "Review notification mechanisms for account changes, validate notification delivery, and ensure proper escalation.",
            "compliance_level": "function_plus_manual"
          },
          "AC-2-i": {
            "description": "Authorize access based on valid authorization and intended usage",
            "aws_functions": [
              "iam_access_control_model_check",
              "iam_access_control_pre_production_check",
              "iam_policy_access_enforcement_check",
              "iam_policy_check_restricted_access"
            ],
            "manual_effort": "Access authorization validation",
            "manual_details": "Review access authorization mechanisms, validate authorization logic, and ensure proper access controls.",
            "compliance_level": "function_plus_manual"
          },
          "AC-2-j": {
            "description": "Review accounts for compliance with account management requirements",
            "aws_functions": [
              "iam_user_account_review",
              "iam_user_permissions_review",
              "iam_user_inventory_check"
            ],
            "manual_effort": "Account compliance review",
            "manual_details": "Review account compliance processes, validate review frequency, and ensure proper remediation.",
            "compliance_level": "function_plus_manual"
          },
          "AC-2-k": {
            "description": "Establish process for changing shared/group account authenticators",
            "aws_functions": [
              "iam_user_credentials_unused_check",
              "iam_user_accesskey_unused"
            ],
            "manual_effort": "Shared account process review",
            "manual_details": "Review shared account management processes, validate authenticator change procedures, and ensure proper controls.",
            "compliance_level": "function_plus_manual"
          },
          "AC-2-l": {
            "description": "Align account management with personnel termination and transfer",
            "aws_functions": [
              "iam_terminated_user_access_revocation_check",
              "iam_user_lifecycle_management_check"
            ],
            "manual_effort": "Personnel process alignment review",
            "manual_details": "Review personnel termination processes, validate account deactivation procedures, and ensure proper coordination.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-3": {
        "title": "Access Enforcement",
        "controls": {
          "AC-3-description": {
            "description": "Enforce approved authorizations for logical access to information and system resources",
            "aws_functions": [
              "iam_access_control_model_check",
              "iam_access_control_pre_production_check",
              "iam_policy_access_enforcement_check",
              "iam_policy_check_restricted_access",
              "iam_policy_condition_check",
              "iam_policy_granularity_check",
              "iam_policy_permission_check",
              "iam_policy_tag_based_access_check"
            ],
            "manual_effort": "Access enforcement testing",
            "manual_details": "Test access enforcement mechanisms, validate authorization logic, and verify least privilege implementation.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-4": {
        "title": "Information Flow Enforcement",
        "controls": {
          "AC-4(1)": {
            "description": "Object security attributes",
            "aws_functions": [
              "s3_bucket_acl_prohibited",
              "s3_bucket_policy_public_write_access",
              "s3_bucket_public_access",
              "s3_bucket_public_access_check"
            ],
            "manual_effort": "Object security review",
            "manual_details": "Review object security attributes, validate information flow controls, and ensure proper data classification.",
            "compliance_level": "function_plus_manual"
          },
          "AC-4(2)": {
            "description": "Processes to ensure information flow compliance",
            "aws_functions": [
              "vpc_network_segmentation_test_results_check",
              "vpc_segmentation_control_test_results_check"
            ],
            "manual_effort": "Information flow process review",
            "manual_details": "Review information flow compliance processes, validate flow controls, and ensure proper enforcement.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-5": {
        "title": "Separation of Duties",
        "controls": {
          "AC-5": {
            "description": "Separate duties of individuals",
            "aws_functions": [
              "iam_role_separation_check",
              "iam_role_separation_of_duties_check",
              "iam_role_administratoraccess_policy",
              "iam_role_cluster_admin_check",
              "iam_role_cluster_admin_usage_check",
              "iam_role_cross_account_readonlyaccess_policy",
              "iam_role_cross_service_confused_deputy_prevention"
            ],
            "manual_effort": "Separation of duties review",
            "manual_details": "Review role assignments, validate separation of duties, and ensure proper role segregation.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-6": {
        "title": "Least Privilege",
        "controls": {
          "AC-6": {
            "description": "Employ the principle of least privilege",
            "aws_functions": [
              "iam_least_privilege_policy_check",
              "iam_role_least_privilege_policy_check",
              "iam_user_least_privilege_policy_check",
              "iam_policy_no_full_admin_privileges",
              "iam_role_no_full_admin_privileges",
              "iam_user_no_full_admin_privileges",
              "iam_policy_no_full_access_to_cloudtrail",
              "iam_policy_no_full_access_to_kms",
              "iam_inline_policy_no_full_access_to_cloudtrail",
              "iam_inline_policy_no_full_access_to_kms",
              "iam_inline_policy_no_administrative_privileges",
              "iam_customer_attached_policy_no_administrative_privileges",
              "iam_customer_unattached_policy_no_administrative_privileges",
              "iam_aws_attached_policy_no_administrative_privileges",
              "iam_group_no_full_admin_privileges",
              "iam_role_minimize_wildcard_use"
            ],
            "manual_effort": "Least privilege assessment",
            "manual_details": "Review and validate least privilege implementation across all services, validate policy assignments, and ensure proper access controls.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-7": {
        "title": "Unsuccessful Logon Attempts",
        "controls": {
          "AC-7": {
            "description": "Limit unsuccessful logon attempts",
            "aws_functions": [
              "iam_invalid_login_attempts_logging_enabled",
              "cognito_user_pool_blocks_compromised_credentials_sign_in_attempts",
              "cognito_user_pool_blocks_potential_malicious_sign_in_attempts",
              "cognito_user_pool_failed_login_attempts_limit"
            ],
            "manual_effort": "Logon attempt monitoring review",
            "manual_details": "Review unsuccessful logon attempt handling, validate response procedures, and ensure proper monitoring.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-8": {
        "title": "System Use Notification",
        "controls": {
          "AC-8": {
            "description": "Display system use notification",
            "aws_functions": [
              "ec2_instance_user_data_banner_check"
            ],
            "manual_effort": "System notification review",
            "manual_details": "Review system use notifications and banners across all systems, validate notification content, and ensure proper display.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-9": {
        "title": "Previous Logon Notification",
        "controls": {
          "AC-9": {
            "description": "Notify user of previous logon",
            "aws_functions": [
              "iam_user_access_last_used_check",
              "cognito_user_pool_last_login_notification",
              "workspaces_user_last_access_check"
            ],
            "manual_effort": "Logon notification review",
            "manual_details": "Review previous logon notification mechanisms, validate notification effectiveness, and ensure proper user awareness.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-10": {
        "title": "Concurrent Session Control",
        "controls": {
          "AC-10": {
            "description": "Limit concurrent sessions",
            "aws_functions": [
              "iam_user_concurrent_session_limit_check",
              "iam_role_maximum_session_duration_check"
            ],
            "manual_effort": "Session control validation",
            "manual_details": "Test concurrent session controls, validate session duration limits, and ensure proper enforcement.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-11": {
        "title": "Session Lock",
        "controls": {
          "AC-11": {
            "description": "Lock session after inactivity",
            "aws_functions": [
              "ec2_instance_idle_session_termination",
              "ec2_instance_idle_timeout_check",
              "ec2_instance_session_disconnect_timeout",
              "ec2_instance_session_idle_disconnect_timeout",
              "rds_instance_session_disconnect_timeout",
              "rds_instance_session_idle_disconnect_timeout",
              "appstream_fleet_session_disconnect_timeout",
              "appstream_fleet_session_idle_disconnect_timeout",
              "streaming_connection_idle_timeout_check"
            ],
            "manual_effort": "Session lock testing",
            "manual_details": "Test session lock mechanisms, validate timeout configurations, and ensure proper session management.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-12": {
        "title": "Session Termination",
        "controls": {
          "AC-12": {
            "description": "Terminate session after inactivity",
            "aws_functions": [
              "ec2_instance_idle_session_termination",
              "ec2_instance_idle_timeout_check",
              "ec2_instance_session_disconnect_timeout",
              "ec2_instance_session_idle_disconnect_timeout"
            ],
            "manual_effort": "Session termination testing",
            "manual_details": "Test session termination mechanisms, validate timeout configurations, and ensure proper session cleanup.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-14": {
        "title": "Permitted Actions Without Identification or Authentication",
        "controls": {
          "AC-14": {
            "description": "Limit actions without identification or authentication",
            "aws_functions": [
              "s3_bucket_public_access",
              "s3_bucket_public_access_check",
              "s3_bucket_public_list_acl",
              "s3_bucket_public_write_acl",
              "s3_bucket_public_write_access",
              "ec2_instance_public_ip",
              "ec2_elastic_ip_shodan",
              "ec2_elastic_ip_unassigned",
              "lightsail_instance_public",
              "lightsail_database_public",
              "neptune_cluster_uses_public_subnet",
              "elasticache_cluster_uses_public_subnet",
              "rds_instance_public_access_check",
              "rds_cluster_public_snapshot",
              "documentdb_cluster_public_snapshot",
              "ec2_ebs_public_snapshot",
              "glacier_vaults_policy_public_access"
            ],
            "manual_effort": "Anonymous access review",
            "manual_details": "Review and validate all systems that permit actions without identification, ensure necessity, and implement proper controls.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-15": {
        "title": "Remote Access",
        "controls": {
          "AC-15": {
            "description": "Control remote access",
            "aws_functions": [
              "ec2_instance_remote_access_copy_restriction",
              "ec2_instance_ssh_access_restriction_check",
              "ec2_instance_rdp_access_restriction_check",
              "lightsail_instance_ssh_access_restriction_check",
              "lightsail_instance_rdp_access_restriction_check",
              "workspaces_web_access_disabled_check",
              "workspaces_interface_ports_inbound_traffic_check",
              "vpc_vpn_connection_tunnels_up",
              "ec2_vpn_connection_authorization_check",
              "ec2_vpn_connection_encryption_enabled"
            ],
            "manual_effort": "Remote access security review",
            "manual_details": "Review remote access controls, VPN configurations, access restrictions, and ensure proper security measures.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-16": {
        "title": "Access Control Markings",
        "controls": {
          "AC-16": {
            "description": "Mark information with access control markings",
            "aws_functions": [
              "ec2_instance_cde_tag_check",
              "rds_instance_cde_tag_check",
              "s3_bucket_cardholder_data_inventory_check",
              "s3_bucket_no_card_verification_code_storage",
              "s3_bucket_no_pin_storage",
              "dynamodb_table_no_card_verification_code_storage",
              "dynamodb_table_no_pin_storage",
              "s3_bucket_pan_detection_enabled",
              "rds_instance_pan_detection_enabled",
              "rds_instance_pan_unreadable_check",
              "rds_instance_sad_encryption_check",
              "rds_instance_sad_storage_check",
              "s3_bucket_sad_encryption_check",
              "s3_bucket_sad_storage_check",
              "cloudwatch_log_pan_masking_check",
              "iam_role_pan_display_access_check"
            ],
            "manual_effort": "Data classification review",
            "manual_details": "Review data classification markings, access control labels, and ensure proper data handling procedures.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-17": {
        "title": "Remote Access",
        "controls": {
          "AC-17": {
            "description": "Control remote access",
            "aws_functions": [
              "ec2_instance_remote_access_copy_restriction",
              "ec2_instance_ssh_access_restriction_check",
              "ec2_instance_rdp_access_restriction_check",
              "vpc_vpn_connection_tunnels_up",
              "ec2_vpn_connection_authorization_check",
              "ec2_vpn_connection_encryption_enabled",
              "vpc_endpoint_for_ec2_enabled",
              "vpc_endpoint_multi_az_enabled"
            ],
            "manual_effort": "Remote access architecture review",
            "manual_details": "Review remote access architecture, security controls, and ensure proper access management.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-18": {
        "title": "Wireless Access",
        "controls": {
          "AC-18": {
            "description": "Control wireless access",
            "aws_functions": [
              "ec2_list_authorized_wireless_access_points",
              "ec2_wireless_access_authorization_check",
              "ec2_wireless_access_configuration_check",
              "ec2_wireless_network_security_check",
              "ec2_instance_wireless_encryption_key_rotation"
            ],
            "manual_effort": "Wireless security review",
            "manual_details": "Review wireless access controls, security configurations, and ensure proper wireless network security.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-19": {
        "title": "Access Control for Mobile Devices",
        "controls": {
          "AC-19": {
            "description": "Control mobile device access",
            "aws_functions": [
              "ec2_mobile_device_authorization_check",
              "ec2_mobile_device_configuration_check"
            ],
            "manual_effort": "Mobile device policy review",
            "manual_details": "Review mobile device access controls, policies, and ensure proper mobile device management.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-20": {
        "title": "Use of External Information Systems",
        "controls": {
          "AC-20": {
            "description": "Control external system access",
            "aws_functions": [
              "ec2_external_system_access_check",
              "ec2_external_system_prohibition_check",
              "s3_bucket_cross_account_access",
              "dynamodb_table_cross_account_access",
              "vpc_peering_routing_tables_with_least_privilege"
            ],
            "manual_effort": "External system access review",
            "manual_details": "Review external system access controls, data handling procedures, and ensure proper access management.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-21": {
        "title": "Information Sharing",
        "controls": {
          "AC-21": {
            "description": "Control information sharing",
            "aws_functions": [
              "s3_bucket_sharing_authorization_check",
              "s3_bucket_sharing_mechanism_check",
              "servicecatalog_portfolio_shared_within_organization_only",
              "eventbridge_bus_cross_account_access",
              "eventbridge_schema_registry_cross_account_access"
            ],
            "manual_effort": "Information sharing policy review",
            "manual_details": "Review information sharing policies, procedures, and ensure proper data sharing controls.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-22": {
        "title": "Publicly Accessible Content",
        "controls": {
          "AC-22": {
            "description": "Control publicly accessible content",
            "aws_functions": [
              "s3_bucket_public_access",
              "s3_bucket_public_access_check",
              "s3_bucket_public_list_acl",
              "s3_bucket_public_write_acl",
              "s3_bucket_public_write_access",
              "ec2_instance_public_ip",
              "ec2_elastic_ip_shodan",
              "ec2_elastic_ip_unassigned",
              "lightsail_instance_public",
              "lightsail_database_public",
              "neptune_cluster_uses_public_subnet",
              "elasticache_cluster_uses_public_subnet",
              "rds_instance_public_access_check",
              "rds_cluster_public_snapshot",
              "documentdb_cluster_public_snapshot",
              "ec2_ebs_public_snapshot",
              "glacier_vaults_policy_public_access"
            ],
            "manual_effort": "Public content review",
            "manual_details": "Review all publicly accessible content, validate necessity, and ensure proper access controls.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-23": {
        "title": "Data Mining Protection",
        "controls": {
          "AC-23": {
            "description": "Protect against data mining",
            "aws_functions": [
              "macie_automated_sensitive_data_discovery_enabled",
              "macie_is_enabled",
              "s3_bucket_data_discovery",
              "s3_bucket_data_classification"
            ],
            "manual_effort": "Data mining protection review",
            "manual_details": "Review data mining protection mechanisms, data classification, and ensure proper data protection controls.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-24": {
        "title": "Access Control Decisions",
        "controls": {
          "AC-24": {
            "description": "Control access decision mechanisms",
            "aws_functions": [
              "iam_access_control_model_check",
              "iam_access_control_pre_production_check",
              "iam_policy_access_enforcement_check",
              "iam_policy_check_restricted_access",
              "iam_policy_condition_check",
              "iam_policy_granularity_check",
              "iam_policy_permission_check",
              "iam_policy_tag_based_access_check"
            ],
            "manual_effort": "Access control decision review",
            "manual_details": "Review access control decision mechanisms, validate decision logic, and ensure proper access controls.",
            "compliance_level": "function_plus_manual"
          }
        }
      },
      "AC-25": {
        "title": "Reference Monitor",
        "controls": {
          "AC-25": {
            "description": "Implement reference monitor",
            "aws_functions": [
              "iam_access_control_model_check",
              "iam_access_control_pre_production_check",
              "iam_policy_access_enforcement_check",
              "iam_policy_check_restricted_access"
            ],
            "manual_effort": "Reference monitor validation",
            "manual_details": "Validate reference monitor implementation, ensure effectiveness, and verify proper access control enforcement.",
            "compliance_level": "function_plus_manual"
          }
        }
      }
    },
    "new_functions_suggested": [
      {
        "function_name": "iam_policy_least_privilege_validation",
        "description": "Validate that IAM policies follow least privilege principles with detailed analysis",
        "purpose": "Enhanced least privilege validation for AC-6 compliance",
        "priority": "HIGH"
      },
      {
        "function_name": "iam_role_separation_of_duties_validation",
        "description": "Validate separation of duties across IAM roles and policies",
        "purpose": "Enhanced separation of duties validation for AC-5 compliance",
        "priority": "HIGH"
      },
      {
        "function_name": "access_control_policy_compliance_check",
        "description": "Check access control policy compliance across all AWS services",
        "purpose": "Comprehensive access control policy validation for AC-1 compliance",
        "priority": "MEDIUM"
      },
      {
        "function_name": "account_lifecycle_automation_check",
        "description": "Validate account lifecycle automation and processes",
        "purpose": "Enhanced account management validation for AC-2 compliance",
        "priority": "MEDIUM"
      }
    ],
    "compliance_summary": {
      "total_controls": 142,
      "fully_automated": 0,
      "function_plus_manual": 139,
      "manual_only": 3,
      "compliance_coverage": "98%",
      "aws_function_coverage": "High",
      "manual_effort_required": "Moderate"
    }
  }
}
