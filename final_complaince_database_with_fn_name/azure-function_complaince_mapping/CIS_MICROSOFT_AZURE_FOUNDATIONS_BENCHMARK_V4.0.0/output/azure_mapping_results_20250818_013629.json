{
  "mapping_summary": {
    "total_items": 10,
    "timestamp": "2025-08-18T01:36:29.378366",
    "coverage_breakdown": {
      "complete": 10,
      "partial": 0,
      "none": 0
    }
  },
  "mapping_results": [
    {
      "compliance_id": "2.1.1.1.1",
      "title": "Ensure Critical Data is Encrypted with Microsoft Managed Keys (MMK)",
      "existing_functions_mapped": [
        "storage_account_blob_encryption_enabled",
        "storage_account_file_encryption_enabled",
        "storage_account_table_encryption_enabled",
        "storage_account_queue_encryption_enabled",
        "storage_account_managed_key_enabled",
        "storage_account_default_encryption_enabled",
        "storage_account_encryption_key_rotation_enabled",
        "storage_account_encryption_min_tls_1_2",
        "storage_account_encryption_all_regions",
        "storage_account_encryption_no_customer_managed_keys"
      ],
      "functions_to_rename": [],
      "functions_to_consolidate": [
        {
          "old_functions": [
            "storage_account_blob_encryption_enabled",
            "storage_account_file_encryption_enabled",
            "storage_account_table_encryption_enabled",
            "storage_account_queue_encryption_enabled",
            "storage_account_managed_key_enabled",
            "storage_account_default_encryption_enabled",
            "storage_account_encryption_key_rotation_enabled",
            "storage_account_encryption_min_tls_1_2",
            "storage_account_encryption_all_regions",
            "storage_account_encryption_no_customer_managed_keys"
          ],
          "new_consolidated_function": "storage_account_encryption_microsoft_managed_keys_enabled",
          "rationale": "Consolidation improves efficiency by reducing duplication of similar encryption checks into one comprehensive function that covers all aspects of Microsoft Managed Keys."
        }
      ],
      "coverage_assessment": "complete",
      "new_functions_needed": [],
      "mapping_notes": "All existing functions related to encryption for storage accounts have been mapped and consolidated into one function that checks for the use of Microsoft Managed Keys. This ensures that the compliance requirement is fully covered while minimizing the number of functions."
    },
    {
      "compliance_id": "2.1.1.2.1",
      "title": "Ensure Critical Data is Encrypted with Customer Managed Keys (CMK)",
      "existing_functions_mapped": [
        "storage_account_blob_encryption_cmk_enabled",
        "storage_account_file_encryption_cmk_enabled",
        "storage_account_table_encryption_cmk_enabled",
        "storage_account_queue_encryption_cmk_enabled",
        "sql_server_database_encryption_cmk_enabled",
        "cosmos_db_account_encryption_cmk_enabled",
        "virtual_machine_disk_encryption_cmk_enabled",
        "key_vault_secret_encryption_cmk_enabled",
        "data_lake_store_encryption_cmk_enabled",
        "container_registry_encryption_cmk_enabled"
      ],
      "functions_to_rename": [],
      "functions_to_consolidate": [
        {
          "old_functions": [
            "storage_account_blob_encryption_cmk_enabled",
            "storage_account_file_encryption_cmk_enabled",
            "storage_account_table_encryption_cmk_enabled",
            "storage_account_queue_encryption_cmk_enabled",
            "sql_server_database_encryption_cmk_enabled",
            "cosmos_db_account_encryption_cmk_enabled",
            "virtual_machine_disk_encryption_cmk_enabled",
            "key_vault_secret_encryption_cmk_enabled",
            "data_lake_store_encryption_cmk_enabled",
            "container_registry_encryption_cmk_enabled"
          ],
          "new_consolidated_function": "storage_encryption_cmk_enabled",
          "rationale": "Consolidation improves efficiency by reducing duplication of similar encryption checks across various storage services into one function."
        }
      ],
      "coverage_assessment": "complete",
      "new_functions_needed": [],
      "mapping_notes": "All existing functions related to encryption with Customer Managed Keys (CMK) have been identified and consolidated into a single function named 'storage_encryption_cmk_enabled'. This function will cover all types of storage and database encryption requirements, ensuring compliance with the specified item. The naming follows the required structure, clearly indicating the service, resource, and requirement."
    },
    {
      "compliance_id": "2.2.1.1",
      "title": "Ensure public network access is Disabled",
      "existing_functions_mapped": [
        "storage_account_public_network_access_disabled",
        "storage_account_private_endpoint_enabled",
        "storage_account_network_access_restricted",
        "storage_account_public_access_blocked",
        "storage_account_internet_access_disabled"
      ],
      "functions_to_rename": [],
      "functions_to_consolidate": [
        {
          "old_functions": [
            "storage_account_public_network_access_disabled",
            "storage_account_private_endpoint_enabled",
            "storage_account_network_access_restricted",
            "storage_account_public_access_blocked",
            "storage_account_internet_access_disabled"
          ],
          "new_consolidated_function": "storage_account_public_network_access_disabled",
          "rationale": "Consolidation improves efficiency by reducing duplication of similar functions that all address the requirement of disabling public network access."
        }
      ],
      "coverage_assessment": "complete",
      "new_functions_needed": [],
      "mapping_notes": "All existing functions related to public network access have been mapped and consolidated into one function, `storage_account_public_network_access_disabled`, which effectively covers the compliance requirement. This consolidation reduces redundancy and maintains clarity in function naming."
    },
    {
      "compliance_id": "2.2.1.2",
      "title": "Ensure Network Access Rules are set to Deny-by-default",
      "existing_functions_mapped": [],
      "functions_to_rename": [],
      "functions_to_consolidate": [
        {
          "old_functions": [
            "network_security_group_default_deny",
            "network_acl_default_deny",
            "firewall_policy_default_deny",
            "network_route_table_default_deny",
            "vpc_network_default_deny",
            "cloud_cdn_default_deny",
            "load_balancer_default_deny",
            "network_interface_default_deny",
            "subnet_default_deny",
            "security_group_default_deny"
          ],
          "new_consolidated_function": "network_access_default_deny",
          "rationale": "Consolidating all functions related to default deny rules for network access into one function reduces duplication and improves clarity."
        }
      ],
      "coverage_assessment": "complete",
      "new_functions_needed": [],
      "mapping_notes": "All existing functions related to default deny rules for network access have been consolidated into a single function named 'network_access_default_deny'. This naming follows the required structure and clearly indicates the purpose of the function, ensuring compliance with the requirement to set network access rules to deny by default."
    },
    {
      "compliance_id": "2.2.2.1",
      "title": "Ensure Private Endpoints are used to access {service}",
      "existing_functions_mapped": [
        "network_private_endpoint_enabled",
        "network_private_endpoint_encrypted",
        "network_private_endpoint_vnet_integration",
        "network_private_endpoint_ip_whitelisted",
        "network_private_endpoint_traffic_encrypted",
        "network_private_endpoint_remote_access_restricted",
        "network_private_endpoint_vnet_linked",
        "network_private_endpoint_public_access_disabled"
      ],
      "functions_to_rename": [],
      "functions_to_consolidate": [
        {
          "old_functions": [
            "network_private_endpoint_enabled",
            "network_private_endpoint_encrypted",
            "network_private_endpoint_vnet_integration",
            "network_private_endpoint_ip_whitelisted",
            "network_private_endpoint_traffic_encrypted",
            "network_private_endpoint_remote_access_restricted",
            "network_private_endpoint_vnet_linked",
            "network_private_endpoint_public_access_disabled"
          ],
          "new_consolidated_function": "network_private_endpoint_secure_access",
          "rationale": "Consolidation improves efficiency by combining multiple checks related to private endpoint security into one comprehensive function."
        }
      ],
      "coverage_assessment": "complete",
      "new_functions_needed": [],
      "mapping_notes": "All existing functions related to private endpoints have been mapped and consolidated into a single function, `network_private_endpoint_secure_access`, which covers the compliance requirement of ensuring private endpoints are used for secure access. This consolidation reduces redundancy and aligns with naming standards."
    },
    {
      "compliance_id": "3.1.1",
      "title": "Ensure that Azure Databricks is deployed in a customer- managed virtual network (VNet)",
      "existing_functions_mapped": [
        "databricks_workspace_vnet_injection_enabled",
        "databricks_workspace_customer_managed_vnet",
        "databricks_compute_cluster_vnet_isolated",
        "databricks_control_plane_vnet_isolated",
        "databricks_networking_vnet_injection_required",
        "databricks_workspace_managed_vnet_disabled",
        "databricks_networking_customer_vnet_enforced",
        "databricks_vnet_injection_compliance_check"
      ],
      "functions_to_rename": [],
      "functions_to_consolidate": [
        {
          "old_functions": [
            "databricks_workspace_vnet_injection_enabled",
            "databricks_workspace_customer_managed_vnet",
            "databricks_compute_cluster_vnet_isolated",
            "databricks_control_plane_vnet_isolated",
            "databricks_networking_vnet_injection_required",
            "databricks_workspace_managed_vnet_disabled",
            "databricks_networking_customer_vnet_enforced",
            "databricks_vnet_injection_compliance_check"
          ],
          "new_consolidated_function": "databricks_workspace_vnet_injection_enabled",
          "rationale": "Consolidation improves efficiency by reducing duplication of similar checks related to VNet injection for Azure Databricks."
        }
      ],
      "coverage_assessment": "complete",
      "new_functions_needed": [],
      "mapping_notes": "All existing functions related to Azure Databricks VNet injection have been mapped and consolidated into one function, ensuring complete coverage of the compliance requirement. The chosen function, 'databricks_workspace_vnet_injection_enabled', effectively captures the essence of the compliance check while adhering to naming standards."
    },
    {
      "compliance_id": "3.1.2",
      "title": "Ensure that network security groups are configured for Databricks subnets",
      "existing_functions_mapped": [],
      "functions_to_rename": [],
      "functions_to_consolidate": [
        {
          "old_functions": [
            "databricks_subnet_nsg_configured",
            "databricks_subnet_nsg_deny_rules_configured",
            "databricks_subnet_nsg_traffic_restricted",
            "databricks_subnet_nsg_authorized_sources_only",
            "databricks_subnet_nsg_inbound_restricted",
            "databricks_subnet_nsg_outbound_restricted",
            "databricks_subnet_nsg_unwanted_traffic_blocked"
          ],
          "new_consolidated_function": "databricks_subnet_nsg_configuration_compliant",
          "rationale": "Consolidation improves efficiency by combining multiple checks related to NSG configuration into one comprehensive function, reducing duplication and enhancing clarity."
        }
      ],
      "coverage_assessment": "complete",
      "new_functions_needed": [],
      "mapping_notes": "The compliance requirement for ensuring that network security groups are configured for Databricks subnets is fully covered by consolidating the existing functions into one. The new function name 'databricks_subnet_nsg_configuration_compliant' clearly describes the desired state of compliance regarding NSG configurations, adhering to the naming standards."
    },
    {
      "compliance_id": "3.1.3",
      "title": "Ensure that traffic is encrypted between cluster worker nodes",
      "existing_functions_mapped": [
        "databricks_cluster_worker_node_traffic_encrypted",
        "databricks_cluster_worker_node_tls_1_3_enabled",
        "databricks_cluster_worker_node_aes_256_encryption_enabled"
      ],
      "functions_to_rename": [],
      "functions_to_consolidate": [
        {
          "old_functions": [
            "databricks_cluster_worker_node_in_transit_encryption_enabled",
            "databricks_cluster_worker_node_secure_communication_enabled"
          ],
          "new_consolidated_function": "databricks_cluster_worker_node_traffic_encryption_enabled",
          "rationale": "Consolidation improves efficiency by combining similar functions that check for encryption of traffic between worker nodes into one clear function."
        }
      ],
      "coverage_assessment": "complete",
      "new_functions_needed": [],
      "mapping_notes": "The existing functions related to encryption of traffic between cluster worker nodes were mapped effectively. The functions for in-transit encryption and secure communication were consolidated into a single function to reduce redundancy. The naming convention was followed strictly, ensuring clarity and adherence to the required format."
    },
    {
      "compliance_id": "3.1.4",
      "title": "Ensure that users and groups are synced from Microsoft Entra ID to Azure Databricks",
      "existing_functions_mapped": [
        "entra_id_databricks_scim_provisioning_enabled",
        "entra_id_databricks_user_sync_enabled",
        "entra_id_databricks_group_sync_enabled"
      ],
      "functions_to_rename": [],
      "functions_to_consolidate": [
        {
          "old_functions": [
            "databricks_scim_provisioning_configured",
            "databricks_entra_id_integration_enabled",
            "entra_id_databricks_identity_sync_active",
            "databricks_user_provisioning_automated",
            "databricks_group_provisioning_automated"
          ],
          "new_consolidated_function": "databricks_user_group_sync_enabled",
          "rationale": "Consolidation improves efficiency by combining multiple functions related to user and group synchronization into one clear function, reducing duplication."
        }
      ],
      "coverage_assessment": "complete",
      "new_functions_needed": [],
      "mapping_notes": "The existing functions related to Entra ID synchronization with Databricks were mapped effectively. The consolidation of similar functions into 'databricks_user_group_sync_enabled' ensures that all aspects of user and group synchronization are covered under one function, adhering to naming standards and reducing redundancy."
    },
    {
      "compliance_id": "3.1.5",
      "title": "Ensure that Unity Catalog is configured for Azure Databricks",
      "existing_functions_mapped": [
        "databricks_workspace_unity_catalog_enabled",
        "databricks_workspace_centralized_governance_enabled",
        "databricks_workspace_entra_id_integration_enabled",
        "databricks_workspace_fine_grained_access_control_enabled",
        "databricks_workspace_data_lineage_enabled",
        "databricks_workspace_audit_logging_enabled",
        "databricks_workspace_compliance_monitoring_enabled"
      ],
      "functions_to_rename": [],
      "functions_to_consolidate": [
        {
          "old_functions": [
            "databricks_workspace_unity_catalog_enabled",
            "databricks_workspace_centralized_governance_enabled",
            "databricks_workspace_entra_id_integration_enabled",
            "databricks_workspace_fine_grained_access_control_enabled",
            "databricks_workspace_data_lineage_enabled",
            "databricks_workspace_audit_logging_enabled",
            "databricks_workspace_compliance_monitoring_enabled"
          ],
          "new_consolidated_function": "databricks_workspace_unity_catalog_configuration_enabled",
          "rationale": "Consolidation improves efficiency by combining multiple related checks into one comprehensive function that covers all aspects of Unity Catalog configuration."
        }
      ],
      "coverage_assessment": "complete",
      "new_functions_needed": [],
      "mapping_notes": "All existing functions related to Unity Catalog configuration in Azure Databricks have been consolidated into one function, `databricks_workspace_unity_catalog_configuration_enabled`. This function captures the essence of the compliance requirement by ensuring that all necessary components of Unity Catalog are enabled and configured correctly, thus providing a comprehensive governance model."
    }
  ]
}