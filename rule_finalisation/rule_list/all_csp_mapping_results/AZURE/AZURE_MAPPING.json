{
  "metadata": {
    "csp": "AZURE",
    "total_unmapped_functions": 629,
    "step1_direct_mapped": 246,
    "step2_ai_pattern_mapped": 324,
    "step3_context_ai_mapped": 29,
    "needs_development": 30,
    "total_mapped": 599,
    "coverage_percentage": 95.23
  },
  "services": {
    "active": {
      "service_name": "active",
      "total_functions": 2,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.active.directory.password.policy.reuse.24",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.active.directory.user.mfa.enabled.console.access",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "ad": {
      "service_name": "ad",
      "total_functions": 19,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.ad.role.least.privilege",
          "matched_rule_id": "azure.ad.role.least_privilege",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.ad.attached.policy.no.administrative.privileges",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.custom.role.no.administrative.privileges",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.customer.attached.policy.no.administrative.privileges",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.inline.policy.no.administrative.privileges",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.no.root.access.key",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.policy.attached.only.to.group.or.roles",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.policy.no.administrative.privileges",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.policy.overly.permissive",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.role.no.administrative.privileges",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.root.hardware.mfa.enabled",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.root.mfa.enabled",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.rotate.access.key.90.days",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.user.accesskey.unused",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.user.console.access.unused",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.user.mfa.enabled",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.user.mfa.enabled.console.access",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.user.password.policy.minimum.length.14",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ad.user.password.policy.strong",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "aisearch": {
      "service_name": "aisearch",
      "total_functions": 1,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.aisearch.service.not.publicly.accessible",
          "matched_rule_id": "azure.aisearch.service.not_publicly_accessible",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "aks": {
      "service_name": "aks",
      "total_functions": 6,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.aks.clusters.created.with.private.nodes",
          "matched_rule_id": "azure.aks.clusters_created_with_private_nodes",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.aks.clusters.public.access.disabled",
          "matched_rule_id": "azure.aks.clusters_public_access_disabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.aks.network.policy.enabled",
          "matched_rule_id": "azure.aks.network.policy_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.aks.cluster.not.publicly.accessible",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.aks.kms.cmk.encryption.in.secrets.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.aks.kms.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "api": {
      "service_name": "api",
      "total_functions": 7,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.api.management.api.gateway.https.required",
          "matched_rule_id": "az::dns_health_probe::dns_security_health_check_https_or_tls_used",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.api.management.client.certificate.enabled",
          "matched_rule_id": "az::dns_health_probe::dns_security_health_check_https_or_tls_used",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.api.management.restapi.client.certificate.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.api.management.restapi.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.api.management.restapi.tracing.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.api.management.authorization.enabled",
          "matched_rule_id": "azure.api.management_authorization_enabled:az.api_management_rate_limit_policy.api_security_rate_limiting_api_stage_throttle_overrides_not_unbounded",
          "semantic_score": 0.6,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.api.management.restapi.waf.acl.attached",
          "matched_rule_id": "azure.api.management_restapi_waf_acl_attached:az.api_management_monitoring.api_security_monitoring_api_access_logging_enabled",
          "semantic_score": 0.717,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        }
      ],
      "needs_development": []
    },
    "apigatewayv2": {
      "service_name": "apigatewayv2",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.apigatewayv2.api.access.logging.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "apimanagement": {
      "service_name": "apimanagement",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.apimanagement.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "app": {
      "service_name": "app",
      "total_functions": 10,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.app.function.identity.without.admin.privileges",
          "matched_rule_id": "azure.app.function.identity_without_admin_privileges",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.app.http.logs.enabled",
          "matched_rule_id": "azure.app.service.http.logs.enabled",
          "confidence_score": 0.8,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.app.function.access.keys.configured",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.app.function.not.publicly.accessible",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.app.minimum.tls.version.12",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.app.service.certificate.certificate.expiration",
          "matched_rule_id": "az::dns_health_probe::dns_security_health_check_https_or_tls_used",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.app.service.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.app.service.kms.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.app.service.autoscale.enabled",
          "matched_rule_id": "azure.app.service.autoscale_enabled:az.azure_paas_app.paas_security_app_logging_enabled",
          "semantic_score": 0.744,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.app.service.managed.updates.enabled",
          "matched_rule_id": "azure.app.service.managed_updates_enabled:az.azure_paas_app.paas_security_app_logging_enabled",
          "semantic_score": 0.85,
          "match_type": "CONTEXT_AI",
          "confidence": "HIGH"
        }
      ],
      "needs_development": []
    },
    "application": {
      "service_name": "application",
      "total_functions": 1,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.application.insights.enabled",
          "matched_rule_id": "azure.application.insights_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "appsync": {
      "service_name": "appsync",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.appsync.field.level.logging.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "automation": {
      "service_name": "automation",
      "total_functions": 3,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.automation.compliant.patching",
          "matched_rule_id": "azure.automation.managed_compliant_patching",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.automation.managed.compliant.patching",
          "matched_rule_id": "azure.automation.managed_compliant_patching",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.automation.patch.compliance",
          "matched_rule_id": "azure.vm.patch_compliance",
          "semantic_score": 0.5,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        }
      ],
      "needs_development": []
    },
    "azure": {
      "service_name": "azure",
      "total_functions": 79,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.azure.active.directory.password.policy.reuse.24",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.active.directory.user.console.access.unused",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.aks.cluster.kms.cmk.encryption.in.secrets.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.aks.endpoints.not.publicly.accessible",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.api.management.restapi.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.awslambda.function.inside.vpc",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.awslambda.function.not.publicly.accessible",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.cache.redis.cluster.backup.enabled",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.cdn.distributions.origin.traffic.encrypted",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.cdn.distributions.using.deprecated.ssl.protocols",
          "matched_rule_id": "az::dns_health_probe::dns_security_health_check_https_or_tls_used",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.compute.ebs.default.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.compute.ebs.public.snapshot",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.compute.ebs.volume.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.compute.ebs.volume.protected.by.backup.plan",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.compute.instance.public.ip",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.compute.securitygroup.allow.ingress.from.internet.to.all.ports",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.compute.securitygroup.allow.ingress.from.internet.to.tcp.port.22",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.cosmos.db.accelerator.cluster.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.cosmos.db.table.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.cosmos.db.table.protected.by.backup.plan",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.cosmos.db.tables.kms.cmk.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.cosmos.db.tables.pitr.enabled",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.database.migration.instance.no.public.access",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.files.encryption.at.rest.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.hdinsight.cluster.master.nodes.no.public.ip",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.load.balancer.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.load.balancer.ssl.listeners",
          "matched_rule_id": "az::dns_health_probe::dns_security_health_check_https_or_tls_used",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.machine.learning.notebook.instance.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.machine.learning.notebook.instance.without.direct.internet.access.configured",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.monitor.cloudwatch.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.monitor.kms.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.monitor.log.file.validation.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.monitor.log.group.kms.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.monitor.log.group.retention.policy.specific.days.enabled",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.monitor.log.metric.filter.root.usage",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.notification.hubs.topics.kms.encryption.at.rest.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.policy.recorder.all.regions.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.search.service.domains.audit.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.search.service.domains.encryption.at.rest.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.search.service.domains.https.communications.enforced",
          "matched_rule_id": "az::dns_health_probe::dns_security_health_check_https_or_tls_used",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.search.service.domains.node.to.node.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.search.service.domains.not.publicly.accessible",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.sql.instance.backup.enabled",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.sql.instance.no.public.access",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.sql.instance.protected.by.backup.plan",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.sql.instance.storage.encrypted",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.sql.snapshots.encrypted",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.sql.snapshots.public.access",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.storage.account.level.public.access.blocks",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.storage.bucket.default.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.storage.bucket.enforces.ssl",
          "matched_rule_id": "az::dns_health_probe::dns_security_health_check_https_or_tls_used",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.storage.bucket.kms.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.storage.bucket.policy.public.write.access",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.storage.bucket.public.write.acl",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.storage.bucket.server.access.logging.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.synapse.cluster.audit.logging",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.synapse.cluster.automated.snapshot",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.synapse.cluster.public.access",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.virtual.network.endpoint.for.ec2.enabled",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.virtual.network.flow.logs.enabled",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.wafv2.web.acl.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.azure.automation.managed.compliant.patching",
          "matched_rule_id": "azure.automation.managed_compliant_patching",
          "semantic_score": 0.8,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.compute.networkacl.allow.ingress.tcp.port.22",
          "matched_rule_id": "azure.compute.networkacl_allow_ingress_any_port",
          "semantic_score": 0.556,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.compute.networkacl.allow.ingress.tcp.port.3389",
          "matched_rule_id": "azure.compute.networkacl_allow_ingress_any_port",
          "semantic_score": 0.556,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.load.balancer.waf.acl.attached",
          "matched_rule_id": "azure.load.balancer_waf_acl_attached:az.azure_network_load_balancer.network_security_lb_waf_attached_where_supported",
          "semantic_score": 0.5,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.monitor.multi.region.enabled",
          "matched_rule_id": "azure.monitor.multi_region_enabled",
          "semantic_score": 0.8,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.azure.sql.cluster.minor.version.upgrade.enabled",
          "matched_rule_id": "azure.sql.auto_minor_version_upgrade",
          "semantic_score": 0.5,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        }
      ],
      "needs_development": [
        {
          "compliance_function": "azure.azure.active.directory.user.accesskey.unused",
          "new_rule_id": "azure.azure.active.directory.user.accesskey.unused",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.azure.aks.cluster.uses.a.supported.version",
          "new_rule_id": "azure.azure.aks.cluster.uses.a.supported.version",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.azure.api.management.restapi.waf.acl.attached",
          "new_rule_id": "azure.azure.api.management.restapi.waf.acl.attached",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.azure.compute.securitygroup.default.restrict.traffic",
          "new_rule_id": "azure.azure.compute.securitygroup.default.restrict.traffic",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.azure.devops.project.no.secrets.in.variables",
          "new_rule_id": "azure.azure.devops.project.no.secrets.in.variables",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.azure.devops.project.source.repo.url.no.sensitive.credentials",
          "new_rule_id": "azure.azure.devops.project.source.repo.url.no.sensitive.credentials",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.azure.monitor.s3.dataevents.read.enabled",
          "new_rule_id": "azure.azure.monitor.s3.dataevents.read.enabled",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.azure.sql.cluster.default.admin",
          "new_rule_id": "azure.azure.sql.cluster.default.admin",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.azure.sql.instance.default.admin",
          "new_rule_id": "azure.azure.sql.instance.default.admin",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.azure.storage.bucket.cross.region.replication",
          "new_rule_id": "azure.azure.storage.bucket.cross.region.replication",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.azure.storage.bucket.lifecycle.enabled",
          "new_rule_id": "azure.azure.storage.bucket.lifecycle.enabled",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.azure.storage.bucket.object.versioning",
          "new_rule_id": "azure.azure.storage.bucket.object.versioning",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        }
      ]
    },
    "backup": {
      "service_name": "backup",
      "total_functions": 6,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.backup.backup.encryption.enabled",
          "matched_rule_id": "azure.backup.backup_encryption_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.backup.enabled.for.vms",
          "matched_rule_id": "azure.backup.enabled_for_vms",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.backup.plan.min.retention",
          "matched_rule_id": "azure.backup.plan_min_retention",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.backup.recovery.point.encrypted",
          "matched_rule_id": "azure.backup.recovery_point_encrypted",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.backup.recovery.point.retention",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.backup.vault.soft.delete.enabled",
          "matched_rule_id": "azure.backup.vault_soft_delete_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "cdn": {
      "service_name": "cdn",
      "total_functions": 4,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.cdn.cloudfront.https.required",
          "matched_rule_id": "azure.cdn.cloudfront_https_required",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.cdn.distributions.logging.enabled",
          "matched_rule_id": "azure.cdn.distributions_logging_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.cdn.distributions.using.deprecated.ssl.protocols",
          "matched_rule_id": "azure.cdn.distributions_using_deprecated_ssl_protocols",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.cdn.distributions.custom.ssl.certificate",
          "matched_rule_id": "az::dns_health_probe::dns_security_health_check_https_or_tls_used",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "certificates": {
      "service_name": "certificates",
      "total_functions": 1,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.certificates.certificates.expiration.check",
          "matched_rule_id": "azure.certificates.certificates_expiration_check",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "compute": {
      "service_name": "compute",
      "total_functions": 13,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.compute.instance.older.than.specific.days",
          "matched_rule_id": "azure.compute.instance.older_than_specific_days",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.compute.instance.profile.attached",
          "matched_rule_id": "azure.compute.instance.profile_attached",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.compute.networkacl.allow.ingress.any.port",
          "matched_rule_id": "azure.compute.networkacl_allow_ingress_any_port",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.compute.networkacl.allow.ingress.tcp.port.22",
          "matched_rule_id": "azure.compute.networkacl_allow_ingress_any_port",
          "confidence_score": 0.625,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.compute.disk.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.compute.disk.encryption.enabled.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.compute.disk.public.snapshot",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.compute.ebs.public.snapshot",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.compute.instance.imdsv2.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.compute.instance.public.ip",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.compute.securitygroup.allow.ingress.from.internet.to.all.ports",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.compute.securitygroup.default.restrict.traffic",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.compute.vm.managed.by.automation",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "container": {
      "service_name": "container",
      "total_functions": 3,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.container.instances.task.definition.logging.enabled",
          "matched_rule_id": "azure.container.instances_task_definition_logging_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.container.registry.image.scan.on.push.enabled",
          "matched_rule_id": "azure.container.registry_image_scan_on_push_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.container.registry.repository.encryption.enabled",
          "matched_rule_id": "azure.container.registry_repository_encryption_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "containerregistry": {
      "service_name": "containerregistry",
      "total_functions": 2,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.containerregistry.not.publicly.accessible",
          "matched_rule_id": "azure.containerregistry.not_publicly_accessible",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.containerregistry.uses.private.link",
          "matched_rule_id": "azure.containerregistry.uses_private_link",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "cosmos": {
      "service_name": "cosmos",
      "total_functions": 7,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.cosmos.db.kms.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "confidence_score": 0.714,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.cosmos.db.pitr.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_pitr_enabled",
          "confidence_score": 0.8,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.cosmos.db.tables.kms.cmk.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.cosmos.db.tables.pitr.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_pitr_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.cosmos.db.accelerator.cluster.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.cosmos.db.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.cosmos.db.table.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "cosmosdb": {
      "service_name": "cosmosdb",
      "total_functions": 10,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.cosmosdb.account.firewall.use.selected.networks",
          "matched_rule_id": "azure.cosmosdb.account.firewall_use_selected_networks",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.cosmosdb.account.use.private.endpoints",
          "matched_rule_id": "azure.cosmosdb.account.use_private_endpoints",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.cosmosdb.autoscale.enabled",
          "matched_rule_id": "azure.cosmosdb.autoscale_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.cosmosdb.backup.enabled",
          "matched_rule_id": "azure.cosmosdb.backup_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.cosmosdb.encryption.enabled",
          "matched_rule_id": "azure.cosmosdb.encryption_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.cosmosdb.geo.redundant",
          "matched_rule_id": "azure.cosmosdb.geo_redundant",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.cosmosdb.global.tables.enabled",
          "matched_rule_id": "azure.cosmosdb.global_tables_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.cosmosdb.kms.cmk.encryption.enabled",
          "matched_rule_id": "azure.cosmosdb.encryption_enabled",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.cosmosdb.pitr.enabled",
          "matched_rule_id": "azure.cosmosdb.pitr_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.cosmosdb.tables.pitr.enabled",
          "matched_rule_id": "azure.cosmosdb.pitr_enabled",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "defender": {
      "service_name": "defender",
      "total_functions": 27,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.defender.additional.email.configured.with.a.security.contact",
          "matched_rule_id": "azure.defender.additional_email_configured_with_a_security_contact",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.assessments.vm.endpoint.protection.installed",
          "matched_rule_id": "azure.defender.vm.endpoint_protection_installed",
          "confidence_score": 0.833,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.auto.provisioning.log.analytics.agent.vms.on",
          "matched_rule_id": "azure.defender.auto_provisioning_log_analytics_agent_vms_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.auto.provisioning.vulnerabilty.assessments.machines.on",
          "matched_rule_id": "azure.defender.auto_provisioning_vulnerabilty_assessments_machines_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.container.images.resolved.vulnerabilities",
          "matched_rule_id": "azure.defender.container_images_resolved_vulnerabilities",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.container.images.scan.enabled",
          "matched_rule_id": "azure.defender.container_images_scan_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.defender.for.app.services.is.on",
          "matched_rule_id": "azure.defender.app.services_is_on",
          "confidence_score": 0.714,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.defender.ensure.defender.for.arm.is.on",
          "matched_rule_id": "azure.defender.ensure_defender_for_arm_is_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.defender.for.azure.sql.databases.is.on",
          "matched_rule_id": "azure.defender.ensure_defender_for_azure_sql_databases_is_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.defender.for.containers.is.on",
          "matched_rule_id": "azure.defender.ensure_defender_for_containers_is_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.defender.for.cosmosdb.is.on",
          "matched_rule_id": "azure.defender.ensure_defender_for_cosmosdb_is_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.defender.for.databases.is.on",
          "matched_rule_id": "azure.defender.ensure_defender_for_databases_is_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.defender.for.dns.is.on",
          "matched_rule_id": "azure.defender.ensure_defender_for_dns_is_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.defender.for.keyvault.is.on",
          "matched_rule_id": "azure.defender.ensure_defender_for_keyvault_is_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.defender.for.os.relational.databases.is.on",
          "matched_rule_id": "azure.defender.ensure_defender_for_os_relational_databases_is_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.defender.for.server.is.on",
          "matched_rule_id": "azure.defender.ensure_defender_for_server_is_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.defender.for.sql.servers.is.on",
          "matched_rule_id": "azure.defender.ensure_defender_for_sql_servers_is_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.defender.for.storage.is.on",
          "matched_rule_id": "azure.defender.ensure_defender_for_arm_is_on",
          "confidence_score": 0.714,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.defender.ensure.iot.hub.defender.is.on",
          "matched_rule_id": "azure.defender.ensure_iot_hub_defender_is_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.mcas.is.enabled",
          "matched_rule_id": "azure.defender.ensure_mcas_is_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.notify.alerts.severity.is.high",
          "matched_rule_id": "azure.defender.ensure_notify_alerts_severity_is_high",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.notify.emails.to.owners",
          "matched_rule_id": "azure.defender.ensure_notify_emails_to_owners",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.system.updates.are.applied",
          "matched_rule_id": "azure.defender.ensure_system_updates_are_applied",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.ensure.wdatp.is.enabled",
          "matched_rule_id": "azure.defender.ensure_wdatp_is_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.for.servers.enabled",
          "matched_rule_id": "azure.defender.for_servers_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.defender.is.enabled",
          "matched_rule_id": "azure.defender.enabled",
          "confidence_score": 0.667,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.defender.no.high.severity.findings",
          "matched_rule_id": "azure.defender.no_high_severity_findings",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "devops": {
      "service_name": "devops",
      "total_functions": 2,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": [
        {
          "compliance_function": "azure.devops.project.no.secrets.in.variables",
          "new_rule_id": "azure.devops.project.no.secrets.in.variables",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.devops.project.source.repo.url.no.sensitive.credentials",
          "new_rule_id": "azure.devops.project.source.repo.url.no.sensitive.credentials",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        }
      ]
    },
    "disk": {
      "service_name": "disk",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.disk.backup.enabled",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "dynamodb": {
      "service_name": "dynamodb",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.dynamodb.backup.enabled",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "eip": {
      "service_name": "eip",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.eip.attached",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "encryption": {
      "service_name": "encryption",
      "total_functions": 10,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.encryption.attached.policy.no.administrative.privileges",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.encryption.aws.attached.policy.no.administrative.privileges",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.encryption.customer.attached.policy.no.administrative.privileges",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.encryption.inline.policy.no.administrative.privileges",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.encryption.no.administrative.privileges",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.encryption.no.root.access.key",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.encryption.policy.no.administrative.privileges",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.encryption.user.accesskey.unused",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.encryption.user.console.access.unused",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.encryption.user.mfa.enabled.console.access",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "entra": {
      "service_name": "entra",
      "total_functions": 46,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.entra.no.guest.accounts.with.permissions",
          "matched_rule_id": "azure.entra.no_guest_accounts_with_permissions",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.entra.policy.user.consent.for.verified.apps storage.blob.public.access.level.is.disabled storage.ensure.azure.services.are.trusted.to.access.is.enabled",
          "matched_rule_id": "azure.entra.policy.user_consent_for_verified_apps storage_blob_public_access_level_is_disabled storage_ensure_azure_services_are_trusted_to_access_is_enabled:az.active_directory_user.identity_access_security_user_inactive_90_days_disabled",
          "confidence_score": 0.655,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.trusted.named.locations.exists",
          "matched_rule_id": "azure.entra.trusted_named_locations_exists",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.entra.attached.policy.no.administrative.privileges",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.conditional.access.policy.require.mfa.for.management.api",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.conditional.access.policy.require.mfa.for.management.app",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.console.mfa.enabled",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.customer.attached.policy.no.administrative.privileges",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.global.admin.in.less.than.five.users",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.group.has.users",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.inline.policy.no.administrative.privileges",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.mfa.enabled",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.no.admin.policy",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.no.admin.privileges",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.no.root.access.key",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.non.privileged.user.has.mfa",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.non.privileged.user.has.mfa entra.privileged.user.has.mfa",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.password.policy.compliance",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.password.policy.expires.passwords.within.90.days.or.less",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.password.policy.lowercase",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.password.policy.minimum.length.14",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.password.policy.number",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.password.policy.reuse.24",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.password.policy.symbol",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.policy.default.users.cannot.create.security.groups",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.policy.ensure.default.user.cannot.create.apps",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.policy.ensure.default.user.cannot.create.tenants",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.policy.guest.invite.only.for.admin.roles",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.policy.guest.users.access.restrictions",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.policy.restricts.user.consent.for.apps",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.policy.user.consent.for.verified.apps",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.privileged.user.has.mfa",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.root.hardware.mfa.enabled",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.root.mfa.enabled",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.rotate.access.key.90.days",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.security.defaults.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.user.accesskey.unused",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.user.console.access.unused",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.user.in.group",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.user.mfa.enabled",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.user.mfa.enabled.console.access",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.user.no.inline.policies",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.user.unused.credentials",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.user.with.vm.access.has.mfa",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.entra.users.cannot.create.microsoft.365.groups",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.entra.user.group.membership",
          "matched_rule_id": "azure.entra.user.group_membership:az.active_directory_group.identity_access_security_group_membership_review_enabled_where_supported",
          "semantic_score": 0.586,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        }
      ],
      "needs_development": []
    },
    "files": {
      "service_name": "files",
      "total_functions": 3,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.files.encryption.at.rest.enabled",
          "matched_rule_id": "azure.files.encryption_at_rest_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.files.encryption.enabled",
          "matched_rule_id": "azure.files.encryption_at_rest_enabled",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.files.have.backup.enabled",
          "matched_rule_id": "azure.files.have_backup_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "fsx": {
      "service_name": "fsx",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.fsx.backup.enabled",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "function": {
      "service_name": "function",
      "total_functions": 2,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.function.app.function.restrict.public.access",
          "matched_rule_id": "azure.function.app.function_restrict_public_access",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.function.app.function.url.authentication",
          "matched_rule_id": "azure.function.app.function_url_authentication",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "functions": {
      "service_name": "functions",
      "total_functions": 8,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.functions.app.restrict.public.access",
          "matched_rule_id": "azure.functions.app.restrict_public_access",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.functions.app.url.public",
          "matched_rule_id": "azure.functions.app.url_public",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.functions.function.url.public",
          "matched_rule_id": "azure.functions.app.url_public",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.functions.public.access",
          "matched_rule_id": "azure.functions.app.restrict_public_access",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.functions.url.public",
          "matched_rule_id": "azure.functions.app.url_public",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.functions.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.functions.function.not.publicly.accessible",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.functions.not.publicly.accessible",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "hdinsight": {
      "service_name": "hdinsight",
      "total_functions": 2,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.hdinsight.cluster.master.nodes.no.public.ip",
          "matched_rule_id": "azure.hdinsight.cluster.master_nodes_no_public_ip",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.hdinsight.master.nodes.no.public.ip",
          "matched_rule_id": "azure.hdinsight.cluster.master_nodes_no_public_ip",
          "confidence_score": 0.857,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "iam": {
      "service_name": "iam",
      "total_functions": 18,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.iam.custom.role.has.permissions.to.administer.resource.locks",
          "matched_rule_id": "azure.iam.role.has_permissions_to_administer_resource_locks",
          "confidence_score": 0.889,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.iam.attached.policy.no.administrative.privileges",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.customer.attached.policy.no.administrative.privileges",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.inline.policy.no.administrative.privileges",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.no.root.access.key",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.password.policy.lowercase",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.password.policy.minimum.length.14",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.password.policy.number",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.password.policy.reuse.24",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.password.policy.symbol",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.password.policy.uppercase",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.root.hardware.mfa.enabled",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.root.mfa.enabled",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.rotate.access.key.90.days",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.support.role.created",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.user.accesskey.unused",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.user.console.access.unused",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.iam.user.mfa.enabled.console.access",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "key": {
      "service_name": "key",
      "total_functions": 4,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.key.vault.cmk.rotation.enabled",
          "matched_rule_id": "azure.key.vault_cmk_rotation_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.key.vault.key.lifecycle.policy",
          "matched_rule_id": "azure.key.key.lifecycle_policy",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.key.vault.kms.key.expiration.set",
          "matched_rule_id": "azure.key.key.expiration_set",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.key.vault.kms.key.rotation.enabled",
          "matched_rule_id": "azure.key.vault_cmk_rotation_enabled",
          "confidence_score": 0.667,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "keyvault": {
      "service_name": "keyvault",
      "total_functions": 11,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.keyvault.automatic.rotation.enabled",
          "matched_rule_id": "azure.keyvault.key.rotation_enabled",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.keyvault.certificates.expiration.check",
          "matched_rule_id": "azure.keyvault.keys.check.expiration",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.keyvault.cmk.rotation.enabled",
          "matched_rule_id": "azure.keyvault.key.rotation_enabled",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.keyvault.enabled",
          "matched_rule_id": "azure.keyvault.logging_enabled",
          "confidence_score": 0.667,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.keyvault.key.not.scheduled.for.deletion",
          "matched_rule_id": "azure.keyvault.key.not_scheduled_for_deletion",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.keyvault.key.rotation.enabled",
          "matched_rule_id": "azure.keyvault.key.rotation_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.keyvault.logging.enabled",
          "matched_rule_id": "azure.keyvault.logging_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.keyvault.private.endpoints",
          "matched_rule_id": "azure.keyvault.private_endpoints",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.keyvault.rotation.enabled",
          "matched_rule_id": "azure.keyvault.key.rotation_enabled",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.keyvault.secret.rotation.enabled",
          "matched_rule_id": "azure.keyvault.secret_rotation_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.keyvault.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "kubernetes": {
      "service_name": "kubernetes",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.kubernetes.service.not.publicly.accessible",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "load": {
      "service_name": "load",
      "total_functions": 9,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.load.balancer.alb.https.redirect",
          "matched_rule_id": "az::dns_health_probe::dns_security_health_check_https_or_tls_used",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.load.balancer.deletion.protection",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.load.balancer.desync.mitigation.mode",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.load.balancer.insecure.ssl.ciphers",
          "matched_rule_id": "az::dns_health_probe::dns_security_health_check_https_or_tls_used",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.load.balancer.logging.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.load.balancer.ssl.listeners",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.load.balancer.v2.logging.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.load.balancer.health.probe.configured",
          "matched_rule_id": "azure.load.balancer_health_probe_configured:az.azure_network_load_balancer.network_security_lb_listener_tls_min_1_2",
          "semantic_score": 0.567,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.load.balancer.waf.acl.attached",
          "matched_rule_id": "azure.load.balancer_waf_acl_attached:az.azure_network_load_balancer.network_security_lb_waf_attached_where_supported",
          "semantic_score": 0.717,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        }
      ],
      "needs_development": []
    },
    "loadbalancer": {
      "service_name": "loadbalancer",
      "total_functions": 5,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.loadbalancer.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.loadbalancer.ssl.listeners",
          "matched_rule_id": "az::dns_health_probe::dns_security_health_check_https_or_tls_used",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.loadbalancer.v2.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": [
        {
          "compliance_function": "azure.loadbalancer.deletion.protection",
          "new_rule_id": "azure.loadbalancer.deletion.protection",
          "source": "need_development",
          "compliance_ids": [
            "nist_800_171_r2_multi_cloud_3_13_2_3.13.2_Employ_architectural_designs_softw_0008"
          ],
          "frameworks": [
            "NIST_800-171"
          ]
        },
        {
          "compliance_function": "azure.loadbalancer.v2.waf.acl.attached",
          "new_rule_id": "azure.loadbalancer.v2.waf.acl.attached",
          "source": "need_development",
          "compliance_ids": [
            "nist_800_171_r2_multi_cloud_3_13_1_3.13.1_Monitor_control_and_protect_commu_0004"
          ],
          "frameworks": [
            "NIST_800-171"
          ]
        }
      ]
    },
    "log": {
      "service_name": "log",
      "total_functions": 2,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.log.log.file.validation.enabled",
          "matched_rule_id": "azure.log.log_file_validation_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.log.multi.region.enabled",
          "matched_rule_id": "azure.log.multi_region_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "machine": {
      "service_name": "machine",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.machine.learning.notebook.instance.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "mariadb": {
      "service_name": "mariadb",
      "total_functions": 1,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.mariadb.geo.redundant.backup",
          "matched_rule_id": "azure.mariadb.geo_redundant_backup",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "microsoft": {
      "service_name": "microsoft",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.microsoft.defender.enabled",
          "matched_rule_id": "azure.sqlserver.microsoft_defender_enabled",
          "semantic_score": 0.75,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        }
      ],
      "needs_development": []
    },
    "ml": {
      "service_name": "ml",
      "total_functions": 2,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.ml.notebook.instance.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.ml.notebook.instance.without.direct.internet.access.configured",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "monitor": {
      "service_name": "monitor",
      "total_functions": 71,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.monitor.alarm.configured",
          "matched_rule_id": "azure.monitor.alarm_configured",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.alert.create.policy.assignment",
          "matched_rule_id": "azure.monitor.policy.assignment",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.alert.create.update.nsg",
          "matched_rule_id": "azure.monitor.alert_create_update_nsg",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.alert.create.update.public.ip.address.rule",
          "matched_rule_id": "azure.monitor.alert_create_update_public_ip_address_rule",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.alert.create.update.security.solution",
          "matched_rule_id": "azure.monitor.alert_create_update_security_solution",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.alert.create.update.sqlserver.fr",
          "matched_rule_id": "azure.monitor.alert_create_update_sqlserver_fr",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.alert.delete.nsg",
          "matched_rule_id": "azure.monitor.alert_delete_nsg",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.alert.delete.policy.assignment",
          "matched_rule_id": "azure.monitor.activity.log.alert.delete.policy.assignment.exists",
          "confidence_score": 0.625,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.alert.delete.public.ip.address.rule",
          "matched_rule_id": "azure.monitor.alert_delete_public_ip_address_rule",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.alert.delete.security.solution",
          "matched_rule_id": "azure.monitor.alert_delete_security_solution",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.alert.delete.sqlserver.fr",
          "matched_rule_id": "azure.monitor.alert_delete_sqlserver_fr",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.apigateway.logging.enabled",
          "matched_rule_id": "azure.monitor.logging_enabled",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.apigateway.restapi.logging.enabled",
          "matched_rule_id": "azure.monitor.logging_enabled",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.audit.logging.enabled",
          "matched_rule_id": "azure.monitor.logging_enabled",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.capacity.alerts.configured",
          "matched_rule_id": "azure.monitor.capacity_alerts_configured",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.changes.to.network.acls.alarm.configured",
          "matched_rule_id": "azure.monitor.network.acls_alarm_configured",
          "confidence_score": 0.714,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.changes.to.network.gateways.alarm.configured",
          "matched_rule_id": "azure.monitor.network.gateways_alarm_configured",
          "confidence_score": 0.714,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.changes.to.network.route.tables.alarm.configured",
          "matched_rule_id": "azure.monitor.network.route_tables_alarm_configured",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.changes.to.virtual.networks.alarm.configured",
          "matched_rule_id": "azure.monitor.changes_to_vpcs_alarm_configured",
          "confidence_score": 0.625,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.changes.to.vpcs.alarm.configured",
          "matched_rule_id": "azure.monitor.changes_to_vpcs_alarm_configured",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.cloudtrail.logging.enabled",
          "matched_rule_id": "azure.monitor.logging_enabled",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.cloudwatch.logging.enabled",
          "matched_rule_id": "azure.monitor.logging_enabled",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.diagnostic.setting.with.appropriate.categories",
          "matched_rule_id": "azure.monitor.diagnostic_setting_with_appropriate_categories",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.diagnostic.settings.exists",
          "matched_rule_id": "azure.monitor.diagnostic_settings_exists",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.elb.logging.enabled",
          "matched_rule_id": "azure.monitor.logging_enabled",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.elbv2.logging.enabled",
          "matched_rule_id": "azure.monitor.logging_enabled",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.enabled",
          "matched_rule_id": "azure.monitor.logging_enabled",
          "confidence_score": 0.667,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.keyvault.encryption.enabled",
          "matched_rule_id": "azure.monitor.kms_encryption_enabled",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.kms.encryption.enabled",
          "matched_rule_id": "azure.monitor.kms_encryption_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.log.analysis.enabled",
          "matched_rule_id": "azure.monitor.log_analysis_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.log.file.integrity.enabled",
          "matched_rule_id": "azure.monitor.log_file_integrity_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.log.file.validation.enabled",
          "matched_rule_id": "azure.monitor.log_file_integrity_enabled",
          "confidence_score": 0.667,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.log.group.kms.encryption.enabled",
          "matched_rule_id": "azure.monitor.group.kms_encryption_enabled",
          "confidence_score": 0.833,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.log.group.retention.policy.specific.days.enabled",
          "matched_rule_id": "azure.monitor.policy.specific_days_enabled",
          "confidence_score": 0.625,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.log.metric.filter.alarm.configured",
          "matched_rule_id": "azure.monitor.log_metric_filter_alarm_configured",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.log.retention.configured",
          "matched_rule_id": "azure.monitor.log_retention_configured",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.log.retention.configured.policy.specific.days.enabled",
          "matched_rule_id": "azure.monitor.policy.specific_days_enabled",
          "confidence_score": 0.625,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.logging.enabled",
          "matched_rule_id": "azure.monitor.logging_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.multi.region.enabled",
          "matched_rule_id": "azure.monitor.multi_region_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.storage.account.with.activity.logs.cmk.encrypted",
          "matched_rule_id": "azure.monitor.storage.account_with_activity_logs_cmk_encrypted",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.storage.account.with.activity.logs.is.private",
          "matched_rule_id": "azure.monitor.storage.account_with_activity_logs_is_private",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.storage.read.events.enabled",
          "matched_rule_id": "azure.monitor.storage.read_events_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.storage.write.events.enabled",
          "matched_rule_id": "azure.monitor.storage.write_events_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.vm.cpu.alerts",
          "matched_rule_id": "azure.monitor.vm.cpu_alerts",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.monitor.vm.memory.alerts",
          "matched_rule_id": "azure.monitor.vm.memory_alerts",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.monitor.cloudtrail.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.guardduty.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.https.enabled",
          "matched_rule_id": "az::dns_health_probe::dns_security_health_check_https_or_tls_used",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.log.metric.filter.and.alarm.for.cloudtrail.configuration.changes.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.log.metric.filter.and.alarm.for.config.configuration.changes.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.log.metric.filter.authentication.failures",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.log.metric.filter.disable.or.scheduled.deletion.of.kms.cmk",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.log.metric.filter.for.storage.bucket.policy.changes",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.log.metric.filter.policy.changes",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.log.metric.filter.root.usage",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.log.metric.filter.security.group.changes",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.log.metric.filter.sign.in.without.mfa",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.log.metric.filter.unauthorized.api.calls",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.logs.storage.access.logging.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.logs.storage.is.not.publicly.accessible",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.metric.filter.authentication.failures",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.rds.instance.integration.cloudwatch.logs",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.redshift.cluster.audit.logging",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.s3.dataevents.read.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.s3.dataevents.write.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.securityhub.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.vpc.flow.logs.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.monitor.elb.enabled",
          "matched_rule_id": "azure.defender.enabled",
          "semantic_score": 0.55,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.elbv2.enabled",
          "matched_rule_id": "azure.defender.enabled",
          "semantic_score": 0.55,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.monitor.no.high.severity.findings",
          "matched_rule_id": "azure.defender.no_high_severity_findings",
          "semantic_score": 0.667,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        }
      ],
      "needs_development": [
        {
          "compliance_function": "azure.monitor.metric.filter.root.usage",
          "new_rule_id": "azure.monitor.metric.filter.root.usage",
          "source": "need_development",
          "compliance_ids": [
            "hipaa_multi_cloud_164_308_a_6_i_0015"
          ],
          "frameworks": [
            "HIPAA"
          ]
        }
      ]
    },
    "multi": {
      "service_name": "multi",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.multi.region.enabled",
          "matched_rule_id": "azure.log.multi_region_enabled",
          "semantic_score": 0.75,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        }
      ],
      "needs_development": []
    },
    "mysql": {
      "service_name": "mysql",
      "total_functions": 5,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.mysql.flexible.server.audit.log.connection.activated",
          "matched_rule_id": "azure.mysql.flexible_server_audit_log_connection_activated",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.mysql.flexible.server.audit.log.enabled",
          "matched_rule_id": "azure.mysql.flexible_server_audit_log_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.mysql.flexible.server.minimum.tls.version.12",
          "matched_rule_id": "azure.mysql.flexible_server_minimum_tls_version_12",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.mysql.flexible.server.ssl.connection.enabled",
          "matched_rule_id": "azure.mysql.flexible_server_ssl_connection_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.mysql.geo.redundant.backup",
          "matched_rule_id": "azure.mysql.geo_redundant_backup",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "network": {
      "service_name": "network",
      "total_functions": 17,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.network.acl.allow.ingress.any.port",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.bastion.host.exists",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.flow.log.captured.sent",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.flow.log.more.than.90.days",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.flow.logs.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.http.internet.access.restricted",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.network.acl.unused",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.public.ip.shodan",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.rdp.internet.access.restricted",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.security.group.allow.ingress.any.port",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.security.group.allow.ingress.from.internet.to.tcp.port.22",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.security.group.default.restrict.traffic",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.securitygroup.allow.ingress.from.internet.to.tcp.port.22",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.securitygroup.default.restrict.traffic",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.ssh.internet.access.restricted",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.udp.internet.access.restricted",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.network.watcher.enabled",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "networksecuritygroup": {
      "service_name": "networksecuritygroup",
      "total_functions": 2,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.networksecuritygroup.allow.ingress.from.internet.to.tcp.port.22",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": [
        {
          "compliance_function": "azure.networksecuritygroup.default.restrict.traffic",
          "new_rule_id": "azure.networksecuritygroup.default.restrict.traffic",
          "source": "need_development",
          "compliance_ids": [
            "nist_800_171_r2_multi_cloud_3_13_2_3.13.2_Employ_architectural_designs_softw_0008"
          ],
          "frameworks": [
            "NIST_800-171"
          ]
        }
      ]
    },
    "notification": {
      "service_name": "notification",
      "total_functions": 1,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.notification.hub.topic.subscription.configured",
          "matched_rule_id": "azure.notification.hub_topic_subscription_configured",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "organizations": {
      "service_name": "organizations",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.organizations.account.part.of.organizations",
          "matched_rule_id": "azure.managementgroup.subscription.part_of_management_group",
          "semantic_score": 0.55,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        }
      ],
      "needs_development": []
    },
    "policy": {
      "service_name": "policy",
      "total_functions": 2,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.policy.ensure.asc.enforcement.enabled",
          "matched_rule_id": "azure.policy.ensure_asc_enforcement_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.policy.recorder.all.regions.enabled",
          "matched_rule_id": "azure.policy.recorder_all_regions_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "postgresql": {
      "service_name": "postgresql",
      "total_functions": 7,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.postgresql.flexible.server.allow.access.services.disabled",
          "matched_rule_id": "azure.postgresql.flexible_server_allow_access_services_disabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.postgresql.flexible.server.enforce.ssl.enabled",
          "matched_rule_id": "azure.postgresql.flexible_server_enforce_ssl_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.postgresql.flexible.server.log.checkpoints.on",
          "matched_rule_id": "azure.postgresql.flexible_server_log_checkpoints_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.postgresql.flexible.server.log.connections.on",
          "matched_rule_id": "azure.postgresql.flexible_server_log_connections_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.postgresql.flexible.server.log.disconnections.on",
          "matched_rule_id": "azure.postgresql.flexible_server_log_disconnections_on",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.postgresql.flexible.server.log.retention.days.greater.3",
          "matched_rule_id": "azure.postgresql.flexible_server_log_retention_days_greater_3",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.postgresql.geo.redundant.backup",
          "matched_rule_id": "azure.postgresql.geo_redundant_backup",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "public": {
      "service_name": "public",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.public.ip.attached",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "redshift": {
      "service_name": "redshift",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.redshift.backup.enabled",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "search": {
      "service_name": "search",
      "total_functions": 7,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.search.domains.encryption.at.rest.enabled",
          "matched_rule_id": "azure.search.service.domains_encryption_at_rest_enabled",
          "confidence_score": 0.857,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.search.node.to.node.encryption.enabled",
          "matched_rule_id": "azure.search.service.domains_node_to_node_encryption_enabled",
          "confidence_score": 0.714,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.search.service.domains.access.control.enabled",
          "matched_rule_id": "azure.search.service.domains_access_control_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.search.service.domains.encryption.at.rest.enabled",
          "matched_rule_id": "azure.search.service.domains_encryption_at_rest_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.search.service.domains.logging.enabled",
          "matched_rule_id": "azure.search.service.domains_logging_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.search.service.domains.node.to.node.encryption.enabled",
          "matched_rule_id": "azure.search.service.domains_node_to_node_encryption_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.search.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "security": {
      "service_name": "security",
      "total_functions": 6,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.security.center.enabled",
          "matched_rule_id": "azure.security.center_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.security.center.guardduty.enabled",
          "matched_rule_id": "azure.security.center_guardduty_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.security.center.is.enabled",
          "matched_rule_id": "azure.security.center_enabled",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.security.center.no.high.severity.findings",
          "matched_rule_id": "azure.security.center_no_high_severity_findings",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.security.center.security.center.enabled",
          "matched_rule_id": "azure.security.center_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.security.center.vulnerability.assessment.enabled",
          "matched_rule_id": "azure.security.center_vulnerability_assessment_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "securitycenter": {
      "service_name": "securitycenter",
      "total_functions": 1,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.securitycenter.exploit.guard.enabled",
          "matched_rule_id": "azure.securitycenter.exploit_guard_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "service": {
      "service_name": "service",
      "total_functions": 2,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.service.bus.topics.keyvault.encryption.at.rest.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.service.bus.topics.kms.encryption.at.rest.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "servicebus": {
      "service_name": "servicebus",
      "total_functions": 2,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.servicebus.kms.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.servicebus.topics.kms.encryption.at.rest.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "shield": {
      "service_name": "shield",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.shield.advanced.protection.in.internet.facing.load.balancers",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "site": {
      "service_name": "site",
      "total_functions": 1,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.site.recovery.configured",
          "matched_rule_id": "azure.site.recovery_configured",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "sql": {
      "service_name": "sql",
      "total_functions": 35,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.sql.aurora.backup.enabled",
          "matched_rule_id": "azure.sql.aurora_backup_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.auto.minor.version.upgrade",
          "matched_rule_id": "azure.sql.auto_minor_version_upgrade",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.backup.enabled",
          "matched_rule_id": "azure.sql.backup_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.database.ad.authentication.enabled",
          "matched_rule_id": "azure.sql.database.ad_authentication_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.database.auditing.enabled",
          "matched_rule_id": "azure.sql.database.auditing_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.database.autoscale.enabled",
          "matched_rule_id": "azure.sql.database.autoscale_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.database.backup.enabled",
          "matched_rule_id": "azure.sql.database.backup_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.database.backup.encrypted",
          "matched_rule_id": "azure.sql.database.backup_encrypted",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.database.deletion.protection",
          "matched_rule_id": "azure.sql.database.deletion_protection",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.database.diagnostic.settings.enabled",
          "matched_rule_id": "azure.sql.database.diagnostic_settings_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.database.encryption.at.rest.enabled",
          "matched_rule_id": "azure.sql.database.encryption_at_rest_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.database.multi.az",
          "matched_rule_id": "azure.sql.database.multi_az",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.database.no.public.access",
          "matched_rule_id": "azure.sql.database.no_public_access",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.database.snapshots.public.access",
          "matched_rule_id": "azure.sql.database.snapshots_public_access",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.database.storage.encrypted",
          "matched_rule_id": "azure.sql.storage.encrypted",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.dynamodb.table.encryption.enabled",
          "matched_rule_id": "azure.sql.dynamodb_table_encryption_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.enabled",
          "matched_rule_id": "azure.sql.backup_enabled",
          "confidence_score": 0.667,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.encryption.enabled",
          "matched_rule_id": "azure.sql.dynamodb_table_encryption_enabled",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.geo.redundant.backup",
          "matched_rule_id": "azure.sql.geo_redundant_backup",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.instance.backup.enabled",
          "matched_rule_id": "azure.sql.backup_enabled",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.instance.multi.az",
          "matched_rule_id": "azure.sql.database.multi_az",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.instance.no.public.access",
          "matched_rule_id": "azure.sql.database.no_public_access",
          "confidence_score": 0.667,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.instance.storage.encrypted",
          "matched_rule_id": "azure.sql.storage.encrypted",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.long.term.retention.enabled",
          "matched_rule_id": "azure.sql.long_term_retention_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.multi.az.enabled",
          "matched_rule_id": "azure.sql.multi_az_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sql.snapshots.public.access",
          "matched_rule_id": "azure.sql.database.snapshots_public_access",
          "confidence_score": 0.8,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.sql.audit.logging",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.audit.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.database.enhanced.monitoring.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.database.integration.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.database.integration.monitoring",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.instance.integration.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.instance.integration.monitoring",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.sql.instance.integration.monitoring.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": [
        {
          "compliance_function": "azure.sql.cluster.default.admin",
          "new_rule_id": "azure.sql.cluster.default.admin",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        }
      ]
    },
    "sqlserver": {
      "service_name": "sqlserver",
      "total_functions": 6,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.sqlserver.auditing.retention.90.days",
          "matched_rule_id": "azure.sqlserver.auditing_retention_90_days",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sqlserver.microsoft.defender.enabled",
          "matched_rule_id": "azure.sqlserver.microsoft_defender_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sqlserver.recommended.minimal.tls.version",
          "matched_rule_id": "azure.sqlserver.recommended_minimal_tls_version",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sqlserver.tde.encrypted.with.cmk",
          "matched_rule_id": "azure.sqlserver.tde_encrypted_with_cmk",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sqlserver.tde.encryption.enabled",
          "matched_rule_id": "azure.sqlserver.tde_encryption_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.sqlserver.unrestricted.inbound.access",
          "matched_rule_id": "azure.sqlserver.unrestricted_inbound_access",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "storage": {
      "service_name": "storage",
      "total_functions": 50,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.storage.account.encryption.enabled",
          "matched_rule_id": "azure.storage.account.infrastructure.encryption.enabled",
          "confidence_score": 0.8,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.account.public.access",
          "matched_rule_id": "azure.storage.account.public.network.access.disabled",
          "confidence_score": 0.667,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.account.secure.transport.policy",
          "matched_rule_id": "azure.storage.account.secure_transport_policy",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.storage.account.versioning.enabled",
          "matched_rule_id": "azure.storage.account.blob.versioning.enabled",
          "confidence_score": 0.8,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.account.website.https.only",
          "matched_rule_id": "azure.storage.account.sas.https.only",
          "confidence_score": 0.667,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.blob.secure.transport.policy",
          "matched_rule_id": "azure.storage.account.secure_transport_policy",
          "confidence_score": 0.667,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.bucket.secure.transport.policy",
          "matched_rule_id": "azure.storage.account.secure_transport_policy",
          "confidence_score": 0.667,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.encryption.enabled",
          "matched_rule_id": "azure.storage.account.infrastructure.encryption.enabled",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.ensure.encryption.with.customer.managed.keys",
          "matched_rule_id": "azure.storage.account.encryption.with.customer.managed.keys",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.geo.redundant",
          "matched_rule_id": "azure.storage.geo_redundant",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.storage.infrastructure.encryption.is.enabled",
          "matched_rule_id": "azure.storage.account.infrastructure.encryption.enabled",
          "confidence_score": 0.667,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.secure.transport.policy",
          "matched_rule_id": "azure.storage.account.secure_transport_policy",
          "confidence_score": 0.8,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.soft.delete.enabled",
          "matched_rule_id": "azure.storage.file.share.soft.delete.enabled",
          "confidence_score": 0.667,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.storage.account.default.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.account.level.public.access.blocks",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.account.logging.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.account.object.versioning",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.account.policy.public.write.access",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.account.public.read.prohibited",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.account.public.write.prohibited",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.account.replication.enabled",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.blob.default.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.blob.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.blob.object.versioning",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.blob.policy.public.write.access",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.blob.public.access",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.blob.public.access.level.is.disabled",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.blob.public.write.access",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.blob.server.access.logging.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.bucket.default.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.bucket.policy.public.write.access",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.bucket.public.access",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.bucket.server.access.logging.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.container.public.access",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.default.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.ensure.azure.services.are.trusted.to.access.is.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.ensure.minimum.tls.version.12",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.ensure.private.endpoints.in.storage.accounts",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.immutable.blob.enabled",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.logging.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.public.access",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.secure.transfer.required.is.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.server.access.logging.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.storage.tables.pitr.enabled",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.storage.ensure.soft.delete.is.enabled",
          "matched_rule_id": "azure.storage.ensure_soft_delete_is_enabled:az.storage_blob.data_protection_storage_security_object_not_publicly_readable",
          "semantic_score": 0.683,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        }
      ],
      "needs_development": [
        {
          "compliance_function": "azure.storage.bucket.cross.region.replication",
          "new_rule_id": "azure.storage.bucket.cross.region.replication",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.storage.bucket.lifecycle.enabled",
          "new_rule_id": "azure.storage.bucket.lifecycle.enabled",
          "source": "need_development",
          "compliance_ids": [],
          "frameworks": []
        },
        {
          "compliance_function": "azure.storage.bucket.object.versioning",
          "new_rule_id": "azure.storage.bucket.object.versioning",
          "source": "need_development",
          "compliance_ids": [
            "hipaa_multi_cloud_164_312_c_1_0027",
            "hipaa_multi_cloud_164_312_c_2_0028"
          ],
          "frameworks": [
            "HIPAA"
          ]
        },
        {
          "compliance_function": "azure.storage.s3.dataevents.read.enabled",
          "new_rule_id": "azure.storage.s3.dataevents.read.enabled",
          "source": "need_development",
          "compliance_ids": [
            "gdpr_multi_cloud_Article_30_Records_of_processing_activities_0002"
          ],
          "frameworks": [
            "GDPR"
          ]
        },
        {
          "compliance_function": "azure.storage.s3.dataevents.write.enabled",
          "new_rule_id": "azure.storage.s3.dataevents.write.enabled",
          "source": "need_development",
          "compliance_ids": [
            "gdpr_multi_cloud_Article_30_Records_of_processing_activities_0002"
          ],
          "frameworks": [
            "GDPR"
          ]
        }
      ]
    },
    "synapse": {
      "service_name": "synapse",
      "total_functions": 10,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.synapse.audit.logging",
          "matched_rule_id": "azure.synapse.cluster.audit_logging",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.synapse.audit.logging.enabled",
          "matched_rule_id": "azure.synapse.cluster.audit_logging",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.synapse.automated.snapshot",
          "matched_rule_id": "azure.synapse.cluster.automated_snapshot",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.synapse.cluster.audit.logging",
          "matched_rule_id": "azure.synapse.cluster.audit_logging",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.synapse.cluster.automated.snapshot",
          "matched_rule_id": "azure.synapse.cluster.automated_snapshot",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.synapse.cluster.automatic.upgrades",
          "matched_rule_id": "azure.synapse.cluster.automatic_upgrades",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.synapse.cluster.maintenance.settings",
          "matched_rule_id": "azure.synapse.cluster.maintenance_settings",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.synapse.cluster.public.access",
          "matched_rule_id": "azure.synapse.cluster.public_access",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.synapse.public.access",
          "matched_rule_id": "azure.synapse.cluster.public_access",
          "confidence_score": 0.75,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.synapse.workgroup.encryption",
          "matched_rule_id": "azure.synapse.workgroup_encryption",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "virtual": {
      "service_name": "virtual",
      "total_functions": 11,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.virtual.machine.identity.attached",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.virtual.machine.public.ip",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.virtual.machines.default.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.virtual.machines.ebs.public.snapshot",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.virtual.machines.instance.public.ip",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.virtual.machines.public.ip",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.virtual.machines.volume.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.virtual.network.acl.allow.ingress.any.port",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.virtual.network.firewall.enabled",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.virtual.network.flow.logs.enabled",
          "matched_rule_id": "az::kubernetes_managed_cluster::containers_kubernetes_security_cluster_audit_logging_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.virtual.network.networkacl.allow.ingress.any.port",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    },
    "virtualmachines": {
      "service_name": "virtualmachines",
      "total_functions": 2,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.virtualmachines.networkacl.allow.ingress.any.port",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": [
        {
          "compliance_function": "azure.virtualmachines.managed.by.automation",
          "new_rule_id": "azure.virtualmachines.managed.by.automation",
          "source": "need_development",
          "compliance_ids": [
            "nist_800_171_r2_multi_cloud_3_4_9_3.4.9_Control_and_monitor_user-installed_so_0041"
          ],
          "frameworks": [
            "NIST_800-171"
          ]
        }
      ]
    },
    "virtualnetwork": {
      "service_name": "virtualnetwork",
      "total_functions": 2,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.virtualnetwork.allow.ingress.any.port",
          "matched_rule_id": "azure.compute.networkacl_allow_ingress_any_port",
          "semantic_score": 0.571,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.virtualnetwork.flow.logs.enabled",
          "matched_rule_id": "azure.defender.enabled",
          "semantic_score": 0.5,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        }
      ],
      "needs_development": []
    },
    "vm": {
      "service_name": "vm",
      "total_functions": 46,
      "step1_direct_mapped": [
        {
          "compliance_function": "azure.vm.aslr.enabled",
          "matched_rule_id": "azure.vm.aslr_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.vm.automation.association.compliance",
          "matched_rule_id": "azure.vm.automation_association_compliance",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.vm.backup.enabled",
          "matched_rule_id": "azure.vm.backup_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.vm.dep.enabled",
          "matched_rule_id": "azure.vm.dep_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.vm.encryption.enabled",
          "matched_rule_id": "azure.vm.encryption.at.host.enabled",
          "confidence_score": 0.6,
          "match_type": "DIRECT_TOKEN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.ensure.using.managed.disks",
          "matched_rule_id": "azure.vm.ensure_using_managed_disks",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.vm.instance.detailed.monitoring.enabled",
          "matched_rule_id": "azure.vm.instance.detailed_monitoring_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.vm.networkacl.unrestricted.ingress",
          "matched_rule_id": "azure.vm.networkacl_unrestricted_ingress",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.vm.patch.compliance",
          "matched_rule_id": "azure.vm.patch_compliance",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.vm.scale.set.autoscale.enabled",
          "matched_rule_id": "azure.vm.scale_set_autoscale_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.vm.scale.set.configured",
          "matched_rule_id": "azure.vm.scale_set_configured",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.vm.stopped.instance",
          "matched_rule_id": "azure.vm.stopped_instance",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.vm.trusted.launch.enabled",
          "matched_rule_id": "azure.vm.trusted_launch_enabled",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        },
        {
          "compliance_function": "azure.vm.volume.in.use",
          "matched_rule_id": "azure.vm.volume.in_use",
          "confidence_score": 1.0,
          "match_type": "DIRECT_TOKEN",
          "confidence": "HIGH"
        }
      ],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.vm.default.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.disk.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.disk.encryption.enabled",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.ebs.volume.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.ensure.attached.disks.encrypted.with.cmk",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.ensure.unattached.disks.encrypted.with.cmk",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.identity.attached",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.instance.no.public.ip",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.instance.public.ip",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.instance.ssh.key.authentication",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.network.acl.allow.ingress.any.port",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.public.ip",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.public.snapshot",
          "matched_rule_id": "azure.backup.recovery_point_retention",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.security.group.allow.ingress.from.internet.to.tcp.port.22",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.securitygroup.allow.ingress.from.internet.to.tcp.port.22",
          "matched_rule_id": "azure.aks.cluster.private.endpoint.and.public.access.check",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.securitygroup.common.ports.restricted",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.securitygroup.default.restricted",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.securitygroup.rdp.restricted",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.securitygroup.ssh.restricted",
          "matched_rule_id": "azure.entra.policy.require_mfa_for_management_api:az.active_directory_tenant.identity_access_security_password_policy_require_upper_lower_number_special",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.ssl.enabled",
          "matched_rule_id": "az::backup_backup_vault::backup_security_encryption_key_policy_least_privilege",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.volume.encryption",
          "matched_rule_id": "azure.cosmos.db_tables_kms_cmk_encryption_enabled",
          "pattern_score": 3,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.vm.imdsv2.enabled",
          "matched_rule_id": "azure.vm.backup_enabled",
          "semantic_score": 0.5,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.instance.older.than.specific.days",
          "matched_rule_id": "azure.compute.instance.older_than_specific_days",
          "semantic_score": 0.714,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.networkacl.allow.ingress.any.port",
          "matched_rule_id": "azure.compute.networkacl_allow_ingress_any_port",
          "semantic_score": 0.714,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.older.than.specific.days",
          "matched_rule_id": "azure.compute.instance.older_than_specific_days",
          "semantic_score": 0.571,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        },
        {
          "compliance_function": "azure.vm.ssm.enabled",
          "matched_rule_id": "azure.vm.backup_enabled",
          "semantic_score": 0.5,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        }
      ],
      "needs_development": [
        {
          "compliance_function": "azure.vm.elastic.ip.unassigned",
          "new_rule_id": "azure.vm.elastic.ip.unassigned",
          "source": "need_development",
          "compliance_ids": [
            "nist_800_171_r2_multi_cloud_3_4_1_3.4.1_Establish_and_maintain_baseline_confi_0037"
          ],
          "frameworks": [
            "NIST_800-171"
          ]
        },
        {
          "compliance_function": "azure.vm.instance.managed.by.ssm",
          "new_rule_id": "azure.vm.instance.managed.by.ssm",
          "source": "need_development",
          "compliance_ids": [
            "nist_800_171_r2_multi_cloud_3_4_1_3.4.1_Establish_and_maintain_baseline_confi_0037"
          ],
          "frameworks": [
            "NIST_800-171"
          ]
        },
        {
          "compliance_function": "azure.vm.managed.by.automation",
          "new_rule_id": "azure.vm.managed.by.automation",
          "source": "need_development",
          "compliance_ids": [
            "nist_800_171_r2_multi_cloud_3_4_2_3.4.2_Establish_and_enforce_security_config_0038"
          ],
          "frameworks": [
            "NIST_800-171"
          ]
        },
        {
          "compliance_function": "azure.vm.managed.by.ssm",
          "new_rule_id": "azure.vm.managed.by.ssm",
          "source": "need_development",
          "compliance_ids": [
            "nist_800_171_r2_multi_cloud_3_4_6_3.4.6_Employ_the_principle_of_least_functio_0039"
          ],
          "frameworks": [
            "NIST_800-171"
          ]
        },
        {
          "compliance_function": "azure.vm.ssm.managed",
          "new_rule_id": "azure.vm.ssm.managed",
          "source": "need_development",
          "compliance_ids": [
            "hipaa_multi_cloud_164_308_a_5_ii_b_0012"
          ],
          "frameworks": [
            "HIPAA"
          ]
        }
      ]
    },
    "vnet": {
      "service_name": "vnet",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [],
      "step3_context_ai_mapped": [
        {
          "compliance_function": "azure.vnet.flow.logs.enabled",
          "matched_rule_id": "azure.defender.enabled",
          "semantic_score": 0.5,
          "match_type": "CONTEXT_AI",
          "confidence": "MEDIUM"
        }
      ],
      "needs_development": []
    },
    "vpc": {
      "service_name": "vpc",
      "total_functions": 1,
      "step1_direct_mapped": [],
      "step2_ai_pattern_mapped": [
        {
          "compliance_function": "azure.vpc.flow.logs.enabled",
          "matched_rule_id": "az::azure_network_vpc::network_security_vpc_flow_logs_enabled",
          "pattern_score": 2,
          "match_type": "AI_PATTERN",
          "confidence": "MEDIUM"
        }
      ],
      "step3_context_ai_mapped": [],
      "needs_development": []
    }
  }
}